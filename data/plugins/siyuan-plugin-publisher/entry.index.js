var bi=Object.defineProperty;var wi=(r,a,t)=>a in r?bi(r,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[a]=t;var x=(r,a,t)=>(wi(r,typeof a!="symbol"?a+"":a,t),t);import{M as H,O as w,P as N,bL as Ei,bM as vi,A as Z,W as P,$ as L,u as m,Z as z,bN as et,bO as tt,a0 as f,Q as rt,G as Ti,T as k,U as _,Y as Pi,bP as ki,aJ as Si,bQ as ho,an as yo,bR as ja,a5 as ae,t as Ye,F as _e,at as Te,_ as G,aA as fo,a9 as _o,aw as te,bS as Ai,q as Ha,bT as Pe,X as _t,v as qe,B as At,a$ as Ft,bU as Es,aC as Ci,bV as Cs,bW as Di,f as po,V as Ui,a1 as Oi,J as Mi,bX as Ii}from"./chunks/chunk.vendor.js";import{d as xi}from"./chunks/chunk.vendor_vite-plugin-node-polyfills.js";import{w as Vi}from"./chunks/chunk.vendor_zhi-lib-base.js";import{u as Ni,c as Bi}from"./chunks/chunk.vendor_vue-i18n.js";import{Q as Ae,M as A,B as it,T as oe,d as se,H as Q,Z as Ca}from"./chunks/chunk.vendor_zhi-common.js";import{T as jt,d as vt,u as mt,n as ht}from"./chunks/chunk.vendor_zhi-device.js";import{u as ct,a as $e,c as Gi,b as $i}from"./chunks/chunk.vendor_vue-router.js";import{E as Y,a as Ra,b as be,c as we,d as Ee,e as Ie,f as qt,g as Ts,h as Li,i as ji,j as Kt,k as bo,l as wo,m as Eo,n as Re,o as vo,p as To,q as Fa,r as Po,s as Ka,t as ko,u as So,v as Ao,w as Je,x as Xe,y as Hi,z as Ri,A as Fi,B as Ct,C as Ki,D as Yi,F as zi,G as Wi}from"./chunks/chunk.vendor_element-plus.js";import{W as qi,v as Ji,m as Xi,A as Zi,x as Qi,T as ce,P as R,H as Ce,j as Co,D as Ya,L as Dt,E as en,R as ze,Q as Pt,Z as Qe,z as nt,S as tn,J as sn,k as pt,X as Ut,a as an}from"./chunks/chunk.vendor_zhi-blog-api.js";import{C as on,a as nn}from"./chunks/chunk.vendor_chatgpt.js";import{s as ln}from"./chunks/chunk.vendor_shorthash2.js";import{v as rn}from"./chunks/chunk.vendor_uuid.js";import{n as Ze,i as at,g as Do,a as Ke}from"./chunks/chunk.vendor_zhi-siyuan-api.js";import{Z as cn}from"./chunks/chunk.vendor_zhi-fetch-middleware.js";import{I as Uo,E as Oo,B as Mo,T as Io}from"./chunks/chunk.vendor_simple-xmlrpc.js";import{f as pn}from"./chunks/chunk.vendor_cross-fetch.js";import{x as un}from"./chunks/chunk.vendor_xmlbuilder2.js";import{k as gn,L as dn}from"./chunks/chunk.vendor_siyuan-plugin-picgo.js";import{b as za}from"./chunks/chunk.vendor_buffer.js";import{g as Wt}from"./chunks/chunk.vendor_js-base64.js";import{_ as ye}from"./chunks/chunk.vendor_lodash.js";import{d as mn,c as hn}from"./chunks/chunk.vendor_pinia.js";import{l as Yt}from"./chunks/chunk.vendor_cheerio.js";import{C as xo,U as yn,B as fn}from"./chunks/chunk.vendor_crypto-js.js";import{D as Vo}from"./chunks/chunk.vendor_zhi-notion-markdown.js";import{Z as _n,Y as bn}from"./chunks/chunk.vendor_zhi-github-middleware.js";import{S as wn}from"./chunks/chunk.vendor_zhi-gitlab-middleware.js";import"./chunks/chunk.vendor_process.js";import"./chunks/chunk.vendor_lodash-es.js";import"./chunks/chunk.vendor_async-validator.js";import"./chunks/chunk.vendor_dayjs.js";import"./chunks/chunk.vendor_asn1-js.js";import"./chunks/chunk.vendor_bn-js.js";import"./chunks/chunk.vendor_inherits.js";import"./chunks/chunk.vendor_safer-buffer.js";import"./chunks/chunk.vendor_minimalistic-assert.js";import"./chunks/chunk.vendor_keyv.js";import"./chunks/chunk.vendor_events.js";import"./chunks/chunk.vendor_json-buffer.js";import"./chunks/chunk.vendor_p-timeout.js";import"./chunks/chunk.vendor_quick-lru.js";import"./chunks/chunk.vendor_js-tiktoken.js";import"./chunks/chunk.vendor_base64-js.js";import"./chunks/chunk.vendor_eventsource-parser.js";import"./chunks/chunk.vendor_ieee754.js";import"./chunks/chunk.vendor_vue-demi.js";import"./chunks/chunk.vendor_domutils.js";import"./chunks/chunk.vendor_dom-serializer.js";import"./chunks/chunk.vendor_domelementtype.js";import"./chunks/chunk.vendor_entities.js";import"./chunks/chunk.vendor_domhandler.js";import"./chunks/chunk.vendor_cheerio-select.js";import"./chunks/chunk.vendor_css-select.js";import"./chunks/chunk.vendor_boolbase.js";import"./chunks/chunk.vendor_css-what.js";import"./chunks/chunk.vendor_nth-check.js";import"./chunks/chunk.vendor_parse5.js";import"./chunks/chunk.vendor_parse5-htmlparser2-tree-adapter.js";import"./chunks/chunk.vendor_htmlparser2.js";import"./chunks/chunk.vendor_crypto-browserify.js";import"./chunks/chunk.vendor_randombytes.js";import"./chunks/chunk.vendor_safe-buffer.js";import"./chunks/chunk.vendor_create-hash.js";import"./chunks/chunk.vendor_md5-js.js";import"./chunks/chunk.vendor_hash-base.js";import"./chunks/chunk.vendor_readable-stream.js";import"./chunks/chunk.vendor_util.js";import"./chunks/chunk.vendor_is-arguments.js";import"./chunks/chunk.vendor_has-tostringtag.js";import"./chunks/chunk.vendor_has-symbols.js";import"./chunks/chunk.vendor_call-bind.js";import"./chunks/chunk.vendor_get-intrinsic.js";import"./chunks/chunk.vendor_has-proto.js";import"./chunks/chunk.vendor_function-bind.js";import"./chunks/chunk.vendor_has.js";import"./chunks/chunk.vendor_is-generator-function.js";import"./chunks/chunk.vendor_which-typed-array.js";import"./chunks/chunk.vendor_for-each.js";import"./chunks/chunk.vendor_is-callable.js";import"./chunks/chunk.vendor_available-typed-arrays.js";import"./chunks/chunk.vendor_gopd.js";import"./chunks/chunk.vendor_is-typed-array.js";import"./chunks/chunk.vendor_util-deprecate.js";import"./chunks/chunk.vendor_string_decoder.js";import"./chunks/chunk.vendor_ripemd160.js";import"./chunks/chunk.vendor_sha-js.js";import"./chunks/chunk.vendor_cipher-base.js";import"./chunks/chunk.vendor_stream-browserify.js";import"./chunks/chunk.vendor_create-hmac.js";import"./chunks/chunk.vendor_browserify-sign.js";import"./chunks/chunk.vendor_browserify-rsa.js";import"./chunks/chunk.vendor_elliptic.js";import"./chunks/chunk.vendor_minimalistic-crypto-utils.js";import"./chunks/chunk.vendor_brorand.js";import"./chunks/chunk.vendor_hash-js.js";import"./chunks/chunk.vendor_hmac-drbg.js";import"./chunks/chunk.vendor_parse-asn1.js";import"./chunks/chunk.vendor_evp_bytestokey.js";import"./chunks/chunk.vendor_browserify-aes.js";import"./chunks/chunk.vendor_buffer-xor.js";import"./chunks/chunk.vendor_pbkdf2.js";import"./chunks/chunk.vendor_browserify-cipher.js";import"./chunks/chunk.vendor_browserify-des.js";import"./chunks/chunk.vendor_des-js.js";import"./chunks/chunk.vendor_diffie-hellman.js";import"./chunks/chunk.vendor_miller-rabin.js";import"./chunks/chunk.vendor_create-ecdh.js";import"./chunks/chunk.vendor_public-encrypt.js";import"./chunks/chunk.vendor_randomfill.js";(function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))s(e);new MutationObserver(e=>{for(const o of e)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(e){const o={};return e.integrity&&(o.integrity=e.integrity),e.referrerPolicy&&(o.referrerPolicy=e.referrerPolicy),e.crossOrigin==="use-credentials"?o.credentials="include":e.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(e){if(e.ep)return;e.ep=!0;const o=t(e);fetch(e.href,o)}})();const bt=!1,Me="dynamic-config",En=["custom_Zhihu","custom_Csdn","custom_Wechat","custom_Jianshu"],vn=["common_Yuque","common_Notion","common_Hexo","gitlab_Gitlabhexo"];typeof window>"u"?xi.global.console=console:window.console=window.console;const B=r=>Vi(r,"publisher-widget",bt),K=()=>{const{messages:r,locale:a}=Ni();return{t:s=>{var o;return((o=r.value)==null?void 0:o[a.value])[s]||s},locale:a}},Tn={class:"header-default"},Pn=H({__name:"DefaultHeader",setup(r){return K(),(a,t)=>(w(),N("div",Tn))}}),No="1.15.1",kn={"@element-plus/icons-vue":"^2.1.0","@terwer/esbuild-config-custom":"^2.0.0","@vueuse/components":"^10.5.0","@vueuse/core":"^10.5.0",chatgpt:"^5.2.5",cheerio:"1.0.0-rc.12","cross-fetch":"^3.1.8","crypto-js":"^4.1.1","element-plus":"^2.3.14","gray-matter":"^4.0.3","js-base64":"^3.7.5","js-yaml":"^4.1.0",lodash:"^4.17.21",pinia:"^2.1.6",shorthash2:"^1.0.3","simple-xmlrpc":"^1.4.2",siyuan:"^0.8.4","siyuan-plugin-picgo":"^1.4.4",uuid:"^9.0.1",vue:"^3.3.4","vue-i18n":"^9.5.0","vue-router":"^4.2.5",xmlbuilder2:"^3.1.1","zhi-blog-api":"^1.45.0","zhi-common":"^1.24.0","zhi-device":"^2.3.1","zhi-fetch-middleware":"^0.6.5","zhi-github-middleware":"^0.4.3","zhi-gitlab-middleware":"^0.6.5","zhi-lib-base":"^0.5.0","zhi-notion-markdown":"^0.1.4","zhi-siyuan-api":"^2.10.5","zhi-xmlrpc-middleware":"^0.5.12"},wt=()=>{const r=B("use-siyuan-device");return{isInSiyuanMainWin:()=>{const o=jt.getDevice(),i=o===vt.DeviceType_Siyuan_MainWin;return r.debug("deviceType=>",o),r.debug("isSiyuanMainWin=>",String(i)),i},isInSiyuanWidget:()=>{const o=jt.getDevice(),i=o===vt.DeviceType_Siyuan_Widget;return r.debug("deviceType=>",o),r.debug("isSiyuanWidget=>",String(i)),i},isInChromeExtension:()=>{const o=jt.getDevice(),i=o===vt.DeviceType_Chrome_Extension;return r.debug("deviceType=>",o),r.debug("isChromeExtension=>",String(i)),i},isInSiyuanOrSiyuanNewWin:()=>{const o=jt.getDevice(),i=o===vt.DeviceType_Siyuan_MainWin||o===vt.DeviceType_Siyuan_NewWin||o===vt.DeviceType_Siyuan_Widget;return r.debug("deviceType=>",o),r.debug("isSiyuanOrSiyuanNewWin=>",String(i)),i}}},Wa=r=>(et("data-v-b9b16a83"),r=r(),tt(),r),Sn={class:"footer"},An={class:"text"},Cn=Wa(()=>P("span",{class:"text"},".",-1)),Dn=Wa(()=>P("span",{class:"text"},".",-1)),Un=Wa(()=>P("span",{class:"text"},".",-1)),On={key:0,class:"text"},Mn={key:2,class:"text"},In=H({__name:"DefaultFooter",setup(r){const{t:a}=K(),t=Ei(),s=vi(t),{isInChromeExtension:e}=wt(),o=e(),i=Z(No),n=Ae.nowYear(),l=ct(),p=()=>{window.open("https://github.com/terwer/siyuan-plugin-publisher")},c=async()=>{await l.push({path:"/about",query:{showBack:"true"}})},g=()=>{l.push({path:"/test"})},y=()=>{const E=chrome.runtime.getURL("/index.html#/");window.open(E)},u=async()=>{await l.push({path:"/setting/publish",query:{showBack:"true"}})},d=async()=>{await l.push({path:"/setting/general",query:{showBack:"true"}})},b=async()=>{await l.push({path:"/test",query:{showBack:"true"}})};return(h,E)=>(w(),N("div",null,[P("div",Sn,[P("div",null,[P("span",An," ©2011-"+L(m(n)),1),P("span",{class:"text s-dark",onClick:E[0]||(E[0]=v=>p())}," siyuan-plugin-publisher "),P("span",{class:"text",onClick:g},"v"+L(i.value)+" ",1),P("span",{class:"text s-dark",onClick:E[1]||(E[1]=v=>c())},L(m(a)("syp.about")),1),Cn,P("span",{class:"text s-dark",onClick:E[2]||(E[2]=v=>m(s)())},L(m(t)?m(a)("theme.mode.light"):m(a)("theme.mode.dark")),1),Dn,P("span",{class:"text s-dark",onClick:u},L(m(a)("service.tab.publish.setting")),1),Un,P("span",{class:"text s-dark",onClick:d},L(m(a)("service.tab.change.local")),1),m(bt)?(w(),N("span",On,".")):z("",!0),m(bt)?(w(),N("span",{key:1,class:"text s-dark",onClick:b}," 组件测试 ")):z("",!0),m(o)?(w(),N("span",Mn,".")):z("",!0),m(o)?(w(),N("span",{key:3,class:"text s-dark",onClick:E[3]||(E[3]=v=>y())},L(m(a)("blog.newwin.open")),1)):z("",!0)])])]))}});const ue=(r,a)=>{const t=r.__vccOpts||r;for(const[s,e]of a)t[s]=e;return t},xn=ue(In,[["__scopeId","data-v-b9b16a83"]]),Vn={id:"app-layout-default"},Nn={class:"default-main"},Bn=H({__name:"AppLayoutDefault",setup(r){return(a,t)=>(w(),N("div",Vn,[f(Pn),P("div",Nn,[rt(a.$slots,"default",{},void 0,!0)]),f(xn)]))}});const Gn=ue(Bn,[["__scopeId","data-v-0cf32ad2"]]),$n=H({__name:"AppLayout",setup(r){const a=Ti(Gn);return(t,s)=>(w(),k(ki,null,{default:_(()=>[(w(),k(Pi(a.value),null,{default:_(()=>[rt(t.$slots,"default")]),_:3}))]),_:3}))}});const Ln=H({__name:"App",setup(r){return(a,t)=>{const s=Si("router-view");return w(),k($n,null,{default:_(()=>[f(s)]),_:1})}}}),jn={title:"自动提取标题",description:"从文章内容中生成有意义的标题",key:"title",content:"请为这篇文章生成简洁且完整概括的标题，只处理文本，尽量返回中文标题。标题长度不超过100个中文字符或255个英文字符。输出为 JSON 格式，键名为 title，结果需放在 {} 内。完整结果必须是合法JSON，不得包含非法 JSON 字符。"},Hn={title:"自动提取摘要",description:"从文章内容生成文章摘要",key:"desc",content:"请为这篇文章生成简明扼要的摘要，只处理文本，尽量返回中文摘要。标题长度不超过255个中文字符或512个英文字符。输出为 JSON 格式，键名为 desc，结果需放在 {} 内。完整结果必须是合法JSON，不得包含非法 JSON 字符。"},Rn={title:"自动提取标签",description:"为文章添加标签",key:"tags",content:"请为这篇文章生成标签，只处理文本，尽量返回中文标签。单个标签不超过6个字符，多个标签用英文逗号分隔，最多返回5个标签。如果单个标签是英文，英文字母必须全部小写并且每个单词之间用-拼接。标签名称不能重复，不能包含任何除英文字母、-以及汉字以外的字符。输出为 JSON 格式，键名为 tags，指令放在数组内，结果需放在 {} 内。完整结果必须是合法JSON，不得包含非法 JSON 字符。"},Fn={title:"自动提取分类",description:"对文章内容进行分类",key:"categories",content:"请为这篇文章文章内容进行分类，只处理文本，尽量返回中文分类。每个分类名称不超过6个字符，最多返回3个分类。如果分类是英文，需要使用驼峰命名并且首字母大写。输出为 JSON 格式，键名为 categories，结果需放在 {} 内。完整结果必须是合法JSON，不得包含非法 JSON 字符。"},Jt={titlePrompt:jn,shortDescPrompt:Hn,tagPrompt:Rn,categoryPrompt:Fn};class Kn extends qi{constructor(){super();x(this,"experimentalUseSiyuanNoteAIConfig");x(this,"experimentalAIEnabled");x(this,"experimentalAICode");x(this,"experimentalAIBaseUrl");x(this,"experimentalAIProxyUrl");this.experimentalUseSiyuanNoteAIConfig=!0,this.experimentalAIEnabled=!1}}const Xt=()=>{const r="publish-preference-cfg",a=B("use-publish-pref"),t=()=>{var l,p,c;const e=new Kn,o=ho(r,e,{serializer:ja.object}),i=mt.siyuanWindow(),n=(c=(p=(l=i==null?void 0:i.siyuan)==null?void 0:l.config)==null?void 0:p.ai)==null?void 0:c.openAI;return a.info("try load win.siyuan.config =>",n),n?(o.value.experimentalUseSiyuanNoteAIConfig=!0,o.value.experimentalAIProxyUrl=n.apiProxy,o.value.experimentalAICode=n.apiKey,o.value.experimentalAIBaseUrl=n.apiBaseURL,a.info("use siyuan-note ai config")):(o.value.experimentalUseSiyuanNoteAIConfig=!1,a.info("use custom ai config")),o};return{getPublishPreferenceSetting:t,getReadOnlyPublishPreferenceSetting:()=>{const e=t();return yo(e)}}};class C{static blogApi(a,t){if(!t)throw new Error("apiAdaptor cannot be null");if(!t.getUsersBlogs)throw this.logger.error("apiAdaptor must implements BlogApi",t),new Error(`apiAdaptor must implements BlogApi => ${this.getObjectName(t)}`);return new Ji(t)}static webApi(a,t){if(!t)throw new Error("webAdaptor cannot be null");if(!t.getMetaData)throw this.logger.error("webAdaptor must implements WebApi",t),new Error(`webAdaptor must implements WebApi => ${this.getObjectName(t)}`);return new Xi(t)}static getObjectName(a){try{return typeof a=="function"&&/^class\s/.test(a.toString())?a.name:typeof a=="function"?a.name||"anonymous function":typeof a=="object"&&Object.values(a.constructor).includes(a)?Object.keys(a.constructor)[Object.values(a.constructor).indexOf(a)]:typeof a!="object"?a:"{}"}catch(t){return console.error(t),"{}"}}static emptyOrDefault(a,t){return A.isEmptyString(a)?t:a}}x(C,"logger",B("publisher-widget-utils"));const ut=()=>{const r=B("use-chatgpt"),{getReadOnlyPublishPreferenceSetting:a}=Xt(),t=a();let s;try{A.isEmptyString(t.value.experimentalAIProxyUrl)?s=new nn({apiKey:C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.OPENAI_ACCESS_TOKEN,t.value.experimentalAICode),apiBaseUrl:C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.OPENAI_BASE_URL,t.value.experimentalAIBaseUrl),debug:bt,fetch:self.fetch.bind(self)}):s=new on({accessToken:C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.OPENAI_API_KEY,t.value.experimentalAICode),apiReverseProxyUrl:C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.OPENAI_PROXY_URL,t.value.experimentalAIProxyUrl),debug:bt,fetch:self.fetch.bind(self)})}catch(o){throw r.error("Failed to initialize ChatGPT API:",o),o}return{chat:async(o,i)=>{try{r.debug("chat q =>",{q:o,opts:i});const n=await s.sendMessage(o,i);return r.debug("chat res =>",n),n.text}catch(n){r.error("Chat encountered an error:",n)}}}};var Ot=(r=>(r[r.MAX_INPUT_TOKEN_LENGTH=3e3]="MAX_INPUT_TOKEN_LENGTH",r))(Ot||{});const Yn=r=>(et("data-v-093b8fbc"),r=r(),tt(),r),zn={class:"form-tag-cates"},Wn={key:0},qn=Yn(()=>P("div",{class:"form-item-bottom"},null,-1)),Jn=H({__name:"CommonCategories",props:{useAi:{type:Boolean,default:!1},cates:{type:Array,default:[]},md:{type:String,default:""},html:{type:String,default:""}},emits:["emitSyncCates"],setup(r,{emit:a}){const t=r,s=B("common-categories"),{t:e}=K(),o=Z(),i=ae({isLoading:!1,useAi:t.useAi,cate:{inputValue:"",dynamicCates:t.cates.length==0?[]:t.cates,inputVisible:!1},recommCates:[],md:t.md,html:t.html});Ye(()=>t.useAi,l=>{i.useAi=l}),Ye(()=>t.html,l=>{i.html=l});const n={handleTagClose:l=>{i.cate.dynamicCates.splice(i.cate.dynamicCates.indexOf(l),1),a("emitSyncCates",i.cate.dynamicCates)},tagShowInput:()=>{i.cate.inputVisible=!0,_o(()=>{o.value.input.focus()})},handleTagInputConfirm:()=>{i.cate.inputValue&&(i.cate.dynamicCates.push(i.cate.inputValue),a("emitSyncCates",i.cate.dynamicCates)),i.cate.inputVisible=!1,i.cate.inputValue=""},fetchCate:async()=>{try{i.isLoading=!0;const l=Jt.categoryPrompt.content,{chat:p}=ut(),c=await p(l,{name:"categories",systemMessage:it.parseHtml(i.html,Ot.MAX_INPUT_TOKEN_LENGTH,!0)});if(A.isEmptyString(c)){Y.error("请求错误，请在偏好设置配置请求地址和ChatGPT key！");return}const g=oe.safeParse(c,{});if(!(g!=null&&g.categories)||(g==null?void 0:g.categories.length)==0)throw new Error("文档信息量太少，未能抽取有效信息");i.recommCates=g.categories,s.info("使用AI智能生成的分类结果 =>",{inputWord:l,chatText:c})}catch(l){s.error(e("main.opt.failure")+"=>",l),Y.error(e("main.opt.failure")+"=>"+l)}finally{i.isLoading=!1}}};return(l,p)=>{const c=Ra,g=be,y=we,u=Ee,d=Ie;return w(),N("div",zn,[f(u,{label:m(e)("main.commonn.cate.title")},{default:_(()=>[(w(!0),N(_e,null,Te(i.cate.dynamicCates,b=>(w(),k(c,{key:b,"disable-transitions":!1,class:"mx-1 pub-tag",closable:"",onClose:h=>n.handleTagClose(b)},{default:_(()=>[G(L(b),1)]),_:2},1032,["onClose"]))),128)),i.cate.inputVisible?(w(),k(g,{key:0,ref_key:"tagRefInput",ref:o,modelValue:i.cate.inputValue,"onUpdate:modelValue":p[0]||(p[0]=b=>i.cate.inputValue=b),class:"ml-1 w-20 pub-tag-input",size:"small",onBlur:n.handleTagInputConfirm,onKeyup:fo(n.handleTagInputConfirm,["enter"])},null,8,["modelValue","onBlur","onKeyup"])):(w(),k(y,{key:1,class:"button-new-tag ml-1 el-tag",size:"small",onClick:n.tagShowInput},{default:_(()=>[G(L(m(e)("main.cate.new")),1)]),_:1},8,["onClick"]))]),_:1},8,["label"]),i.useAi?(w(),N("div",Wn,[i.recommCates.length>0?(w(),k(u,{key:0,class:"recomm-show"},{default:_(()=>[G(" 推荐的分类： "),(w(!0),N(_e,null,Te(i.recommCates,b=>(w(),k(c,{class:"ml-2 recomm-cate",type:"success"},{default:_(()=>[G(L(b),1)]),_:2},1024))),256))]),_:1})):z("",!0),f(u,{class:"cat-action"},{default:_(()=>[f(y,{size:"small",loading:i.isLoading,type:"primary",onClick:n.fetchCate},{default:_(()=>[G(L(i.isLoading?m(e)("main.opt.loading"):m(e)("main.auto.fetch.cate")),1)]),_:1},8,["loading","onClick"])]),_:1}),f(u,null,{default:_(()=>[f(d,{closable:!1,title:m(e)("category.ai.hand"),class:"form-item-tip",type:"warning"},null,8,["title"])]),_:1})])):z("",!0),f(u,null,{default:_(()=>[f(d,{closable:!1,title:m(e)("category.batch.not.supported"),class:"form-item-tip",type:"warning"},null,8,["title"])]),_:1}),qn])}}});const Xn=ue(Jn,[["__scopeId","data-v-093b8fbc"]]),Zn={class:"form-tags"},Qn=H({__name:"PublishTags",props:{useAi:{type:Boolean,default:!1},pageId:{type:String,default:""},tags:{type:String,default:""},md:{type:String,default:""},html:{type:String,default:""}},emits:["emitSyncTags"],setup(r,{emit:a}){const t=r,s=B("publish-tags"),{t:e}=K(),o=Z(),i=ae({isTagLoading:!1,useAi:t.useAi,pageId:t.pageId,tag:{inputValue:"",dynamicTags:A.isEmptyString(t.tags)?[]:t.tags.split(","),inputVisible:!1},md:t.md,html:t.html});Ye(()=>t.useAi,l=>{i.useAi=l}),Ye(()=>t.html,l=>{i.html=l});const n={handleTagClose:l=>{i.tag.dynamicTags.splice(i.tag.dynamicTags.indexOf(l),1),a("emitSyncTags",i.tag.dynamicTags)},tagShowInput:()=>{i.tag.inputVisible=!0,_o(()=>{o.value.input.focus()})},handleTagInputConfirm:()=>{i.tag.inputValue&&(i.tag.dynamicTags.push(i.tag.inputValue),a("emitSyncTags",i.tag.dynamicTags)),i.tag.inputVisible=!1,i.tag.inputValue=""},fetchTag:async()=>{try{i.isTagLoading=!0;const l=Jt.tagPrompt.content,{chat:p}=ut(),c=await p(l,{name:"tags",systemMessage:it.parseHtml(i.html,Ot.MAX_INPUT_TOKEN_LENGTH,!0)});if(A.isEmptyString(c)){Y.error("请求错误，请在偏好设置配置请求地址和ChatGPT key！");return}const g=oe.safeParse(c,{});if(!(g!=null&&g.tags)||(g==null?void 0:g.tags.length)==0)throw new Error("文档信息量太少，未能抽取有效信息");for(let y=0;y<g.tags.length;y++)i.tag.dynamicTags.includes(g.tags[y])||i.tag.dynamicTags.push(g.tags[y]);s.info("使用AI智能生成的标签结果 =>",{inputWord:l,chatText:c}),a("emitSyncTags",i.tag.dynamicTags),Y.success("使用人工智能智能提取标签成功")}catch(l){s.error(e("main.opt.failure")+"=>",l),Y.error(e("main.opt.failure")+"=>"+l)}finally{i.isTagLoading=!1}}};return(l,p)=>{const c=Ra,g=be,y=we,u=Ee;return w(),N("div",Zn,[f(u,{label:m(e)("main.tag")},{default:_(()=>[(w(!0),N(_e,null,Te(i.tag.dynamicTags,d=>(w(),k(c,{key:d,"disable-transitions":!1,class:"mx-1 pub-tag",closable:"",onClose:b=>n.handleTagClose(d)},{default:_(()=>[G(L(d),1)]),_:2},1032,["onClose"]))),128)),i.tag.inputVisible?(w(),k(g,{key:0,ref_key:"tagRefInput",ref:o,modelValue:i.tag.inputValue,"onUpdate:modelValue":p[0]||(p[0]=d=>i.tag.inputValue=d),class:"ml-1 w-20 pub-tag-input",size:"small",onBlur:n.handleTagInputConfirm,onKeyup:fo(n.handleTagInputConfirm,["enter"])},null,8,["modelValue","onBlur","onKeyup"])):(w(),k(y,{key:1,class:"button-new-tag ml-1 el-tag",size:"small",onClick:n.tagShowInput},{default:_(()=>[G(L(m(e)("main.tag.new")),1)]),_:1},8,["onClick"]))]),_:1},8,["label"]),i.useAi?(w(),k(u,{key:0},{default:_(()=>[f(y,{size:"small",loading:i.isTagLoading,type:"primary",onClick:n.fetchTag},{default:_(()=>[G(L(i.isTagLoading?m(e)("main.opt.loading"):m(e)("main.auto.fetch.tag")),1)]),_:1},8,["loading","onClick"])]),_:1})):z("",!0)])}}});const Bo=ue(Qn,[["__scopeId","data-v-32b4b281"]]),el={class:"form-desc"},Go=H({__name:"PublishDescription",props:{useAi:{type:Boolean,default:!1},pageId:{type:String,default:""},desc:{type:String,default:""},md:{type:String,default:""},html:{type:String,default:""}},emits:["emitSyncDesc"],setup(r,{emit:a}){const t=r,s=B("publish-description"),{t:e}=K(),o=ae({isDescLoading:!1,useAi:t.useAi,pageId:t.pageId,desc:t.desc,md:t.md,html:t.html});Ye(()=>t.useAi,l=>{o.useAi=l}),Ye(()=>t.html,l=>{o.html=l});const i=async()=>{o.isDescLoading=!0;try{const l=Jt.shortDescPrompt.content,{chat:p}=ut(),c=await p(l,{name:"desc",systemMessage:it.parseHtml(o.html,Ot.MAX_INPUT_TOKEN_LENGTH,!0)});if(A.isEmptyString(c)){Y.error("请求错误，请在偏好设置配置请求地址和ChatGPT key！");return}const g=oe.safeParse(c,{});if(A.isEmptyString(g==null?void 0:g.desc))throw new Error("文档信息量太少，未能抽取有效信息");o.desc=g.desc,s.info("使用AI智能生成的摘要结果 =>",{inputWord:l,chatText:c}),a("emitSyncDesc",o.desc),Y.success("使用人工智能提取摘要成功")}catch(l){s.error(e("main.opt.failure")+"=>",l),Y.error(e("main.opt.failure")+"=>"+l)}finally{o.isDescLoading=!1}},n=()=>{a("emitSyncDesc",o.desc)};return(l,p)=>{const c=be,g=Ee,y=we;return w(),N("div",el,[f(g,{label:m(e)("main.desc")},{default:_(()=>[f(c,{modelValue:o.desc,"onUpdate:modelValue":p[0]||(p[0]=u=>o.desc=u),autosize:{minRows:3,maxRows:16},type:"textarea",placeholder:"请输入文章摘要",onInput:n},null,8,["modelValue"])]),_:1},8,["label"]),o.useAi?(w(),k(g,{key:0},{default:_(()=>[f(y,{size:"small",loading:o.isDescLoading,type:"primary",onClick:i},{default:_(()=>[G(L(o.isDescLoading?m(e)("main.opt.loading"):m(e)("main.auto.fetch.desc")),1)]),_:1},8,["loading"])]),_:1})):z("",!0)])}}});var je=(r=>(r[r.YAML=0]="YAML",r[r.MD_CONTENT=1]="MD_CONTENT",r[r.YAML_MD_CONTENT=2]="YAML_MD_CONTENT",r[r.HTML_CONTENT=3]="HTML_CONTENT",r))(je||{});const tl=()=>{const r=new Date().toISOString();return ln(r).toLowerCase()},sl=()=>rn(),al=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){const t=Math.random()*16|0;return(a==="x"?t:t&3|8).toString(16)}),Ps={newUuid:sl,newID:tl,randomUuid:al};class Ht{constructor(a,t,s,e,o){x(this,"platformType");x(this,"subPlatformType");x(this,"platformKey");x(this,"platformName");x(this,"platformIcon");x(this,"isEnabled");x(this,"isAuth");x(this,"authMode");x(this,"authUrl");x(this,"domain");x(this,"cookieLimit");x(this,"isSys");this.platformType=a,this.platformKey=t,this.platformName=s,this.isAuth=!1,this.isEnabled=!1,this.authMode="api",this.cookieLimit=!1,this.isSys=!1,this.subPlatformType=e,this.platformIcon=o}}var pe=(r=>(r.API="api",r.WEBSITE="web",r))(pe||{}),he=(r=>(r.Common="Common",r.Metaweblog="Metaweblog",r.Wordpress="Wordpress",r.Github="Github",r.Gitlab="Gitlab",r.Custom="Custom",r.System="System",r))(he||{}),D=(r=>(r.Common_Yuque="Yuque",r.Common_Notion="Notion",r.Common_Halo="Halo",r.Github_Hexo="Hexo",r.Github_Hugo="Hugo",r.Github_Jekyll="Jekyll",r.Github_Vuepress="Vuepress",r.Github_Vuepress2="Vuepress2",r.Github_Vitepress="Vitepress",r.Gitlab_Hexo="Gitlabhexo",r.Gitlab_Hugo="Gitlabhugo",r.Gitlab_Jekyll="Gitlabjekyll",r.Gitlab_Vuepress="Gitlabvuepress",r.Gitlab_Vuepress2="Gitlabvuepress2",r.Gitlab_Vitepress="Gitlabvitepress",r.Metaweblog_Metaweblog="Metaweblog",r.Metaweblog_Cnblogs="Cnblogs",r.Metaweblog_Typecho="Typecho",r.Wordpress_Wordpress="Wordpress",r.Custom_Zhihu="Zhihu",r.Custom_CSDN="Csdn",r.Custom_Wechat="Wechat",r.Custom_Jianshu="Jianshu",r.Custom_Juejin="Juejin",r.System_Siyuan="Siyuan",r.NONE="none",r))(D||{});function ol(r){const a=[];switch(r){case"Common":a.push("Yuque"),a.push("Notion"),a.push("Halo");break;case"Github":a.push("Hexo"),a.push("Hugo"),a.push("Jekyll"),a.push("Vuepress"),a.push("Vuepress2"),a.push("Vitepress");break;case"Gitlab":a.push("Gitlabhexo"),a.push("Gitlabhugo"),a.push("Gitlabjekyll"),a.push("Gitlabvuepress"),a.push("Gitlabvuepress2"),a.push("Gitlabvitepress");break;case"Metaweblog":a.push("Metaweblog"),a.push("Cnblogs"),a.push("Typecho");break;case"Wordpress":a.push("Wordpress");break;case"Custom":a.push("Zhihu"),a.push("Csdn"),a.push("Wechat"),a.push("Jianshu"),a.push("Juejin");break;case"System":a.push("Siyuan");break}return a}function ot(r){const a=r,t=[],s=[],e=[],o=[],i=[],n=[],l=[];return a.forEach(c=>{switch(c.platformType){case"Common":t.push(c);break;case"Github":s.push(c);break;case"Gitlab":e.push(c);break;case"Metaweblog":o.push(c);break;case"Wordpress":i.push(c);break;case"Custom":n.push(c);break;case"System":l.push(c);break}}),{totalCfg:a,commonCfg:t,githubCfg:s,gitlabCfg:e,metaweblogCfg:o,wordpressCfg:i,customCfg:n,systemCfg:l}}function ls(r){const a=r.split("-");let t="";if(a.length>0){const o=a[0].split("_");t=o.length>1?o[1]:o[0]}else throw new Error("Invalid platform key");const e=Object.values(D).find(o=>typeof o=="string"&&o.toLowerCase()===t.toLowerCase());if(e)return e;throw new Error("Invalid platform key")}function Rt(r,a){let t;const s=Ps.newID();return t=r.toLowerCase(),!A.isEmptyString(a)&&a!=="none"&&(t=[t,"_",A.upperFirst(a)].join("")),[t,"-",s].join("")}function $o(r,a){let t=!1;for(let s=0;s<r.length;s++)if(r[s].platformKey===a){t=!0;break}return t}function qa(r,a){for(let t=0;t<r.length;t++)if(r[t].platformKey===a)return r[t];return null}function yt(r,a,t){const s=[...r];for(let e=0;e<s.length;e++)if(s[e].platformKey===a){s[e]=t;break}return s}function il(r,a){return r.filter(t=>t.platformKey!==a)}function ke(r){return"custom-"+r+"-post-id"}function St(r){return"custom-"+r.replace(/_/g,"-")+"-yaml"}class Mt extends Zi{}class Zt extends Mt{}class Qt extends Qi{constructor(t,s,e,o,i){super();x(this,"placeholder",{});this.home=t,this.apiUrl=s,this.username=e,this.password=o,this.apiStatus=!1,this.blogid="",this.blogName="",this.posidKey="",this.previewUrl="",this.pageType=ce.Markdown,this.middlewareUrl=i,this.usernameEnabled=!1,this.allowPreviewUrlChange=!0,this.showTokenTip=!1,this.yamlLinkEnabled=!0,this.useMdFilename=!1,this.usePathCategory=!1,this.placeholder=new Mt}}class ks extends Qt{constructor(t,s,e,o,i){super(t,s,e,o,i);x(this,"home","");x(this,"apiUrl","");x(this,"username","");x(this,"password","");x(this,"apiStatus",!1);x(this,"blogid","");x(this,"blogName","");x(this,"posidKey","");x(this,"previewUrl","");x(this,"pageType",ce.Markdown);x(this,"placeholder",{});x(this,"middlewareUrl","");this.home=t,this.apiUrl=s,this.username=e,this.password=o,this.apiStatus=!1,this.blogid="",this.blogName="",this.posidKey="",this.previewUrl="",this.pageType=ce.Html,this.middlewareUrl=i,this.placeholder=new Zt,this.usernameEnabled=!0,this.showTokenTip=!1,this.allowPreviewUrlChange=!0,this.tagEnabled=!0,this.cateEnabled=!0,this.categoryType=R.CategoryType_Multi,this.allowCateChange=!0,this.knowledgeSpaceEnabled=!1,this.useMdFilename=!1,this.usePathCategory=!1}}class nl extends ks{constructor(a,t,s,e){super("https://www.cnblogs.com/[your-blog-name]",a,t,s,e),this.tokenSettingUrl="https://i.cnblogs.com/settings",this.previewUrl="/p/[postid].html",this.pageType=ce.Markdown,this.usernameEnabled=!0,this.passwordType=Ce.PasswordType_Token,this.showTokenTip=!0,this.allowPreviewUrlChange=!0,this.tagEnabled=!0,this.cateEnabled=!0,this.categoryType=R.CategoryType_Multi,this.allowCateChange=!0,this.knowledgeSpaceEnabled=!1}}class vs{}x(vs,"METHOD_GET_USERS_BLOGS","blogger.getUsersBlogs"),x(vs,"METHOD_DELETE_POST","blogger.deletePost");class Be{}x(Be,"METHOD_GET_USERS_BLOGS","metaWeblog.getUsersBlogs"),x(Be,"METHOD_NEW_POST","metaWeblog.newPost"),x(Be,"METHOD_EDIT_POST","metaWeblog.editPost"),x(Be,"METHOD_DELETE_POST","metaWeblog.deletePost"),x(Be,"METHOD_GET_RECENT_POSTS","metaWeblog.getRecentPosts"),x(Be,"METHOD_GET_POST","metaWeblog.getPost"),x(Be,"METHOD_GET_CATEGORIES","metaWeblog.getCategories"),x(Be,"METHOD_NEW_MEDIA_OBJECT","metaWeblog.newMediaObject");const Lo=()=>{const r="siyuan-cfg",{isInSiyuanOrSiyuanNewWin:a}=wt(),t=()=>{let e="http://127.0.0.1:6806",o="",i="https://api.terwer.space/api/middleware",n;if(a()){const c=mt.siyuanWindow();n=c==null?void 0:c.location.origin}const l=new Ze(n??e,o);l.middlewareUrl=i;const p=ho(r,l,{serializer:ja.object});return n&&(p.value.apiUrl=n),p};return{getSiyuanSetting:t,getReadOnlySiyuanSetting:()=>{const e=t();return yo(e)}}},We=()=>{const r=B("use-siyuan-api"),{getReadOnlySiyuanSetting:a}=Lo(),{getReadOnlyPublishPreferenceSetting:t}=Xt(),s=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_SIYUAN_API_URL,""),e=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_SIYUAN_AUTH_TOKEN,""),o=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_SIYUAN_COOKIE,""),i=t(),n=a(),l=n.value.apiUrl??s,p=n.value.password??e,c=new Ze(l,p);c.cookie=n.value.cookie??o,c.preferenceConfig.fixTitle=i.value.fixTitle,c.preferenceConfig.keepTitle=i.value.keepTitle,c.preferenceConfig.removeFirstH1=i.value.removeFirstH1,c.preferenceConfig.removeMdWidgetTag=i.value.removeMdWidgetTag;const g=new at(c),y=new Do(c),{isInChromeExtension:u}=wt(),d=()=>{const h="siyuan",E=h==="siyuan";return r.info("defaultType=>",h),r.info("storeViaSiyuanApi=>",String(E)),E};return{blogApi:g,kernelApi:y,siyuanConfig:c,isStorageViaSiyuanApi:d,isUseSiyuanProxy:()=>u()?!1:d()}};class ge{constructor(){x(this,"logger");x(this,"deviceType");x(this,"win");x(this,"moduleBase");x(this,"fetch");x(this,"xmlbuilder2");x(this,"simpleXmlrpc");var a,t,s,e;this.logger=B("app-instance"),this.deviceType=jt.getDevice(),this.fetch=pn,this.xmlbuilder2={create:un.create},this.simpleXmlrpc={SimpleXmlRpcClient:Uo,Serializer:Oo,Deserializer:Mo,XmlrpcUtil:Io},this.win=mt.siyuanWindow(),this.moduleBase=`${(e=(s=(t=(a=this.win)==null?void 0:a.siyuan)==null?void 0:t.config)==null?void 0:s.system)==null?void 0:e.workspaceDir}/data/plugins/siyuan-plugin-publisher/`}}const Ja=r=>{const a=B("use-proxy"),{kernelApi:t,isUseSiyuanProxy:s}=We(),e=new ge,o="";r=r??"https://api.terwer.space/api/middleware";const i=new cn(e,o,r,bt),n=new Oo(e),l=async(c,g=[],y={},u="GET",d="application/json")=>{if(s&&["application/json","text/html","text/xml",""].includes(d)){a.info("Using Siyuan forwardProxy, contentType=>",d);let h;(typeof y=="string"&&!A.isEmptyString(y)||typeof y=="object"&&!se.isEmptyObject(y))&&(h=y);const E=`${o}${c}`;a.info("siyuan forwardProxy url =>",E),a.info("siyuan forwardProxy fetchOptions =>",{headers:g,body:h,method:u,contentType:d});const v=await t.forwardProxy(E,g,h,u,d,void 0,void 0,3e4);if(a.debug("proxyFetch result =>",v),!(v.status>=200&&v.status<300))throw new Error(v==null?void 0:v.body);if(d==="application/json"){const T=v==null?void 0:v.body;return oe.safeParse(T,{})}else return d==="text/html"||d==="text/xml"?v==null?void 0:v.body:(a.info("SiYuan proxy directly response fetchResult for content type:",d),v)}else{a.info("Using middleware proxy");const h=g.length>0?g[0]:{},E={method:u,headers:{"Content-Type":d,...h}};a.info("commonFetchClient url in proxyFetch =>",c),a.info("commonFetchClient fetchOptions in proxyFetch =>",E);const v=await i.fetchCall(c,E);return a.debug("Result of proxyFetch in commonFetchClient =>",v),v}};return{proxyFetch:l,proxyXmlrpc:async(c,g,y)=>{const u=n.serializeMethodCall(g,y);let b=await l(c,[],u,"POST","text/xml");b=Io.removeXmlHeader(b);const E=await new Mo().deserializeMethodResponse(b);return a.debug("xmlrpc fetch result, resJson =>",E),E}}};class rs{static mdToHtml(a){if(typeof window>"u")return this.logger.warn("不是浏览器环境，不渲染"),a;const t=window.Lute;if(!t)return this.logger.warn("未找到Lute，不渲染"),a;this.logger.info("found Lute =>",t),this.logger.info("使用Lute渲染Markdown");const e=t.New().MarkdownStr("",a);return this.logger.debug("md to html =>",{html:e}),e}}x(rs,"logger",B("lute-util"));const Xa=()=>{const r=B("use-picgo-bridge"),{siyuanConfig:a,kernelApi:t,blogApi:s}=We(),e=new gn(t);return{handlePicgo:async(n,l)=>{let p=l;const c="文档可能已经成功发布，但是图片上传失败或者当前场景不支持图片上传，详细信息=>";try{const g=await t.getBlockAttrs(n),y={pageId:n,meta:g};A.isEmptyString(p)&&(p=(await s.getPost(n)).markdown);const u="使用 PicGO 自动上传图片，若图片较多可能会较慢请耐心等待";await t.pushMsg({msg:u,timeout:3e3});const d=await e.uploadPostImagesToBed(y.pageId,y.meta,p);d.hasImages?d.flag?p=d.mdContent:(r.warn(c+d.errmsg),Y.warning(c+d.errmsg)):r.info(c+d.errmsg)}catch(g){r.error(c,g),Y.error("文档可能已经成功发布，但是图片上传失败或者当前场景不支持图片上传，详细信息=>"+g)}return p},getImageItemsFromMd:async(n,l)=>{const p=new dn;let c=[];r.debug("getImageItemsFromMd=>",{md:l});const g=p.parseImagesToArray(l);c=[...new Set([...c,...g])],r.debug("retImgs=>",c);const y=await t.getBlockAttrs(n),u=a.apiUrl??"",d=await e.doConvertImagesToImagesItemArray(y,c,u);return r.debug("imageItemArray=>",d),d}}},es=async r=>new Promise((a,t)=>{const s=new FileReader;s.onload=e=>{const o=za.Buffer.from(e.target.result);a(o)},s.onerror=t,s.readAsArrayBuffer(r)}),ll=r=>{const a=r.match(/^data:(.*?);base64,/);return a&&a[1]?a[1]:""},Za=async r=>{const a=await rl(r);return jo(r,a)},jo=(r,a)=>{const t=a.split(";base64,").pop()||"",s=r.substring(r.lastIndexOf("/")+1),e=ll(a);return{imageName:s,mimeType:e,imageBase64:t}},Qa=r=>{const a=Wt.toUint8Array(r);return za.Buffer.from(a)};function rl(r){return new Promise((a,t)=>{(async()=>{let s=null;try{s=await(await window.fetch(r)).blob()}catch(e){return t(e)}if(s!=null){const e=new FileReader;e.readAsDataURL(s),e.onloadend=function(){var o=e.result;a(o)},e.onerror=function(o){t(o)}}})()})}const cl=r=>{const a=new Uint8Array(r);return za.Buffer.from(a)},pl=async(r,a,t)=>{try{const s=await r.getFile(a,t);return t==="text"?!A.isEmptyString(s):s!==null}catch{return!1}};class Ho extends Co{constructor(t){super();x(this,"logger");x(this,"api");x(this,"picgoBridge");x(this,"isSiyuanOrSiyuanNewWin");x(this,"kernelApi");this.logger=B("base-extend-api"),this.api=t,this.picgoBridge=Xa();const{isInSiyuanOrSiyuanNewWin:s}=wt();this.isSiyuanOrSiyuanNewWin=s();const{kernelApi:e}=We();this.kernelApi=e}async preEditPost(t,s,e){return t=await this.handleFilename(t,s,e),t=await this.handleDesc(t,s,e),t=await this.handleCategories(t,s,e),t=await this.handlePictures(t,s,e),t=await this.handleMd(t,s,e),t=await this.handleYaml(t,s,e),t=await this.handleOther(t,s,e),t}async handleFilename(t,s,e){const o=e==null?void 0:e.cfg,i=ye.cloneDeep(t);if(o!=null&&o.mdFilenameRule){const g=Ae.formatIsoToZhDate(i.dateCreated.toISOString(),!0).split(" ")[0].split("-"),y=g[0],u=g[1],d=g[2];this.logger.debug("created numarr=>",g);let b=o.mdFilenameRule.replace(/\.md/g,"");o.useMdFilename?b=b.replace(/\[filename\]/g,i.title):b=b.replace(/\[slug\]/g,i.wp_slug),b=b.replace(/\[yyyy\]/g,y).replace(/\[MM\]/g,u).replace(/\[mm\]/g,u).replace(/\[dd\]/g,d),i.mdFilename=b}const{getReadOnlyPublishPreferenceSetting:n}=Xt();return n().value.fixTitle&&(i.title=it.removeTitleNumber(i.title)),this.logger.debug("处理MD文件名完成，post",{post:te(i)}),i}async handleDesc(t,s,e){const o=ye.cloneDeep(t);return o.mt_excerpt=o.shortDesc,o.mt_text_more=o.shortDesc,o}async handleCategories(t,s,e){var c;const o=e==null?void 0:e.cfg,i=ye.cloneDeep(t),n=((c=i.cate_slugs)==null?void 0:c[0])??o.blogid,l=[];if(o.usePathCategory){const g=n.split("/");if(g.length>1)for(let y=1;y<g.length;y++){const u=it.removeTitleNumber(g[y]);l.push(u)}}this.logger.info("目录路径转换的分类 =>",l);const p=[...new Set([...l??[],...(i==null?void 0:i.categories)??[]])].filter(g=>g.trim()!=="");return i.categories=p,this.logger.info("最终的分类 =>",i.categories),this.logger.debug("目录路径转换完成，post",{post:te(i)}),i}async handleMd(t,s,e){e==null||e.cfg;const o=ye.cloneDeep(t);let i=o.markdown;return i=Q.extractMarkdown(i),i=i.replace(/==([^=]+)==/g,'<span style="font-weight: bold;" class="mark">$1</span>'),o.markdown=i,this.logger.debug("markdown处理完毕，post",{post:te(o)}),o}async handleOther(t,s,e){const o=e==null?void 0:e.cfg,i=ye.cloneDeep(t),n=Q.extractMarkdown(i.markdown);return i.html=rs.mdToHtml(n),(o==null?void 0:o.pageType)==ce.Markdown?i.description=i.markdown:i.description=i.html,i}async handleYaml(t,s,e){const o=e==null?void 0:e.cfg,i=ye.cloneDeep(t);this.logger.debug("开始处理yaml，post",{post:te(i)});const n=this.api.getYamlAdaptor();if(n!==null){const l=n.convertToYaml(i,o);i.yaml=l.formatter,i.markdown=l.mdFullContent,i.html=l.htmlContent,this.logger.info("rehandled yaml using YamlConverterAdaptor")}else{const l=Ya.toYamlObj(i),p=Q.obj2Yaml(l),c=Q.extractMarkdown(i.markdown);i.yaml=p,i.markdown=c,i.html=rs.mdToHtml(c),this.logger.info("yaml adaptor not found, using default")}return this.logger.debug("yaml处理之后，post",{post:te(i)}),i}async handlePictures(t,s,e){const o=e==null?void 0:e.cfg,i=e==null?void 0:e.dynCfg,n=o==null?void 0:o.middlewareUrl,l=ye.cloneDeep(t);this.logger.debug("图片处理之前, post =>",{post:te(l)});const p=En,c=vn,g=await this.checkPicgoInstalled();g||this.logger.warn("未安装 PicGO 插件，将使用平台上传图片");let y=!1,u=!1;if(i!=null&&i.platformKey&&(y=p.some(b=>new RegExp(`${b}(-\\w+)?`).test(i.platformKey)),u=c.some(b=>new RegExp(`${b}(-\\w+)?`).test(i.platformKey))),y&&this.logger.warn("该平台不支持 Picgo 插件，将使用平台上传图片"),g&&!y)this.logger.info("使用 PicGO上传图片"),this.logger.debug("开始图片处理, post =>",{post:te(l)}),l.markdown=await this.picgoBridge.handlePicgo(s,l.markdown),this.logger.debug("图片处理完毕, post.markdown =>",{md:l.markdown});else if(u){const b="检测到您未安装Picgo插件，该平台的图片将无法处理，如需使用图床功能，请在集市下载并配置Picgo插件";this.logger.error(b),await this.kernelApi.pushMsg({msg:b,timeout:7e3})}else{this.logger.info("使用平台上传图片");const b=await this.picgoBridge.getImageItemsFromMd(s,l.markdown);if(b.length===0)return this.logger.info("未找到图片，不处理"),l;this.logger.info(`找到${b.length}张图片，开始上传`);const h={};try{for(const T of b){const S=T.url,M=await this.readFileToBase64(S,n),V=Qa(M.imageBase64),$=new Dt(T.name,M.mimeType,V);this.logger.debug("before upload, mediaObject =>",$);const J=await this.api.newMediaObject($);this.logger.debug("attachResult =>",J),J&&J.url&&(h[T.originUrl]=J.url);const le=`使用平台自带的图片上传能力，已成功上传图片 ${T.name}`;await this.kernelApi.pushMsg({msg:le,timeout:3e3})}}catch(T){const S="文章可能已经发布成功，但是平台图片上传失败";this.logger.error(S,T),await this.kernelApi.pushMsg({msg:S,timeout:7e3})}this.logger.info("平台图片全部上传完成，将开始进行连接替换，urlMap =>",h);const E=new RegExp(Object.keys(h).map(T=>`\\b${T}\\b`).join("|"),"g"),v=T=>h[T]||T;l.markdown=l.markdown.replace(E,v)}return l.html=rs.mdToHtml(l.markdown),this.logger.info("图片预处理全部完成"),this.logger.debug("图片处理之后，post",{post:te(l)}),l}async checkPicgoInstalled(){return await pl(this.kernelApi,"/data/plugins/siyuan-plugin-picgo/plugin.json","text")}async readFileToBase64(t,s){let e;if(this.isSiyuanOrSiyuanNewWin)this.logger.info("Inside Siyuan notes, use the built-in request to obtain base64"),e=await Za(t);else{this.logger.info("Outside the browser, use an image proxy");const o=A.isEmptyString(s)?"https://api.terwer.space/api/middleware":s,i=await this.api.proxyFetch(`${o}/image`,[],{url:t},"POST");this.logger.debug("readFileToBase64 proxyFetch response =>",i);const l=i.body.base64;e=jo(t,l)}return this.logger.debug("readFileToBase64 proxyFetch base64Info =>",{base64Info:e}),e}}class It extends en{constructor(t,s){super();x(this,"appInstance");x(this,"logger");x(this,"cfg");x(this,"proxyFetch");x(this,"baseExtendApi");this.appInstance=t,this.cfg=s,this.logger=B("base-blog-api"),this.baseExtendApi=new Ho(this);const{proxyFetch:e}=Ja(s.middlewareUrl);this.proxyFetch=e}getYamlAdaptor(){return null}async preEditPost(t,s,e){return await this.baseExtendApi.preEditPost(t,s,e)}async apiFormFetch(t,s,e){const i=this.appInstance.win.require(`${this.appInstance.moduleBase}libs/zhi-formdata-fetch/index.cjs`),n=s.length>0?s[0]:{};this.logger.debug("before zhi-formdata-fetch, headers =>",s),this.logger.debug("before zhi-formdata-fetch, url =>",t);const l=await i(this.appInstance.moduleBase,t,n,e);this.logger.debug("apiForm doFetch success, resText =>",l);const p=oe.safeParse(l,{});return this.logger.debug("apiForm doFetch success, resJson=>",p),p}}class Ss extends It{constructor(t,s){super(t,s);x(this,"proxyXmlrpc");this.cfg.blogid="metaweblog",this.logger=B("metaweblog-api-adaptor");const{proxyXmlrpc:e}=Ja(s.middlewareUrl);this.proxyXmlrpc=e}async getUsersBlogs(){let t=[];return t=await this.metaweblogCall(Be.METHOD_GET_USERS_BLOGS,[this.cfg.blogid,this.cfg.username,this.cfg.password]),this.logger.debug("getUsersBlogs=>",t),t}async getRecentPostsCount(t){return 0}async getRecentPosts(t){const s=[],e=await this.metaweblogCall(Be.METHOD_GET_RECENT_POSTS,[this.cfg.blogid,this.cfg.username,this.cfg.password,t]);for(let o=0;o<e.length;o++){const i=e[o],n=new ze;n.postid=i.postid,n.title=i.title,n.mt_keywords=i.mt_keywords,n.permalink=i.permalink,n.description=i.description,n.wp_slug=i.wp_slug,n.dateCreated=i.dateCreated,n.categories=i.categories,s.push(n)}return s}async getPost(t){return await this.metaweblogCall(Be.METHOD_GET_POST,[t,this.cfg.username,this.cfg.password])}async newPost(t,s){s=s??!0,t.post_status=s===!1?Pt.PostStatusEnum_Draft:Pt.PostStatusEnum_Publish;const e=this.createPostStruct(t);this.logger.debug("postStruct=>",e);let o=await this.metaweblogCall(Be.METHOD_NEW_POST,[this.cfg.blogid,this.cfg.username,this.cfg.password,e,s]);return o=o+"",o=o.replace(/"/g,""),this.logger.debug("ret=>",o),o}async editPost(t,s,e){e=e??!0,s.post_status=e===!1?Pt.PostStatusEnum_Draft:Pt.PostStatusEnum_Publish;const o=this.createPostStruct(s);this.logger.debug("postStruct=>",o);const i=await this.metaweblogCall(Be.METHOD_EDIT_POST,[t,this.cfg.username,this.cfg.password,o,e]);return this.logger.debug("ret=>",i),i}async deletePost(t){const s=await this.metaweblogCall(Be.METHOD_DELETE_POST,[this.cfg.blogid,t,this.cfg.username,this.cfg.password,!1]);return this.logger.debug("ret=>",s),s}async getPreviewUrl(t){const s=this.cfg.previewUrl.replace(/\[postid\]/g,t);return A.pathJoin(this.cfg.home??"",s)}async getCategories(){const t=[];try{const e=await this.metaweblogCall(Be.METHOD_GET_CATEGORIES,[this.cfg.blogid,this.cfg.username,this.cfg.password]);this.logger.debug("获取的分类信息，dataArr=>",e),e.forEach(o=>{const i=new Qe;i.categoryId=o.categoryId,i.categoryName=o.categoryName,i.description=o.description,i.categoryDescription=o.categoryDescription,i.htmlUrl=o.htmlUrl,i.parentId=o.parentId,i.rssUrl=o.rssUrl,t.push(i)})}catch(s){this.logger.error("分类获取失败",s)}return t}async newMediaObject(t,s){let e;try{e=await this.metaweblogCall(Be.METHOD_NEW_MEDIA_OBJECT,[this.cfg.blogid,this.cfg.username,this.cfg.password,t]),this.logger.debug("上传媒体完成, ret =>",e)}catch(o){this.logger.error("媒体上传失败",o)}return e}async metaweblogCall(t,s){return await this.proxyXmlrpc(this.cfg.apiUrl,t,s)}createPostStruct(t){const s={};return A.isEmptyString(t.title)||Object.assign(s,{title:t.title}),A.isEmptyString(t.mt_keywords)||Object.assign(s,{mt_keywords:t.mt_keywords}),A.isEmptyString(t.mt_excerpt)||Object.assign(s,{mt_excerpt:t.mt_excerpt}),A.isEmptyString(t.mt_text_more)||Object.assign(s,{mt_text_more:t.mt_text_more}),A.isEmptyString(t.description)||Object.assign(s,{description:t.description}),A.isEmptyString(t.wp_slug)||Object.assign(s,{wp_slug:t.wp_slug}),ht.isInBrowser||Object.assign(s,{dateCreated:t.dateCreated||new Date}),Object.assign(s,{categories:t.categories||[]}),Object.assign(s,{post_status:t.post_status??Pt.PostStatusEnum_Publish}),A.isEmptyString(t.wp_password)||Object.assign(s,{wp_password:t.wp_password}),s}}class ul extends Ss{constructor(t,s){super(t,s);x(this,"MD_CATEGORY","[Markdown]");this.logger=B("cnblogs-api-adaptor"),this.cfg.blogid="cnblogs"}async getUsersBlogs(){let t=[];return t=await this.metaweblogCall(vs.METHOD_GET_USERS_BLOGS,[this.cfg.blogid,this.cfg.username,this.cfg.password]),this.logger.debug("getUsersBlogs=>",t),t}async newPost(t,s){return t=this.assignMdCategory(t),super.newPost(t,s)}async editPost(t,s,e){return s=this.assignMdCategory(s),super.editPost(t,s,e)}async deletePost(t){const s=await this.metaweblogCall(vs.METHOD_DELETE_POST,[this.cfg.blogid,t,this.cfg.username,this.cfg.password,!1]);return this.logger.debug("ret=>",s),s}async getCategories(){const t=[];try{const e=await this.metaweblogCall(Be.METHOD_GET_CATEGORIES,[this.cfg.blogid,this.cfg.username,this.cfg.password]);this.logger.debug("博客园获取的分类信息，dataArr=>",e),e.forEach(o=>{const i=new Qe;o.title!==this.MD_CATEGORY&&(i.categoryId=o.categoryid,i.categoryName=o.title,i.description=o.description,i.categoryDescription=o.categoryDescription,i.htmlUrl=o.htmlUrl,i.parentId=o.parentId,i.rssUrl=o.rssUrl,t.push(i))})}catch(s){this.logger.error("博客园分类获取失败",s)}return t}assignMdCategory(t){const s=t.categories??[];return s.some(e=>e.toLowerCase()===this.MD_CATEGORY.toLowerCase())||s.push(this.MD_CATEGORY),t}}const gl={lang:"zh_CN",[Me]:"{}"};class dl{constructor(a){x(this,"logger");x(this,"storageViaSiyuanApi");x(this,"kernelApi");x(this,"key");this.logger=B("common-storage");const{isStorageViaSiyuanApi:t,kernelApi:s}=We();if(this.storageViaSiyuanApi=t(),this.kernelApi=s,this.storageViaSiyuanApi)this.key=a;else{const e=a.split("/").pop()??"";this.key=e.slice(0,e.lastIndexOf("."))}}async getItem(a){this.logger.info(`Retrieving value for '${a}' from CommonStorage.`);let t;if(this.storageViaSiyuanApi)try{t=await this.kernelApi.getFile(a,"text")??""}catch(s){this.logger.error(`Failed to get value for key '${a}' from SiYuan Api LocalStorageAdaptor. Error:`,s)}else try{t=mt.siyuanWindow().localStorage.getItem(a)??""}catch(s){this.logger.error(`Failed to get value for key '${a}' from Browser LocalStorageAdaptor. Error:`,s)}return A.isEmptyString(t)&&(t="{}"),t}async removeItem(a){this.logger.info(`Removing value for ${a} from CommonStorage.`)}async setItem(a,t){this.storageViaSiyuanApi?(await this.kernelApi.saveTextData(a,t),this.logger.debug(`Use SiYuan Api LocalStorageAdaptor to setItem - Key '${a}'`)):(mt.siyuanWindow().localStorage.setItem(a,t),this.logger.debug(`Use Browser LocalStorageAdaptor to setItem - Key '${a}'`))}}const ml=(r,a)=>{const t=B("common-storage-async"),s=new dl(r),e=Ai(a),o=hl(e);t.debug(`It is detected that the serialization type is ${o}`);const i=ja[o];return{commonStore:{async get(){t.debug("Fetching data from common storage...");const l=await s.getItem(s.key)??"{}";let p=await i.read(l)??{};return se.isEmptyObject(p)&&(t.info("Initial data not found in common storage. Setting initial value..."),await s.setItem(s.key,i.write(a)),t.debug("Initial value set:",a),p=a),p},async set(l){await s.setItem(s.key,i.write(l))}}}};function hl(r){return r==null?"any":r instanceof Set?"set":r instanceof Map?"map":r instanceof Date?"date":typeof r=="boolean"?"boolean":typeof r=="string"?"string":typeof r=="object"?"object":Number.isNaN(r)?"any":"number"}const me=mn("setting",()=>{const r=B("use-setting-store"),a="/data/storage/syp/sy-p-plus-cfg.json",t=gl,{commonStore:s}=ml(a,t),e=Z(null),o=Ha(async()=>{const c=await s.get();return r.debug("get data from setting=>",c),e.value=c,c});return{getSetting:async()=>{if(e.value===null){r.info("Setting not initialized. Initializing now...");const c=o.value;return r.info("Loaded setting from remote api"),c??{}}return r.info("Loaded setting from cache."),e.value??{}},updateSetting:async c=>{r.debug("update setting=>",c),await s.set(c),e.value={...e.value,...c}},checkKeyExists:c=>{const g=e.value;if(!g)return!1;for(const y in g)if(y===c)return!0;return!1},deleteKey:c=>{const g=e.value;if(g){for(const y in g)if(y===c){delete g[y];return}}}}}),Da=async(r,a)=>{const t=B("use-cnblogs-api");t.info("Start using Cnblogs API...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:i}=me(),n=await i();if(e=oe.safeParse(n[r],{}),se.isEmptyObject(e)){const l=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_CNBLOGS_API_URL,"https://rpc.cnblogs.com/metaweblog/[your-blog-name]"),p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_CNBLOGS_USERNAME,""),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_CNBLOGS_AUTH_TOKEN,""),g=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");e=new nl(l,p,c,g),t.debug("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.tagEnabled=!0,e.cateEnabled=!0,e.categoryType=R.CategoryType_Multi,e.allowCateChange=!0,e.knowledgeSpaceEnabled=!1;const o=new ul(s,e);return t.info("Cnblogs API created successfully."),{cfg:e,blogApi:o}};class eo{static parseHomeAndUrl(a){this.logger.debug(`Parsing Home address: ${a}`);let t="";return a.endsWith("/xmlrpc.php")?(t=a,a=a.replace("/xmlrpc.php","")):(a=a.replace(/\/$/,""),t=`${a}/xmlrpc.php`),this.logger.debug(`Parse result: home=${a}, apiUrl=${t}`),{home:a,apiUrl:t}}}x(eo,"logger",B("wordpress-utils"));class yl extends ks{constructor(a,t,s,e){super(a,"",t,s,e);const{home:o,apiUrl:i}=eo.parseHomeAndUrl(a);this.home=o,this.apiUrl=i,this.previewUrl="/?p=[postid]",this.pageType=ce.Html,this.usernameEnabled=!0,this.showTokenTip=!1,this.allowPreviewUrlChange=!0,this.tagEnabled=!0,this.cateEnabled=!0,this.categoryType=R.CategoryType_Multi,this.allowCateChange=!0,this.knowledgeSpaceEnabled=!1}}class fl extends Ss{constructor(a,t){super(a,t),this.logger=B("wordpress-api-adaptor"),this.cfg.blogid="wordpress"}}const Ua=async(r,a)=>{const t=B("use-wordpress-api");t.info("Start using Wordpress API...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:i}=me(),n=await i();if(e=oe.safeParse(n[r],{}),se.isEmptyObject(e)){const l=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_WORDPRESS_API_URL,"http://your-wordpress-home.com"),p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_WORDPRESS_USERNAME,""),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_WORDPRESS_AUTH_TOKEN,""),g=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");e=new yl(l,p,c,g),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.tagEnabled=!0,e.cateEnabled=!0,e.categoryType=R.CategoryType_Multi,e.allowCateChange=!0,e.knowledgeSpaceEnabled=!1;const o=new fl(s,e);return t.info("Wordpress API created successfully.",e),{cfg:e,blogApi:o}};class to{static parseHomeAndUrl(a){this.logger.debug(`Parsing Home address: ${a}`);let t="";return a.endsWith("/index.php/action/xmlrpc")?(t=a,a=a.replace("/index.php/action/xmlrpc","")):(a=a.replace(/\/$/,""),t=`${a}/index.php/action/xmlrpc`),this.logger.debug(`Parse result: home=${a}, apiUrl=${t}`),{home:a,apiUrl:t}}}x(to,"logger",B("typecho-utils"));class _l extends ks{constructor(a,t,s,e){super(a,"",t,s,e);const{home:o,apiUrl:i}=to.parseHomeAndUrl(a);this.home=o,this.apiUrl=i,this.previewUrl="/index.php/archives/[postid]",this.pageType=ce.Html,this.showTokenTip=!1,this.allowPreviewUrlChange=!0,this.tagEnabled=!0,this.cateEnabled=!0,this.categoryType=R.CategoryType_Multi,this.allowCateChange=!0,this.knowledgeSpaceEnabled=!1}}class bl extends Ss{constructor(a,t){super(a,t),this.logger=B("typecho-api-adaptor"),this.cfg.blogid="typecho"}}const Oa=async(r,a)=>{const t=B("use-typecho-api");t.info("Start using Typecho API...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:i}=me(),n=await i();if(e=oe.safeParse(n[r],{}),se.isEmptyObject(e)){const l=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_TYPECHO_API_URL,"http://your-typecho-home.com/"),p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_TYPECHO_USERNAME,""),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_TYPECHO_AUTH_TOKEN,""),g=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");e=new _l(l,p,c,g),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.tagEnabled=!0,e.cateEnabled=!0,e.categoryType=R.CategoryType_Multi,e.allowCateChange=!0,e.knowledgeSpaceEnabled=!1;const o=new bl(s,e);return t.info("Typecho API created successfully.",e),{cfg:e,blogApi:o}};class wl extends Qt{constructor(a,t,s){super("https://www.yuque.com/","https://www.yuque.com/api/v2",a,t,s),this.tokenSettingUrl="https://www.yuque.com/settings/tokens",this.showTokenTip=!0,this.previewUrl="/[notebook]/[postid]",this.pageType=ce.Markdown,this.usernameEnabled=!0,this.passwordType=Ce.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!1,this.cateEnabled=!1,this.knowledgeSpaceEnabled=!0,this.knowledgeSpaceTitle="知识库",this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="由于语雀平台的限制，暂时不支持编辑所属知识库。如果您想移动文档，请先点击取消删除该文档，然后重新选择新的知识库发布"}}class El extends It{constructor(a,t){super(a,t),this.logger=B("yuque-api-adaptor")}async getUsersBlogs(){const a=[];return(await this.getRepos()).forEach(s=>{const e=new nt;e.blogid=s.namespace,e.blogName=s.name,e.url=s.namespace,a.push(e)}),a}async newPost(a,t){var e;const s=((e=a.cate_slugs)==null?void 0:e[0])??this.cfg.blogid;return await this.addDoc(a.title,a.wp_slug,a.description,s)}async editPost(a,t,s){const e=this.getYuquePostidKey(a);return await this.updateDoc(e.docId,t.title,t.wp_slug,t.description,e.docRepo)}async deletePost(a){const t=this.getYuquePostidKey(a);return await this.delDoc(t.docId,t.docRepo)}async getPost(a,t){const s=this.getYuquePostidKey(a),e=await this.getDoc(s.docId,s.docRepo);this.logger.debug("yuqueDoc=>",e);const o=new ze;o.title=e.title,o.description=e.body;const i=e.book,n=[];return n.push(i.namespace),o.cate_slugs=n,o}async getCategories(){const a=[],t=await this.getRepos();return t&&t.length>0&&t.forEach(s=>{if(s.type==="Book"){const e=new Qe;e.categoryId=`${this.cfg.username}/${s.slug}`,e.categoryName=s.name,e.description=s.name,e.categoryDescription=s.name,a.push(e)}}),a}async getPreviewUrl(a){const t=this.cfg.previewUrl??"",s=this.getYuquePostidKey(a),e=s.docId,o=s.docRepo??this.cfg.blogid??"",i=t.replace("[postid]",e).replace("[notebook]",o);return A.pathJoin(this.cfg.home??"",i)}async getRepos(){const a="/users/"+this.cfg.username+"/repos",t=await this.yuqueRequest(a,{},"GET");return this.logger.debug("yuque repos=>",t),t}async addDoc(a,t,s,e){let o="/repos/"+this.cfg.blogid+"/docs";e&&(o="/repos/"+e+"/docs",this.logger.warn("yuque addDoc with repo",e));const i={title:a,slug:t,format:"markdown",body:s},n=await this.yuqueRequest(o,i,"POST");if(this.logger.debug("yuqueRequest addDoc=>",n),!n)throw new Error("请求语雀API异常");return e?`${n.id}_${e}`:`${n.id}`}async updateDoc(a,t,s,e,o){let i="/repos/"+this.cfg.blogid+"/docs/"+a;o&&(i="/repos/"+o+"/docs/"+a,this.logger.warn("yuque updateDoc with repo",o));const n={title:t,slug:s,body:e,_force_asl:1};if(!await this.yuqueRequest(i,n,"PUT"))throw new Error("请求语雀API异常");return!0}getYuquePostidKey(a){let t,s;if(a.indexOf("_")>0){const e=a.split("_");t=e[0],s=e[1]}else t=a;return{docId:t,docRepo:s}}async delDoc(a,t){let s="/repos/"+this.cfg.blogid+"/docs/"+a;if(t&&(s="/repos/"+t+"/docs/"+a,this.logger.warn("yuque delDoc with repo",t)),!await this.yuqueRequest(s,{},"DELETE"))throw new Error("请求语雀API异常");return!0}async getDoc(a,t){let s="/repos/"+this.cfg.blogid+"/docs/"+a;t&&(s="/repos/"+t+"/docs/"+a,this.logger.warn("yuque getDoc with repo",t));const e=await this.yuqueRequest(s,{},"GET");if(!e)throw new Error("请求语雀API异常");return e}async yuqueRequest(a,t,s="POST"){const e="application/json",o={"Content-Type":e,"X-Auth-Token":this.cfg.password},i=`${this.cfg.apiUrl}${a}`;this.logger.debug("向语雀请求数据，apiUrl =>",i),this.logger.debug("向语雀请求数据，params =>",t);const n=se.isEmptyObject(t)?"":JSON.stringify(t),l=await this.proxyFetch(i,[o],n,s,e);if(this.logger.debug("向语雀请求数据，resJson =>",l),(l==null?void 0:l.status)===401)throw new Error(l==null?void 0:l.message);return l.data?l.data:null}}const Ma=async(r,a)=>{const t=B("use-yuque-api");t.info("Start using Yuque API...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:i}=me(),n=await i();if(e=oe.safeParse(n[r],{}),se.isEmptyObject(e)){const l=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_YUQUE_USERNAME,""),p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_YUQUE_AUTH_TOKEN,""),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");e=new wl(l,p,c),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.tagEnabled=!1,e.cateEnabled=!1,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceType=R.CategoryType_Single,e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="由于语雀平台的限制，暂时不支持编辑所属知识库。如果您想移动文档，请先点击取消删除该文档，然后重新选择新的知识库发布";const o=new El(s,e);return t.info("Yuque API created successfully.",e),{cfg:e,blogApi:o}};class ts extends Co{constructor(t,s){super();x(this,"appInstance");x(this,"logger");x(this,"cfg");x(this,"baseExtendApi");x(this,"proxyFetch");this.appInstance=t,this.cfg=s,this.logger=B("base-web-api"),this.baseExtendApi=new Ho(this);const{proxyFetch:e}=Ja(s.middlewareUrl);this.proxyFetch=e}updateCfg(t){this.cfg=t}async buildCookie(t){return t.map(s=>`${s.name}=${s.value}`).join(";")}getYamlAdaptor(){return null}async preEditPost(t,s,e){return await this.baseExtendApi.preEditPost(t,s,e)}async newPost(t,s){try{const e=await this.addPost(t);if(e.status!=="success")throw new Error("网页授权发布文章异常");return e.post_id}catch(e){throw e}}async newMediaObject(t,s){const e=t.bits;this.logger.debug("newMediaObject on baseWebApi =>",t);const o=new Blob([e],{type:t.type}),i=await this.uploadFile(o,t.name);return{attachment_id:i==null?void 0:i.id,date_created_gmt:new Date,parent:0,link:i==null?void 0:i.url,title:t.name,caption:"",description:"",metadata:{width:0,height:0,file:"",filesize:0,sizes:[]},type:t.type,thumbnail:"",id:i==null?void 0:i.article_id,file:t.name,url:i.url}}async webProxyFetch(t,s=[],e={},o="GET",i="application/json"){const l=[{...s.length>0?s[0]:{},Cookie:this.cfg.password}];return await this.proxyFetch(t,l,e,o,i)}async webFormFetch(t,s,e){const i=this.appInstance.win.require(`${this.appInstance.moduleBase}libs/zhi-formdata-fetch/index.cjs`),n=s.length>0?s[0]:{};this.logger.debug("before zhi-formdata-fetch, headers =>",s),this.logger.debug("before zhi-formdata-fetch, url =>",t);const l=await i(this.appInstance.moduleBase,t,n,e);this.logger.debug("webForm doFetch success, resText =>",l);const p=oe.safeParse(l,{});return this.logger.debug("webForm doFetch success, resJson=>",p),p}}const vl=(r,a,t)=>new OSS({endpoint:r,accessKeyId:t.access_id,accessKeySecret:t.access_key,stsToken:t.access_token,cname:!0,bucket:a});class Tl extends ts{async getMetaData(){const a=await this.webProxyFetch("https://www.zhihu.com/api/v4/me?include=account_status%2Cis_bind_phone%2Cis_force_renamed%2Cemail%2Crenamed_fullname"),t=!!a.uid;return this.logger.info(`get zhihu metadata finished, flag => ${t}`),{flag:t,uid:a.uid,title:a.name,avatar:a.avatar_url,supportTypes:["html"],type:"zhihu",displayName:"知乎",home:"https://www.zhihu.com/settings/account",icon:"https://static.zhihu.com/static/favicon.ico"}}async getUsersBlogs(){var l,p;let a=[];const t=`https://www.zhihu.com/people/${this.cfg.username}/columns`,s=await this.webProxyFetch(t,[],{},"GET","text/html");this.logger.debug("get zhihu columns dom =>",{res:s});const o=Yt(s)("#js-initialData").html(),i=oe.safeParse(o,{});this.logger.debug("get column initJson=>",i);const n=((p=(l=i==null?void 0:i.initialState)==null?void 0:l.entities)==null?void 0:p.columns)??{};return this.logger.debug("get columns=>",n),Object.keys(n).map(c=>{const g=new nt,y=n[c];g.blogid=y.id,g.blogName=y.title,g.url=y.url,a.push(g)}),this.logger.debug("getUsersBlogs=>",a),a}async addPost(a){var l;const t=JSON.stringify({title:a.title,content:a.description}),s=await this.webProxyFetch("https://zhuanlan.zhihu.com/api/articles/drafts",[],t,"POST");if(this.logger.debug("save zhihu draft res=>",s),!s.id)throw new Error("知乎文章发布失败");const e=s.id.toString(),o=JSON.stringify({column:null,commentPermission:"anyone",disclaimer_type:"none",disclaimer_status:"close",table_of_contents_enabled:!1,commercial_report_info:{commercial_types:[]},commercial_zhitask_bind_info:null}),i=await this.webProxyFetch(`https://zhuanlan.zhihu.com/api/articles/${s.id}/publish`,[],o,"PUT");this.logger.debug("publish zhihu article pubRes=>",i);const n=((l=a.cate_slugs)==null?void 0:l[0])??this.cfg.blogid;return await this.addPostToColumn(n,e),{status:"success",post_id:e}}async editPost(a,t,s){var l;const e=JSON.stringify({title:t.title,content:t.description,table_of_contents:!1,delta_time:10}),o=await this.webProxyFetch(`https://zhuanlan.zhihu.com/api/articles/${a}/draft`,[],e,"PATCH");if(this.logger.debug("updated zhihu draft =>",o),(l=o==null?void 0:o.error)!=null&&l.message)throw new Error(`知乎文章更新失败：[${o.error.name}] `+o.error.message);const i=JSON.stringify({disclaimer_type:"none",disclaimer_status:"close",table_of_contents_enabled:!1,commercial_report_info:{commercial_types:[]},commercial_zhitask_bind_info:null}),n=await this.webProxyFetch(`https://zhuanlan.zhihu.com/api/articles/${a}/publish`,[],i,"PUT");return this.logger.debug("edit zhihu pubRes=>",n),!0}async getPreviewUrl(a){return`https://zhuanlan.zhihu.com/p/${a}`}async deletePost(a){let t=!1;try{const s=await this.webProxyFetch(`https://www.zhihu.com/api/v4/articles/${a}`,[],{},"DELETE");if(this.logger.debug("delete zhihu article res=>",s),s.success)t=!0;else throw new Error(s.error.message)}catch(s){throw this.logger.error("知乎文章删除失败",s),s}return t}async getCategories(){var l,p;const a=[],t=`https://www.zhihu.com/people/${this.cfg.username}/columns`,s=await this.webProxyFetch(t,[],{},"GET","text/html");this.logger.debug("get zhihu columns dom =>",{res:s});const o=Yt(s)("#js-initialData").html(),i=oe.safeParse(o,{});this.logger.debug("get column initJson=>",i);const n=((p=(l=i==null?void 0:i.initialState)==null?void 0:l.entities)==null?void 0:p.columns)??{};return this.logger.debug("get columns=>",n),Object.keys(n).map(c=>{const g=new Qe,y=n[c];g.categoryId=y.id,g.categoryName=y.title,g.description=y.url,g.categoryDescription=y.url,a.push(g)}),a}async uploadFile(a,t){if(this.logger.debug(`zhihu start uploadFile ${t}=>`,a),a instanceof Blob){const s=await a.arrayBuffer(),e=cl(s),o=xo.MD5(e.toString("utf8")).toString(),i=JSON.stringify({image_hash:o,source:"article"});this.logger.debug("zhihu uploadFile, params =>",i);const n=await this.webProxyFetch("https://api.zhihu.com/images",[],i,"POST");this.logger.debug("zhihu uploadFile, fileResp =>",n);const l=n.upload_file;if(n.upload_file.state==1){const p=await this.untilImageDone(l.image_id);this.logger.debug("imgDetail",p),l.object_key=p.original_hash}else{const p=n.upload_token;try{const c=vl("https://zhihu-pics-upload.zhimg.com","zhihu-pics",p),g=await c.put(l.object_key,new Blob([e]));this.logger.debug("zhihu uploadFile finished",{client:c,finalUrl:g})}catch(c){throw this.logger.error("知乎图片上传失败 =>",c),new Error("知乎图片上传失败, 错误原因 =>"+c)}}return a.type==="image/gif"&&(l.object_key=l.object_key+".gif"),{id:l.object_key,object_key:l.object_key,url:"https://pic4.zhimg.com/"+l.object_key}}return{}}async addPostToColumn(a,t){if(A.isEmptyString(a)||A.isEmptyString(t)){this.logger.info("文章或者专栏为空，不收录");return}try{const s={type:"article",id:t};await this.webProxyFetch(`https://www.zhihu.com/api/v4/columns/${a}/items`,[],s,"POST")}catch(s){this.logger.error("文章收录到专栏失败",s)}this.logger.info("文章收录到专栏成功")}async untilImageDone(a){const t=this;return new Promise(function(s,e){function o(){t.logger.debug("untilImageDone start processing...",a),(async()=>{const i=await t.webProxyFetch(`https://api.zhihu.com/images/${a}`,[],{},"GET");t.logger.debug("imgDetail",i),i.status!="processing"?(t.logger.info("image upload all done"),s(i)):(t.logger.debug("go next",o),setTimeout(o,300))})()}o()})}}class xt extends tn{}class ss extends sn{constructor(t,s,e,o,i){super(o,i);x(this,"placeholder",{});this.home=t,this.apiUrl=s,this.username=e,this.password=o,this.apiStatus=!1,this.blogid="",this.blogName="",this.posidKey="",this.previewUrl="",this.pageType=ce.Markdown,this.middlewareUrl=i,this.usernameEnabled=!1,this.allowPreviewUrlChange=!0,this.showTokenTip=!1,this.yamlLinkEnabled=!0,this.tagEnabled=!1,this.cateEnabled=!1,this.knowledgeSpaceEnabled=!1,this.placeholder=new xt}}class Pl extends ss{constructor(a,t,s){super("https://zhuanlan.zhihu.com","https://zhuanlan.zhihu.com/api",a,t,s),this.previewUrl="/p/[postid]",this.pageType=ce.Html,this.passwordType=Ce.PasswordType_Cookie,this.usernameEnabled=!0,this.tagEnabled=!1,this.cateEnabled=!1,this.knowledgeSpaceEnabled=!0,this.knowledgeSpaceTitle="专栏",this.knowledgeSpaceType=R.CategoryType_Single,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="由于知乎平台的限制，暂时不支持编辑所属专栏。如果您想移动文档，请先点击取消删除该文档，然后重新选择新的专栏发布"}}const Ia=async(r,a)=>{const t=B("use-zhihu-web");t.info("Start using Zhihu WebAuth...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:i}=me(),n=await i();if(e=oe.safeParse(n[r],{}),se.isEmptyObject(e)){const p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware"),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_ZHIHU_AUTH_TOKEN,"");e=new Pl("",c,p),t.debug("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");const l=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");A.isEmptyString(e.middlewareUrl)&&(e.middlewareUrl=l),A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.tagEnabled=!1,e.cateEnabled=!1,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceType=R.CategoryType_Single,e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="由于知乎平台的限制，暂时不支持编辑所属专栏。如果您想移动文档，请先点击取消删除该文档，然后重新选择新的专栏发布";const o=new Tl(s,e);return{cfg:e,webApi:o}},xa=async(r,a)=>{const t=B("use-metaweblog-api");t.info("Start using Metaweblog API...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:i}=me(),n=await i();if(e=oe.safeParse(n[r],{}),se.isEmptyObject(e)){const l="",p="",c="",g=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");e=new ks("",l,p,c,g),t.debug("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.tagEnabled=!0,e.cateEnabled=!0,e.categoryType=R.CategoryType_Multi,e.allowCateChange=!0,e.knowledgeSpaceEnabled=!1;const o=new Ss(s,e);return t.info("Metaweblog API created successfully."),{cfg:e,blogApi:o}};class kl extends Qt{constructor(a,t){super("https://www.notion.so/","https://api.notion.com/v1","",a,t),this.tokenSettingUrl="https://www.notion.so/my-integrations",this.showTokenTip=!0,this.previewUrl="/[postid]",this.pageType=ce.Markdown,this.passwordType=Ce.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!1,this.cateEnabled=!1,this.knowledgeSpaceEnabled=!0,this.knowledgeSpaceTitle="根页面",this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="由于Notion平台的限制，暂时不支持编辑所属父页面。如果您想移动文档，请先点击取消删除该文档，然后重新选择新的根页面发布",this.cateSearchEnabled=!0}}class Sl extends It{constructor(a,t){super(a,t),this.logger=B("notion-api-adaptor")}async getUsersBlogs(a){const t=[];return(await this.getPages(a)).forEach(e=>{var n,l;const o=new nt;o.blogid=e.id;const i=((l=(n=e==null?void 0:e.properties)==null?void 0:n.title)==null?void 0:l.title)??[];o.blogName=i.map(p=>p.plain_text).join(""),o.url=e.public_url,t.push(o)}),this.logger.debug("get usersBlogs result=>",t),t}async newPost(a,t){var e;const s=((e=a.cate_slugs)==null?void 0:e[0])??this.cfg.blogid;return await this.createPage(a.title,a.description,s)}async editPost(a,t,s){return await this.updatePage(a,t.title,t.description)}async deletePost(a){const t=this.getNotionPostidKey(a);return await this.deletePage(t.pageId)}async getPost(a,t){var p,c,g;const s=this.getNotionPostidKey(a),e=await this.getPage(s.pageId);this.logger.debug("notionPage=>",e),this.logger.debug("postid=>",a);const o=new ze,i=((c=(p=e==null?void 0:e.properties)==null?void 0:p.title)==null?void 0:c.title)??[];o.title=i.map(y=>y.plain_text).join(""),o.description="暂不支持Notion正文";const n=(g=e==null?void 0:e.parent)==null?void 0:g.page_id,l=[];return l.push(n),o.cate_slugs=l,o}async getCategories(a){const t=[],s=await this.getPages(a);return s&&s.length>0&&s.forEach(e=>{var n,l;const o=new Qe;o.categoryId=e.id;const i=((l=(n=e==null?void 0:e.properties)==null?void 0:n.title)==null?void 0:l.title)??[];o.categoryName=i.map(p=>p.plain_text).join(""),o.description=o.categoryName,o.categoryDescription=o.categoryName,o.htmlUrl=e.public_url,t.push(o)}),t}async getPreviewUrl(a){const t=this.cfg.previewUrl??"",e=this.getNotionPostidKey(a).endUrl,o=t.replace("[postid]",e);return A.pathJoin(this.cfg.home??"",o)}async getPages(a){const t={page_size:10,query:a??"",filter:{value:"page",property:"object"}},e=(await this.notionRequest("/search",t,"POST")).results;if(this.logger.debug("notion pages=>",e),e.length===0)throw new Error("no shared page linked to your connection, you must have at least one page as root page, see more at: https://stackoverflow.com/a/75537092/4037224");return e}async createPage(a,t,s){const e=s??this.cfg.blogid,o=Vo.markdownToNotion(t),i={parent:{page_id:e},properties:{title:[{text:{content:a}}]},children:o};this.logger.debug("before createPage =>",{markdownText:t,notionObject:o});const n=await this.notionRequest("/pages",i,"POST");if(n.object!=="page")throw new Error("Notion create page error");const p=n.url.split("/").slice(-1)[0];return`${n.id}_${p}`}async deletePage(a){this.logger.debug("before deletePage, pageId=>",a);const t=`/pages/${a}`,s={archived:!0},e=await this.notionRequest(t,s,"PATCH");if(e.object!=="page")throw new Error("Notion delete page error");return e.archived}async updatePage(a,t,s){throw new Error("Notion是基于块的API，暂时不支持更新，如需更新，请删除之后重新发布")}async getPage(a){this.logger.debug("before getPage, pageId=>",a);const t=`/pages/${a}`,s=await this.notionRequest(t,{},"GET");if(s.object!=="page")throw new Error("Notion get page error");return s}getNotionPostidKey(a){let t,s;if(a.indexOf("_")>0){const e=a.split("_");t=e[0],s=e[1]}else t=a;return{pageId:t,endUrl:s}}async notionRequest(a,t,s="POST"){const e="application/json",o={"Content-Type":e,Authorization:`Bearer ${this.cfg.password}`,"Notion-Version":"2022-06-28"},i=`${this.cfg.apiUrl}${a}`;this.logger.debug("向Notion请求数据，apiUrl =>",i),this.logger.debug("向Notion请求数据，params =>",t);const n=se.isEmptyObject(t)?{}:t,l=await this.proxyFetch(i,[o],n,s,e);if(this.logger.debug("向Notion请求数据，resJson =>",l),(l==null?void 0:l.status)===400||(l==null?void 0:l.status)===401||(l==null?void 0:l.status)===404||(l==null?void 0:l.status)===429)throw new Error(l==null?void 0:l.message);return l}}const Va=async(r,a)=>{const t=B("use-notion-api");t.info("Start using Notion API...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:i}=me(),n=await i();if(e=oe.safeParse(n[r],{}),se.isEmptyObject(e)){const l=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_NOTION_AUTH_TOKEN,""),p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");e=new kl(l,p),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.tagEnabled=!1,e.cateEnabled=!1,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceType=R.CategoryType_Single,e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="由于Notion平台的限制，暂时不支持编辑所属父页面。如果您想移动文档，请先点击取消删除该文档，然后重新选择新的根页面发布",e.cateSearchEnabled=!0;const o=new Sl(s,e);return t.info("Notion API created successfully.",e),{cfg:e,blogApi:o}};class Et extends Qt{constructor(t,s,e,o,i){super("https://github.com","https://api.github.com",t,s,i);x(this,"githubRepo");x(this,"githubBranch");x(this,"defaultPath");x(this,"defaultMsg");x(this,"author");x(this,"email");x(this,"mdFilenameRule");x(this,"previewPostUrl");x(this,"previewUrl","");this.username=t,this.usernameEnabled=!0,this.password=s,this.passwordType=Ce.PasswordType_Token,this.tokenSettingUrl="https://github.com/settings/tokens",this.showTokenTip=!0,this.tagEnabled=!0,this.cateEnabled=!0,this.knowledgeSpaceEnabled=!1,this.githubRepo=e,this.githubBranch=o,this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.defaultPath="/",this.defaultMsg="auto published by siyuan-plugin-publisher",this.author="terwer",this.email="youweics@163.com",this.mdFilenameRule="[filename].md",this.useMdFilename=!1,this.usePathCategory=!1,this.middlewareUrl=i}}class Ro extends Et{constructor(a,t,s,e,o){super(a,t,s,e,o),this.tokenSettingUrl="https://github.com/settings/tokens",this.showTokenTip=!0,this.defaultPath="source/_posts",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[slug].md",this.pageType=ce.Markdown,this.passwordType=Ce.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=R.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Hexo 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=R.CategoryType_Tree_Single,this.useMdFilename=!1,this.usePathCategory=!1}}class Vt extends It{constructor(t,s){super(t,s);x(this,"githubClient");this.logger=B("common-github-api-adaptor");const e=new _n(s.username,s.githubRepo,s.password);e.defaultBranch=s.githubBranch,e.defaultPath=s.defaultPath,e.defaultMsg=s.defaultMsg,e.author=s.author,e.email=s.email,e.previewMdUrl=s.previewUrl,e.previewUrl=s.previewPostUrl,e.baseUrl=s.home,e.mdFilenameRule=s.mdFilenameRule,this.githubClient=new bn(e)}async getUsersBlogs(){const t=[],s=await this.githubClient.getGithubPageTreeNode("");if(this.logger.debug("getGithubPageTreeNode =>",s),s&&s.length>0){const e=new nt,o=this.cfg;e.blogid=o.defaultPath,e.blogName=o.defaultPath,e.url=A.pathJoin(A.pathJoin(o.home,o.username),o.githubRepo),t.push(e)}return this.logger.debug("result result =>",t),t}async newPost(t,s){var p,c;this.logger.debug("start newPost =>",{post:te(t)});const e=this.cfg,o=((p=t.cate_slugs)==null?void 0:p[0])??e.blogid,i=t.mdFilename??"auto-"+Ps.newID(),n=`${o}/${i}.md`;this.logger.info("将要最终发送到以下目录 =>",n);const l=await this.githubClient.publishGithubPage(n,t.description);if(!((c=l==null?void 0:l.content)!=null&&c.path))throw new Error("Github 调用API异常");return l.content.path}async getPost(t,s){this.logger.debug("start getPost =>",{postid:t});const e=await this.githubClient.getGithubPage(t);if(this.logger.debug("getPost finished =>",e),!e)throw new Error("Github 调用API异常");let o=new ze;o.postid=e.path,o.mdFilename=e.name,o.markdown=Wt.fromBase64(e.content),o.description=o.markdown;const i=this.getYamlAdaptor();if(i!==null){const p=await Q.yaml2ObjAsync(o.description),c=new pt;c.yamlObj=p,this.logger.debug("extract frontFormatter, yamlFormatObj =>",c),o=i.convertToAttr(o,c,this.cfg),this.logger.debug("handled yamlObj using YamlConverterAdaptor =>",p)}const n=[],l=e.path.replace(e.name,"").replace(/\/$/,"");return n.push(l),o.cate_slugs=n,o}async editPost(t,s,e){var i;this.logger.debug("start editPost =>",{postid:t,post:te(s)});const o=await this.githubClient.updateGithubPage(s.postid,s.description);if(!((i=o==null?void 0:o.content)!=null&&i.path))throw new Error("Github 调用API异常");return!0}async deletePost(t){var e;const s=await this.githubClient.deleteGithubPage(t);if(!((e=s==null?void 0:s.commit)!=null&&e.sha))throw new Error("Github 调用API异常");return!0}async getCategories(){return Promise.resolve([])}async getCategoryTreeNodes(t){return await this.githubClient.getGithubPageTreeNode(t)}async getPreviewUrl(t){const s=this.cfg;let e;return e=s.previewUrl.replace("[user]",s.username).replace("[repo]",s.githubRepo).replace("[branch]",s.githubBranch).replace("[docpath]",t),e=A.pathJoin(this.cfg.home,e),e}async getPostPreviewUrl(t){let s;const e=t.substring(t.lastIndexOf("/")+1).replace(".md","");return s=this.cfg.previewUrl.replace("[postid]",e),s=A.pathJoin(A.pathJoin(this.cfg.home,this.cfg.username),s),s}processFilename(t,s){const i=Ae.formatIsoToZhDate(t.dateCreated.toISOString(),!0).split(" ")[0].split("-"),n=i[0],l=i[1],p=i[2];this.logger.debug("created numarr=>",i);let c=s.mdFilenameRule.replace(/\.md/g,"");return s.useMdFilename?c=c.replace(/\[filename\]/g,t.title):c=c.replace(/\[slug\]/g,t.wp_slug),c=c.replace(/\[yyyy\]/g,n).replace(/\[MM\]/g,l).replace(/\[mm\]/g,l).replace(/\[dd\]/g,p),c}processPathCategory(t,s){let e=[];if(s.usePathCategory){this.logger.debug("savePath=>",t);const o=t.split("/");if(o.length>1)for(let i=1;i<o.length-1;i++){const n=it.removeTitleNumber(o[i]);e.push(n)}}return e}}class so extends Ut{constructor(){super(...arguments);x(this,"logger",B("hexo-yaml-converter-adaptor"))}convertToYaml(t,s){var i,n;this.logger.debug("您正在使用 Hexo Yaml Converter",{post:te(t)});let e=new pt;if(e.yamlObj.title=t.title,e.yamlObj.date=Ae.formatIsoToZh(t.dateCreated.toISOString(),!0),t.dateUpdated||(t.dateUpdated=new Date),e.yamlObj.updated=Ae.formatIsoToZh(t.dateUpdated.toISOString(),!0),A.isEmptyString(t.shortDesc)||(e.yamlObj.excerpt=t.shortDesc),!A.isEmptyString(t.mt_keywords)){const l=t.mt_keywords.split(",");e.yamlObj.tags=l}if(((i=t.categories)==null?void 0:i.length)>0&&(e.yamlObj.categories=t.categories),s.yamlLinkEnabled){let l="/post/"+t.wp_slug+".html";if(s instanceof Et){const p=s;if(!A.isEmptyString(s.previewPostUrl)){l=p.previewPostUrl.replace("[postid]",t.wp_slug);const y=Ae.formatIsoToZh(t.dateCreated.toISOString(),!0).split(" ")[0].split("-");this.logger.debug("created numarr=>",y);const u=y[0],d=y[1],b=y[2];l=l.replace(/\[yyyy]/g,u),l=l.replace(/\[MM]/g,d),l=l.replace(/\[mm]/g,d),l=l.replace(/\[dd]/g,b),((n=e.yamlObj.categories)==null?void 0:n.length)>0?l=l.replace(/\[cats]/,e.yamlObj.categories.join("/")):l=l.replace(/\/\[cats]/,"")}}e.yamlObj.permalink=l}e.yamlObj.comments=!0,e.yamlObj.toc=!0;let o=Q.obj2Yaml(e.yamlObj);return this.logger.debug("yaml=>",o),e.formatter=o,e.mdContent=t.markdown,e.mdFullContent=Q.addYamlToMd(e.formatter,e.mdContent),e.htmlContent=t.html,this.logger.info("生成默认的YAML"),e}convertToAttr(t,s,e){var o,i,n,l,p,c,g,y,u,d;return this.logger.debug("开始转换YAML到Post",s),(o=s.yamlObj)!=null&&o.title&&(t.title=(i=s.yamlObj)==null?void 0:i.title),(n=s.yamlObj)!=null&&n.date&&(t.dateCreated=Ae.convertStringToDate((l=s.yamlObj)==null?void 0:l.date)),(p=s.yamlObj)!=null&&p.updated&&(t.dateUpdated=Ae.convertStringToDate((c=s.yamlObj)==null?void 0:c.updated)),t.shortDesc=(g=s.yamlObj)==null?void 0:g.excerpt,t.mt_keywords=(u=(y=s.yamlObj)==null?void 0:y.tags)==null?void 0:u.join(","),t.categories=(d=s.yamlObj)==null?void 0:d.categories,t.yaml=Q.obj2Yaml(s.yamlObj),this.logger.debug("转换完成，post =>",t),t}}class Al extends Vt{getYamlAdaptor(){return new so}async preEditPost(a,t,s){const e=await super.preEditPost(a,t,s),o=s==null?void 0:s.cfg,i=ye.cloneDeep(e),n=i.markdown;this.logger.info("准备处理 Hexo 正文"),this.logger.debug("md =>",{md:n});const l=Q.extractFrontmatter(n,!0);let p=Q.extractMarkdown(n);return i.markdown=`${l}
${p}`,this.logger.info("Hexo 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:p}),(o==null?void 0:o.pageType)==ce.Markdown?i.description=i.markdown:i.description=i.html,i}}const cs=async(r,a)=>{const t=B("use-hexo-api");t.info("Start using Hexo API...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:n}=me(),l=await n();if(e=oe.safeParse(l[r],{}),se.isEmptyObject(e)){const p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_USERNAME,""),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_AUTH_TOKEN,""),g=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_REPO,""),y=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_BRANCH,"main"),u=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");e=new Ro(p,c,g,y,u),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.mdFilenameRule="[slug].md",e.useMdFilename=!1,e.usePathCategory=!1,e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=R.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Hexo 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=R.CategoryType_Tree_Single;const o=new so,i=new Al(s,e);return t.info("Hexo API created successfully.",e),{cfg:e,yamlAdaptor:o,blogApi:i}};class Cl extends Ro{constructor(a,t,s,e,o){super(a,t,s,e,o),this.home="[your-gitlab-home]",this.apiUrl="[your-gitlab-api-url]",this.tokenSettingUrl="[your-gitlab-host]/-/profile/personal_access_tokens",this.showTokenTip=!0,this.defaultPath="source/_posts",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[slug].md",this.pageType=ce.Markdown,this.passwordType=Ce.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=R.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Githubhexo 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=R.CategoryType_Tree_Single,this.useMdFilename=!1,this.usePathCategory=!1}}class Fo extends so{}class Nt extends It{constructor(t,s){super(t,s);x(this,"gitlabClient");this.logger=B("common-gitlab-api-adaptor"),this.gitlabClient=new wn(t,s.apiUrl,s.password,s.username,s.githubRepo,s.githubBranch,s.defaultMsg,s.email,s.author,s.middlewareUrl,bt)}async getUsersBlogs(){const t=[],s=await this.gitlabClient.getRepositoryTree("");if(this.logger.debug("getRepositoryTree =>",s),s&&s.length>0){const e=new nt,o=this.cfg;e.blogid=o.defaultPath,e.blogName=o.defaultPath,e.url=A.pathJoin(A.pathJoin(o.home,o.username),o.githubRepo),t.push(e)}return this.logger.debug("result result =>",t),t}async newPost(t,s){var p;this.logger.debug("start newPost =>",{post:te(t)});const e=this.cfg,o=((p=t.cate_slugs)==null?void 0:p[0])??e.blogid,i=t.mdFilename??"auto-"+Ps.newID(),n=`${o}/${i}.md`;this.logger.info("将要最终发送到以下目录 =>",n);const l=await this.gitlabClient.createRepositoryFile(n,t.description);if(this.logger.debug("gitlab newPost finished =>",l),!(l!=null&&l.file_path))throw new Error("Gitlab 调用API异常 =>"+(l==null?void 0:l.message));return l.file_path}async getPost(t,s){this.logger.debug("start getPost =>",{postid:t});const e=await this.gitlabClient.getRepositoryFile(t);if(this.logger.debug("gitlab getPost finished =>",e),!e)throw new Error("Gitlab 调用API异常");let o=new ze;o.postid=e.file_path,o.mdFilename=e.file_name,o.markdown=Wt.fromBase64(e.content),o.description=o.markdown;const i=this.getYamlAdaptor();if(i!==null){const p=await Q.yaml2ObjAsync(o.description),c=new pt;c.yamlObj=p,this.logger.debug("extract frontFormatter, yamlFormatObj =>",c),o=i.convertToAttr(o,c,this.cfg),this.logger.debug("handled yamlObj using YamlConverterAdaptor =>",p)}const n=[],l=e.file_path.replace(e.file_name,"").replace(/\/$/,"");return n.push(l),o.cate_slugs=n,o}async editPost(t,s,e){this.logger.debug("start editPost =>",{postid:t,post:te(s)});const o=await this.gitlabClient.updateRepositoryFile(s.postid,s.description);if(this.logger.debug("gitlab editPost finished =>",o),!(o!=null&&o.file_path))throw new Error("Gitlab 调用API异常");return!0}async deletePost(t){try{const s=await this.gitlabClient.deleteRepositoryFile(t);this.logger.debug("gitlab deletePost finished =>",s)}catch(s){throw new Error("Gitlab 调用API异常 =>"+s)}return!0}async getCategories(){return Promise.resolve([])}async getCategoryTreeNodes(t){return await this.gitlabClient.getRepositoryTree(t)}async getPreviewUrl(t){const s=this.cfg;let e;return e=s.previewUrl.replace("[user]",s.username).replace("[repo]",s.githubRepo).replace("[branch]",s.githubBranch).replace("[docpath]",t),e=A.pathJoin(this.cfg.home,e),e}async getPostPreviewUrl(t){let s;const e=t.substring(t.lastIndexOf("/")+1).replace(".md","");return s=this.cfg.previewUrl.replace("[postid]",e),s=A.pathJoin(A.pathJoin(this.cfg.home,this.cfg.username),s),s}}class Dl extends Nt{getYamlAdaptor(){return new Fo}async preEditPost(a,t,s){const e=await super.preEditPost(a,t,s),o=s==null?void 0:s.cfg,i=ye.cloneDeep(e),n=i.markdown;this.logger.info("准备处理 Gitlabhexo 正文"),this.logger.debug("md =>",{md:n});const l=Q.extractFrontmatter(n,!0);let p=Q.extractMarkdown(n);return i.markdown=`${l}
${p}`,this.logger.info("Gitlabhexo 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:p}),(o==null?void 0:o.pageType)==ce.Markdown?i.description=i.markdown:i.description=i.html,i}}const ps=async(r,a)=>{const t=B("use-gitlab-hexo-api");t.info("Start using Gitlabhexo API...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:n}=me(),l=await n();if(e=oe.safeParse(l[r],{}),se.isEmptyObject(e)){const p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_USERNAME,""),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_AUTH_TOKEN,""),g=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_REPO,""),y=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_BRANCH,"main"),u=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");e=new Cl(p,c,g,y,u),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.mdFilenameRule="[slug].md",e.useMdFilename=!1,e.usePathCategory=!1,e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=R.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabhexo 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=R.CategoryType_Tree_Single;const o=new Fo,i=new Dl(s,e);return t.info("Gitlabhexo API created successfully.",e),{cfg:e,yamlAdaptor:o,blogApi:i}};class Ul extends ss{constructor(a,t,s){super("https://blog.csdn.net","https://bizapi.csdn.net",a,t,s),this.previewUrl="[userid]/article/details/[postid]",this.pageType=ce.Markdown,this.usernameEnabled=!1,this.passwordType=Ce.PasswordType_Cookie,this.tagEnabled=!0,this.cateEnabled=!0,this.categoryType=R.CategoryType_Multi,this.allowCateChange=!0,this.knowledgeSpaceEnabled=!1}}const ft=class ft{static generateXCaNonce(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){const t=16*Math.random()|0;return(a==="x"?t:3&t|8).toString(16)})}static generateXCaSignature(a,t,s,e,o){const i=new URL(a),n=yn.parse(ft.APP_SECRET);let l;if(t==="GET"){const g=i.pathname+i.search;l=`GET
${s}

${o}

x-ca-key:${ft.X_CA_KEY}
x-ca-nonce:${e}
${g}`}else{const g=i.pathname;l=`POST
${s}

${o}

x-ca-key:${ft.X_CA_KEY}
x-ca-nonce:${e}
${g}`}const p=xo.HmacSHA256(l,n);return fn.stringify(p)}};x(ft,"X_CA_KEY","203803574"),x(ft,"APP_SECRET","9znpamsyl2c7cdrr9sas0le9vbc3r6ba");let zt=ft;class Ol{static readCookie(a,t){const s=t.split(";");for(const e of s){const[o,i]=e.split("=");if(o.trim()===a)return decodeURIComponent(i)??""}return""}}class Ml extends ts{async getMetaData(){const a=await this.csdnFetch("https://bizapi.csdn.net/blog-console-api/v1/user/info"),t=!!a.data.username;return this.logger.info(`get csdn metadata finished, flag => ${t}`),{flag:t,uid:a.data.username,title:a.data.username,avatar:a.data.avatar,type:"csdn",displayName:"CSDN",supportTypes:["markdown","html"],home:"https://mp.csdn.net/",icon:"https://g.csdnimg.cn/static/logo/favicon32.ico"}}async getUsersBlogs(){var s;let a=[];const t=await this.csdnFetch("https://bizapi.csdn.net/blog/phoenix/console/v1/column/list?type=all");if(this.logger.debug("get csdn columns =>",t),(t==null?void 0:t.code)===200){const e=(s=t==null?void 0:t.data)==null?void 0:s.list,o=(e==null?void 0:e.column)??[],i=(e==null?void 0:e.pay_column)??[];o.forEach(n=>{const l=new nt;l.blogid=n.id,l.blogName=n.edit_title,l.url=n.column_url,a.push(l)}),i.forEach(n=>{const l=new nt;l.blogid=n.id,l.blogName=n.edit_title,l.url=n.column_url,a.push(l)})}return this.logger.debug("getUsersBlogs=>",a),a}async getCategories(){var s;const a=[],t=await this.csdnFetch("https://bizapi.csdn.net/blog/phoenix/console/v1/column/list?type=all");if(this.logger.debug("get csdn columns =>",t),(t==null?void 0:t.code)===200){const e=(s=t==null?void 0:t.data)==null?void 0:s.list,o=(e==null?void 0:e.column)??[],i=(e==null?void 0:e.pay_column)??[];o.forEach(n=>{const l=new Qe;l.categoryId=n.id,l.categoryName=n.edit_title,l.description=n.column_url,l.categoryDescription=n.desc,a.push(l)}),i.forEach(n=>{const l=new Qe;l.categoryId=n.id,l.categoryName=n.edit_title,l.description=n.column_url,l.categoryDescription=n.desc,a.push(l)})}return a}async addPost(a){const t=JSON.stringify({title:a.title,markdowncontent:a.markdown,content:a.html,readType:"public",level:0,tags:a.mt_keywords,status:0,categories:a.categories.join(","),type:"original",original_link:"",authorized_status:!1,Description:a.shortDesc,not_auto_saved:"1",source:"pc_mdeditor",cover_images:[],cover_type:1,is_new:1,vote_id:0,resource_id:"",pubStatus:"publish"}),s=await this.csdnFetch("https://bizapi.csdn.net/blog-console-api/v3/mdeditor/saveArticle",[],t,"POST");if(this.logger.debug("save csdn post res=>",s),(s==null?void 0:s.code)!==200)throw new Error("CSDN文章发布失败，可能是等级不够导致，如过等级不够，请去掉文章标签");return{status:"success",post_id:s.data.id.toString()}}async editPost(a,t,s){const e=JSON.stringify({id:a,title:t.title,markdowncontent:t.markdown,content:t.html,readType:"public",level:"1",tags:t.mt_keywords,status:0,categories:t.categories.join(","),type:"original",original_link:"",authorized_status:!1,Description:t.shortDesc,resource_url:"",not_auto_saved:"1",source:"pc_mdeditor",cover_images:[],cover_type:1,is_new:1,vote_id:0,resource_id:"",pubStatus:"publish"}),o=await this.csdnFetch("https://bizapi.csdn.net/blog-console-api/v3/mdeditor/saveArticle",[],e,"POST");if(this.logger.debug("save csdn post res=>",o),(o==null?void 0:o.code)!==200)throw new Error("CSDN文章更新失败，可能是等级不够导致，如过等级不够，请去掉文章标签");return this.logger.debug("edit csdn post res=>",o),!0}async getPost(a){const t=await this.csdnFetch(`https://bizapi.csdn.net/blog-console-api/v3/editor/getArticle?id=${a}`);this.logger.debug("get csdn post =>",t);const s=new ze;if((t==null?void 0:t.code)===200){const e=t==null?void 0:t.data;s.postid=e.article_id,s.title=e.title,s.mt_keywords=(e==null?void 0:e.tags)??"",s.categories=(e==null?void 0:e.categories.split(","))??[]}return s}async deletePost(a){let t=!1;try{const s=JSON.stringify({articleId:a,deep:!1}),e=await this.csdnFetch("https://bizapi.csdn.net/blog/phoenix/console/v1/article/del",[],s,"POST");if(this.logger.debug("delete csdn article res=>",e),(e==null?void 0:e.code)!==200)throw new Error(e==null?void 0:e.message);t=!0}catch(s){throw this.logger.error("CSDN文章删除失败",s),s}return t}async uploadFile(a,t){if(this.logger.debug(`csdn start uploadFile ${t}=>`,a),a instanceof Blob){const s=await this.requestUpload(t);if(this.logger.debug("csdn image uploadData =>",s),!s)throw new Error("CSDN图片信息获取失败 =>"+t);const e=s.host,o=new FormData;o.append("key",s.filePath),o.append("policy",s.policy),o.append("OSSAccessKeyId",s.accessId),o.append("success_action_status","200"),o.append("signature",s.signature),o.append("callback",s.callbackUrl),o.append("file",a),this.logger.debug("csdn image upload strat...");const n=await(await fetch(e,{method:"POST",body:o})).text();this.logger.debug("csdn image upload success, resText=>",n);const l=oe.safeParse(n,{});if(l.code!==200)throw new Error("CSDN图片上传失败 =>"+t);return{id:l.data.targetObjectKey,object_key:l.data.targetObjectKeyy,url:l.data.imageUrl}}return{}}async requestUpload(a){const t="https://imgservice.csdn.net/direct/v1.0/image/upload?watermark=&type=blog&rtype=markdown",s=a.split(".").pop();if(!this.validateFileExt(s))return null;var e=await this.csdnFetch(t,{"x-image-app":"direct_blog","x-image-suffix":s,"x-image-dir":"direct"});return e.code!==200?(this.logger.error("图片可能已经上传，信息如下",e),null):e.data}validateFileExt(a){switch(a.toLowerCase()){case"jpg":case"png":case"jpeg":case"gif":return!0;default:return!1}}async csdnFetch(a,t={},s=void 0,e="GET",o="application/json"){var d;const i="*/*",n=zt.X_CA_KEY,l=zt.generateXCaNonce(),p=zt.generateXCaSignature(a,e,i,l,o),c=new Map;c.set("accept",i),c.set("content-type",o),c.set("x-ca-key",n),c.set("x-ca-nonce",l),c.set("x-ca-signature",p),c.set("x-ca-signature-headers","x-ca-key,x-ca-nonce");const g={...Object.fromEntries(c),...t},y={method:e,headers:g,body:s};this.logger.debug("csdn url =>",a),this.logger.debug("csdn requestOptions =>",y);const u=await this.webProxyFetch(a,[g],s,e,o);if((u==null?void 0:u.code)!==200)throw new Error((d=u==null?void 0:u.body)==null?void 0:d.message);return u}async getPreviewUrl(a){const t=this.cfg.password,s=Ol.readCookie("UserName",t),e=this.cfg.previewUrl.replace(/\[userid\]/g,s).replace(/\[postid\]/g,a);return A.pathJoin(this.cfg.home??"",e)}}const Na=async(r,a)=>{const t=B("use-csdn-web");t.info("Start using Csdn WebAuth...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:i}=me(),n=await i();if(e=oe.safeParse(n[r],{}),se.isEmptyObject(e)){const p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware"),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_CSDN_AUTH_TOKEN,"");e=new Ul("",c,p),t.debug("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");const l=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");A.isEmptyString(e.middlewareUrl)&&(e.middlewareUrl=l),A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.tagEnabled=!0,e.cateEnabled=!0,e.categoryType=R.CategoryType_Multi,e.allowCateChange=!0,e.knowledgeSpaceEnabled=!1;const o=new Ml(s,e);return{cfg:e,webApi:o}};class Il extends ss{constructor(a,t,s){super("https://mp.weixin.qq.com","https://mp.weixin.qq.com/cgi-bin/appmsg",a,t,s),this.previewUrl="/cgi-bin/appmsg?t=media/appmsg_edit&action=edit&type=77&appmsgid=[postid]&token=[token]&lang=zh_CN",this.pageType=ce.Html,this.passwordType=Ce.PasswordType_Cookie,this.usernameEnabled=!1,this.tagEnabled=!1,this.cateEnabled=!1,this.knowledgeSpaceEnabled=!1}}class xl extends ts{async getMetaData(){const a=await this.webProxyFetch("https://mp.weixin.qq.com/",[],{},"GET","text/html");this.logger.debug("WechatWebAdaptor res=>",{res:a});const t=Yt(a),s=t("script")[0],e=t(s).text();this.logger.debug("scriptElement =>",{scriptText:e});const o=e.substring(e.indexOf("window.wx.commonData")),i=new Function("window.wx = {}; window.handlerNickname = function(){};"+o+"; return window.wx;")();this.logger.debug(o,i);const n=Object.assign({},i.commonData);if(delete window.wx,!n.data.t)throw new Error("微信公众号未登录或者登录过期，请更新cookie");const l={flag:!A.isEmptyString(n.data.t),uid:n.data.user_name,title:n.data.nick_name,token:n.data.t,commonData:n,avatar:t(".weui-desktop-account__thumb").eq(0).attr("src"),type:"weixin",supportTypes:["html"],home:"https://mp.weixin.qq.com",icon:"https://mp.weixin.qq.com/favicon.ico"};return this.logger.info(`get wechat metadata finished, flag => ${l}`),l}async getUsersBlogs(){let a=[];const t=await this.webProxyFetch("https://mp.weixin.qq.com/",[],{},"GET","text/html");this.logger.debug("WechatWebAdaptor res=>",{res:t});const s=Yt(t),e=s("script")[0],o=s(e).text();this.logger.debug("scriptElement =>",{scriptText:o});const i=o.substring(o.indexOf("window.wx.commonData")),n=new Function("window.wx = {}; window.handlerNickname = function(){};"+i+"; return window.wx;")();this.logger.debug(i,n);const l=Object.assign({},n.commonData);if(delete window.wx,!l.data.t)throw new Error("微信公众号未登录或者登录过期，请更新cookie");this.logger.info("get wechat commonData =>",l);const p=new nt;return p.blogid=l.data.user_name,p.blogName=l.data.nick_name,a.push(p),this.logger.debug("getUsersBlogs=>",a),a}async addPost(a){this.logger.debug("addPost get metadata =>",{cfg:te(this.cfg.metadata)});const t="https://mp.weixin.qq.com/cgi-bin/operate_appmsg?t=ajax-response&sub=create&type=77&token="+this.cfg.metadata.token+"&lang=zh_CN",s=it.parseHtml(a.shortDesc??"",119,!0),e={token:this.cfg.metadata.token,lang:"zh_CN",f:"json",ajax:"1",random:Math.random(),AppMsgId:"",count:"1",data_seq:null,operate_from:"Chrome",isnew:"0",autosave_log:"true",articlenum:"1",pre_timesend_set:"0",is_finder_video0:"0",finder_draft_id0:"0",applyori0:"0",ad_video_transition0:"",can_reward0:"0",pay_gifts_count0:"0",reward_reply_id0:"",related_video0:"",is_video_recommend0:"-1",title0:a.title,author0:"",writerid0:"0",fileid0:"",digest0:s,auto_gen_digest0:"1",content0:a.html,sourceurl0:"",last_choose_cover_from0:"0",need_open_comment0:"1",only_fans_can_comment0:"0",only_fans_days_can_comment0:"0",reply_flag0:"5",not_pay_can_comment0:"0",open_fansmsg0:"0",cdn_url0:"",cdn_235_1_url0:"",cdn_16_9_url0:"",cdn_3_4_url0:"",cdn_1_1_url0:"",cdn_finder_url0:"",cdn_video_url0:"",cdn_url_back0:"",crop_list0:"",app_cover_auto0:"0",music_id0:"",video_id0:"",voteid0:"",voteismlt0:"",supervoteid0:"",cardid0:"",cardquantity0:"",cardlimit0:"",vid_type0:"",show_cover_pic0:"0",shortvideofileid0:"",copyright_type0:"0",is_cartoon_copyright0:"0",copyright_img_list0:'{"max_width":578,"img_list":[]}',releasefirst0:"",platform0:"",reprint_permit_type0:"",allow_fast_reprint0:"0",allow_reprint0:"",allow_reprint_modify0:"",original_article_type0:"",ori_white_list0:"",video_ori_status0:"",hit_nickname0:"",free_content0:"",fee0:"0",ad_id0:"",guide_words0:"",is_share_copyright0:"0",share_copyright_url0:"",source_article_type0:"",reprint_recommend_title0:"",reprint_recommend_content0:"",share_page_type0:"0",share_imageinfo0:'{"list":[]}',share_video_id0:"",dot0:"{}",share_voice_id0:"",share_finder_audio_username0:"",share_finder_audio_exportid0:"",mmlistenitem_json_buf0:"",insert_ad_mode0:"",categories_list0:"[]",is_pay_subscribe0:"0",pay_fee0:"",pay_preview_percent0:"",pay_desc0:"",pay_album_info0:"",appmsg_album_info0:'{"appmsg_album_infos":[]}',can_insert_ad0:"1",audio_info0:'{"audio_infos":[]}',danmu_pub_type0_0:"0",is_set_sync_to_finder0:"0",sync_to_finder_cover0:"",sync_to_finder_cover_source0:"",import_to_finder0:"0",import_from_finder_export_id0:"",style_type0:"3",sticker_info0:'{"is_stickers":0,"common_stickers_num":0,"union_stickers_num":0,"sticker_id_list":[],"has_invalid_sticker":0}',new_pic_process0:"0",disable_recommend0:"0",req:'{"idx_infos":[{"save_old":0,"cps_info":{"cps_import":0}}]}',is_auto_type_setting:"3",save_type:"1",isneedsave:"0"},o=await this.wechatFetch(t,e);if(!o.appMsgId){const i=o.base_resp;throw new Error("同步到微信公众号失败，错误内容："+(i&&i.errmsg?i.errmsg:i.ret))}return{status:"success",post_id:o.appMsgId.toString()}}async editPost(a,t,s){this.logger.debug("editPost get metadata =>",{cfg:te(this.cfg.metadata)});let e=!1;const o="https://mp.weixin.qq.com/cgi-bin/operate_appmsg?t=ajax-response&sub=update&type=77&token="+this.cfg.metadata.token+"&lang=zh_CN",i=it.parseHtml(t.shortDesc??"",119,!0),n=a,l={token:this.cfg.metadata.token,lang:"zh_CN",f:"json",ajax:"1",random:Math.random(),AppMsgId:n,count:"1",data_seq:null,operate_from:"Chrome",isnew:"0",autosave_log:"true",articlenum:"1",pre_timesend_set:"0",is_finder_video0:"0",finder_draft_id0:"0",applyori0:"0",ad_video_transition0:"",can_reward0:"0",pay_gifts_count0:"0",reward_reply_id0:"",related_video0:"",is_video_recommend0:"-1",title0:t.title,author0:"",writerid0:"0",fileid0:"",digest0:i,auto_gen_digest0:"1",content0:t.html,sourceurl0:"",last_choose_cover_from0:"0",need_open_comment0:"1",only_fans_can_comment0:"0",reply_flag0:"5",not_pay_can_comment0:"0",open_fansmsg0:"0",cdn_url0:"",cdn_235_1_url0:"",cdn_16_9_url0:"",cdn_3_4_url0:"",cdn_1_1_url0:"",cdn_finder_url0:"",cdn_video_url0:"",cdn_url_back0:"",crop_list0:"",app_cover_auto0:"0",music_id0:"",voteid0:"",voteismlt0:"",supervoteid0:"",cardid0:"",cardquantity0:"",cardlimit0:"",vid_type0:"",show_cover_pic0:"0",shortvideofileid0:"",copyright_type0:"0",is_cartoon_copyright0:"0",copyright_img_list0:'{"max_width":578,"img_list":[]}',releasefirst0:"",platform0:"",reprint_permit_type0:"",allow_fast_reprint0:"0",allow_reprint0:"",allow_reprint_modify0:"",original_article_type0:"",ori_white_list0:"",video_ori_status0:"",hit_nickname0:"",free_content0:"",fee0:"0",ad_id0:"",guide_words0:"",is_share_copyright0:"0",share_copyright_url0:"",source_article_type0:"",reprint_recommend_title0:"",reprint_recommend_content0:"",share_page_type0:"0",share_imageinfo0:'{"list":[]}',share_video_id0:"",dot0:"{}",share_voice_id0:"",share_finder_audio_username0:"",share_finder_audio_exportid0:"",mmlistenitem_json_buf0:"",insert_ad_mode0:"",categories_list0:"[]",is_pay_subscribe0:"0",pay_fee0:"",pay_preview_percent0:"",pay_desc0:"",pay_album_info0:"",appmsg_album_info0:'{"appmsg_album_infos":[]}',can_insert_ad0:"1",audio_info0:'{"audio_infos":[]}',danmu_pub_type0_0:"0",is_set_sync_to_finder0:"0",sync_to_finder_cover0:"",sync_to_finder_cover_source0:"",import_to_finder0:"0",import_from_finder_export_id0:"",style_type0:"3",sticker_info0:'{"is_stickers":0,"common_stickers_num":0,"union_stickers_num":0,"sticker_id_list":[],"has_invalid_sticker":0}',new_pic_process0:"0",disable_recommend0:"0",req:'{"idx_infos":[{"save_old":0,"cps_info":{"cps_import":0}}]}',is_auto_type_setting:"3",save_type:"1",isneedsave:"0"},p=await this.wechatFetch(o,l);if(!p.appMsgId){const c=p.base_resp;throw new Error("同步到微信公众号失败，错误内容："+(c&&c.errmsg?c.errmsg:c.ret))}return e=!0,e}async getPost(a){const t=this.cfg.metadata.token,s=`https://mp.weixin.qq.com/cgi-bin/appmsg?t=media/appmsg_edit&action=edit&type=77&appmsgid=${a}&token=${t}&lang=zh_CN`,e=await this.webProxyFetch(s,[],{},"GET","text/html");this.logger.debug("get wechat post finished, res=>",e);const o=new ze,l=(Yt(e)("html").html()||"").match(/infos\s*=\s*({.*?}},)/);if(l&&l[1]){const p=l[1].replace(/,$/,"");this.logger.debug(`matched infoJSON ${typeof p} =>`,p);try{const c=oe.safeParse(p,{});if(!se.isEmptyObject(c)){this.logger.debug("found infos =>",c);const g=c.item.find(y=>y.app_id.toString()===a);this.logger.debug("curItem =>",g),o.title=g.title,o.shortDesc=g.digest}}catch(c){this.logger.error("微信公众号JSON解析错误",c)}}else this.logger.error("微信公众号未找到infos = {}},");return o}async deletePost(a){let t=!1;const s="https://mp.weixin.qq.com/cgi-bin/operate_appmsg?sub=del&t=ajax-response",e={token:this.cfg.metadata.token,lang:"zh_CN",f:"json",ajax:"1",AppMsgId:a},o=await this.wechatFetch(s,e);if(!o.appMsgId){const i=o.base_resp;throw new Error("微信公众号文章删除失败，错误内容："+(i&&i.errmsg?i.errmsg:i.ret))}return this.logger.debug("delete wechat article res=>",o),t=!0,t}async getPreviewUrl(a){const t=this.cfg.metadata.token;return`https://mp.weixin.qq.com/cgi-bin/appmsg?t=media/appmsg_edit&action=edit&type=77&appmsgid=${a}&token=${t}&lang=zh_CN`}async uploadFile(a,t){if(this.logger.debug(`wechat start uploadFile ${t}=>`,a),a instanceof Blob){const s=this.appInstance.win;if(!s.require)throw new Error("非常抱歉，目前仅思源笔记PC客户端支持上传图片");const{FormData:e,Blob:o}=s.require(`${this.appInstance.moduleBase}libs/node-fetch-cjs/dist/index.js`),i=this.cfg.metadata.commonData.data.user_name,n=this.cfg.metadata.commonData.data.ticket,l=this.cfg.metadata.commonData.data.time,p=this.cfg.metadata.commonData.data.t,c=new Date().getTime(),g=`https://mp.weixin.qq.com/cgi-bin/filetransfer?action=upload_material&f=json&scene=8&writetype=doublewrite&groupid=1&ticket_id=${i}&ticket=${n}&svr_time=${l}&token=${p}&lang=zh_CN&seq=${c}&t=`+Math.random(),y=await es(a),u=new o([y],{type:a.type}),d=new e;d.append("type",a.type),d.append("id",new Date().getTime()),d.append("name",t),d.append("lastModifiedDate",new Date().toString()),d.append("size",a.size),d.append("file",u,t);const b=await this.wechatFormFetch(g,d);if(b.base_resp.err_msg!="ok")throw this.logger.error(`微信公众号图片上传失败, ${t} =>`,b.base_resp.err_msg),new Error("upload failed =>"+b.base_resp.err_msg);const h=b.cdn_url;return{id:b.content,object_key:b.content,url:h}}return{}}async preEditPost(a,t,s){const e=await super.preEditPost(a,t,s),o=s==null?void 0:s.cfg,i=ye.cloneDeep(e),n=i.html;this.logger.info("准备处理微信公众号正文"),this.logger.debug("html =>",{html:n});let l=n;return i.html=l,this.logger.info("微信公众号正文处理完毕"),this.logger.debug("updatedHtml =>",{updatedHtml:l}),(o==null?void 0:o.pageType)==ce.Markdown?a.description=a.markdown:a.description=a.html,i}async wechatFetch(a,t){this.logger.debug("before getFormdataFetch, params =>",t);const s=new FormData;for(const e in t)s.append(e,t[e]??"");return this.wechatFormFetch(a,s)}async wechatFormFetch(a,t){const s={Cookie:this.cfg.password,Referer:"https://mp.weixin.qq.com/cgi-bin/appmsg"};return await this.webFormFetch(a,[s],t)}}const Ba=async(r,a)=>{const t=B("use-wechat-web");t.info("Start using Wechat WebAuth...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:i}=me(),n=await i();if(e=oe.safeParse(n[r],{}),se.isEmptyObject(e)){const p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware"),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_WECHAT_AUTH_TOKEN,"");e=new Il("",c,p),t.debug("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");const l=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");A.isEmptyString(e.middlewareUrl)&&(e.middlewareUrl=l),A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.tagEnabled=!1,e.cateEnabled=!1,e.knowledgeSpaceEnabled=!1;const o=new xl(s,e);return{cfg:e,webApi:o}};class Vl extends ss{constructor(a,t,s){super("https://www.jianshu.com","https://www.jianshu.com",a,t,s),this.previewUrl="/p/[postid]",this.pageType=ce.Markdown,this.passwordType=Ce.PasswordType_Cookie,this.usernameEnabled=!1,this.tagEnabled=!1,this.cateEnabled=!1,this.knowledgeSpaceEnabled=!0,this.knowledgeSpaceTitle="笔记本",this.knowledgeSpaceType=R.CategoryType_Single,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="由于简书平台的限制，暂时不支持编辑所属笔记本。如果您想移动文档，请先点击取消删除该文档，然后重新选择新的笔记本发布"}}class Nl extends ts{async getMetaData(){const a=await this.webProxyFetch("https://www.jianshu.com/settings/basic.json"),t=a.data.avatar,s=t.substring(t.lastIndexOf("/")+1,t.lastIndexOf(".")),e=!!s;return this.logger.info(`get jianshu metadata finished, flag => ${e}`),{flag:e,uid:s,title:a.data.nickname,avatar:t,type:"jianshu",displayName:"简书",supportTypes:["html"],home:"https://www.jianshu.com/settings/basic",icon:"https://www.jianshu.com/favicon.ico"}}async getUsersBlogs(){const a=[],t={accept:"application/json"},s=await this.webProxyFetch("https://www.jianshu.com/author/notebooks",[t]);return this.logger.info("get jianshu notebooks",s),s&&s.length>0&&s.forEach(e=>{const o=new nt;o.blogid=e.id,o.blogName=e.name,a.push(o)}),this.logger.debug("getUsersBlogs=>",a),a}async getCategories(){const a=[],t={accept:"application/json"},s=await this.webProxyFetch("https://www.jianshu.com/author/notebooks",[t]);return this.logger.info("get jianshu notebooks",s),s&&s.length>0&&s.forEach(e=>{const o=new Qe;o.categoryId=e.id,o.categoryName=e.name,a.push(o)}),a}async addPost(a){var p,c;this.logger.debug("start add post =>",{post:a});const t=((c=(p=a.cate_slugs)==null?void 0:p[0])==null?void 0:c.toString())??this.cfg.blogid.toString(),s={accept:"application/json"},e={notebook_id:t,title:a.title,at_bottom:!1},o=await this.webProxyFetch("https://www.jianshu.com/author/notes",[s],e,"POST");this.logger.debug("jianshu addPost initRes =>",o);const i=o.id,n=o.slug;return await this.updateJianshuArticle(i,a.title,a.description,1),this.logger.info(`文章发布成功，开始组装简书的ID组合,pageId=${i},notebookId=${t},endUrl=${n}`),{status:"success",post_id:[i,t,n].join("_")}}async getPreviewUrl(a){const t=this.cfg.previewUrl??"",e=this.getJianshuPostidKey(a).endUrl,o=t.replace("[postid]",e);return A.pathJoin(this.cfg.home??"",o)}async deletePost(a){const s=this.getJianshuPostidKey(a).pageId,e={accept:"application/json"},o=await this.webProxyFetch(`https://www.jianshu.com/author/notes/${s}/soft_destroy`,[e],void 0,"POST");return this.logger.debug("jianshu delete post res =>",o),!0}async editPost(a,t,s){let e=!1;try{const i=this.getJianshuPostidKey(a).pageId,n={accept:"application/json"},l=await this.webProxyFetch(`https://www.jianshu.com/author/notes/${i}/note_logs`,[n]);this.logger.debug("jianshu get post version res =>",l);const p=l.length+1;this.logger.debug("jianshu update post with new version =>",p),await this.updateJianshuArticle(i,t.title,t.description,p),e=!0}catch(o){this.logger.error("简书文章更新失败",o)}return e}async uploadFile(a,t){if(this.logger.debug(`jianshu start uploadFile ${t}=>`,a),a instanceof Blob){const s=this.appInstance.win;if(!s.require)throw new Error("非常抱歉，目前仅思源笔记PC客户端支持上传图片");const{FormData:e,Blob:o}=s.require(`${this.appInstance.moduleBase}libs/node-fetch-cjs/dist/index.js`),i="https://upload.qiniup.com/",n=await es(a),l=new o([n],{type:a.type}),p=await this.webProxyFetch("https://www.jianshu.com/upload_images/token.json?filename="+t);this.logger.debug("jianshu get picture token res =>",p);const c=new e;c.append("token",p.token),c.append("key",p.key),c.append("x:protocol","https"),c.append("file",l,t);const g=await this.jianshuFormFetch(i,c);if(this.logger.debug("jianshu upload success, resJson =>",g),!g.url)throw new Error("简书图片上传失败 =>"+t);const y=g.url;return{id:p.key,object_key:p.key,url:y}}return{}}getJianshuPostidKey(a){let t,s,e;if(a.indexOf("_")>0){const o=a.split("_");t=o[0],s=o[1],e=o[2]}else t=a;return{pageId:t,notebookId:s,endUrl:e}}async updateJianshuArticle(a,t,s,e=1){const o={accept:"application/json"},i={id:a,autosave_control:e,title:t,content:s},n=await this.webProxyFetch(`https://www.jianshu.com/author/notes/${a}`,[o],i,"PUT");this.logger.debug("jianshu savePost saveRes =>",n);try{const l={accept:"application/json"},p=await this.webProxyFetch(`https://www.jianshu.com/author/notes/${a}/publicize`,[l],{},"POST");this.logger.debug("jianshu publishPost pubRes =>",p)}catch(l){Y.warning("简书文章发布失败，内容已存入草稿 =>"+l),this.logger.error("简书文章发布失败",l)}}async jianshuFormFetch(a,t){const s={};return await this.webFormFetch(a,[s],t)}}const Ga=async(r,a)=>{const t=B("use-jianshu-web");t.info("Start using Jianshu WebAuth...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:i}=me(),n=await i();if(e=oe.safeParse(n[r],{}),se.isEmptyObject(e)){const p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware"),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_JIANSHU_AUTH_TOKEN,"");e=new Vl("",c,p),t.debug("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");const l=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");A.isEmptyString(e.middlewareUrl)&&(e.middlewareUrl=l),A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.tagEnabled=!1,e.cateEnabled=!1,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="笔记本",e.knowledgeSpaceType=R.CategoryType_Single,e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="由于简书平台的限制，暂时不支持编辑所属笔记本。如果您想移动文档，请先点击取消删除该文档，然后重新选择新的笔记本发布";const o=new Nl(s,e);return{cfg:e,webApi:o}};class Bl extends ss{constructor(a,t,s){super("https://juejin.cn","https://api.juejin.cn",a,t,s),this.previewUrl="/post/[postid]",this.pageType=ce.Markdown,this.passwordType=Ce.PasswordType_Cookie,this.usernameEnabled=!1,this.tagEnabled=!1,this.tagSlugEnabled=!0,this.cateEnabled=!1,this.categoryType=R.CategoryType_Single,this.knowledgeSpaceEnabled=!0,this.knowledgeSpaceTitle="分类",this.knowledgeSpaceType=R.CategoryType_Single,this.allowKnowledgeSpaceChange=!0}}class Gl extends ts{async getMetaData(){const a=await this.webProxyFetch("https://api.juejin.cn/user_api/v1/user/get"),t=!!a.data.user_id;return this.logger.info(`get juejin metadata finished, flag => ${t}`),{flag:t,uid:a.data.user_id,title:a.data.user_name,avatar:a.data.avatar_large,type:"juejin",displayName:"掘金",raw:a.data,supportTypes:["markdown","html"],home:"https://juejin.cn/editor/drafts",icon:"https://juejin.cn/favicon.ico"}}async getUsersBlogs(){let a=[];const t={accept:"application/json"},s=await this.webProxyFetch("https://api.juejin.cn/tag_api/v1/query_category_list",[t],{},"POST");return this.logger.info("get juejin categories",s.data),s.data&&s.data.length>0&&s.data.forEach(o=>{const i=new nt;i.blogid=o.category_id,i.blogName=o.category.category_name,i.url=o.category.icon,a.push(i)}),this.logger.debug("getUsersBlogs=>",a),a}async addPost(a){var g;let t=((g=a.cate_slugs)==null?void 0:g[0])??this.cfg.blogid;A.isEmptyString(t)&&(t="6809637769959178254",this.logger.error("掘金平台未选择分类，将使用默认分类：后端"));let s=a.tags_slugs??"";A.isEmptyString(s)&&(s="6809640482725954000",this.logger.error("掘金平台未选择标签，将使用默认标签：程序员"));const e="由于掘金平台的摘要有强制字数要求，这里需要给一下默认文字作为摘要。这里是掘金平台的默认摘要，您可以稍后自行修改。";(A.isEmptyString(a.shortDesc)||a.shortDesc.length<e.length)&&(a.shortDesc=e,this.logger.error("掘金平台未设置摘要或者摘要字数不够，将使用默认摘要"));const o="https://api.juejin.cn/content_api/v1/article_draft/create",i={category_id:t,tag_ids:s.split(","),link_url:"",cover_image:"",title:a.title,brief_content:a.shortDesc,edit_type:10,html_content:"deprecated",mark_content:a.description,theme_ids:[]},n=await this.webProxyFetch(o,[],i,"POST");if(this.logger.debug("juejin add post =>",n),n.err_no!==0)throw new Error("掘金文章草稿保存错误 =>"+n.err_msg);const l=n.data.id.toString();return{status:"success",post_id:[await this.publishPost(l),l].join("_")}}async editPost(a,t,s){var g;const e=((g=t.cate_slugs)==null?void 0:g[0])??this.cfg.blogid;if(A.isEmptyString(e))throw new Error("掘金平台必须选择一个分类");const o=t.tags_slugs??"";if(A.isEmptyString(o))throw new Error("掘金平台必须选择一个标签");const n=this.getJuejinPostidKey(a).draftId,l="https://api.juejin.cn/content_api/v1/article_draft/update",p={id:n,category_id:e,tag_ids:o.split(","),link_url:"",cover_image:"",title:t.title,brief_content:t.shortDesc,edit_type:10,html_content:"deprecated",mark_content:t.markdown,theme_ids:[]},c=await this.webProxyFetch(l,[],p,"POST");if(this.logger.debug("juejin update post =>",c),c.err_no!==0)throw new Error("掘金文章更新错误 =>"+c.err_msg);return await this.publishPost(n),!0}async getPreviewUrl(a){const s=this.getJuejinPostidKey(a).pageId,e=this.cfg.previewUrl.replace("[postid]",s);return A.pathJoin(this.cfg.home??"",e)}async deletePost(a){const t="https://api.juejin.cn/content_api/v1/article/delete",o={article_id:this.getJuejinPostidKey(a).pageId},i=await this.webProxyFetch(t,[],o,"POST");if(this.logger.debug("juejin delete post res =>",i),i.err_no!==0)throw new Error("掘金文章删除失败 =>"+i.err_msg);return!0}async getPost(a,t){const e=this.getJuejinPostidKey(a).pageId,o="https://api.juejin.cn/content_api/v1/article/detail",i={article_id:e},n=await this.webProxyFetch(o,[],i,"POST");if(this.logger.debug("juejin get post res =>",n),n.err_no!==0)throw new Error("掘金文章获取失败 =>"+n.err_msg);const l=new ze,p=n.data.tags??[],c=[];p.forEach(u=>{c.push(u.tag_id)}),l.tags_slugs=c.join(",");const g=n.data.category.category_id,y=[];return y.push(g),l.cate_slugs=y,l}async getCategories(){const a=[],t={accept:"application/json"},s=await this.webProxyFetch("https://api.juejin.cn/tag_api/v1/query_category_list",[t],{},"POST");return this.logger.info("get juejin categories",s.data),s.data&&s.data.length>0&&s.data.forEach(e=>{const o=new Qe;o.categoryId=e.category_id,o.categoryName=e.category.category_name,a.push(o)}),a}async getTags(){const a=[],t={accept:"application/json"},s={cursor:"0",key_word:"",limit:10,sort_type:1},e=await this.webProxyFetch("https://api.juejin.cn/tag_api/v1/query_tag_list",[t],s,"POST");return this.logger.info("get juejin categories",e.data),e.data&&e.data.length>0&&e.data.forEach(o=>{const i=new an;i.tagId=o.tag_id,i.tagName=o.tag.tag_name,a.push(i)}),a}getJuejinPostidKey(a){let t,s;if(a.indexOf("_")>0){const e=a.split("_");t=e[0],s=e[1]}else t=a;return{pageId:t,draftId:s}}async publishPost(a){const t="https://api.juejin.cn/content_api/v1/article/publish",s={draft_id:a,sync_to_org:!1,column_ids:[],theme_ids:[]},e=await this.webProxyFetch(t,[],s,"POST");if(this.logger.debug("juejin publish post res =>",e),e.err_no!==0)throw new Error("掘金文章发布失败 =>"+(e==null?void 0:e.err_msg));return e.data.article_id.toString()}}const $a=async(r,a)=>{const t=B("use-juejin-web");t.info("Start using Juejin WebAuth...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:i}=me(),n=await i();if(e=oe.safeParse(n[r],{}),se.isEmptyObject(e)){const p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware"),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_JUEJIN_AUTH_TOKEN,"");e=new Bl("",c,p),t.debug("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");const l=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");A.isEmptyString(e.middlewareUrl)&&(e.middlewareUrl=l),A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.tagEnabled=!1,e.tagSlugEnabled=!0,e.cateEnabled=!1,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="分类",e.knowledgeSpaceType=R.CategoryType_Single,e.allowKnowledgeSpaceChange=!0;const o=new Gl(s,e);return{cfg:e,webApi:o}};class Ko extends Et{constructor(a,t,s,e,o){super(a,t,s,e,o),this.tokenSettingUrl="https://github.com/settings/tokens",this.showTokenTip=!0,this.defaultPath="content/post",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[slug].md",this.pageType=ce.Markdown,this.passwordType=Ce.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=R.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Hugo 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=R.CategoryType_Tree_Single,this.useMdFilename=!1,this.usePathCategory=!1}}class ao extends Ut{constructor(){super(...arguments);x(this,"logger",B("hugo-yaml-converter-adaptor"))}convertToYaml(t,s){var i;this.logger.debug("您正在使用 Hugo Yaml Converter",{post:te(t)});let e=new pt;if(e.yamlObj.title=t.title,e.yamlObj.slug=t.wp_slug,s.yamlLinkEnabled&&(e.yamlObj.url="/post/"+t.wp_slug+".html"),e.yamlObj.date=Ae.formatIsoToZh(t.dateCreated.toISOString(),!0),t.dateUpdated||(t.dateUpdated=new Date),e.yamlObj.lastmod=Ae.formatIsoToZh(t.dateUpdated.toISOString(),!0),e.yamlObj.toc=!0,!A.isEmptyString(t.mt_keywords)){const n=t.mt_keywords.split(",");e.yamlObj.tags=n}((i=t.categories)==null?void 0:i.length)>0&&(e.yamlObj.categories=t.categories),A.isEmptyString(t.mt_keywords)||(e.yamlObj.keywords=t.mt_keywords),A.isEmptyString(t.shortDesc)||(e.yamlObj.description=t.shortDesc),e.yamlObj.isCJKLanguage=!0;let o=Q.obj2Yaml(e.yamlObj);return this.logger.debug("yaml=>",o),e.formatter=o,e.mdContent=t.markdown,e.mdFullContent=Q.addYamlToMd(e.formatter,e.mdContent),e.htmlContent=t.html,this.logger.info("生成默认的YAML"),e}convertToAttr(t,s,e){var o,i,n,l,p,c,g,y,u,d;return this.logger.debug("开始转换YAML到Post",s),(o=s.yamlObj)!=null&&o.title&&(t.title=(i=s.yamlObj)==null?void 0:i.title),(n=s.yamlObj)!=null&&n.date&&(t.dateCreated=Ae.convertStringToDate((l=s.yamlObj)==null?void 0:l.date)),(p=s.yamlObj)!=null&&p.lastmod&&(t.dateUpdated=Ae.convertStringToDate((c=s.yamlObj)==null?void 0:c.lastmod)),t.shortDesc=(g=s.yamlObj)==null?void 0:g.description,t.mt_keywords=(u=(y=s.yamlObj)==null?void 0:y.tags)==null?void 0:u.join(","),t.categories=(d=s.yamlObj)==null?void 0:d.categories,t.yaml=Q.obj2Yaml(s.yamlObj),this.logger.debug("转换完成，post =>",t),t}}class $l extends Vt{getYamlAdaptor(){return new ao}async preEditPost(a,t,s){const e=await super.preEditPost(a,t,s),o=s==null?void 0:s.cfg,i=ye.cloneDeep(e),n=i.markdown;this.logger.info("准备处理 Hugo 正文"),this.logger.debug("md =>",{md:n});const l=Q.extractFrontmatter(n,!0);let p=Q.extractMarkdown(n);return i.markdown=`${l}
${p}`,this.logger.info("Hugo 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:p}),(o==null?void 0:o.pageType)==ce.Markdown?i.description=i.markdown:i.description=i.html,i}}const us=async(r,a)=>{const t=B("use-hugo-api");t.info("Start using Hexo API...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:n}=me(),l=await n();if(e=oe.safeParse(l[r],{}),se.isEmptyObject(e)){const p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_USERNAME,""),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_AUTH_TOKEN,""),g=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_REPO,""),y=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_BRANCH,"main"),u=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");e=new Ko(p,c,g,y,u),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.mdFilenameRule="[slug].md",e.useMdFilename=!1,e.usePathCategory=!1,e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=R.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Hugo 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=R.CategoryType_Tree_Single;const o=new ao,i=new $l(s,e);return t.info("Hugo API created successfully.",e),{cfg:e,yamlAdaptor:o,blogApi:i}};class Ll extends Ko{constructor(a,t,s,e,o){super(a,t,s,e,o),this.home="[your-gitlab-home]",this.apiUrl="[your-gitlab-api-url]",this.tokenSettingUrl="[your-gitlab-host]/-/profile/personal_access_tokens",this.showTokenTip=!0,this.defaultPath="content/post",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[slug].md",this.pageType=ce.Markdown,this.passwordType=Ce.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=R.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Githubhugo 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=R.CategoryType_Tree_Single,this.useMdFilename=!1,this.usePathCategory=!1}}class Yo extends ao{}class jl extends Nt{getYamlAdaptor(){return new Yo}async preEditPost(a,t,s){const e=await super.preEditPost(a,t,s),o=s==null?void 0:s.cfg,i=ye.cloneDeep(e),n=i.markdown;this.logger.info("准备处理 Gitlabhugo 正文"),this.logger.debug("md =>",{md:n});const l=Q.extractFrontmatter(n,!0);let p=Q.extractMarkdown(n);return i.markdown=`${l}
${p}`,this.logger.info("Gitlabhugo 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:p}),(o==null?void 0:o.pageType)==ce.Markdown?i.description=i.markdown:i.description=i.html,i}}const gs=async(r,a)=>{const t=B("use-gitlab-hugo-api");t.info("Start using Gitlabhugo API...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:n}=me(),l=await n();if(e=oe.safeParse(l[r],{}),se.isEmptyObject(e)){const p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_USERNAME,""),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_AUTH_TOKEN,""),g=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_REPO,""),y=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_BRANCH,"main"),u=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");e=new Ll(p,c,g,y,u),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.mdFilenameRule="[slug].md",e.useMdFilename=!1,e.usePathCategory=!1,e.tagEnabled=!0,e.useMdFilename=!1,e.usePathCategory=!1,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=R.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabhugo 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=R.CategoryType_Tree_Single;const o=new Yo,i=new jl(s,e);return t.info("Gitlbhugo API created successfully.",e),{cfg:e,yamlAdaptor:o,blogApi:i}};class zo extends Et{constructor(a,t,s,e,o){super(a,t,s,e,o),this.tokenSettingUrl="https://github.com/settings/tokens",this.showTokenTip=!0,this.defaultPath="_posts",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[yyyy]-[mm]-[dd]-[slug].md",this.pageType=ce.Markdown,this.passwordType=Ce.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=R.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Jekyll 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=R.CategoryType_Tree_Single,this.useMdFilename=!1,this.usePathCategory=!1}}class oo extends Ut{constructor(){super(...arguments);x(this,"logger",B("hexo-yaml-converter-adaptor"))}convertToYaml(t,s){var l;this.logger.debug("您正在使用 Jekyll Yaml Converter",{post:te(t)});let e=new pt;e.yamlObj.layout="post",e.yamlObj.title=t.title,e.yamlObj.date=Ae.formatIsoToZh(t.dateCreated.toISOString(),!0);let o="/post/"+t.wp_slug+".html";const i=s;if(i.yamlLinkEnabled&&!A.isEmptyString(i.previewPostUrl)&&(o=i.previewPostUrl.replace("[postid]",t.wp_slug)),this.logger.debug("link=>",o),e.yamlObj.permalink=o,A.isEmptyString(t.shortDesc)||(e.yamlObj.tagline=t.shortDesc),!A.isEmptyString(t.mt_keywords)){const p=t.mt_keywords.split(",");e.yamlObj.tags=p}((l=t.categories)==null?void 0:l.length)>0&&(e.yamlObj.categories=t.categories),e.yamlObj.published=!0;let n=Q.obj2Yaml(e.yamlObj);return this.logger.debug("yaml=>",n),e.formatter=n,e.mdContent=t.markdown,e.mdFullContent=Q.addYamlToMd(e.formatter,e.mdContent),e.htmlContent=t.html,this.logger.info("生成默认的YAML"),e}convertToAttr(t,s,e){var o,i,n,l,p,c,g,y;return this.logger.debug("开始转换YAML到Post",s),(o=s.yamlObj)!=null&&o.title&&(t.title=(i=s.yamlObj)==null?void 0:i.title),(n=s.yamlObj)!=null&&n.date&&(t.dateCreated=Ae.convertStringToDate((l=s.yamlObj)==null?void 0:l.date)),t.shortDesc=(p=s.yamlObj)==null?void 0:p.tagline,t.mt_keywords=(g=(c=s.yamlObj)==null?void 0:c.tags)==null?void 0:g.join(","),t.categories=(y=s.yamlObj)==null?void 0:y.categories,t.yaml=Q.obj2Yaml(s.yamlObj),this.logger.debug("转换完成，post =>",t),t}}class Hl extends Vt{getYamlAdaptor(){return new oo}async preEditPost(a,t,s){const e=await super.preEditPost(a,t,s),o=s==null?void 0:s.cfg,i=ye.cloneDeep(e),n=i.markdown;this.logger.info("准备处理 Jekyll 正文"),this.logger.debug("md =>",{md:n});const l=Q.extractFrontmatter(n,!0);let p=Q.extractMarkdown(n);return i.markdown=`${l}
${p}`,this.logger.info("Jekyll 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:p}),(o==null?void 0:o.pageType)==ce.Markdown?i.description=i.markdown:i.description=i.html,i}}const ds=async(r,a)=>{const t=B("use-jekyll-api");t.info("Start using Hexo API...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:n}=me(),l=await n();if(e=oe.safeParse(l[r],{}),se.isEmptyObject(e)){const p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_USERNAME,""),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_AUTH_TOKEN,""),g=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_REPO,""),y=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_BRANCH,"main"),u=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");e=new zo(p,c,g,y,u),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.mdFilenameRule="[yyyy]-[mm]-[dd]-[slug].md",e.useMdFilename=!1,e.usePathCategory=!1,e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=R.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Jekyll 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=R.CategoryType_Tree_Single;const o=new oo,i=new Hl(s,e);return t.info("Jekyll API created successfully.",e),{cfg:e,yamlAdaptor:o,blogApi:i}};class Rl extends zo{constructor(a,t,s,e,o){super(a,t,s,e,o),this.home="[your-gitlab-home]",this.apiUrl="[your-gitlab-api-url]",this.tokenSettingUrl="[your-gitlab-host]/-/profile/personal_access_tokens",this.showTokenTip=!0,this.defaultPath="_posts",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[yyyy]-[mm]-[dd]-[slug].md",this.pageType=ce.Markdown,this.passwordType=Ce.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=R.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabjekyll 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=R.CategoryType_Tree_Single,this.useMdFilename=!1,this.usePathCategory=!1}}class Wo extends oo{}class Fl extends Nt{getYamlAdaptor(){return new Wo}async preEditPost(a,t,s){const e=await super.preEditPost(a,t,s),o=s==null?void 0:s.cfg,i=ye.cloneDeep(e),n=i.markdown;this.logger.info("准备处理 Gitlabjekyll 正文"),this.logger.debug("md =>",{md:n});const l=Q.extractFrontmatter(n,!0);let p=Q.extractMarkdown(n);return i.markdown=`${l}
${p}`,this.logger.info("Gitlabjekyll 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:p}),(o==null?void 0:o.pageType)==ce.Markdown?i.description=i.markdown:i.description=i.html,i}}const ms=async(r,a)=>{const t=B("use-gitlab-hugo-api");t.info("Start using Gitlabhugo API...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:n}=me(),l=await n();if(e=oe.safeParse(l[r],{}),se.isEmptyObject(e)){const p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_USERNAME,""),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_AUTH_TOKEN,""),g=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_REPO,""),y=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_BRANCH,"main"),u=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");e=new Rl(p,c,g,y,u),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.mdFilenameRule="[yyyy]-[mm]-[dd]-[slug].md",e.useMdFilename=!1,e.usePathCategory=!1,e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=R.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabjekyll 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=R.CategoryType_Tree_Single;const o=new Wo,i=new Fl(s,e);return t.info("Gitlabjekyll API created successfully.",e),{cfg:e,yamlAdaptor:o,blogApi:i}};class qo extends Et{constructor(a,t,s,e,o){super(a,t,s,e,o),this.tokenSettingUrl="https://github.com/settings/tokens",this.showTokenTip=!0,this.defaultPath="docs",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[filename].md",this.pageType=ce.Markdown,this.passwordType=Ce.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=R.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Vuepress 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=R.CategoryType_Tree_Single,this.useMdFilename=!0,this.usePathCategory=!0}}class io extends Ut{constructor(){super(...arguments);x(this,"logger",B("vuepress-yaml-converter-adaptor"))}convertToYaml(t,s){var l;this.logger.debug("您正在使用 Vuepress Yaml Converter",{post:te(t)});let e=new pt;if(e.yamlObj.title=t.title,e.yamlObj.date=Ae.formatIsoToZh(t.dateCreated.toISOString(),!0),e.yamlObj.meta=[],A.isEmptyString(t.mt_keywords)||e.yamlObj.meta.push({name:"keywords",content:t.mt_keywords.split(",").join(" ")||""}),A.isEmptyString(t.shortDesc)||e.yamlObj.meta.push({name:"description",content:t.shortDesc}),!A.isEmptyString(t.mt_keywords)){const p=t.mt_keywords.split(",");e.yamlObj.tags=p}if(((l=t.categories)==null?void 0:l.length)>0&&(e.yamlObj.categories=t.categories),s.yamlLinkEnabled){let p="/post/"+t.wp_slug+".html";e.yamlObj.permalink=p}let o="https://github.com/terwer";const i=s;i.home&&(o=A.pathJoin(i.home,"/"+i.username)),e.yamlObj.author={name:i.author??"terwer",link:o};let n=Q.obj2Yaml(e.yamlObj);return this.logger.debug("yaml=>",n),e.formatter=n,e.mdContent=t.markdown,e.mdFullContent=Q.addYamlToMd(e.formatter,e.mdContent),e.htmlContent=t.html,this.logger.info("生成默认的YAML"),e}convertToAttr(t,s,e){var i,n,l,p,c,g,y;this.logger.debug("开始转换YAML到Post",s),(i=s.yamlObj)!=null&&i.title&&(t.title=(n=s.yamlObj)==null?void 0:n.title),(l=s.yamlObj)!=null&&l.date&&(t.dateCreated=Ae.convertStringToDate((p=s.yamlObj)==null?void 0:p.date));const o=s.yamlObj.meta;for(let u=0;u<o.length;u++){const d=o[u];if(d.name==="description"&&!A.isEmptyString(d.content)){t.shortDesc=d.content;break}}return t.mt_keywords=(g=(c=s.yamlObj)==null?void 0:c.tags)==null?void 0:g.join(","),t.categories=(y=s.yamlObj)==null?void 0:y.categories,t.yaml=Q.obj2Yaml(s.yamlObj),this.logger.debug("转换完成，post =>",t),t}}class Kl extends Vt{getYamlAdaptor(){return new io}async preEditPost(a,t,s){const e=await super.preEditPost(a,t,s),o=s==null?void 0:s.cfg,i=ye.cloneDeep(e),n=i.markdown;this.logger.info("准备处理 Vuepress 正文"),this.logger.debug("md =>",{md:n});const l=Q.extractFrontmatter(n,!0);let p=Q.extractMarkdown(n);const c=i.shortDesc??"";return/(\n{2}<!-- more -->\n{2})/.test(p)||(p=`${c}

<!-- more -->

${p}`),i.markdown=`${l}
${p}`,this.logger.info("Vuepress 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:p}),(o==null?void 0:o.pageType)==ce.Markdown?i.description=i.markdown:i.description=i.html,i}}const hs=async(r,a)=>{const t=B("use-vuepress-api");t.info("Start using Vuepress API...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:n}=me(),l=await n();if(e=oe.safeParse(l[r],{}),se.isEmptyObject(e)){const p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_USERNAME,""),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_AUTH_TOKEN,""),g=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_REPO,""),y=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_BRANCH,"main"),u=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");e=new qo(p,c,g,y,u),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.mdFilenameRule="[filename].md",e.useMdFilename=!0,e.usePathCategory=!0,e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=R.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Vuepress 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=R.CategoryType_Tree_Single;const o=new io,i=new Kl(s,e);return t.info("Vuepress API created successfully.",e),{cfg:e,yamlAdaptor:o,blogApi:i}};class Yl extends qo{constructor(a,t,s,e,o){super(a,t,s,e,o),this.home="[your-gitlab-home]",this.apiUrl="[your-gitlab-api-url]",this.tokenSettingUrl="[your-gitlab-host]/-/profile/personal_access_tokens",this.showTokenTip=!0,this.defaultPath="docs",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[filename].md",this.pageType=ce.Markdown,this.passwordType=Ce.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=R.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabvuepress 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=R.CategoryType_Tree_Single,this.useMdFilename=!0,this.usePathCategory=!0}}class Jo extends io{}class zl extends Nt{getYamlAdaptor(){return new Jo}async preEditPost(a,t,s){const e=await super.preEditPost(a,t,s),o=s==null?void 0:s.cfg,i=ye.cloneDeep(e),n=i.markdown;this.logger.info("准备处理 Gitlabvuepress 正文"),this.logger.debug("md =>",{md:n});const l=Q.extractFrontmatter(n,!0);let p=Q.extractMarkdown(n);const c=i.shortDesc??"";return/(\n{2}<!-- more -->\n{2})/.test(p)||(p=`${c}

<!-- more -->

${p}`),i.markdown=`${l}
${p}`,this.logger.info("Gitlabvuepress 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:p}),(o==null?void 0:o.pageType)==ce.Markdown?i.description=i.markdown:i.description=i.html,i}}const ys=async(r,a)=>{const t=B("use-gitlab-hexo-api");t.info("Start using Gitlabvuepress API...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:n}=me(),l=await n();if(e=oe.safeParse(l[r],{}),se.isEmptyObject(e)){const p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_USERNAME,""),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_AUTH_TOKEN,""),g=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_REPO,""),y=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_BRANCH,"main"),u=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");e=new Yl(p,c,g,y,u),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.mdFilenameRule="[filename].md",e.useMdFilename=!0,e.usePathCategory=!0,e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=R.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabvuepress 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=R.CategoryType_Tree_Single;const o=new Jo,i=new zl(s,e);return t.info("Gitlabvuepress API created successfully.",e),{cfg:e,yamlAdaptor:o,blogApi:i}};class Xo extends Et{constructor(a,t,s,e,o){super(a,t,s,e,o),this.tokenSettingUrl="https://github.com/settings/tokens",this.showTokenTip=!0,this.defaultPath="src/post",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[slug].md",this.pageType=ce.Markdown,this.passwordType=Ce.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=R.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Vuepress2 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=R.CategoryType_Tree_Single,this.useMdFilename=!1,this.usePathCategory=!1}}class no extends Ut{constructor(){super(...arguments);x(this,"logger",B("vuepress2-yaml-converter-adaptor"))}convertToYaml(t,s){var i;this.logger.debug("您正在使用 Vuepress2 Yaml Converter",{post:te(t)});let e=new pt;if(e.yamlObj.title=t.title,e.yamlObj.short_title="",e.yamlObj.date=t.dateCreated,A.isEmptyString(t.shortDesc)||(e.yamlObj.description=t.shortDesc),!A.isEmptyString(t.mt_keywords)){const n=t.mt_keywords.split(",");e.yamlObj.tag=n}((i=t.categories)==null?void 0:i.length)>0&&(e.yamlObj.category=t.categories),e.yamlObj.article=!0,e.yamlObj.timeline=!1,e.yamlObj.isOriginal=!0;const o=Q.obj2Yaml(e.yamlObj);return e.formatter=this.removeTZ(o),e.mdContent=t.markdown,e.mdFullContent=Q.addYamlToMd(e.formatter,e.mdContent),e.htmlContent=t.html,this.logger.info("生成默认的YAML"),e}convertToAttr(t,s,e){var i,n,l,p,c,g,y,u;this.logger.debug("开始转换YAML到Post",s),(i=s.yamlObj)!=null&&i.title&&(t.title=(n=s.yamlObj)==null?void 0:n.title),(l=s.yamlObj)!=null&&l.date&&(t.dateCreated=(p=s.yamlObj)==null?void 0:p.date),t.shortDesc=(c=s.yamlObj)==null?void 0:c.description,t.mt_keywords=(y=(g=s.yamlObj)==null?void 0:g.tag)==null?void 0:y.join(","),t.categories=(u=s.yamlObj)==null?void 0:u.category;const o=Q.obj2Yaml(s.yamlObj);return t.yaml=this.removeTZ(o),this.logger.debug("转换完成，post =>",t),t}removeTZ(t){return t.replace(/---([\s\S]*?)---/g,function(s,e){return s.replace(/T/g," ").replace(/\.\d{3}Z/g,"")})}}class Wl extends Vt{getYamlAdaptor(){return new no}async preEditPost(a,t,s){const e=await super.preEditPost(a,t,s),o=s==null?void 0:s.cfg,i=ye.cloneDeep(e),n=i.markdown;this.logger.info("准备处理 Vuepress2 正文"),this.logger.debug("md =>",{md:n});const l=Q.extractFrontmatter(n,!0);let p=Q.extractMarkdown(n);const c=i.shortDesc??"";return/(\n{2}<!-- more -->\n{2})/.test(p)||(p=`${c}

<!-- more -->

${p}`),i.markdown=`${l}
${p}`,this.logger.info("Vuepress2 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:p}),(o==null?void 0:o.pageType)==ce.Markdown?i.description=i.markdown:i.description=i.html,i}}const fs=async(r,a)=>{const t=B("use-vuepress2-api");t.info("Start using Vuepress2 API...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:n}=me(),l=await n();if(e=oe.safeParse(l[r],{}),se.isEmptyObject(e)){const p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_USERNAME,""),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_AUTH_TOKEN,""),g=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_REPO,""),y=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_BRANCH,"main"),u=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");e=new Xo(p,c,g,y,u),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.mdFilenameRule="[slug].md",e.useMdFilename=!1,e.usePathCategory=!1,e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=R.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Vuepress2 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=R.CategoryType_Tree_Single;const o=new no,i=new Wl(s,e);return t.info("Vuepress2 API created successfully.",e),{cfg:e,yamlAdaptor:o,blogApi:i}};class Zo extends Et{constructor(a,t,s,e,o){super(a,t,s,e,o),this.tokenSettingUrl="https://github.com/settings/tokens",this.showTokenTip=!0,this.defaultPath="docs",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[slug].md",this.pageType=ce.Markdown,this.passwordType=Ce.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=R.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Vitepress 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=R.CategoryType_Tree_Single,this.useMdFilename=!1,this.usePathCategory=!1}}class lo extends Ut{constructor(){super(...arguments);x(this,"logger",B("vitepress-yaml-converter-adaptor"))}convertToYaml(t,s){var i;this.logger.debug("您正在使用 Vitepress Yaml Converter",{post:te(t)});let e=new pt;e.yamlObj.title=t.title,A.isEmptyString(t.shortDesc)||(e.yamlObj.description=t.shortDesc),e.yamlObj.date=Ae.formatIsoToZh(t.dateCreated.toISOString(),!0),e.yamlObj.head=[],A.isEmptyString(t.mt_keywords)||e.yamlObj.head.push({name:"keywords",content:t.mt_keywords.split(",").join(" ")}),A.isEmptyString(t.shortDesc)||e.yamlObj.head.push({name:"description",content:t.shortDesc}),((i=t.categories)==null?void 0:i.length)>0&&(e.yamlObj.categories=t.categories),e.yamlObj.outline="deep",e.yamlObj.sidebar=!1,e.yamlObj.prev=!1,e.yamlObj.next=!1;let o=Q.obj2Yaml(e.yamlObj);return this.logger.debug("yaml=>",o),e.formatter=o,e.mdContent=t.markdown,e.mdFullContent=Q.addYamlToMd(e.formatter,e.mdContent),e.htmlContent=t.html,this.logger.info("生成默认的YAML"),e}convertToAttr(t,s,e){var i,n,l,p,c,g,y,u;this.logger.debug("开始转换YAML到Post",s),(i=s.yamlObj)!=null&&i.title&&(t.title=(n=s.yamlObj)==null?void 0:n.title),(l=s.yamlObj)!=null&&l.date&&(t.dateCreated=Ae.convertStringToDate((p=s.yamlObj)==null?void 0:p.date)),(c=s.yamlObj)!=null&&c.description&&(t.shortDesc=s.yamlObj.description);const o=(g=s.yamlObj)==null?void 0:g.head;if(o&&o.length==4)for(let d=0;d<o.length;d++){const b=o[d];if((b==null?void 0:b.name)==="keywords"&&!A.isEmptyString(b.content)){t.mt_keywords=(y=b.content)==null?void 0:y.split(" ");break}}return t.categories=(u=s.yamlObj)==null?void 0:u.categories,t.yaml=Q.obj2Yaml(s.yamlObj),this.logger.debug("转换完成，post =>",t),t}}class ql extends Vt{getYamlAdaptor(){return new lo}async preEditPost(a,t,s){const e=await super.preEditPost(a,t,s),o=s==null?void 0:s.cfg,i=ye.cloneDeep(e),n=i.markdown;this.logger.info("准备处理 Vitepress 正文"),this.logger.debug("md =>",{md:n});const l=Q.extractFrontmatter(n,!0);let p=Q.extractMarkdown(n);return i.markdown=`${l}
${p}`,this.logger.info("Vitepress 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:p}),(o==null?void 0:o.pageType)==ce.Markdown?i.description=i.markdown:i.description=i.html,i}}const _s=async(r,a)=>{const t=B("use-vitepress-api");t.info("Start using Vitepress API...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:n}=me(),l=await n();if(e=oe.safeParse(l[r],{}),se.isEmptyObject(e)){const p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_USERNAME,""),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_AUTH_TOKEN,""),g=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_REPO,""),y=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITHUB_BRANCH,"main"),u=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");e=new Zo(p,c,g,y,u),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.mdFilenameRule="[slug].md",e.useMdFilename=!1,e.usePathCategory=!1,e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=R.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Vitepress 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=R.CategoryType_Tree_Single;const o=new lo,i=new ql(s,e);return t.info("Vitepress API created successfully.",e),{cfg:e,yamlAdaptor:o,blogApi:i}};class Jl extends Xo{constructor(a,t,s,e,o){super(a,t,s,e,o),this.home="[your-gitlab-home]",this.apiUrl="[your-gitlab-api-url]",this.tokenSettingUrl="[your-gitlab-host]/-/profile/personal_access_tokens",this.showTokenTip=!0,this.defaultPath="src/post",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[slug].md",this.pageType=ce.Markdown,this.passwordType=Ce.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=R.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabvuepress2 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=R.CategoryType_Tree_Single,this.useMdFilename=!1,this.usePathCategory=!1}}class Qo extends no{}class Xl extends Nt{getYamlAdaptor(){return new Qo}async preEditPost(a,t,s){const e=await super.preEditPost(a,t,s),o=s==null?void 0:s.cfg,i=ye.cloneDeep(e),n=i.markdown;this.logger.info("准备处理 Gitlabvuepress2 正文"),this.logger.debug("md =>",{md:n});const l=Q.extractFrontmatter(n,!0);let p=Q.extractMarkdown(n);const c=i.shortDesc??"";return/(\n{2}<!-- more -->\n{2})/.test(p)||(p=`${c}

<!-- more -->

${p}`),i.markdown=`${l}
${p}`,this.logger.info("Gitlabvuepress2 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:p}),(o==null?void 0:o.pageType)==ce.Markdown?i.description=i.markdown:i.description=i.html,i}}const bs=async(r,a)=>{const t=B("use-gitlab-hexo-api");t.info("Start using Gitlabvuepress2 API...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:n}=me(),l=await n();if(e=oe.safeParse(l[r],{}),se.isEmptyObject(e)){const p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_USERNAME,""),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_AUTH_TOKEN,""),g=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_REPO,""),y=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_BRANCH,"main"),u=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");e=new Jl(p,c,g,y,u),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.mdFilenameRule="[slug].md",e.useMdFilename=!1,e.usePathCategory=!1,e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=R.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabvuepress2 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=R.CategoryType_Tree_Single;const o=new Qo,i=new Xl(s,e);return t.info("Gitlabvuepress2 API created successfully.",e),{cfg:e,yamlAdaptor:o,blogApi:i}};class Zl extends Zo{constructor(a,t,s,e,o){super(a,t,s,e,o),this.home="[your-gitlab-home]",this.apiUrl="[your-gitlab-api-url]",this.tokenSettingUrl="[your-gitlab-host]/-/profile/personal_access_tokens",this.showTokenTip=!0,this.defaultPath="docs",this.previewUrl="/[user]/[repo]/blob/[branch]/[docpath]",this.previewPostUrl="/post/[postid].html",this.mdFilenameRule="[slug].md",this.pageType=ce.Markdown,this.passwordType=Ce.PasswordType_Token,this.allowPreviewUrlChange=!1,this.tagEnabled=!0,this.cateEnabled=!0,this.allowCateChange=!0,this.categoryType=R.CategoryType_Multi,this.knowledgeSpaceEnabled=!0,this.allowKnowledgeSpaceChange=!1,this.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabvitepress 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",this.knowledgeSpaceType=R.CategoryType_Tree_Single,this.useMdFilename=!1,this.usePathCategory=!1}}class ei extends lo{}class Ql extends Nt{getYamlAdaptor(){return new ei}async preEditPost(a,t,s){const e=await super.preEditPost(a,t,s),o=s==null?void 0:s.cfg,i=ye.cloneDeep(e),n=i.markdown;this.logger.info("准备处理 Gitlabvitepress 正文"),this.logger.debug("md =>",{md:n});const l=Q.extractFrontmatter(n,!0);let p=Q.extractMarkdown(n);return i.markdown=`${l}
${p}`,this.logger.info("Gitlabvitepress 正文处理完毕"),this.logger.debug("updatedMd =>",{yfm:l,updatedMd:p}),(o==null?void 0:o.pageType)==ce.Markdown?i.description=i.markdown:i.description=i.html,i}}const ws=async(r,a)=>{const t=B("use-gitlab-vitepress-api");t.info("Start using Gitlabvitepress API...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:n}=me(),l=await n();if(e=oe.safeParse(l[r],{}),se.isEmptyObject(e)){const p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_USERNAME,""),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_AUTH_TOKEN,""),g=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_REPO,""),y=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_GITLAB_BRANCH,"main"),u=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");e=new Zl(p,c,g,y,u),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.mdFilenameRule="[slug].md",e.useMdFilename=!1,e.usePathCategory=!1,e.tagEnabled=!0,e.cateEnabled=!0,e.allowCateChange=!0,e.categoryType=R.CategoryType_Multi,e.knowledgeSpaceEnabled=!0,e.knowledgeSpaceTitle="发布目录",e.allowKnowledgeSpaceChange=!1,e.placeholder.knowledgeSpaceReadonlyModeTip="Gitlabvitepress 平台暂不支持修改发布目录，如需修改，请删除之后重新发布",e.knowledgeSpaceType=R.CategoryType_Tree_Single;const o=new ei,i=new Ql(s,e);return t.info("Gitlabvitepress API created successfully.",e),{cfg:e,yamlAdaptor:o,blogApi:i}};class er extends Qt{constructor(a,t,s){super("","",a,t,s),this.home="[your-halo-home]",this.apiUrl="[your-halo-api-url]",this.previewUrl="/archives/{slug}",this.pageType=ce.Html,this.usernameEnabled=!0,this.showTokenTip=!1,this.allowPreviewUrlChange=!0,this.tagEnabled=!0,this.cateEnabled=!0,this.categoryType=R.CategoryType_Multi,this.allowCateChange=!0,this.knowledgeSpaceEnabled=!1}}class tr{constructor(a,t,s){x(this,"slug");x(this,"name");x(this,"year");x(this,"month");x(this,"day");this.slug=a,this.name=t;const i=Ae.formatIsoToZhDate(s.toISOString(),!0).split(" ")[0].split("-");this.year=i[0],this.month=i[1],this.day=i[2]}}class sr extends It{constructor(a,t){super(a,t),this.logger=B("halo-api-adaptor")}async getUsersBlogs(){const a=[];return(await this.getHaloCategories()).forEach(s=>{const e=new nt;e.blogid=s.spec.slug,e.blogName=s.spec.displayName,e.url=s.status.permalink,a.push(e)}),this.logger.debug("get halo categories =>",a),a}async newPost(a,t){var i;const s={post:{spec:{title:"",slug:"",template:"",cover:"",deleted:!1,publish:!1,publishTime:void 0,pinned:!1,allowComment:!0,visible:"PUBLIC",priority:0,excerpt:{autoGenerate:!0,raw:""},categories:[],tags:[],htmlMetas:[]},apiVersion:"content.halo.run/v1alpha1",kind:"Post",metadata:{name:"",annotations:{}}},content:{raw:"",content:"",rawType:"HTML"}};s.content.raw=a.html,s.content.content=a.description,A.isEmptyString(a.shortDesc)?s.post.spec.excerpt.autoGenerate=!0:(s.post.spec.excerpt.autoGenerate=!1,s.post.spec.excerpt.raw=a.shortDesc),s.post.metadata.name=Ps.randomUuid(),s.post.spec.title=a.title,s.post.spec.slug=a.wp_slug;try{if(a.categories&&a.categories.length>0){const n=await this.getCategoryNames(a.categories);s.post.spec.categories=n}if(!A.isEmptyString(a.mt_keywords)){const n=a.mt_keywords.split(","),l=await this.getTagNames(n);s.post.spec.tags=l}}catch(n){throw n}const e=await this.haloRequest("/apis/api.console.halo.run/v1alpha1/posts",s,"POST");if(this.logger.debug("halo newPost res =>",e),!((i=e==null?void 0:e.metadata)!=null&&i.name))throw new Error("Halo 文章发布失败");this.logger.debug("halo 文章草稿完成"),await this.haloRequest(`/apis/api.console.halo.run/v1alpha1/posts/${s.post.metadata.name}/publish`,{},"PUT"),this.logger.debug("halo 文章发布完成");const o=new tr(e.spec.slug,e.metadata.name,a.dateCreated);return this.logger.debug("postidMeta =>",o),JSON.stringify(o)}async editPost(a,t,s){let e=!1;try{const i=this.getHaloPostidKey(a).name;let n=await this.getHaloPost(i);if(this.logger.debug("get latest halo post =>",{name:i,haloPost:n}),!n.post)throw new Error("获取文章信息失败，如果文章删除，请强制删除解除关联");if(n.content.raw=t.html,n.content.content=t.description,A.isEmptyString(t.shortDesc)?n.post.spec.excerpt.autoGenerate=!0:(n.post.spec.excerpt.autoGenerate=!1,n.post.spec.excerpt.raw=t.shortDesc),n.post.metadata.name=i,n.post.spec.title=t.title,n.post.spec.slug=t.wp_slug,t.categories&&t.categories.length>0){const l=await this.getCategoryNames(t.categories);n.post.spec.categories=l}if(!A.isEmptyString(t.mt_keywords)){const l=t.mt_keywords.split(","),p=await this.getTagNames(l);n.post.spec.tags=p}await this.haloRequest(`/apis/content.halo.run/v1alpha1/posts/${i}`,n.post,"PUT"),await this.haloRequest(`/apis/api.console.halo.run/v1alpha1/posts/${i}/content`,n.content,"PUT"),await this.haloRequest(`/apis/api.console.halo.run/v1alpha1/posts/${n.post.metadata.name}/publish`,{},"PUT"),this.logger.debug("halo 文章发布完成")}catch(o){this.logger.error("Halo文章更新失败",o)}return e}async getPost(a,t){const e=this.getHaloPostidKey(a).name,o=await this.getHaloPost(e);this.logger.debug("getPost haloPost =>",{name:e,haloPost:o});const i=new ze;return i.title=o.post.spec.title,i.wp_slug=o.post.spec.slug,i.shortDesc=o.post.spec.excerpt.raw,i.tags_slugs=o.post.spec.tags.join(","),i.cate_slugs=o.post.spec.categories,i}async getPreviewUrl(a){const t=this.getHaloPostidKey(a),s=this.cfg.previewUrl.replace("{slug}",t.slug).replace("{name}",t.name).replace("{year}",t.year).replace("{month}",t.month).replace("{day}",t.day);return A.pathJoin(this.cfg.home??"",s)}async deletePost(a){var o;const s=`/apis/api.console.halo.run/v1alpha1/posts/${this.getHaloPostidKey(a).name}/recycle`,e=await this.haloRequest(s,{},"PUT");if(this.logger.debug("halo deletePost res =>",e),!((o=e==null?void 0:e.metadata)!=null&&o.name))throw new Error("Halo 文章删除失败");return!0}async getCategories(){const a=[],t=await this.getHaloCategories();return t&&t.length>0&&(t.forEach(s=>{const e=new Qe;e.categoryId=s.spec.slug,e.categoryName=s.spec.displayName,e.description=s.spec.displayName,e.categoryDescription=s.spec.description,a.push(e)}),this.logger.debug("get halo categories =>",a)),a}async newMediaObject(a,t){var n,l,p;let s;try{const c=a.bits;this.logger.debug("newMediaObject on halo =>",a);const g=this.appInstance.win;if(!g.require)throw new Error("非常抱歉，目前仅思源笔记PC客户端支持上传图片");const{FormData:y,Blob:u}=g.require(`${this.appInstance.moduleBase}libs/node-fetch-cjs/dist/index.js`),d=new u([c],{type:a.type}),b=`${this.cfg.apiUrl}/apis/api.console.halo.run/v1alpha1/attachments/upload`,h=new y;if(h.append("file",d,a.name),h.append("policyName","default-policy"),h.append("groupName",""),h.append("file",d,a.name),s=await this.haloFormFetch(b,h),this.logger.debug("halo upload success, res =>",s),!s.metadata)throw new Error("Halo图片上传失败 =>"+a.name)}catch(c){this.logger.error("Error uploading image to halo:",c)}const e=((n=s==null?void 0:s.spec)==null?void 0:n.displayName)??"",o=((l=s==null?void 0:s.metadata)==null?void 0:l.name)??"",i=this.cfg.home+((p=s==null?void 0:s.metadata)==null?void 0:p.annotations["storage.halo.run/uri"]);return{attachment_id:e,date_created_gmt:new Date,parent:0,link:i,title:a.name,caption:"",description:"",metadata:{width:0,height:0,file:"",filesize:0,sizes:[]},type:a.type,thumbnail:"",id:o,file:a.name,url:i}}getHaloPostidKey(a){return oe.safeParse(a,{})}async getHaloPost(a){try{const t=await this.haloRequest(`/apis/content.halo.run/v1alpha1/posts/${a}`,{},"GET"),s=await this.haloRequest(`/apis/api.console.halo.run/v1alpha1/posts/${a}/head-content`,{},"GET");return Promise.resolve({post:t,content:s})}catch{return Promise.resolve(void 0)}}async getCategoryNames(a){const t=await this.getHaloCategories(),s=a.filter(i=>!t.find(n=>n.spec.displayName===i)),e=await Promise.all(s.map(async(i,n)=>{const l=await Ca.getPageSlug(i,!0);return await this.haloRequest("/apis/content.halo.run/v1alpha1/categories",{spec:{displayName:i,slug:l,description:"",cover:"",template:"",priority:t.length+n,children:[]},apiVersion:"content.halo.run/v1alpha1",kind:"Category",metadata:{name:"",generateName:"category-"}},"POST")})),o=a.map(i=>{const n=t.find(l=>l.spec.displayName===i);return n?n.metadata.name:void 0}).filter(Boolean);return this.logger.debug("newCategories =>",e),[...o,...e.map(i=>i.metadata.name)]}async getHaloCategories(){const a=await this.haloRequest("/apis/content.halo.run/v1alpha1/categories",{},"GET");return Promise.resolve(a.items)}async getTagNames(a){const t=await this.getHaloTags(),s=a.filter(i=>!t.find(n=>n.spec.displayName===i)),e=await Promise.all(s.map(async i=>{const n=await Ca.getPageSlug(i,!0);return await this.haloRequest("/apis/content.halo.run/v1alpha1/tags",{spec:{displayName:i,slug:n,color:"#ffffff",cover:""},apiVersion:"content.halo.run/v1alpha1",kind:"Tag",metadata:{name:"",generateName:"tag-"}},"POST")})),o=a.map(i=>{const n=t.find(l=>l.spec.displayName===i);return n?n.metadata.name:void 0}).filter(Boolean);return this.logger.debug("newTags =>",e),[...o,...e.map(i=>i.metadata.name)]}async getHaloTags(){const a=await this.haloRequest("/apis/content.halo.run/v1alpha1/tags",{},"GET");return Promise.resolve(a.items)}async haloRequest(a,t,s="POST",e={}){const o="application/json",i="Basic "+Wt.btoa(this.cfg.username+":"+this.cfg.password),n={"Content-Type":o,Authorization:i,...e},l=`${this.cfg.apiUrl}${a}`;this.logger.debug("向 Halo 请求数据，apiUrl =>",l),this.logger.debug("向 Halo 请求数据，params =>",t);const p=se.isEmptyObject(t)?"":JSON.stringify(t),c=await this.proxyFetch(l,[n],p,s,o);return this.logger.debug("向 Halo 请求数据，resJson =>",c),c??null}async haloFormFetch(a,t){const e={Authorization:"Basic "+Wt.btoa(this.cfg.username+":"+this.cfg.password)};return await this.apiFormFetch(a,[e],t)}}const La=async(r,a)=>{const t=B("use-halo-api");t.info("Start using Halo API...");const s=new ge;let e;if(a)t.info("Initialize with the latest newCfg passed in..."),e=a;else{const{getSetting:i}=me(),n=await i();if(e=oe.safeParse(n[r],{}),se.isEmptyObject(e)){const l=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_YUQUE_USERNAME,""),p=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_YUQUE_AUTH_TOKEN,""),c=C.emptyOrDefault({DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_MIDDLEWARE_URL,"https://api.terwer.space/api/middleware");e=new er(l,p,c),t.info("Configuration is empty, using default environment variables.")}else t.info("Using configuration from settings...");A.isEmptyString(e.posidKey)&&(e.posidKey=ke(r))}e.usernameEnabled=!0,e.tagEnabled=!0,e.cateEnabled=!0,e.categoryType=R.CategoryType_Multi,e.allowCateChange=!0,e.knowledgeSpaceEnabled=!1;const o=new sr(s,e);return t.info("Halo API created successfully.",e),{cfg:e,blogApi:o}};class de{static async getCfg(a,t){let s=null;switch(ls(a)){case D.Common_Yuque:{const{cfg:o}=await Ma(a,t);s=o;break}case D.Common_Notion:{const{cfg:o}=await Va(a,t);s=o;break}case D.Common_Halo:{const{cfg:o}=await La(a,t);s=o;break}case D.Github_Hexo:{const{cfg:o}=await cs(a,t);s=o;break}case D.Github_Hugo:{const{cfg:o}=await us(a,t);s=o;break}case D.Github_Jekyll:{const{cfg:o}=await ds(a,t);s=o;break}case D.Github_Vuepress:{const{cfg:o}=await hs(a,t);s=o;break}case D.Github_Vuepress2:{const{cfg:o}=await fs(a,t);s=o;break}case D.Github_Vitepress:{const{cfg:o}=await _s(a,t);s=o;break}case D.Gitlab_Hexo:{const{cfg:o}=await ps(a,t);s=o;break}case D.Gitlab_Hugo:{const{cfg:o}=await gs(a,t);s=o;break}case D.Gitlab_Jekyll:{const{cfg:o}=await ms(a,t);s=o;break}case D.Gitlab_Vuepress:{const{cfg:o}=await ys(a,t);s=o;break}case D.Gitlab_Vuepress2:{const{cfg:o}=await bs(a,t);s=o;break}case D.Gitlab_Vitepress:{const{cfg:o}=await ws(a,t);s=o;break}case D.Metaweblog_Metaweblog:{const{cfg:o}=await xa(a,t);s=o;break}case D.Metaweblog_Cnblogs:{const{cfg:o}=await Da(a,t);s=o;break}case D.Metaweblog_Typecho:{const{cfg:o}=await Oa(a,t);s=o;break}case D.Wordpress_Wordpress:{const{cfg:o}=await Ua(a,t);s=o;break}case D.Custom_Zhihu:{const{cfg:o}=await Ia(a,t);s=o;break}case D.Custom_CSDN:{const{cfg:o}=await Na(a);s=o;break}case D.Custom_Wechat:{const{cfg:o}=await Ba(a);s=o;break}case D.Custom_Jianshu:{const{cfg:o}=await Ga(a);s=o;break}case D.Custom_Juejin:{const{cfg:o}=await $a(a);s=o;break}case D.System_Siyuan:{const{siyuanConfig:o}=We();s=o;break}default:{s={};break}}return this.logger.debug(`get conf from key ${a}=>`,s),s}static async getAdaptor(a,t){let s=null;switch(ls(a)){case D.Common_Yuque:{const{blogApi:o}=await Ma(a,t);s=o;break}case D.Common_Notion:{const{blogApi:o}=await Va(a,t);s=o;break}case D.Common_Halo:{const{blogApi:o}=await La(a,t);s=o;break}case D.Github_Hexo:{const{blogApi:o}=await cs(a,t);s=o;break}case D.Github_Hugo:{const{blogApi:o}=await us(a,t);s=o;break}case D.Github_Jekyll:{const{blogApi:o}=await ds(a,t);s=o;break}case D.Github_Vuepress:{const{blogApi:o}=await hs(a,t);s=o;break}case D.Github_Vuepress2:{const{blogApi:o}=await fs(a,t);s=o;break}case D.Github_Vitepress:{const{blogApi:o}=await _s(a,t);s=o;break}case D.Gitlab_Hexo:{const{blogApi:o}=await ps(a,t);s=o;break}case D.Gitlab_Hugo:{const{blogApi:o}=await gs(a,t);s=o;break}case D.Gitlab_Jekyll:{const{blogApi:o}=await ms(a,t);s=o;break}case D.Gitlab_Vuepress:{const{blogApi:o}=await ys(a,t);s=o;break}case D.Gitlab_Vuepress2:{const{blogApi:o}=await bs(a,t);s=o;break}case D.Gitlab_Vitepress:{const{blogApi:o}=await ws(a,t);s=o;break}case D.Metaweblog_Metaweblog:{const{blogApi:o}=await xa(a,t);s=o;break}case D.Metaweblog_Cnblogs:{const{blogApi:o}=await Da(a,t);s=o;break}case D.Metaweblog_Typecho:{const{blogApi:o}=await Oa(a,t);s=o;break}case D.Wordpress_Wordpress:{const{blogApi:o}=await Ua(a,t);s=o;break}case D.Custom_Zhihu:{const{webApi:o}=await Ia(a,t);s=o;break}case D.Custom_CSDN:{const{webApi:o}=await Na(a,t);s=o;break}case D.Custom_Wechat:{const{webApi:o}=await Ba(a,t);s=o;break}case D.Custom_Jianshu:{const{webApi:o}=await Ga(a,t);s=o;break}case D.Custom_Juejin:{const{webApi:o}=await $a(a,t);s=o;break}case D.System_Siyuan:{const{blogApi:o}=We();s=o;break}}return this.logger.debug(`get blogAdaptor from key ${a}`),s}static async getYamlAdaptor(a,t){let s=null;switch(ls(a)){case D.Github_Hexo:{const{yamlAdaptor:o}=await cs(a,t);s=o;break}case D.Github_Hugo:{const{yamlAdaptor:o}=await us(a,t);s=o;break}case D.Github_Jekyll:{const{yamlAdaptor:o}=await ds(a,t);s=o;break}case D.Github_Vuepress:{const{yamlAdaptor:o}=await hs(a,t);s=o;break}case D.Github_Vuepress2:{const{yamlAdaptor:o}=await fs(a,t);s=o;break}case D.Github_Vitepress:{const{yamlAdaptor:o}=await _s(a,t);s=o;break}case D.Gitlab_Hexo:{const{yamlAdaptor:o}=await ps(a,t);s=o;break}case D.Gitlab_Hugo:{const{yamlAdaptor:o}=await gs(a,t);s=o;break}case D.Gitlab_Jekyll:{const{yamlAdaptor:o}=await ms(a,t);s=o;break}case D.Gitlab_Vuepress:{const{yamlAdaptor:o}=await ys(a,t);s=o;break}case D.Gitlab_Vuepress2:{const{yamlAdaptor:o}=await bs(a,t);s=o;break}case D.Gitlab_Vitepress:{const{yamlAdaptor:o}=await ws(a,t);s=o;break}}return this.logger.debug(`get yamlAdaptor from key ${a}=>`,s),s}}x(de,"logger",B("adaptors"));const ar={key:1,class:"source-mode"},or={class:"source-opt"},ir={key:2,id:"yaml-edit-content"},nr={key:3,id:"yaml-detail-content"},lr={id:"yaml-read-mode-tip"},rr=H({__name:"SourceMode",props:{modelValue:{type:Object,default:{}},pageId:{type:String,default:""},apiType:{type:String,default:""},cfg:{type:Object,default:{}}},emits:["emitSyncPost"],async setup(r,{emit:a}){let t,s;const e=r,o=B("source-mode"),{t:i}=K(),{handlePicgo:n}=Xa(),{kernelApi:l}=We(),p=ae({isLoading:!1,stype:je.MD_CONTENT,contentReadonlyMode:!0,readonlyMode:A.isEmptyString(e.apiType),syncStatus:"info",syncMessage:"未修改",pageId:e.pageId,apiType:e.apiType,cfg:e.cfg,yamlAdaptor:{},yamlFormatObj:{},siyuanPost:e.modelValue,yamlContent:"",isSaved:!0}),c=E=>{switch(p.stype=E,E){case je.YAML:p.contentReadonlyMode=!1,b(p.yamlFormatObj.formatter);break;case je.MD_CONTENT:p.contentReadonlyMode=!0,b(p.yamlFormatObj.mdContent);break;case je.YAML_MD_CONTENT:p.contentReadonlyMode=!0,b(p.yamlFormatObj.mdFullContent);break;case je.HTML_CONTENT:p.contentReadonlyMode=!0,b(p.yamlFormatObj.htmlContent);break}},g=E=>{if(E.preventDefault(),E.target.select(),ht.isInBrowser)try{ht.copyToClipboardInBrowser(p.yamlContent),Y.success(i("main.copy.success"))}catch(T){o.error(i("main.copy.failure"),T),Y.error(i("main.copy.failure")+"=>"+T)}},y=E=>{o.debug("仅在常规发布使用"),p.isSaved=!1,p.syncStatus="info",p.syncMessage="已修改"},u=()=>{p.yamlFormatObj.formatter=p.yamlContent,p.yamlFormatObj.mdFullContent=Q.addYamlToMd(p.yamlFormatObj.formatter,p.yamlFormatObj.mdContent),o.debug("val =>",p.yamlContent);try{const E=Q.yaml2Obj(p.yamlFormatObj.formatter);p.yamlFormatObj.yamlObj=E,p.siyuanPost=p.yamlAdaptor.convertToAttr(p.siyuanPost,p.yamlFormatObj,p.cfg),o.debug("准备emit =>",{post:te(p.siyuanPost)}),a("emitSyncPost",p.siyuanPost),p.syncStatus="success",p.syncMessage="YAML已解析成功并同步。同步时间 =>"+Ae.formatIsoToZh(new Date().toISOString(),!0),p.isSaved=!0}catch(E){p.syncStatus="error",p.syncMessage="YAML解析失败，YAML将不可用，错误如下 =>"+E,o.error("YAML解析失败",E)}},d=E=>{E.preventDefault()},b=async E=>{p.yamlContent=E},h=async()=>{p.isLoading=!0;try{let E=new pt;const v=p.siyuanPost;p.yamlAdaptor=p.readonlyMode?null:await de.getYamlAdaptor(p.apiType,p.cfg),p.readonlyMode=p.yamlAdaptor===null;const T=p.pageId,S=await n(T,v.markdown);if(v.markdown=S,p.readonlyMode){const M=Ya.toYamlObj(p.siyuanPost);E.formatter=Q.obj2Yaml(M),E.mdContent=v.markdown,E.mdFullContent=Q.addYamlToMd(E.formatter,E.mdContent),E.htmlContent=v.html,o.debug("未找到YAML适配器，将生成公共的YAML")}else{const M=p.apiType,V=St(M),$=await l.getSingleBlockAttr(T,V),J=Q.extractFrontmatter($).trim();A.isEmptyString(J)?(E=p.yamlAdaptor.convertToYaml(v,p.cfg),o.info("有适配器未保存，生成新的YAML")):(E.formatter=$,E.mdContent=v.markdown,E.mdFullContent=Q.addYamlToMd(E.formatter,E.mdContent),E.htmlContent=v.html,o.info("有适配器且YAML已保存，无需处理")),o.debug("常规发布，生成对应平台的YAML, =>",M)}p.yamlFormatObj=E,c(p.stype),o.debug(`init Page in source mode, readonlyMode: ${p.readonlyMode} =>`,{siyuanPost:te(p.siyuanPost)})}catch(E){Y.error(E.message),o.error(i("main.opt.failure")+"=>",E)}finally{p.isLoading=!1}};return[t,s]=Pe(()=>h()),await t,s(),(E,v)=>{const T=qt,S=Ee,M=Ie,V=be;return p.isLoading?(w(),k(T,{key:0,class:"placeholder",rows:5,animated:""})):(w(),N("div",ar,[p.isSaved?z("",!0):(w(),k(S,{key:0,class:"un-saved-tip"},{default:_(()=>[G(" 检测到有未保存的更改，是否保存？"),P("a",{onClick:u},"马上保存")]),_:1})),p.readonlyMode?z("",!0):(w(),k(S,{key:1},{default:_(()=>[f(M,{closable:!1,title:p.syncMessage,class:"top-yaml-tip",type:p.syncStatus},null,8,["title","type"])]),_:1})),P("div",or,[f(S,null,{default:_(()=>[P("a",{class:_t({current:p.stype===m(je).YAML}),onClick:v[0]||(v[0]=$=>c(m(je).YAML))},L(m(i)("yaml.show.type.yaml")),3),P("a",{class:_t({current:p.stype===m(je).MD_CONTENT,middle:!0}),onClick:v[1]||(v[1]=$=>c(m(je).MD_CONTENT))},L(m(i)("yaml.show.type.md")),3),P("a",{class:_t({current:p.stype===m(je).YAML_MD_CONTENT,middle:!0}),onClick:v[2]||(v[2]=$=>c(m(je).YAML_MD_CONTENT))},L(m(i)("yaml.show.type.yamlmd")),3),P("a",{class:_t({current:p.stype===m(je).HTML_CONTENT}),onClick:v[3]||(v[3]=$=>c(m(je).HTML_CONTENT))},L(m(i)("yaml.show.type.html")),3)]),_:1})]),!p.contentReadonlyMode&&!p.readonlyMode?(w(),N("div",ir,[f(S,null,{default:_(()=>[f(V,{modelValue:p.yamlContent,"onUpdate:modelValue":v[4]||(v[4]=$=>p.yamlContent=$),autosize:{minRows:4,maxRows:16},type:"textarea",onInput:y},null,8,["modelValue"])]),_:1})])):(w(),N("div",nr,[f(S,null,{default:_(()=>[f(V,{id:"yaml-detail-preview",modelValue:p.yamlContent,"onUpdate:modelValue":v[5]||(v[5]=$=>p.yamlContent=$),autosize:{minRows:4,maxRows:16},readonly:"",type:"textarea",class:"readonly-textarea",onClick:g,onContextmenu:d},null,8,["modelValue"])]),_:1})])),P("div",lr,[f(S,null,{default:_(()=>[p.readonlyMode?(w(),k(M,{key:0,class:"top-yaml-tip",closable:!1,title:m(i)("main.read.mode.tip1"),type:"error"},null,8,["title"])):z("",!0),p.readonlyMode?z("",!0):(w(),k(M,{key:1,class:"top-yaml-tip",closable:!1,title:m(i)("main.read.mode.tip4"),type:"error"},null,8,["title"]))]),_:1})])]))}}});const ti=ue(rr,[["__scopeId","data-v-8b508283"]]);const cr={},pr={class:"publish-tips"};function ur(r,a){const t=Ie;return w(),N("div",pr,[f(t,{closable:!1,title:"多平台文章分发。其中思源笔记为内置平台，这里的修改发布后，也会同步更新思源笔记",class:"top-tip",type:"info"})])}const gr=ue(cr,[["render",ur],["__scopeId","data-v-fbb669b2"]]),fe={iconEPPlus:'<svg viewBox="0 0 1024 1024" xmlns="http://www.w3.org/2000/svg" data-v-ea893728=""><path d="M480 480V128a32 32 0 0 1 64 0v352h352a32 32 0 1 1 0 64H544v352a32 32 0 1 1-64 0V544H128a32 32 0 0 1 0-64h352z"></path></svg>',iconIFEdit:'<svg t="1689998125340" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5430" width="16" height="16"><path d="M652.4 156.6125a112.5 112.5 0 1 1 155.925 161.15625L731.375 394.71875 572.3 235.5875l79.5375-79.5375 0.5625 0.5625zM333.63125 792.40625v0.1125H174.5v-159.1875l358.03125-357.975 159.075 159.13125-357.975 357.91875zM62 849.5h900v112.5H62v-112.5z" p-id="5431"></path></svg>',iconIFHexo:'<svg t="1684170255787" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7119" width="16" height="16"><path d="M512 0.298667L66.986667 258.389333V770.133333L512 1023.786667l445.013333-258.090667V253.952L512 0.298667z m204.714667 729.813333l-40.064 22.229333-40.064-22.229333V552.106667H387.413333v178.005333l-40.106666 22.229333-40.021334-22.229333V293.973333l40.064-22.229333 40.064 22.229333v178.005334h249.173334V293.973333l40.106666-22.229333 40.021334 22.229333v436.138667z" p-id="7120"></path></svg>',iconIFHexoGitlab:'<svg t="1693214758547" class="icon" viewBox="0 0 1137 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12137" width="16" height="16"><path d="M896.227556 577.991111c-21.048889 0-38.115556 16.952889-38.115556 38.058667v280.007111c0 28.103111-22.755556 50.801778-50.858667 50.801778H728.177778v-131.242667a127.317333 127.317333 0 0 0-127.146667-127.032889H538.168889a127.317333 127.317333 0 0 0-127.089778 127.032889v131.128889H331.776a50.801778 50.801778 0 0 1-50.801778-50.801778v-279.893333a38.115556 38.115556 0 1 0-76.288 0v280.007111a127.317333 127.317333 0 0 0 127.089778 127.032889h155.363556v-207.473778c0-28.046222 22.755556-50.801778 50.858666-50.801778h62.919111c28.103111 0 50.858667 22.755556 50.858667 50.801778v207.36h155.477333a127.317333 127.317333 0 0 0 127.146667-127.032889v-279.893333c0-21.048889-17.066667-38.115556-38.115556-38.115556z" p-id="12138"></path><path d="M1073.208889 413.411556a38.115556 38.115556 0 0 0-22.755556 72.817777 15.36 15.36 0 0 1 2.503111 28.16 15.530667 15.530667 0 0 1-21.845333-9.272889 41.528889 41.528889 0 0 0-4.039111-8.988444l-172.259556-398.677333-0.170666-0.398223a15.473778 15.473778 0 0 1 0.682666-11.662222 15.530667 15.530667 0 0 1 8.760889-7.907555 15.530667 15.530667 0 0 1 11.662223 0.625777 15.36 15.36 0 0 1 5.688888 22.983112 38.115556 38.115556 0 0 0 61.212445 45.511111 91.022222 91.022222 0 0 0 12.856889-84.878223 90.624 90.624 0 0 0-46.819556-52.224A91.192889 91.192889 0 0 0 838.656 5.688889a90.680889 90.680889 0 0 0-52.280889 46.762667 92.728889 92.728889 0 0 0-8.590222 30.890666H359.765333A91.932444 91.932444 0 0 0 298.894222 5.688889a91.192889 91.192889 0 0 0-70.087111 3.811555 91.704889 91.704889 0 0 0-33.962667 137.102223 38.115556 38.115556 0 1 0 61.212445-45.511111 15.36 15.36 0 1 1 26.794667-3.982223l-0.113778 0.341334L110.592 496.071111a44.487111 44.487111 0 0 0-4.039111 8.988445 15.303111 15.303111 0 0 1-10.24 10.296888 15.815111 15.815111 0 0 1-11.662222-1.024 15.36 15.36 0 0 1 2.56-28.216888 38.229333 38.229333 0 0 0 25.031111-47.786667 38.286222 38.286222 0 0 0-47.786667-24.974222 91.591111 91.591111 0 0 0-15.018667 168.448 90.680889 90.680889 0 0 0 69.802667 6.257777c23.893333-7.509333 43.349333-24.177778 54.442667-46.136888h790.414222a91.704889 91.704889 0 0 0 169.244444-13.824 91.818667 91.818667 0 0 0-60.131555-114.744889z m-866.474667 52.451555L339.057778 159.573333h459.434666l132.323556 306.289778H206.734222z" p-id="12139"></path></svg>',iconIFHugo:'<svg t="1684170339672" class="icon" viewBox="0 0 1280 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="9235" width="16" height="16"><path d="M800.20014 389.6c-21.8 5.6-39.8 8.6-58.2 15.2-14.6 3.8-29.4 7.8-46.4 12.2l-1.2 0.2c-8.4 2.4-9.2 2.6-17-6.4-9.4-10.6-16.2-17.4-29.2-23.8-39.4-19.2-77.4-13.6-112.8 9.4-42.4 27.4-64.2 68-63.6 118.4 0.6 50 34.8 91 82.4 97.8 44 5.6 79.6-9.2 107.6-41 4.2-5.2 8-10.6 12.2-16.6 1.6-2 3-4.2 4.6-6.6h-120.2c-13 0-16.2-8-11.8-18.6 8-19.4 23-51.8 31.8-68 1.8-3.6 6.2-11.6 13.8-11.6h202.2c9-26.8 23.6-53.8 43.2-79.4 45.4-59.8 98.6-91 174.4-104 63.6-11.2 123.4-5 177.8 31.8 49.2 33.6 79.6 79.2 87.8 139 10.6 84.2-13.8 152.6-73.4 211.2-39.4 41.8-89.8 68-147.8 79.8-11.2 2-22.2 3-33 4-5.8 0.4-11.4 1-17 1.6-56.6-1.2-108.4-17.4-152-54.8-30.6-26.6-51.8-59.2-62.2-97-7.4 14.6-16 28.8-28 42.2-43.2 59.2-101.8 96-175.8 105.8-61.2 8.2-117.8-3.6-167.8-41-46-35-72.2-81-79-138.4-8.2-68 11.8-130.8 52.8-182.6 44.4-58 103-94.8 174.6-107.8 58.6-12.4 114.6-3.8 165.2 30.6 33 21.8 56.6 51.6 72.2 87.8 3.8 5.6 1.2 8.8-6.2 10.6z m-703.6 11.2c-2.5 0-3.12-1.2-1.88-3.2l13.1-16.8c1.24-1.8 4.36-3 6.86-3H337.20014c2.4 0 3 1.8 1.8 3.6l-10.6 16.2c-1.2 2-4.4 3.8-6.2 3.8l-225.6-0.6zM2.49214 458.2c-2.492 0-3.116-1.4-1.868-3.2l13.086-16.8c1.248-1.8 4.364-3.2 6.85-3.2H304.80014c2.4 0 3.6 2 3 3.8l-5 15c-0.6 2.4-3 3.8-5.6 3.8l-294.708 0.6z m148.948 53.6c-1.24 1.8-0.62 3.6 1.86 3.6l135.9 0.6c1.8 0 4.4-1.8 4.4-4.2l1.2-15c0-2.6-1.2-4.4-3.8-4.4H166.40014c-2.5 0-4.98 1.8-6.24 3.8l-8.72 15.6z m1002.96-36c-0.4-5.2-0.6-9.6-1.4-14-11.2-61.6-68-96.6-127.2-82.8-58 13-95.4 49.8-109 108.4-11.2 48.6 12.4 97.8 57.2 117.8 34.4 15 68.6 13.2 101.6-3.8 49.2-27.2 76-65.4 79.2-119-0.2-2.4-0.2-4.6-0.4-6.6z" p-id="9236"></path></svg>',iconIFJekyll:'<svg t="1694167709305" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4932" width="16" height="16"><path d="M667.4 180c-35.2 0-69.6 8.8-99.7 27.1-57.2 32.2-91.6 89.4-91.6 151.7v306.4c0 35.9-20.5 68.9-55 88.7-19.8 11-41.8 16.9-64.5 16.9-66 0-119.5-47.6-119.5-105.5 0-17.6 4.4-34.4 13.9-49.8 13.9-23.5 38.8-41.8 70.4-51.3 3.7-1.5 6.6-1.5 8.1-1.5 20.5 0 36.6-16.1 36.6-36.6s-16.1-36.6-36.6-36.6c-8.8 0-17.6 1.5-30.8 5.1-46.9 13.9-85.8 43.2-109.9 82.8-16.1 27.1-24.9 57.2-24.9 87.9 0 98.9 86.5 178.8 192.8 178.8 35.2 0 69.6-8.8 100.4-26.4 57.2-32.2 91.6-89.4 91.6-151.7V358.8c0-35.9 20.5-68.9 55-88.7 19.8-11 41.8-16.9 64.5-16.9 65.2 0 118.7 47.6 118.7 105.5 0 17.6-4.4 34.4-13.9 49.8-13.9 24.2-38.8 42.5-70.4 51.3-3.7 1.5-6.6 1.5-8.1 1.5-20.5 0-36.6 16.1-36.6 36.6s16.1 36.6 36.6 36.6c8.8 0 18.3-1.5 30.8-5.1 46.9-13.9 85.8-43.2 109.9-82.8 16.1-27.1 24.9-57.2 24.9-87.9 0-98.8-86.5-178.7-192.7-178.7z" p-id="4933"></path></svg>',iconIFVuepress:'<svg t="1694167910261" class="icon" viewBox="0 0 1120 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8613" width="16" height="16"><path d="M1055.594124 381.672727L897.339578 139.636364c-18.618182-37.236364-74.472727-55.854545-111.709091-55.854546H282.939578c-37.236364 0-93.090909 27.927273-111.709091 55.854546L12.975942 381.672727c-18.618182 37.236364-18.618182 83.781818 9.309091 111.709091l465.454545 493.381818c27.927273 27.927273 65.163636 18.618182 93.090909 0l465.454546-493.381818c27.927273-27.927273 37.236364-83.781818 9.309091-111.709091z m-242.036364-74.472727s0 9.309091 0 0L552.903215 726.109091H422.575942L376.030487 344.436364c0-18.618182-9.309091-27.927273-9.309091-37.236364-9.309091-9.309091-18.618182-9.309091-27.927272-9.309091l9.309091-18.618182H469.121396c9.309091 0 18.618182 0 27.927273 9.309091 9.309091 9.309091 9.309091 18.618182 9.309091 27.927273l27.927273 269.963636 139.636363-251.345454v-9.309091-9.309091c0-9.309091 0-9.309091-9.309091-18.618182-9.309091 0-9.309091-9.309091-18.618181-9.309091l9.309091-18.618182h139.636363c9.309091 0 18.618182 0 18.618182 9.309091s9.309091 18.618182 0 27.927273c9.309091 0 0 0 0 0z" p-id="8614"></path></svg>',iconIFVuepress2:'<svg t="1694167983538" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="8866" width="16" height="16"><path d="M554.666667 384h234.666666L554.666667 149.333333V384M256 85.333333h341.333333l256 256v512a85.333333 85.333333 0 0 1-85.333333 85.333334H256a85.333333 85.333333 0 0 1-85.333333-85.333334V170.666667c0-47.36 37.973333-85.333333 85.333333-85.333334m384 682.666667v-85.333333H256v85.333333h384m128-170.666667v-85.333333H256v85.333333h512z" p-id="8867"></path><path d="M516.010667 555.946667l249.941333 431.36 249.941333-429.269334v-2.133333h-97.152l-151.338666 259.925333-150.613334-259.925333z" fill="#41B883" p-id="8868"></path><path d="M616.789333 555.946667l150.613334 259.925333 151.338666-259.968h-91.136L768 658.218667l-59.306667-102.314667z" p-id="8869"></path></svg>',iconIFVue:'<svg t="1684170497745" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="10726" width="16" height="16"><path d="M512 504L764.8 68.8h-134.4L512 275.2 393.6 70.4h-134.4L512 504zM819.2 70.4L512 600 204.8 68.8H0l512 886.4L1024 70.4H819.2z" p-id="10727"></path></svg>',iconIFNuxt:'<svg t="1689995630285" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2710" width="16" height="16"><path d="M841.557333 864.938667l0.981334-1.92a31.573333 31.573333 0 0 0 2.261333-4.992l0.085333-0.213334a49.493333 49.493333 0 0 0 2.304-25.898666l0.042667 0.298666a76.586667 76.586667 0 0 0-10.026667-26.581333l0.213334 0.341333-226.858667-399.061333-34.645333-60.586667-34.432 60.586667-226.730667 399.061333a78.933333 78.933333 0 0 0-8.704 25.770667l-0.042667 0.469333a53.632 53.632 0 0 0 3.413334 30.421334l-0.128-0.341334a34.517333 34.517333 0 0 0 2.133333 4.352l-0.085333-0.170666c6.826667 11.733333 21.333333 25.685333 53.333333 25.685333h422.314667c6.698667 0 39.466667-1.365333 54.613333-27.178667z m-265.685333-397.482667l207.317333 364.714667H368.64z m437.290667 338.517333L713.813333 278.613333c-3.072-5.546667-20.352-33.578667-50.432-33.578666-13.525333 0-32.938667 5.76-48.725333 33.493333l-38.698667 67.84 34.432 60.586667 53.333334-94.378667 296.149333 519.68h-112.64a50.645333 50.645333 0 0 1-2.474667 25.941333l0.128-0.341333a32.938667 32.938667 0 0 1-2.432 5.376l0.085334-0.170667-0.981334 1.92c-15.146667 25.813333-47.872 27.178667-54.272 27.178667h176.170667c6.485333 0 39.125333-1.365333 54.272-27.178667 6.698667-11.733333 11.52-31.445333-4.565333-58.965333zM311.637333 866.432a42.197333 42.197333 0 0 1-1.92-3.925333l-0.085333-0.256a52.394667 52.394667 0 0 1-3.584-30.378667l-0.042667 0.298667H64.042667L423.68 199.338667l118.058667 207.530666 34.218666-60.586666-102.912-181.290667c-2.858667-5.205333-20.266667-33.152-50.218666-33.152-13.525333 0-32.938667 5.845333-48.725334 33.578667L9.813333 805.930667c-3.072 5.546667-18.133333 34.645333-3.2 60.458666 6.826667 11.733333 21.333333 25.685333 53.333334 25.685334h305.109333c-31.786667 0-46.506667-13.738667-53.333333-25.685334z" p-id="2711"></path></svg>',iconIFYuque:'<svg t="1684169305378" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5780" width="16" height="16"><path d="M903.542857 350.4c-11.314286-45.028571 11.314286-116.8 83.885714-142.171429l-77.6-4.114285s-29.371429-102.857143-164.114285-112c-134.628571-9.257143-222.742857-3.428571-222.857143-3.428572 0.114286 0 99.885714 63.542857 59.885714 176.8-29.257143 60-75.2 109.257143-124.342857 165.371429-1.485714 1.485714-2.857143 2.971429-4 4.228571C291.885714 618.285714 36.571429 909.714286 36.571429 909.714286c281.028571 73.6 469.371429-7.2 580.8-104.114286 23.428571-0.228571 41.028571-0.342857 52.914285-0.342857 155.2 0 286.4-134.4 281.028572-283.885714-3.657143-102.742857-36.457143-125.942857-47.771429-170.971429z m-233.257143 381.714286c-12.114286 0-29.942857 0.114286-53.485714 0.342857l-26.971429 0.228571-20.342857 17.714286c-53.828571 46.857143-119.314286 81.714286-195.885714 100.114286-60 14.4-125.714286 18.514286-197.371429 10.971428 20.571429-23.428571 41.714286-47.542857 63.314286-72.114285 105.142857-119.542857 198.628571-225.714286 270.742857-306.857143l1.6-1.6 1.485715-1.714286c4.685714-5.257143 23.542857-26.628571 28.228571-32.114286 11.085714-12.685714 19.771429-22.742857 28-32.685714 35.085714-41.942857 59.657143-77.485714 78.857143-116.8l1.828571-3.771429 1.371429-3.885714c15.657143-44.342857 17.6-87.885714 7.085714-128.914286 25.714286 0.8 53.142857 2.171429 81.942857 4.114286 38.057143 2.628571 63.428571 14.742857 81.257143 33.371429 6.628571 6.857143 11.657143 14.285714 15.314286 21.371428 1.142857 2.285714 1.942857 4.114286 2.628571 5.714286l5.714286 20.228571c-17.942857 39.428571-22.742857 83.771429-13.028571 122.514286 3.428571 13.485714 7.885714 25.6 14.057142 39.314286 2.4 5.371429 10.857143 22.971429 12.571429 26.628571 11.771429 25.942857 17.6 49.142857 19.085714 89.942857 3.771429 108.114286-94.514286 207.885714-208 207.885715z" p-id="5781"></path></svg>',iconIFNotion:'<svg t="1691069780339" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3978" width="16" height="16"><path d="M190.3619 179.479263c31.818329 25.847061 43.760866 23.885073 103.558852 19.875793l563.645073-33.822969c11.942537 0 2.00464-11.942537-1.961988-13.904525L761.940229 83.938971c-17.913805-13.904525-41.84153-29.856341-87.649688-25.889713L128.559273 97.886148c-19.875793 1.961988-23.885073 11.942537-15.951816 19.875793z m33.822969 131.367902v593.032243c0 31.860981 15.909165 43.803518 51.779427 41.798878l619.433779-35.827609c35.870262-1.961988 39.879542-23.885073 39.879541-49.774787V271.010276c0-25.847061-9.937896-39.794238-31.903633-37.83225l-647.328132 37.83225c-23.885073 2.00464-31.860981 13.947177-31.860982 39.794237z m611.500523 31.775678c3.966628 17.913805 0 35.82761-17.913805 37.874902l-29.856341 5.971268v437.779268c-25.932365 13.947177-49.817438 21.923085-69.735883 21.923085-31.903633 0-39.879542-9.980548-63.764615-39.794238l-195.21782-306.49667v296.516122L520.956902 810.386408s0 35.82761-49.817438 35.82761l-137.424474 7.933256c-3.966628-7.933256 0-27.851701 13.947177-31.818329l35.827609-9.937897V420.291982L333.800294 416.282702c-4.00928-17.913805 5.971268-43.760866 33.82297-45.765506l147.405022-9.937896 203.193729 310.463298v-274.678341l-51.822078-5.928616c-3.966628-21.923085 11.942537-37.83225 31.860981-39.794238zM82.751115 44.144733l567.697005-41.798878c69.693231-5.971268 87.649688-2.00464 131.453206 29.856342l181.227992 127.358622c29.856341 21.880433 39.83689 27.851701 39.83689 51.736774v698.553084c0 43.760866-15.909165 69.693231-71.65522 73.617207l-659.313321 39.83689c-41.798878 2.00464-61.759975-3.966628-83.683059-31.860982l-133.457846-173.166779c-23.885073-31.860981-33.82297-55.703403-33.82297-83.597756V113.752661c0-35.784958 15.951817-65.683951 61.717323-69.607928z" p-id="3979"></path></svg>',iconIFHalo:'<svg t="1695187534618" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5055" width="16" height="16"><path d="M540.672 470.09792c0-0.7424-0.03584-1.46944-0.11264-2.19136a20.9408 20.9408 0 0 1 11.58144-20.92032c1.54112-0.75776 2.98496-1.70496 4.3008-2.816l320.9216-314.17856a20.93056 20.93056 0 0 0-13.5936-36.89984H160.2304a21.00224 21.00224 0 0 0-15.2576 6.56384 20.9152 20.9152 0 0 0 0.84992 29.60384l288.82944 314.17344c2.2272 2.0992 4.88448 3.6864 7.7824 4.64896a20.94592 20.94592 0 0 1 14.336 20.92544c-0.0256 0.54272-0.0256 0.54272-0.03072 1.09056v426.89536l83.93216 20.9408V470.10304z m41.96864 481.73056c0 15.56992-16.41472 25.69728-30.36672 18.73408l-125.9008-41.89184a20.9408 20.9408 0 0 1-11.60192-18.73408V480.90624c-3.1744-2.05824-6.16448-4.4032-8.9344-7.0144L117.00736 159.71328c-25.27744-23.82848-26.41408-63.60064-2.54464-88.832A63.00672 63.00672 0 0 1 160.2304 51.2h703.5392C898.5344 51.2 926.72 79.3344 926.72 114.03264c0 18.432-8.11008 35.9424-22.17984 47.87712l-320.9216 314.17344c-0.32256 0.27648-0.65024 0.54784-0.97792 0.81408v474.9312z"  p-id="5056"></path></svg>',iconIFCnblogs:'<svg t="1684168925817" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4454" width="16" height="16"><path d="M851.404 172.596c-187.462-187.461-491.346-187.461-678.808 0-187.461 187.462-187.461 491.346 0 678.808 187.462 187.461 491.346 187.461 678.808 0 187.461-187.462 187.461-491.346 0-678.808zM387.33 728.087a47.084 47.084 0 1 1-66.633-66.502 47.084 47.084 0 0 1 66.633 66.502z m205.527 1.397a38.75 38.75 0 0 1-76.625-11.52h-0.044a6.545 6.545 0 0 0-0.044 0.305v-0.349c0.306-2.618 2.051-20.727-2.967-44.99a174.24 174.24 0 0 0-48.567-89.28 172.102 172.102 0 0 0-88.8-48.305 156.698 156.698 0 0 0-42.458-2.923 38.662 38.662 0 0 1-35.39-65.324 38.618 38.618 0 0 1 21.12-10.822v-0.218c4.452-0.742 111.142-16.45 200.335 72.742 89.018 89.018 74.182 196.145 73.44 200.727z m175.2 7.592a38.75 38.75 0 0 1-65.673 21.382 39.49 39.49 0 0 1-11.65-33.73c0.087-0.35 5.105-37.484-5.062-88.975-13.31-67.375-45.295-126.895-94.953-176.902-50.007-49.702-109.527-81.644-176.945-94.953-51.491-10.167-88.582-5.193-89.019-5.149h0.219-0.044a39.927 39.927 0 0 1-44.684-32.902 38.836 38.836 0 0 1 32.204-44.378c1.92-0.305 47.869-7.33 111.273 4.364a411.753 411.753 0 0 1 106.254 34.952 425.76 425.76 0 0 1 114.633 82.255l0.916 0.96 0.96 0.873a425.89 425.89 0 0 1 82.255 114.72c16.407 33.6 28.145 69.294 34.996 106.21 11.651 63.404 4.67 109.353 4.32 111.273z" p-id="4455"></path></svg>',iconIFTypecho:'<svg t="1684170671485" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="12354" width="16" height="16"><path d="M942.933333 132.266667l-168.533333-10.666667v64l164.266667 10.666667c8.533333 0 12.8 4.266667 14.933333 6.4 2.133333 2.133333 6.4 8.533333 4.266667 14.933333l-46.933334 718.933333c0 10.666667-10.666667 19.2-21.333333 19.2h-2.133333l-115.2-8.533333c-4.266667 21.333333-23.466667 36.266667-46.933334 36.266667H362.666667l522.666666 34.133333h6.4c44.8 0 81.066667-34.133333 85.333334-78.933333L1024 219.733333c2.133333-44.8-34.133333-85.333333-81.066667-87.466666z" p-id="12355"></path><path d="M727.466667 74.666667c6.4 0 10.666667 4.266667 10.666666 10.666666v853.333334c0 6.4-4.266667 10.666667-10.666666 10.666666h-640c-6.4 0-10.666667-4.266667-10.666667-10.666666V85.333333c0-6.4 4.266667-10.666667 10.666667-10.666666h640m0-74.666667h-640c-46.933333 0-85.333333 38.4-85.333334 85.333333v853.333334c0 46.933333 38.4 85.333333 85.333334 85.333333h640c46.933333 0 85.333333-38.4 85.333333-85.333333V85.333333c0-46.933333-38.4-85.333333-85.333333-85.333333z" p-id="12356"></path><path d="M522.666667 518.4H177.066667c-21.333333 0-36.266667-17.066667-36.266667-36.266667 0-21.333333 17.066667-36.266667 36.266667-36.266666h345.6c21.333333 0 36.266667 17.066667 36.266666 36.266666 0 19.2-17.066667 36.266667-36.266666 36.266667z" p-id="12357"></path><path d="M424.533333 686.933333H177.066667c-21.333333 0-38.4 17.066667-38.4 38.4s17.066667 38.4 38.4 38.4h247.466666c21.333333 0 38.4-17.066667 38.4-38.4s-17.066667-38.4-38.4-38.4z" p-id="12358"></path></svg>',iconIFWordpress:'<svg t="1684168789622" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="4159" width="16" height="16"><path d="M916.010667 291.2c35.84 65.578667 56.234667 140.8 56.234666 220.8 0 169.770667-91.989333 318.122667-228.821333 397.866667l140.586667-406.485334c26.24-65.706667 34.986667-118.229333 34.986666-164.864 0-17.28-1.109333-33.28-2.986666-47.36m-340.522667 4.48c27.605333-1.28 52.565333-4.48 52.565333-4.48 24.832-3.2 21.930667-39.68-2.858666-38.357333 0 0-74.88 5.76-122.88 5.76-45.397333 0-121.6-6.4-121.6-6.4-24.96-1.28-28.202667 36.48-3.2 37.76 0 0 23.04 2.602667 48 3.84l71.68 196.48-101.12 302.08L228.437333 294.4c27.690667-1.28 52.650667-4.266667 52.650667-4.266667 24.96-3.2 22.016-39.68-2.773333-38.229333 0 0-74.496 5.888-122.624 5.888-8.533333 0-18.688-0.341333-29.44-0.64C209.536 134.4 351.36 51.84 512 51.84c119.850667 0 228.906667 45.738667 310.869333 120.874667-1.962667-0.128-3.882667-0.384-6.016-0.384-45.226667 0-77.312 39.381333-77.312 81.664 0 37.973333 21.888 70.101333 45.226667 107.989333 17.536 30.72 37.973333 70.101333 37.973333 127.018667 0 39.04-15.104 85.077333-35.029333 148.437333l-45.866667 152.96-166.4-495.36 0.042667 0.597333zM512 972.117333c-45.184 0-88.789333-6.528-130.048-18.645333l138.112-401.322667 141.44 387.712c1.024 2.261333 2.133333 4.309333 3.328 6.357334-47.786667 16.768-99.2 25.984-152.832 25.984M51.669333 512c0-66.730667 14.336-130.133333 39.893334-187.306667L311.04 926.250667A460.544 460.544 0 0 1 51.669333 512M512 0C229.76 0 0 229.76 0 512s229.76 512 512 512 512-229.76 512-512S794.24 0 512 0" p-id="4160"></path></svg>',iconIFZhihu:'<svg t="1689993036802" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2449" width="16" height="16"><path d="M564.7 230.1V803h60l25.2 71.4L756.3 803h131.5V230.1H564.7z m247.7 497h-59.9l-75.1 50.4-17.8-50.4h-18V308.3h170.7v418.8zM526.1 486.9H393.3c2.1-44.9 4.3-104.3 6.6-172.9h130.9l-0.1-8.1c0-0.6-0.2-14.7-2.3-29.1-2.1-15-6.6-34.9-21-34.9H287.8c4.4-20.6 15.7-69.7 29.4-93.8l6.4-11.2-12.9-0.7c-0.8 0-19.6-0.9-41.4 10.6-35.7 19-51.7 56.4-58.7 84.4-18.4 73.1-44.6 123.9-55.7 145.6-3.3 6.4-5.3 10.2-6.2 12.8-1.8 4.9-0.8 9.8 2.8 13 10.5 9.5 38.2-2.9 38.5-3 0.6-0.3 1.3-0.6 2.2-1 13.9-6.3 55.1-25 69.8-84.5h56.7c0.7 32.2 3.1 138.4 2.9 172.9h-141l-2.1 1.5c-23.1 16.9-30.5 63.2-30.8 65.2l-1.4 9.2h167c-12.3 78.3-26.5 113.4-34 127.4-3.7 7-7.3 14-10.7 20.8-21.3 42.2-43.4 85.8-126.3 153.6-3.6 2.8-7 8-4.8 13.7 2.4 6.3 9.3 9.1 24.6 9.1 5.4 0 11.8-0.3 19.4-1 49.9-4.4 100.8-18 135.1-87.6 17-35.1 31.7-71.7 43.9-108.9L497 850l5-12c0.8-1.9 19-46.3 5.1-95.9l-0.5-1.8-108.1-123-22 16.6c6.4-26.1 10.6-49.9 12.5-71.1h158.7v-8c0-40.1-18.5-63.9-19.2-64.9l-2.4-3z" p-id="2450"></path></svg>',iconIFCSDN:'<svg t="1690721786570" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3120" width="16" height="16"><path d="M512 0c282.784 0 512 229.216 512 512s-229.216 512-512 512S0 794.784 0 512 229.216 0 512 0z m189.952 752l11.2-108.224c-31.904 9.536-100.928 16.128-147.712 16.128-134.464 0-205.728-47.296-195.328-146.304 11.584-110.688 113.152-145.696 232.64-145.696 54.784 0 122.432 8.8 151.296 18.336L768 272.704C724.544 262.24 678.272 256 599.584 256c-203.2 0-388.704 94.88-406.4 263.488C178.336 660.96 303.584 768 535.616 768c80.672 0 138.464-6.432 166.336-16z" p-id="3121"></path></svg>',iconIFJianshu:'<svg t="1690723639888" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5035" width="16" height="16"><path d="M654.791 38.495h-286.53c-95.005 0-142.412 0-193.612 16.118-55.94 20.48-99.935 64.474-120.225 120.226-16.308 51.2-16.308 98.607-16.308 193.611v286.53c0 95.005 0 142.602 16.118 193.613 20.29 55.75 64.285 99.745 120.036 120.035 51.2 16.119 98.607 16.119 193.611 16.119h286.53c95.005 0 142.413 0 193.613-16.119 55.75-20.29 99.745-64.284 120.225-120.035 16.118-51.2 16.118-98.608 16.118-193.612V368.45c0-95.005 0-142.412-16.118-193.612-20.29-55.752-64.285-99.746-120.225-120.226-50.821-16.118-98.228-16.118-193.233-16.118z m0 0" p-id="5036"></path><path d="M235.52 456.818h70.732v370.346H235.52V456.818z m40.012-112.45c17.825 32.995 29.203 65.8 34.512 98.796h77.18c-10.62-42.097-23.894-74.903-39.823-98.797h-71.87z m0 0" fill="#a0cfff" p-id="5037"></path><path d="M427.804 278.566h85.144v-46.649H358.59c1.706-3.603 4.361-10.05 7.964-19.153 1.707-7.395 3.603-12.705 5.31-16.497H292.03c-12.326 49.303-40.77 85.902-85.144 109.795v46.65c58.595-14.602 100.124-39.254 124.966-73.956H358.4c8.913 23.703 14.222 46.648 15.929 68.645h74.524c-5.12-25.79-12.326-48.734-21.049-68.835z m-34.702 148.1h320.664v301.701c1.707 27.497-10.62 40.202-37.167 38.306h-43.995v54.803h63.906c62.009 1.896 92.16-26.549 90.453-85.144V371.864h-393.86v54.803z m0 0" fill="#a0cfff" p-id="5038"></path><path d="M643.224 476.16H382.483v277.049H563.39c56.699 1.896 83.437-25.6 79.834-82.3V476.16z m-188.871 49.304h117.001v63.146H454.353v-63.146z m82.488 178.252h-82.488v-68.457h117.001v32.996c1.707 25.41-9.671 37.357-34.513 35.46zM645.88 229.262c0-1.896 0.948-4.55 2.654-8.154l7.965-24.652h-79.834c-12.516 51.2-39.823 89.695-82.49 115.295v43.805c54.993-14.602 96.712-40.202 124.967-76.8h37.167c8.913 23.703 14.222 46.648 15.929 68.645h71.87c-1.707-18.204-8.913-41.15-21.239-68.645h93.108v-49.304H645.88z m0 0" fill="#a0cfff" p-id="5039"></path></svg>',iconIFJuejin:'<svg t="1690725319716" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="6174" width="16" height="16"><path d="M465.189 161.792c-22.967 18.14-44.325 35.109-47.397 37.742l-5.851 4.68 10.971 8.632c5.998 4.827 11.85 9.508 13.02 10.532 1.17 1.024 17.993 14.336 37.156 29.696l34.962 27.795 5.267-3.95c2.925-2.194 23.259-18.432 45.348-35.986 21.943-17.555 41.253-32.768 42.716-33.646 1.609-1.024 2.779-2.194 2.779-2.78 0-0.438-9.655-8.63-21.504-17.846-11.995-9.363-22.674-17.847-23.845-18.871-15.945-13.02-49.737-39.059-50.76-39.059-0.586 0.147-19.896 14.922-42.862 33.061z m233.325 180.37C507.465 493.275 508.928 492.105 505.417 489.911c-3.072-1.902-11.556-8.485-64.073-50.03-9.07-7.168-18.578-14.775-21.358-16.823-2.78-2.194-8.777-6.875-13.312-10.532-4.68-3.657-10.679-8.339-13.312-10.533-13.165-10.24-71.095-56.027-102.107-80.457-5.852-4.681-11.41-8.485-12.142-8.485-0.731 0-10.971 7.754-22.674 17.116-11.703 9.508-22.674 18.286-24.284 19.456-1.755 1.17-5.12 3.95-7.46 6.144-2.34 2.34-4.828 4.096-5.413 4.096-3.072 0-0.731 3.072 6.437 8.777 4.096 3.218 8.777 6.875 10.094 8.046 1.316 1.024 10.24 8.045 19.748 15.506s23.26 18.286 30.428 23.99c19.31 15.215 31.89 25.308 127.853 101.084 47.836 37.742 88.796 69.779 90.844 71.095 3.657 2.487 3.95 2.487 7.46-0.292a1041.42 1041.42 0 0 0 16.092-12.727c6.875-5.413 14.775-11.703 17.554-13.897 30.135-23.699 80.018-63.05 81.774-64.512 1.17-1.024 12.434-9.802 24.868-19.603s37.888-29.696 56.32-44.324c18.579-14.629 46.227-36.425 61.733-48.567 15.506-12.142 27.794-22.528 27.502-23.26-0.878-1.17-57.637-47.104-59.978-48.274-0.731-0.439-18.578 12.727-39.497 29.257z" p-id="6175"></path><path d="M57.93 489.326c-15.215 12.288-28.527 23.405-29.697 24.576-2.34 2.194-5.412-0.44 80.018 66.852 33.207 26.185 32.622 25.747 57.637 45.495 10.386 8.192 36.279 28.672 57.783 45.495 38.18 30.135 44.91 35.401 52.663 41.545 2.048 1.756 22.967 18.14 46.372 36.572 23.26 18.432 74.167 58.514 112.933 89.088 38.912 30.573 71.095 55.734 71.826 56.027 0.732 0.293 7.46-4.389 14.921-10.386 21.797-16.97 90.259-70.949 101.523-79.872 5.705-4.535 12.873-10.24 15.945-12.58 3.072-2.488 6.436-5.12 7.314-5.852 0.878-0.878 11.85-9.509 24.283-19.31 20.773-16.091 59.1-46.226 64.366-50.615 1.17-1.024 5.12-4.096 8.777-6.875 3.657-2.78 7.9-6.29 9.509-7.607 1.609-1.317 14.775-11.703 29.257-23.113 29.11-22.82 42.277-33.207 88.503-69.632 17.262-13.605 32.475-25.454 33.646-26.478 2.486-2.048 31.451-24.869 44.617-35.255 4.827-3.657 9.07-7.168 9.508-7.607 0.44-0.585 5.998-4.827 12.435-9.8 6.436-4.828 13.165-10.24 15.067-11.85l3.365-2.926-9.948-7.753c-5.412-4.388-10.24-8.192-10.679-8.63-1.17-1.317-22.381-18.433-30.135-24.284-3.95-3.072-7.314-5.998-7.606-6.73-1.317-3.071-6.73 0.147-29.258 17.994-13.458 10.532-25.746 20.187-27.355 21.504-1.61 1.463-10.533 8.338-19.749 15.652-9.216 7.168-17.115 13.459-17.554 13.898-0.439 0.438-6.583 5.412-13.897 10.971-7.168 5.559-15.214 11.703-17.7 13.75-4.974 4.097-5.413 4.39-20.334 16.239-5.56 4.388-11.264 8.777-12.435 9.8-1.17 1.025-20.333 16.092-42.422 33.354-22.09 17.408-41.546 32.768-43.155 34.084-1.609 1.463-14.482 11.557-28.525 22.528s-40.814 32.037-59.539 46.812c-18.578 14.775-42.276 33.353-52.516 41.399s-23.26 18.285-28.965 22.82l-10.386 8.339-4.389-3.072c-2.34-1.756-4.68-3.511-5.12-3.95-0.439-0.439-4.973-4.096-10.24-8.046-11.849-9.216-14.482-11.264-16.676-13.166-0.878-0.877-4.243-3.51-7.46-5.851-3.22-2.487-6.145-4.681-6.584-5.12-0.439-0.439-6.875-5.705-14.482-11.703-7.607-5.851-14.921-11.556-16.091-12.58-1.317-1.17-17.116-13.605-35.255-27.795-17.993-14.19-35.109-27.648-38.035-29.842-5.705-4.681-33.499-26.624-125.074-98.743-34.523-27.209-72.704-57.344-84.846-66.852-49.737-39.498-55.15-43.594-56.905-43.447-0.877 0-14.043 10.24-29.257 22.528z" p-id="6176"></path></svg>',iconIFWechat:'<svg t="1690726490823" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7276" width="16" height="16"><path d="M996.427776 623.853568c0-139.354112-138.063872-251.815936-291.87072-251.815936-162.281472 0-290.656256 112.461824-290.656256 251.815936 0 139.352064 128.374784 251.807744 290.656256 251.807744 35.119104 0 69.031936-11.001856 104.148992-18.331648l92.043264 52.559872-24.2176-88.014848c67.821568-50.122752 119.896064-119.791616 119.896064-198.02112z m-386.338816-45.24032c-16.95744 0-33.906688-15.890432-33.906688-31.77472 0-19.562496 16.95744-35.446784 33.906688-35.446784 25.438208 0 43.599872 15.890432 43.599872 35.446784 0.002048 15.884288-18.161664 31.77472-43.599872 31.77472z m190.144512 0c-18.167808 0-33.910784-15.890432-33.910784-31.77472 0-19.562496 15.745024-35.446784 33.910784-35.446784 24.219648 0 42.387456 15.890432 42.387456 35.446784 0 15.884288-18.169856 31.77472-42.387456 31.77472z"  p-id="7277"></path><path d="M683.97056 352.48128c9.68704 0 20.588544 1.216512 32.700416 3.672064-29.063168-141.809664-178.03264-242.044928-345.155584-242.044928-188.925952 0-343.943168 127.127552-343.943168 293.373952 0 94.130176 50.868224 171.145216 136.855552 232.25344l-35.131392 105.132032 122.318848-62.347264c42.385408 12.232704 75.087872 19.562496 119.90016 19.562496 9.68704 0 20.594688 0 30.27968-1.216512-6.053888-24.45312-9.684992-47.681536-9.684992-73.34912 0-150.355968 127.156224-275.03616 291.86048-275.03616z m-185.2928-91.686912c26.64448 0 43.599872 15.890432 43.599872 42.78272 0 25.675776-16.955392 42.784768-43.599872 42.784768-25.432064 0-49.657856-17.1008-49.657856-42.784768 0-26.894336 24.225792-42.78272 49.657856-42.78272z m-239.794176 85.573632c-25.432064 0-52.076544-17.115136-52.076544-42.79296 0-26.894336 26.64448-42.78272 52.076544-42.78272 24.223744 0 43.599872 15.890432 43.599872 42.78272 0 25.677824-19.376128 42.79296-43.599872 42.79296z"  p-id="7278"></path></svg>',iconIFSiyuan:'<svg t="1690817357506" class="icon" viewBox="0 0 1025 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1557" width="16" height="16"><path d="M1.706667 0h1024v1024H1.706667z" fill="#2E2C2F" p-id="1558"></path><path d="M307.862187 555.677013l38.34368 13.202774c-13.19936 47.77472-22.00064 70.40512-38.971734 106.23488-13.830827 28.91264-22.00064 42.115413-42.745173 69.771946l-35.82976-25.775786c22.00064-24.512853 30.17216-37.08416 43.373227-62.85824 17.600853-33.312427 25.14432-54.683307 35.82976-100.575574z m-13.201067-103.673173v-153.378133c0-27.02848-0.628053-44.00128-2.515627-60.972374 16.34304 2.51392 34.573653 3.141973 59.088214 3.141974H668.0064c24.512853 0 42.743467-0.628053 59.086507-3.141974-1.88416 16.34304-2.51392 32.058027-2.51392 60.972374v153.378133c0 26.400427 0.62976 42.115413 2.51392 58.4192-18.230613-2.471253-37.085867-3.10272-59.086507-3.10272H350.605653c-21.998933 0-40.855893 1.256107-58.458453 3.10272 1.885867-16.93184 2.51392-33.90464 2.51392-58.4192z m230.029653 20.744533h161.542827v-83.60448h-161.542827v83.60448z m0-117.548373h161.542827v-79.83104h-161.542827v79.83104z m-191.684266 117.548373h154.632533v-83.60448h-154.632533v83.60448z m0-117.548373h154.632533v-79.83104h-154.632533v79.83104z m144.576853 196.082347l29.540693-20.744534c36.462933 34.573653 58.422613 59.712853 90.478934 104.3456l-32.05632 25.14432c-27.0336-45.88544-48.402773-72.915627-87.963307-108.745386z m-43.999573 57.828693v89.260373c0 23.888213 10.68032 27.026773 91.106986 27.026774 72.91392 0 95.5392-3.13856 104.97024-15.085227 6.28736-8.797867 9.42592-28.286293 11.32032-72.287573 13.824 8.173227 23.253333 11.94496 38.966614 15.714986-6.28736 61.60384-11.93984 81.716907-27.656534 92.407467-16.34304 11.941547-52.169387 16.341333-135.14752 16.341333-104.9344 0-123.16672-8.173227-123.16672-55.942826v-97.4336c0-32.684373-0.626347-42.745173-3.76832-57.8304h47.14496c-3.145387 16.96768-3.770027 27.656533-3.770026 57.828693z m261.4528-57.828693c42.743467 52.800853 71.02976 96.802133 103.71584 162.174293l-35.82976 24.517973c-30.173867-72.28928-53.430613-111.261013-98.689707-167.835306l30.803627-18.85696z" fill="#FFFFFF" p-id="1559"></path></svg>',iconOTYes:'<svg viewBox="64 64 896 896" focusable="false" class="" data-icon="check-circle" width="1em" height="1em" fill="currentColor" aria-hidden="true"><path d="M512 64C264.6 64 64 264.6 64 512s200.6 448 448 448 448-200.6 448-448S759.4 64 512 64zm0 820c-205.4 0-372-166.6-372-372s166.6-372 372-372 372 166.6 372 372-166.6 372-372 372z" fill="#52c41a"></path><path d="M512 140c-205.4 0-372 166.6-372 372s166.6 372 372 372 372-166.6 372-372-166.6-372-372-372zm193.4 225.7l-210.6 292a31.8 31.8 0 01-51.7 0L318.5 484.9c-3.8-5.3 0-12.7 6.5-12.7h46.9c10.3 0 19.9 5 25.9 13.3l71.2 98.8 157.2-218c6-8.4 15.7-13.3 25.9-13.3H699c6.5 0 10.3 7.4 6.4 12.7z" fill="#f6ffed"></path><path d="M699 353h-46.9c-10.2 0-19.9 4.9-25.9 13.3L469 584.3l-71.2-98.8c-6-8.3-15.6-13.3-25.9-13.3H325c-6.5 0-10.3 7.4-6.5 12.7l124.6 172.8a31.8 31.8 0 0051.7 0l210.6-292c3.9-5.3.1-12.7-6.4-12.7z" fill="#52c41a"></path></svg>',iconOTNo:'<svg t="1690801094533" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="3185" width="16" height="16"><path d="M512 0a512 512 0 1 1 0 1024A512 512 0 0 1 512 0z m0 93.12a418.88 418.88 0 1 0 0 837.76 418.88 418.88 0 0 0 0-837.76zM676.544 281.6L742.4 347.52 577.792 512l164.608 164.544L676.48 742.4 512 577.792 347.456 742.4 281.6 676.48 446.208 512 281.6 347.456 347.52 281.6 512 446.208 676.544 281.6z" fill="none" p-id="3186"></path></svg>'},dr=r=>[{type:he.Common,title:r("setting.platform.universal"),img:"./images/universal.webp",description:r("setting.platform.universal.desc")},{type:he.Github,title:r("setting.platform.github"),img:"./images/github.png",description:r("setting.platform.github.desc")},{type:he.Gitlab,title:r("setting.platform.gitlab"),img:"./images/gitlab.jpg",description:r("setting.platform.gitlab.desc")},{type:he.Metaweblog,title:r("setting.platform.metaweblog"),img:"./images/xmlrpc.png",description:r("setting.platform.metaweblog.desc")},{type:he.Wordpress,title:r("setting.platform.wordpress"),img:"./images/wordpress-logo.svg",description:r("setting.platform.wordpress.desc")},{type:he.Custom,title:r("setting.platform.custom"),img:"./images/http.png",description:r("setting.platform.custom.desc")}],xe={commonCfg:[{platformType:he.Common,subPlatformType:D.Common_Yuque,platformKey:"common_Yuque",platformName:"语雀",platformIcon:fe.iconIFYuque,authMode:pe.API,isEnabled:!1},{platformType:he.Common,subPlatformType:D.Common_Notion,platformKey:"common_Notion",platformName:"Notion",platformIcon:fe.iconIFNotion,authMode:pe.API,isEnabled:!1},{platformType:he.Common,subPlatformType:D.Common_Halo,platformKey:"common_Halo",platformName:"Halo",platformIcon:fe.iconIFHalo,authMode:pe.API,isEnabled:!1}],githubCfg:[{platformType:he.Github,subPlatformType:D.Github_Hexo,platformKey:"github_Hexo",platformName:"Hexo",platformIcon:fe.iconIFHexo,authMode:pe.API,isEnabled:!1},{platformType:he.Github,subPlatformType:D.Github_Hugo,platformKey:"github_Hugo",platformName:"Hugo",platformIcon:fe.iconIFHugo,authMode:pe.API,isEnabled:!1},{platformType:he.Github,subPlatformType:D.Github_Jekyll,platformKey:"github_Jekyll",platformName:"Jekyll",platformIcon:fe.iconIFJekyll,authMode:pe.API,isEnabled:!1},{platformType:he.Github,subPlatformType:D.Github_Vuepress,platformKey:"github_Vuepress",platformName:"Vuepress",platformIcon:fe.iconIFVuepress,authMode:pe.API,isEnabled:!1},{platformType:he.Github,subPlatformType:D.Github_Vuepress2,platformKey:"github_Vuepress2",platformName:"Vuepress2",platformIcon:fe.iconIFVuepress2,authMode:pe.API,isEnabled:!1},{platformType:he.Github,subPlatformType:D.Github_Vitepress,platformKey:"github_Vitepress",platformName:"Vitepress",platformIcon:fe.iconIFVue,authMode:pe.API,isEnabled:!1}],gitlabCfg:[{platformType:he.Gitlab,subPlatformType:D.Gitlab_Hexo,platformKey:"gitlab_Gitlabhexo",platformName:"Gitlabhexo",platformIcon:fe.iconIFHexo,authMode:pe.API,isEnabled:!1},{platformType:he.Gitlab,subPlatformType:D.Gitlab_Hugo,platformKey:"gitlab_Gitlabhugo",platformName:"Gitlabhugo",platformIcon:fe.iconIFHugo,authMode:pe.API,isEnabled:!1},{platformType:he.Gitlab,subPlatformType:D.Gitlab_Jekyll,platformKey:"gitlab_Gitlabjekyll",platformName:"Gitlabjekyll",platformIcon:fe.iconIFJekyll,authMode:pe.API,isEnabled:!1},{platformType:he.Gitlab,subPlatformType:D.Gitlab_Vuepress,platformKey:"gitlab_Gitlabvuepress",platformName:"Gitlabvuepress",platformIcon:fe.iconIFVuepress,authMode:pe.API,isEnabled:!1},{platformType:he.Gitlab,subPlatformType:D.Gitlab_Vuepress2,platformKey:"gitlab_Gitlabvuepress2",platformName:"Gitlabvuepress2",platformIcon:fe.iconIFVuepress2,authMode:pe.API,isEnabled:!1},{platformType:he.Gitlab,subPlatformType:D.Gitlab_Vitepress,platformKey:"gitlab_Gitlabvitepress",platformName:"Gitlabvitepress",platformIcon:fe.iconIFVue,authMode:pe.API,isEnabled:!1}],metaweblogCfg:[{platformType:he.Metaweblog,subPlatformType:D.Metaweblog_Cnblogs,platformKey:"metaweblog_Cnblogs",platformName:"博客园",platformIcon:fe.iconIFCnblogs,authMode:pe.API,isEnabled:!1},{platformType:he.Metaweblog,subPlatformType:D.Metaweblog_Typecho,platformKey:"metaweblog_Typecho",platformName:"Typecho",platformIcon:fe.iconIFTypecho,authMode:pe.API,isEnabled:!1}],wordpressCfg:[{platformType:he.Wordpress,subPlatformType:D.Wordpress_Wordpress,platformKey:"wordpress_Wordpress",platformName:"Wordpress",platformIcon:fe.iconIFWordpress,authMode:pe.API,isEnabled:!1}],customCfg:[{platformType:he.Custom,subPlatformType:D.Custom_Zhihu,platformKey:"custom_Zhihu",platformName:"知乎",platformIcon:fe.iconIFZhihu,authMode:pe.WEBSITE,authUrl:"https://www.zhihu.com/signin",domain:"zhihu.com",isEnabled:!1},{platformType:he.Custom,subPlatformType:D.Custom_CSDN,platformKey:"custom_Csdn",platformName:"CSDN",platformIcon:fe.iconIFCSDN,authMode:pe.WEBSITE,authUrl:"https://passport.csdn.net/login",domain:"csdn.net",isEnabled:!1},{platformType:he.Custom,subPlatformType:D.Custom_Wechat,platformKey:"custom_Wechat",platformName:"微信公众号",platformIcon:fe.iconIFWechat,authMode:pe.WEBSITE,authUrl:"https://mp.weixin.qq.com/",domain:"qq.com",cookieLimit:!0,isEnabled:!1},{platformType:he.Custom,subPlatformType:D.Custom_Jianshu,platformKey:"custom_Jianshu",platformName:"简书",platformIcon:fe.iconIFJianshu,authMode:pe.WEBSITE,authUrl:"https://www.jianshu.com/sign_in",domain:"jianshu.com",isEnabled:!1},{platformType:he.Custom,subPlatformType:D.Custom_Juejin,platformKey:"custom_Juejin",platformName:"掘金",platformIcon:fe.iconIFJuejin,authMode:pe.WEBSITE,authUrl:"https://juejin.cn/login",domain:"juejin.cn",isEnabled:!1}],systemCfg:[{platformType:he.System,subPlatformType:D.System_Siyuan,platformKey:"system_Siyuan",platformName:"思源笔记",platformIcon:fe.iconIFSiyuan,authMode:pe.API,isEnabled:!0,isSys:!0}]},mr=r=>(et("data-v-1d11aa2a"),r=r(),tt(),r),hr=mr(()=>P("p",null,"请选择要发布的平台：",-1)),yr={class:"syp-distri-platform-container"},fr=["title","onClick"],_r=["innerHTML"],br=["innerHTML"],wr=["innerHTML"],Er=H({__name:"PublishPlatform",props:{id:{type:String,default:""}},emits:["emitSyncDynList"],setup(r,{emit:a}){const t=r,s=B("publish-platform"),{getSetting:e}=me(),o=xe.systemCfg.map(l=>l.platformKey),i=ae({dynamicConfigArray:[],selectedKeys:[].concat(o)});a&&(s.info("selectedKeys=>",i.selectedKeys),a("emitSyncDynList",i.selectedKeys));const n=l=>{var p;i.selectedKeys.includes(l)?i.selectedKeys=((p=i.selectedKeys)==null?void 0:p.filter(c=>c!==l))??[]:i.selectedKeys.push(l),a&&(s.info("selectedKeys=>",i.selectedKeys),a("emitSyncDynList",i.selectedKeys))};return qe(async()=>{var y;const l=await e(),c=(y=oe.safeParse(l[Me],{}).totalCfg)==null?void 0:y.filter(u=>u.isEnabled===!0&&u.isAuth===!0);i.dynamicConfigArray=c||[];const g=l[t.id]??{};i.dynamicConfigArray.forEach(u=>{const d=u.platformKey,b=ke(d);if(!A.isEmptyString(b)){const h=g[b]??"";A.isEmptyString(h)||n(d)}})}),(l,p)=>{const c=Ts;return w(),N("div",null,[hr,P("div",yr,[(w(!0),N(_e,null,Te(i.dynamicConfigArray,g=>(w(),N("a",{class:"distri-item",title:g.platformName,onClick:y=>n(g.platformKey)},[f(c,{class:"platform-icon"},{default:_(()=>[P("span",{innerHTML:g.platformIcon},null,8,_r)]),_:2},1024),i.selectedKeys.includes(g.platformKey)?(w(),N("span",{key:0,innerHTML:m(fe).iconOTYes},null,8,br)):(w(),N("span",{key:1,class:"icon-no",innerHTML:m(fe).iconOTNo},null,8,wr))],8,fr))),256))])])}}});const vr=ue(Er,[["__scopeId","data-v-1d11aa2a"]]);var He=(r=>(r.METHOD_ADD="add",r.METHOD_EDIT="edit",r))(He||{});const as=()=>{const{getSetting:r}=me(),a=new ge;return{getPublishCfg:async e=>{const o=await r(),i=oe.safeParse(o[Me],{}),n=(i==null?void 0:i.totalCfg)||[];if(e){const l=oe.safeParse(o[e],{}),p=await de.getCfg(e,l),c=qa(n,e);return{setting:o,dynamicConfigArray:n,cfg:p,dynCfg:c}}else return{setting:o,dynamicConfigArray:n,cfg:void 0,dynCfg:void 0}},getPublishApi:async(e,o)=>{const i=await de.getAdaptor(e,o);return C.blogApi(a,i)}}},ro=()=>{const r=B("use-publish"),{t:a}=K(),{updateSetting:t}=me(),{kernelApi:s,blogApi:e}=We(),{getPublishApi:o}=as(),i=ae({isPublishLoading:!1,publishProcessStatus:!1,isAdd:!0,errMsg:""}),n=async(y,u,d,b)=>{const h=d.setting,E=d.cfg;d.dynCfg;let v,T;try{const S=xe.systemCfg.some(J=>J.platformKey===y);if(r.info(`isSys=>${S}`),S)v=u;else{const J=E.posidKey;if(A.isEmptyString(J))throw new Error("配置错误，posidKey不能为空，请检查配置");const le=se.getProperty(h,u,{});v=se.getProperty(le,J)}i.isAdd=A.isEmptyString(v);const M=ye.cloneDeep(b);r.debug("准备开始发布处理, doc =>",{post:te(b)}),M.postid=v;const V=await o(y,E);r.info(`开始文章预处理, isAdd =>${i.isAdd}`),r.debug("post=>",te(M));const $=await V.preEditPost(M,u,d);if(r.info(`文章全部预处理完毕，id=${u},key=${y}`),r.debug("最终结果 =>",{finalPost:te($)}),i.isAdd){r.info("文章未发布，准备发布");const J=await V.newPost($);v=J;const le=E.posidKey,re=se.getProperty(h,u,{});re[le]=v,re[Ke.Custom_slug]=$.wp_slug,h[u]=re,await t(h),r.info("new post=>",J),r.info("文章发布成功")}else{r.info("文章已发布，准备更新");const J=await V.editPost(v,$),le=se.getProperty(h,u,{});le.hasOwnProperty(Ke.Custom_slug)?$.wp_slug=le[Ke.Custom_slug]:(r.info("检测到未生成过别名，准备更新别名"),le[Ke.Custom_slug]=$.wp_slug,h[u]=le,await t(h)),r.info("edit post=>",J),r.info("文章更新成功")}if(r.info("发布完成，准备处理文章属性"),S)r.info("内置平台，忽略保存属性");else{const J=St(y);await s.setSingleBlockAttr(u,J,$.yaml)}r.info("文章属性处理完成"),T=await c(V,v,E),i.publishProcessStatus=!0}catch(S){i.errMsg=a("main.opt.failure")+"=>"+S,await s.pushErrMsg({msg:i.errMsg,timeout:7e3}),i.publishProcessStatus=!1}return{key:y,status:i.publishProcessStatus,name:E==null?void 0:E.blogName,previewUrl:T,errMsg:i.errMsg}},l=async(y,u,d)=>{const b=d.setting,h=d.cfg;d.dynCfg;try{const E=h.posidKey;if(A.isEmptyString(E))throw new Error("配置错误，posidKey不能为空，请检查配置");const v=se.getProperty(b,u,{}),T=se.getProperty(v,E);if(A.isEmptyString(T))throw new Error("未找到postid，无法删除，请手动在平台删除");const S=await o(y,h);if(i.publishProcessStatus=await S.deletePost(T),i.publishProcessStatus){const V={...se.getProperty(b,u,{})};V.hasOwnProperty(E)&&delete V[E],V.hasOwnProperty(Ke.Custom_slug)&&delete V[Ke.Custom_slug],b[u]=V,await t(b),r.info(`[${y}] [${u}] 文章发布信息已移除`);const $=St(y);await s.setSingleBlockAttr(u,$,""),r.info(`[${y}] [${u}] 属性已移除`)}}catch(E){i.errMsg=a("main.opt.failure")+"=>"+E,await s.pushErrMsg({msg:i.errMsg,timeout:7e3})}return{key:y,status:i.publishProcessStatus,errMsg:i.errMsg}},p=async(y,u,d)=>{try{const b=d.setting,h=d.cfg,E=d.dynCfg,v=h.posidKey;if(A.isEmptyString(v))throw new Error("配置错误，posidKey不能为空，请检查配置");if(!A.isEmptyString(v)){const S={...se.getProperty(b,u,{})};S.hasOwnProperty(v)&&delete S[v],b[u]=S,await t(b);const M=St(y);await s.setSingleBlockAttr(u,M,""),r.info(`[${y}] [${u}] 属性已移除`),await s.pushMsg({msg:a("main.opt.ok"),timeout:2e3}),r.info(`[${y}] [${u}] 文章发布信息已强制移除`),Y.success(`[${y}] [${u}] 文章发布信息已强制移除`)}}catch(b){Y.error(a("main.opt.failure")+"=>"+b),r.error(a("main.opt.failure")+"=>",b),await s.pushErrMsg({msg:a("main.opt.failure")+"=>"+b,timeout:7e3})}},c=async(y,u,d)=>{const b=await y.getPreviewUrl(u);return/^http/.test(b)?b:`${(d==null?void 0:d.home)??""}${b}`},g={assignInitSlug:async(y,u,d)=>{const b=d.setting,h=se.getProperty(b,u,{}),E=ye.cloneDeep(y),v=se.getProperty(h,Ke.Custom_slug,E.wp_slug);if(!A.isEmptyString(v))E.wp_slug=v,r.info("Using existing siyuan note slug");else{const T=await Ca.getPageSlug(E.title,!0);E.wp_slug=`${T}`,r.info("Generated new slug")}return E.post_status=Pt.PostStatusEnum_Publish,E},assignInitAttrs:async(y,u,d)=>{d.setting;const b=d.cfg,E=d.dynCfg.platformKey,v=xe.systemCfg.some(M=>M.platformKey===E),T=await g.assignInitSlug(y,u,d);let S=ye.cloneDeep(T);if(S.title,!v){const M=St(E),V=await s.getSingleBlockAttr(u,M),$=Q.extractFrontmatter(V).trim(),J=await de.getYamlAdaptor(E,b);if(J!==null){let le;A.isEmptyString($)?(le=J.convertToYaml(S,b),r.info("YAML未保存，使用适配器生成默认的yamlFormatObj",{yamlFormatObj:te(le)}),S.yaml=V,S=J.convertToAttr(S,le,b),r.debug("使用适配器初始化转换yamlObj到post完成 =>",{post:te(S)})):r.info("有适配器且YAML已保存，无需处理")}else if(A.isEmptyString($))r.info("未保存过YAML，未找到适配器，默认不处理");else{const le=await Q.yaml2ObjAsync(V);S.yaml=V,Ya.fromYaml(S,le),r.info("读取已经存在的YAML，无适配器，使用fromYaml生成默认的yamlObj")}}return b.useMdFilename&&(S!=null&&S.mdFilename.includes(".md"))&&(S.title=S.mdFilename),S},doInitSinglePage:async(y,u,d=He.METHOD_ADD,b)=>{const h=b.setting,E=b.cfg;b.dynCfg;const v=E.posidKey;if(A.isEmptyString(v))throw new Error("配置错误，posidKey不能为空，请检查配置");const T=se.getProperty(h,u,{}),S=se.getProperty(T,v),M=await o(y,E);let V="",$={};const J=await e.getPost(u);if(d===He.METHOD_ADD)r.info("Add, using siyuan post"),$=ye.cloneDeep(J),$.mt_keywords=($==null?void 0:$.mt_keywords)??"",$.categories=($==null?void 0:$.categories)??[];else{if(r.info("Reading post from remote platform"),A.isEmptyString(S))throw new Error("未找到postid，将无法进行更新");const le=await M.getPost(S);$=ye.cloneDeep(le),r.debug("get init platformPost ok =>",$),$.title=le.title,$.markdown=J.markdown,$.html=J.html,$.description=J.description,$=g.doMergeBatchPost(J,$),V=await c(M,S,E)}return r.debug("doInitPage finished mergedPost =>",te($)),{mergedPost:$,postPreviewUrl:V}},doOverideBatchPost:(y,u)=>{const d=ye.cloneDeep(u);return d.title=y.title,d.shortDesc=y.shortDesc,d.mt_keywords=y.mt_keywords,d.categories=y.categories,d},doMergeBatchPost:(y,u)=>{var T,S;const d=ye.cloneDeep(u);A.isEmptyString(d.shortDesc)&&(d.shortDesc=d.mt_excerpt),A.isEmptyString(d.mt_excerpt)&&(d.mt_excerpt=d.shortDesc);const b=((T=y==null?void 0:y.mt_keywords)==null?void 0:T.split(","))??[],h=((S=u==null?void 0:u.mt_keywords)==null?void 0:S.split(","))??[],E=[...new Set([...b.map(M=>M.trim()),...h.map(M=>M.trim())])].filter(M=>M.trim()!=="");d.mt_keywords=E.join(",");const v=[...new Set([...((y==null?void 0:y.categories)??[]).map(M=>M.trim()),...((u==null?void 0:u.categories)??[]).map(M=>M.trim())])].filter(M=>M.trim()!=="");return d.categories=v,d}};return{singleFormData:i,doSinglePublish:n,doSingleDelete:l,doForceSingleDelete:p,initPublishMethods:g}};var Ge=(r=>(r[r.EditMode_simple=0]="EditMode_simple",r[r.EditMode_complex=1]="EditMode_complex",r[r.EditMode_source=2]="EditMode_source",r))(Ge||{});const Tr={class:"form-edit-mode"},si=H({__name:"EditModeSelect",props:{editType:{type:Number,default:Ge.EditMode_simple}},emits:["emitSyncEditMode"],setup(r,{emit:a}){const t=r,{t:s}=K(),e=ae({etype:t.editType});Ye(()=>t.editType,i=>{e.etype=i});const o=i=>{e.etype=i,a("emitSyncEditMode",i)};return(i,n)=>{const l=we,p=Li,c=Ee;return w(),N("div",Tr,[f(c,{label:m(s)("main.publish.editmode")},{default:_(()=>[f(p,null,{default:_(()=>[f(l,{type:e.etype===m(Ge).EditMode_simple?"primary":"default",onClick:n[0]||(n[0]=g=>o(m(Ge).EditMode_simple))},{default:_(()=>[G(L(m(s)("main.publish.editmode.simple")),1)]),_:1},8,["type"]),f(l,{type:e.etype===m(Ge).EditMode_complex?"primary":"default",onClick:n[1]||(n[1]=g=>o(m(Ge).EditMode_complex))},{default:_(()=>[G(L(m(s)("main.publish.editmode.complex")),1)]),_:1},8,["type"]),f(l,{type:e.etype===m(Ge).EditMode_source?"primary":"default",onClick:n[2]||(n[2]=g=>o(m(Ge).EditMode_source))},{default:_(()=>[G(L(m(s)("main.publish.editmode.source")),1)]),_:1},8,["type"])]),_:1})]),_:1},8,["label"])])}}}),Pr={class:"form-publish-time"},ai=H({__name:"PublishTime",props:{modelValue:{type:Object,default:{}}},emits:["emitSyncPublishTime"],setup(r,{emit:a}){var i,n,l;const t=r,{t:s}=K(),e=ae({dateCreatedString:Ae.formatIsoToZh((n=(i=t.modelValue)==null?void 0:i.dateCreated)==null?void 0:n.toISOString(),!0),dateUpdatedString:Ae.formatIsoToZh((((l=t.modelValue)==null?void 0:l.dateUpdated)??new Date).toISOString(),!0)}),o=()=>{const p=Ae.convertStringToDate(e.dateCreatedString),c=Ae.convertStringToDate(e.dateUpdatedString);a("emitSyncPublishTime",p,c)};return(p,c)=>{const g=ji,y=Ee;return w(),N("div",Pr,[f(y,{label:m(s)("main.create.time")},{default:_(()=>[f(g,{modelValue:e.dateCreatedString,"onUpdate:modelValue":c[0]||(c[0]=u=>e.dateCreatedString=u),placeholder:m(s)("main.create.time.placeholder"),format:"YYYY-MM-DD HH:mm:ss",type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",onChange:o},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),f(y,{label:m(s)("main.update.time")},{default:_(()=>[f(g,{modelValue:e.dateUpdatedString,"onUpdate:modelValue":c[1]||(c[1]=u=>e.dateUpdatedString=u),placeholder:m(s)("main.update.time.placeholder"),format:"YYYY-MM-DD HH:mm:ss",type:"datetime","value-format":"YYYY-MM-DD HH:mm:ss",onChange:o},null,8,["modelValue","placeholder"])]),_:1},8,["label"])])}}});var kt=(r=>(r.Override="Override",r.Merge="Merge",r))(kt||{});const kr={class:"form-post-title"},oi=H({__name:"PublishTitle",props:{useAi:{type:Boolean,default:!1},modelValue:{type:String,default:""},md:{type:String,default:""},html:{type:String,default:""}},emits:["emitSyncPublishTitle"],setup(r,{emit:a}){const t=r,s=B("publish-title"),{t:e}=K(),o=ae({postTitle:t.modelValue,isLoading:!1,useAi:t.useAi,md:t.md,html:t.html});Ye(()=>t.useAi,l=>{o.useAi=l}),Ye(()=>t.modelValue,l=>{o.postTitle=l}),Ye(()=>t.html,l=>{o.html=l});const i=()=>{a("emitSyncPublishTitle",o.postTitle)},n=async()=>{try{o.isLoading=!0;const l=Jt.titlePrompt.content,{chat:p}=ut(),c=await p(l,{name:"title",systemMessage:it.parseHtml(o.html,Ot.MAX_INPUT_TOKEN_LENGTH,!0)});if(A.isEmptyString(c)){Y.error("请求错误，请在偏好设置配置请求地址和ChatGPT key！");return}const g=oe.safeParse(c,{});if(A.isEmptyString(g==null?void 0:g.title))throw new Error("文档信息量太少，未能抽取有效信息");o.postTitle=g.title,s.info("使用AI智能生成的标题结果 =>",{inputWord:l,chatText:c}),a("emitSyncPublishTitle",o.postTitle),Y.success("使用人工智能提取标题成功")}catch(l){s.error(e("main.opt.failure")+"=>",l),Y.error(e("main.opt.failure")+"=>"+l)}finally{o.isLoading=!1}};return(l,p)=>{const c=be,g=Ee,y=we;return w(),N("div",kr,[f(g,{label:m(e)("main.title")},{default:_(()=>[f(c,{modelValue:o.postTitle,"onUpdate:modelValue":p[0]||(p[0]=u=>o.postTitle=u),onInput:i},null,8,["modelValue"])]),_:1},8,["label"]),o.useAi?(w(),k(g,{key:0},{default:_(()=>[f(y,{size:"small",loading:o.isLoading,type:"primary",onClick:n},{default:_(()=>[G(L(o.isLoading?m(e)("main.opt.loading"):m(e)("main.auto.fetch.title")),1)]),_:1},8,["loading"])]),_:1})):z("",!0)])}}}),Sr={id:"batch-publish-index"},Ar={class:"error-total-msg"},Cr=["onClick"],Dr={key:0,class:"success-result success-tips"},Ur={class:"platform"},Or=["href"],Mr={class:"publish-form"},Ir={key:2,class:"normal-mode"},xr={class:"distri-type"},Vr={key:0,class:"complex-mode"},Nr=H({__name:"BatchPublishIndex",props:{id:{type:String,default:""}},setup(r){const a=r,t=B("publisher-index"),{t:s}=K(),{doSinglePublish:e,doSingleDelete:o,doForceSingleDelete:i,initPublishMethods:n}=ro(),{blogApi:l}=We(),{getPublishCfg:p}=as(),{kernelApi:c}=We(),g=xe.systemCfg.map(F=>F.platformKey),y=A.isEmptyString(a.id)?{DEV_MODE:"false",DEBUG_MODE:"false",APP_BASE:"/plugins/siyuan-plugin-publisher/",NODE_ENV:"development",VITE_DEFAULT_TYPE:"siyuan"}.VITE_DEV_PAGE_ID:a.id,u=ae({isPublishLoading:!1,isDeleteLoading:!1,showProcessResult:!1,errCount:0,successBatchResults:[],failBatchResults:[],siyuanPost:{},publishCfg:{},categoryConfig:{},useAi:!1,dynList:[],editType:Ge.EditMode_simple,distriPattern:kt.Merge,actionEnable:!0}),d=async()=>{try{if(u.isPublishLoading=!0,u.dynList.length===0)throw new Error("必须选择一个分发平台");u.errCount=0,u.failBatchResults=[],u.successBatchResults=[];const F=ye.cloneDeep(u.siyuanPost);for(const j of u.dynList){let O;if(g.includes(j))t.info(`开始发布 [${j}] 系统内置平台`),O=F;else{t.info(`开始发布 [${j}] 自定义平台`);const X=await p(j);u.publishCfg=X,O=await n.assignInitAttrs(F,y,u.publishCfg),u.distriPattern===kt.Override?(O=n.doOverideBatchPost(F,O),t.debug("批量分发模式文章已覆盖",{siyuanPost:te(F),mergedPost:te(O)})):(O=n.doMergeBatchPost(F,O),t.debug("批量分发模式文章已合并",{siyuanPost:te(F),mergedPost:te(O)}))}const ie=await e(j,y,u.publishCfg,O);ie.status?u.successBatchResults.push(ie):(u.failBatchResults.push(ie),u.errCount++)}u.actionEnable=!1,u.showProcessResult=!0,u.errCount===0?Y.success("多平台文章分发成功"):Y.error(`多平台文章分发失败，失败个数：${u.errCount}`)}catch(F){const j=s("main.opt.failure")+"=>"+F;t.error(s("main.opt.failure")+"=>",F),await c.pushErrMsg({msg:j,timeout:7e3})}finally{u.isPublishLoading=!1}},b=async()=>{Kt.confirm(`确认要删除平台 ${u.dynList.join("、")} 下的这篇文章吗，此平台文章数据也将永久删除 [注意：系统内置平台会忽略，不做删除] ？`,"温馨提示",{type:"error",icon:Ft(Es),confirmButtonText:s("main.opt.ok"),cancelButtonText:s("main.opt.cancel")}).then(async()=>{await h()}).catch(()=>{})},h=async()=>{try{if(u.isDeleteLoading=!0,u.dynList.length===0)throw new Error("必须选择一个分发平台");u.errCount=0,u.failBatchResults=[],u.successBatchResults=[];for(const F of u.dynList){if(g.includes(F)){t.info(`[${F}] 系统内置平台，不可删除，跳过`);continue}const j=await p(F);u.publishCfg=j;const O=await o(F,y,j);O.status||(u.failBatchResults.push(O),u.errCount++)}u.actionEnable=!1,u.showProcessResult=!0,u.errCount===0?Y.success("多平台文章删除成功"):Y.error(`多平台文章删除失败，失败个数：${u.errCount}`)}catch(F){const j=s("main.opt.failure")+"=>"+F;t.error(s("main.opt.failure")+"=>",F),await c.pushErrMsg({msg:j,timeout:7e3})}finally{u.isDeleteLoading=!1}},E=async(F,j,O)=>{try{await i(F,j,O)}catch(ie){Y.error(ie.message)}finally{u.isDeleteLoading=!1}},v=async()=>{const F={[Ke.Sys_memo]:u.siyuanPost.shortDesc,[Ke.Sys_tags]:u.siyuanPost.mt_keywords,[Ke.Custom_categories]:u.siyuanPost.categories.join(",")};await c.setBlockAttrs(y,F),t.info("内置平台，保存属性",F),Y.success("属性已经成功同步到思源")},T=F=>{u.siyuanPost.title=F,t.debug("syncPublishTitle in batch publish")},S=async F=>{u.editType=F,t.debug("syncEditMode in batch publish")},M=F=>{u.dynList=F,t.debug("syncDynList in batch publish")},V=F=>{u.siyuanPost.shortDesc=F,u.siyuanPost.mt_text_more=F,u.siyuanPost.mt_excerpt=F,t.debug("syncDesc in batch publish")},$=F=>{u.siyuanPost.mt_keywords=F==null?void 0:F.join(","),t.debug("syncTags in batch publish")},J=F=>{u.siyuanPost.categories=F,t.debug("syncCates in batch publish")},le=(F,j)=>{u.siyuanPost.dateCreated=F,u.siyuanPost.dateUpdated=j,t.debug("syncPublishTime in batch publish")},re=()=>{ht.reloadPage()},ve=()=>{let F=!1,j=0;for(;!F&&j<3;)try{ut(),F=!0}catch(O){t.error(`${s("main.opt.failure")} => ${O}`),j++}return t.info(`第${j}次尝试就检测AI状态: ${F}`),F};return qe(async()=>{u.publishCfg=await p();const F=await l.getPost(y);u.siyuanPost=await n.assignInitSlug(F,y,u.publishCfg),t.debug("batch inited siyuanPost =>",te(u.siyuanPost)),u.useAi=ve(),u.editType=Ge.EditMode_simple}),(F,j)=>{const O=Ie,ie=ti,X=bo,Ve=wo,De=Ee,ne=Eo,Ue=be,Fe=Go,lt=Bo,I=Xn,U=we,Se=Re,Le=vo,gt=To;return w(),N("div",Sr,[f(gt,null,{default:_(()=>[f(Le,null,{default:_(()=>[f(gr),u.showProcessResult?(w(),N("div",{key:0,class:_t(u.errCount>0?"batch-result fail-tips":"batch-result success-tips")},[P("div",Ar,[G(" 错误平台个数 ["+L(u.errCount)+"] ，选择的总平台数 ["+L(u.dynList.length)+"] 。 ",1),P("a",{class:"refresh-page",onClick:re},"刷新页面")]),(w(!0),N(_e,null,Te(u.failBatchResults,W=>(w(),N("div",null,[G(" ["+L(W.key)+"] "+L(m(A).isEmptyString(W.name)?"":`[${W.name}]`)+" "+L(W.errMsg)+" ",1),P("a",{href:"javascript:void(0)",onClick:dt=>E(W.key,a.id,u.publishCfg)},"强制解除关联",8,Cr)]))),256)),u.successBatchResults.length>0?(w(),N("div",Dr,[G(" 已分发成功的结果如下： "),(w(!0),N(_e,null,Te(u.successBatchResults,W=>(w(),N("p",null,[P("span",Ur,"["+L(W.key)+"] "+L(m(A).isEmptyString(W.name)?"":`[${W.name}]`),1),G(" ， "),P("a",{href:W.previewUrl,target:"_blank"},"查看文章",8,Or)]))),256))])):z("",!0)],2)):z("",!0),P("div",Mr,[f(Se,{"label-width":"100px"},{default:_(()=>[u.useAi?(w(),k(O,{key:0,class:"top-tip",title:m(s)("category.ai.enabled"),type:"success",closable:!1},null,8,["title"])):z("",!0),f(si,{"edit-type":u.editType,"onUpdate:editType":j[0]||(j[0]=W=>u.editType=W),onEmitSyncEditMode:S},null,8,["edit-type"]),u.editType===m(Ge).EditMode_source?(w(),k(ie,{key:1,modelValue:u.siyuanPost,"onUpdate:modelValue":j[1]||(j[1]=W=>u.siyuanPost=W),"page-id":m(y)},null,8,["modelValue","page-id"])):(w(),N("div",Ir,[f(oi,{"use-ai":u.useAi,"onUpdate:useAi":j[2]||(j[2]=W=>u.useAi=W),modelValue:u.siyuanPost.title,"onUpdate:modelValue":j[3]||(j[3]=W=>u.siyuanPost.title=W),onEmitSyncPublishTitle:T,md:u.siyuanPost.markdown,"onUpdate:md":j[4]||(j[4]=W=>u.siyuanPost.markdown=W),html:u.siyuanPost.html,"onUpdate:html":j[5]||(j[5]=W=>u.siyuanPost.html=W)},null,8,["use-ai","modelValue","md","html"]),P("div",xr,[f(De,{label:"分发模式"},{default:_(()=>[f(Ve,{modelValue:u.distriPattern,"onUpdate:modelValue":j[6]||(j[6]=W=>u.distriPattern=W),class:"ml-4 distri-type-check"},{default:_(()=>[f(X,{label:m(kt).Override,size:"large"},{default:_(()=>[G("覆盖")]),_:1},8,["label"]),f(X,{label:m(kt).Merge,size:"large"},{default:_(()=>[G("合并")]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1}),f(De,{class:"distri-tip"},{default:_(()=>[u.distriPattern===m(kt).Override?(w(),k(O,{key:0,closable:!1,title:m(s)("distri.type.overide.warn"),class:"distri-tip-alert",type:"error"},null,8,["title"])):(w(),k(O,{key:1,closable:!1,title:m(s)("distri.type.merge.warn"),class:"distri-tip-alert",type:"warning"},null,8,["title"]))]),_:1})]),f(ne,{"border-style":"dashed"}),u.editType===m(Ge).EditMode_complex?(w(),N("div",Vr,[f(De,{label:m(s)("main.slug")},{default:_(()=>[f(Ue,{modelValue:u.siyuanPost.wp_slug,"onUpdate:modelValue":j[7]||(j[7]=W=>u.siyuanPost.wp_slug=W),disabled:!0},null,8,["modelValue"])]),_:1},8,["label"]),f(Fe,{"use-ai":u.useAi,"onUpdate:useAi":j[8]||(j[8]=W=>u.useAi=W),"page-id":m(y),"onUpdate:pageId":j[9]||(j[9]=W=>At(y)?y.value=W:null),desc:u.siyuanPost.shortDesc,"onUpdate:desc":j[10]||(j[10]=W=>u.siyuanPost.shortDesc=W),md:u.siyuanPost.markdown,"onUpdate:md":j[11]||(j[11]=W=>u.siyuanPost.markdown=W),html:u.siyuanPost.html,"onUpdate:html":j[12]||(j[12]=W=>u.siyuanPost.html=W),onEmitSyncDesc:V},null,8,["use-ai","page-id","desc","md","html"]),f(lt,{"use-ai":u.useAi,"onUpdate:useAi":j[13]||(j[13]=W=>u.useAi=W),"page-id":m(y),"onUpdate:pageId":j[14]||(j[14]=W=>At(y)?y.value=W:null),tags:u.siyuanPost.mt_keywords,"onUpdate:tags":j[15]||(j[15]=W=>u.siyuanPost.mt_keywords=W),md:u.siyuanPost.markdown,"onUpdate:md":j[16]||(j[16]=W=>u.siyuanPost.markdown=W),html:u.siyuanPost.html,"onUpdate:html":j[17]||(j[17]=W=>u.siyuanPost.html=W),onEmitSyncTags:$},null,8,["use-ai","page-id","tags","md","html"]),f(I,{"use-ai":u.useAi,"onUpdate:useAi":j[18]||(j[18]=W=>u.useAi=W),cates:u.siyuanPost.categories,"onUpdate:cates":j[19]||(j[19]=W=>u.siyuanPost.categories=W),onEmitSyncCates:J,md:u.siyuanPost.markdown,"onUpdate:md":j[20]||(j[20]=W=>u.siyuanPost.markdown=W),html:u.siyuanPost.html,"onUpdate:html":j[21]||(j[21]=W=>u.siyuanPost.html=W)},null,8,["use-ai","cates","md","html"]),f(ai,{modelValue:u.siyuanPost,"onUpdate:modelValue":j[22]||(j[22]=W=>u.siyuanPost=W),onEmitSyncPublishTime:le},null,8,["modelValue"]),f(ne,{"border-style":"dashed"})])):z("",!0)])),f(vr,{id:a.id,onEmitSyncDynList:M},null,8,["id"]),f(ne,{"border-style":"dashed"}),f(De,{"label-width":"100px",class:"form-action"},{default:_(()=>[f(U,{type:"primary",loading:u.isPublishLoading,onClick:d,disabled:!u.actionEnable},{default:_(()=>[G(L(m(s)("main.publish.start")),1)]),_:1},8,["loading","disabled"]),f(U,{type:"danger",loading:u.isDeleteLoading,onClick:b,disabled:!u.actionEnable,class:"btn-rm-action"},{default:_(()=>[G(L(m(s)("main.publish.remove")),1)]),_:1},8,["loading","disabled"]),f(U,{type:"warning",onClick:v,disabled:!u.actionEnable},{default:_(()=>[G(" 同步修改到思源笔记 ")]),_:1},8,["disabled"])]),_:1})]),_:1})])]),_:1})]),_:1})])}}});const Br=ue(Nr,[["__scopeId","data-v-aa10d1e2"]]),Tt=B("widget-utils"),uo=(r,a,t)=>{const{isInSiyuanWidget:s}=wt();s()?Gr(r,void 0,void 0,!1,!1,!t,a,t):window.open(r)},Gr=(r,a,t,s=!1,e=!1,o=!0,i,n=void 0)=>{try{if(A.isEmptyString(r)){Tt.error("Url cannot be empty");return}const{isInSiyuanWidget:l}=wt();if(!ht.isElectron()&&!l){Tt.info("BrowserWindow can ony be available in siyuan Electron environment");return}a&&Object.keys(a).forEach(h=>{const E=a[h];r=ht.setUrlParameter(r,h,E)}),Tt.info(A.f("Opening a new BrowserWindow from url => {0}",r));const p=t??mt.siyuanWindow(),{app:c,BrowserWindow:g,getCurrentWindow:y}=p.require("@electron/remote"),u=p.require("@electron/remote").require("@electron/remote/main"),d=y(),b=new g({parent:d,width:900,height:750,show:o,resizable:!0,modal:e,icon:mt.browserJoinPath(mt.siyuanWindow().siyuan.config.system.appDir,"stage","icon-large.png"),titleBarOverlay:{color:"#cccccca5",symbolColor:"black"},webPreferences:{nativeWindowOpen:!0,nodeIntegration:!0,webviewTag:!0,webSecurity:!1,contextIsolation:!1}});b.webContents.userAgent=`SiYuan/${c.getVersion()} https://b3log.org/siyuan Electron`,u.enable(b.webContents),s&&b.webContents.openDevTools(),b.on("close",h=>{Tt.info("窗口关闭事件触发")}),b.loadURL(r),n&&((()=>{const E=b.webContents.session,v=i.domain;E.cookies.get({domain:v}).then(async T=>{Tt.info(`读取cookie事件触发，准备读取 ${v} 下的所有 Cookie`),await n(i,T)}).catch(T=>{console.error(`读取 Cookie 失败：${T}`)})})(),b.hide(),b.close())}catch(l){Tt.error("Open browser window failed",l)}},$r=r=>{const a=r.querySelector("div.protyle:not(.fn__none)"),t=a==null?void 0:a.querySelector("div.protyle-title");return t==null?void 0:t.getAttribute("data-node-id")},os=()=>{const r=window.parent.document;return $r(r)},go=H({__name:"BatchPublish",setup(r){const{query:a}=$e(),t=a.id??os();return(s,e)=>(w(),k(Br,{id:m(t)},null,8,["id"]))}}),Lr={class:"platform-desc"},jr={class:"icon-list"},Hr={class:"el-icon"},Rr=["innerHTML"],Fr=H({__name:"SinglePublishSelectPlatform",props:{id:{type:String,default:""}},setup(r){const a=r,t=B("single-publish-select-platform");K();const s=ct(),{getSetting:e}=me(),o=ae({enabledConfigArray:[],postMeta:{}}),i=p=>{const c=n(p)?"edit":"add",g=`/publish/singlePublish/doPublish/${p}/${a.id}`;t.info("will go to =>",g);const y={path:g,query:{showBack:"true",method:c}};s.push(y)},n=p=>{const c=ke(p),g=se.getProperty(o.postMeta,c);return!A.isEmptyString(g)},l=async()=>{const p=await e(),c=oe.safeParse(p[Me],{}),g=(c==null?void 0:c.totalCfg)||[];o.enabledConfigArray=g.filter(y=>y.isEnabled&&y.isAuth),o.postMeta=se.getProperty(p,a.id,{})};return qe(async()=>{await l()}),(p,c)=>{const g=Ie,y=Fa,u=Po,d=Ka,b=ko,h=So;return w(),N(_e,null,[P("div",Lr,[P("p",null,[f(g,{class:"desc-tip",type:"warning",title:"点击图标进入对应平台的发布页面"})])]),f(h,{gutter:20,class:"row-box"},{default:_(()=>[(w(!0),N(_e,null,Te(o.enabledConfigArray,E=>(w(),k(b,{span:8,title:E.platformName,class:"platform-select-card",onClick:v=>i(E.platformKey)},{default:_(()=>[f(d,{class:"card-item"},{default:_(()=>[P("div",jr,[f(u,{type:n(E.platformKey)?"success":"danger",value:n(E.platformKey)?"已发布":"未发布",class:"item"},{default:_(()=>[f(y,{class:"define-item"},{default:_(()=>[P("i",Hr,[P("span",{innerHTML:E==null?void 0:E.platformIcon},null,8,Rr)]),G(" "+L(m(A).upperFirst(m(it).parseHtml(E.platformName,11))),1)]),_:2},1024)]),_:2},1032,["type","value"])])]),_:2},1024)]),_:2},1032,["title","onClick"]))),256))]),_:1})],64)}}});const Kr=ue(Fr,[["__scopeId","data-v-ae3dc054"]]),Yr=H({__name:"SinglePublish",setup(r){const{query:a}=$e(),t=a.id??os();return(s,e)=>(w(),k(Kr,{id:m(t)},null,8,["id"]))}}),zr={key:0,class:"multi-categories"},Wr=H({__name:"MultiCategories",props:{categoryConfig:{type:Object,default:{}},categories:{type:Array,default:[]}},emits:["emitSyncMultiCates"],setup(r,{emit:a}){const t=r,s=B("multi-categories"),{t:e}=K(),o=ae({categoryConfig:t.categoryConfig,categories:t.categories,useRemoteData:!A.isEmptyString(t.categoryConfig.apiType),cate:{categorySelected:[],categoryList:[]}}),i=(g,y,u,d)=>{},n=(g,y)=>{s.debug("checked item=>",{data:te(g),status:te(y)});const u=[];y.checkedKeys.forEach(b=>{u.push(b.toString())}),o.categories=u,s.debug(" formData.categories=>",{categories:te(o.categories)}),a("emitSyncMultiCates",u)},l=g=>{const y=g;s.debug("准备删除 =>",y);const u=o.categories.filter(d=>d!==y);o.categories=u,s.debug("formData.categories=>",{categories:te(o.categories)}),a("emitSyncMultiCates",u)},p=g=>{const y=g;s.debug("选中项已改变 =>",y),a("emitSyncMultiCates",y)},c=async()=>{if(o.categoryConfig.cateEnabled){let g=[];if(s.debug(`useRemoteData => ${o.useRemoteData}`),o.useRemoteData){const y=o.categoryConfig.cfg;if(g=await(await de.getAdaptor(o.categoryConfig.apiType,y)).getCategories(),g.length===0&&(g=o.categories.map(d=>{const b=new Qe;return b.categoryId=d,b.categoryName=d,b})),s.debug("getCategories for multi categories",g),g.length>0){o.cate.categoryList=g.map(b=>({value:b.categoryName,label:b.categoryName})),s.debug("get multi categoryList =>",{categoryList:te(o.cate.categoryList)});const d=o.categories;o.cate.categorySelected=d,a("emitSyncMultiCates",d),s.debug("muti cates is syncing =>",{cates:te(d)})}}else{const y=o.categories??[];g=y.map(u=>{const d=new Qe;return d.categoryId=u,d.categoryName=u,d.categoryDescription=u,d}),g.length>0&&(o.cate.categoryList=g.map(u=>({value:u.categoryId,label:u.categoryName})),o.cate.categorySelected=y),s.debug("读取已有分类 =>",{cates:te(y)})}}};return qe(async()=>{await c()}),(g,y)=>{const u=Ao,d=Ee;return o.categoryConfig.cateEnabled?(w(),N("div",zr,[f(d,{label:m(e)("main.cat")},{default:_(()=>[f(u,{style:{width:"100%"},modelValue:o.cate.categorySelected,"onUpdate:modelValue":y[0]||(y[0]=b=>o.cate.categorySelected=b),data:o.cate.categoryList,filterable:"","allow-create":"",multiple:"","check-on-click-node":!0,"render-after-expand":!1,"show-checkbox":"",placeholder:m(e)("main.cat.select"),"empty-text":m(e)("main.cat.empty"),"no-data-text":m(e)("main.cat.empty"),disabled:o.categoryConfig.readonlyMode,onNodeClick:i,onCheck:n,onRemoveTag:l,onChange:p},null,8,["modelValue","data","placeholder","empty-text","no-data-text","disabled"])]),_:1},8,["label"])])):z("",!0)}}});const qr=ue(Wr,[["__scopeId","data-v-067d018f"]]),Jr=r=>(et("data-v-a73ebeae"),r=r(),tt(),r),Xr={class:"category-box"},Zr={key:0},Qr={key:1},ec={key:2},tc=Jr(()=>P("div",{class:"form-item-bottom"},null,-1)),sc=H({__name:"PublishCategories",props:{useAi:{type:Boolean,default:!1},categoryType:{type:String,default:R.CategoryType_None},categoryConfig:{type:Object,default:{}},categories:{type:Array,default:[]},md:{type:String,default:""},html:{type:String,default:""}},emits:["emitSyncCates"],setup(r,{emit:a}){const t=r,s=B("publish-categories"),{t:e}=K(),o=ae({useAi:t.useAi,categoryType:t.categoryType,categoryConfig:t.categoryConfig,categories:t.categories,isLoading:!1,recommCates:[],md:t.md,html:t.html});Ye(()=>t.useAi,l=>{o.useAi=l}),Ye(()=>t.html,l=>{o.html=l});const i=l=>{s.debug("sync single cates =>",{cates:te(l)}),o.categories=l,a("emitSyncCates",l)},n=async()=>{try{o.isLoading=!0;const l=Jt.categoryPrompt.content,{chat:p}=ut(),c=await p(l,{name:"categories",systemMessage:it.parseHtml(o.html,Ot.MAX_INPUT_TOKEN_LENGTH,!0)});if(A.isEmptyString(c)){Y.error("请求错误，请在偏好设置配置请求地址和ChatGPT key！");return}const g=oe.safeParse(c,{});if(!(g!=null&&g.categories)||(g==null?void 0:g.categories.length)==0)throw new Error("文档信息量太少，未能抽取有效信息");o.recommCates=g.categories,s.info("使用AI智能生成的分类结果 =>",{inputWord:l,chatText:c})}catch(l){s.error(e("main.opt.failure")+"=>",l),Y.error(e("main.opt.failure")+"=>"+l)}finally{o.isLoading=!1}};return(l,p)=>{const c=qr,g=Ra,y=Ee,u=we,d=Ie;return w(),N("div",Xr,[o.categoryType===m(R).CategoryType_Multi?(w(),N("div",Zr,[f(c,{"category-config":o.categoryConfig,"onUpdate:categoryConfig":p[0]||(p[0]=b=>o.categoryConfig=b),categories:o.categories,"onUpdate:categories":p[1]||(p[1]=b=>o.categories=b),onEmitSyncMultiCates:i},null,8,["category-config","categories"])])):(w(),N("div",Qr)),o.useAi&&o.categoryConfig.cateEnabled?(w(),N("div",ec,[o.recommCates.length>0?(w(),k(y,{key:0,class:"recomm-show"},{default:_(()=>[G(" 推荐的分类： "),(w(!0),N(_e,null,Te(o.recommCates,b=>(w(),k(g,{class:"ml-2 recomm-cate",type:"success"},{default:_(()=>[G(L(b),1)]),_:2},1024))),256))]),_:1})):z("",!0),f(y,{class:"cat-action"},{default:_(()=>[f(u,{size:"small",loading:o.isLoading,type:"primary",onClick:n},{default:_(()=>[G(L(o.isLoading?m(e)("main.opt.loading"):m(e)("main.auto.fetch.cate")),1)]),_:1},8,["loading"])]),_:1}),f(y,null,{default:_(()=>[f(d,{closable:!1,title:m(e)("category.ai.hand"),class:"form-item-tip",type:"warning"},null,8,["title"])]),_:1}),tc])):z("",!0)])}}});const ac=ue(sc,[["__scopeId","data-v-a73ebeae"]]),oc=r=>(et("data-v-03712654"),r=r(),tt(),r),ic={key:1,class:"single-tag-slug"},nc=oc(()=>P("div",{class:"form-item-bottom"},null,-1)),lc=H({__name:"SingleTagSlug",props:{cfg:{type:Object,default:{}},apiType:{type:String,default:""},tagSlugs:{type:String,default:""}},emits:["emitSyncTagSlugs"],setup(r,{emit:a}){const t=r,s=B("single-tag-slugs");K();const e=ae({cfg:t.cfg,apiType:t.apiType,tagSlugs:A.isEmptyString(t.tagSlugs)?[]:t.tagSlugs.split(","),tag:{tagSelected:"",tagList:[]},isInit:!1}),o=n=>{const l=n;s.debug("value=>",l),s.debug("label=>",l);const p=[];p.push(l),e.tagSlugs=p,s.debug("cateSlugs=>",e.tagSlugs),a("emitSyncTagSlugs",p)},i=async()=>{var c;let n=[];const l=e.cfg;n=await(await de.getAdaptor(e.apiType,l)).getTags(),s.debug("getTags for single slug tag",n),n.length>0&&(e.tag.tagList=n.map(g=>({value:g.tagId,label:g.tagName})),e.tag.tagSelected=((c=e.tagSlugs)==null?void 0:c[0])??"",s.debug("读取已有别名标签 =>",{tagSlugs:te(e.tagSlugs)}))};return qe(async()=>{try{await i()}catch(n){s.error("别名标签加载失败",n)}finally{e.isInit=!0}}),(n,l)=>{const p=qt,c=Je,g=Xe,y=Ee;return e.isInit?(w(),N("div",ic,[f(y,{label:"标签"},{default:_(()=>[f(g,{modelValue:e.tag.tagSelected,"onUpdate:modelValue":l[0]||(l[0]=u=>e.tag.tagSelected=u),placeholder:"请选择","no-data-text":"暂无数据",class:"m-2",size:"default",onChange:o},{default:_(()=>[(w(!0),N(_e,null,Te(e.tag.tagList,u=>(w(),k(c,{key:u.value,label:u.label,value:u.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1}),nc])):(w(),k(p,{key:0,class:"placeholder",rows:1,animated:""}))}}});const rc=ue(lc,[["__scopeId","data-v-03712654"]]),cc={id:"page-body"},pc={key:0,class:"page-head"},uc={class:"flex items-center"},gc={class:"text-large font-600 mr-3"},dc={class:"page-content-box"},mc=H({__name:"BackPage",props:{title:{type:String,default:""},hasBackEmit:{type:Boolean,default:!1}},emits:["backEmit"],setup(r,{emit:a}){const t=r,s=B("back-page");K();const e=ct();$e();const{query:o}=$e(),i=Z(o.showBack==="true"),n=()=>{a&&t.hasBackEmit?(s.info("using backEmit do back"),a("backEmit")):(s.warn("no backEmit, using router handle back"),e.back())};return(l,p)=>{const c=Hi;return w(),N("div",cc,[i.value?(w(),N("div",pc,[f(c,{icon:m(Ci),title:"返回",onClick:n},{content:_(()=>[P("div",uc,[P("span",gc,L(t.title),1)])]),_:1},8,["icon"])])):z("",!0),P("div",dc,[rt(l.$slots,"default",{},void 0,!0)])])}}});const Oe=ue(mc,[["__scopeId","data-v-cf41ea16"]]),hc=r=>(et("data-v-82be54cc"),r=r(),tt(),r),yc={key:0,class:"tree-single-cateslugs"},fc=hc(()=>P("div",{class:"form-item-bottom"},null,-1)),_c=H({__name:"TreeSingleKnowledgeSpace",props:{knowledgeSpaceConfig:{type:Object,default:{}},cateSlugs:{type:Array,default:[]}},emits:["emitSyncTreeSingleCateSlugs"],setup(r,{emit:a}){const t=r,s=B("tree-single-cateslugs"),{t:e}=K(),o=ae({knowledgeSpaceConfig:t.knowledgeSpaceConfig,cateSlugs:t.cateSlugs,path:{customPath:"",cacheData:[],customProps:{label:"label",children:"children",isLeaf:"isLeaf"}}}),i=async(l,p)=>{if(l.isLeaf)return p([]);const c=o.knowledgeSpaceConfig.cfg,g=await de.getAdaptor(o.knowledgeSpaceConfig.apiType,c);let y,u=l.data.value||"";u===""&&o.path.customPath!==""?y="":(u===""&&(u=""),y=u);const d=await g.getCategoryTreeNodes(y);p(d)},n=l=>{if(s.debug("onSelectChange=>",l),l.isLeaf){Y.error("您当前选择的是页面，请注意，页面必须发布在目录下");return}const p=l.value,c=[];c.push(p),a("emitSyncTreeSingleCateSlugs",c)};return qe(()=>{var p,c,g;const l=((p=o.cateSlugs)==null?void 0:p[0])??((g=(c=o.knowledgeSpaceConfig)==null?void 0:c.cfg)==null?void 0:g.blogid);o.path.customPath=l,s.debug("init tree data, cateSlugs =>",{cateSlugs:te(o.cateSlugs)})}),(l,p)=>{const c=Ao,g=Ee,y=Ie;return o.knowledgeSpaceConfig.cateEnabled?(w(),N("div",yc,[f(g,{label:m(e)("main.publish.github.choose.path")},{default:_(()=>[f(c,{modelValue:o.path.customPath,"onUpdate:modelValue":p[0]||(p[0]=u=>o.path.customPath=u),lazy:"",load:i,props:o.path.customProps,"check-strictly":!0,"empty-text":m(e)("main.data.empty"),"no-data-text":m(e)("main.data.empty"),placeholder:m(e)("main.opt.select"),disabled:o.knowledgeSpaceConfig.readonlyMode,onNodeClick:n},null,8,["modelValue","props","empty-text","no-data-text","placeholder","disabled"])]),_:1},8,["label"]),o.knowledgeSpaceConfig.readonlyMode?(w(),k(g,{key:0},{default:_(()=>[f(y,{closable:!1,title:o.knowledgeSpaceConfig.cfg.placeholder.knowledgeSpaceReadonlyModeTip,class:"form-item-tip",type:"warning"},null,8,["title"])]),_:1})):z("",!0),fc])):z("",!0)}}});const bc=ue(_c,[["__scopeId","data-v-82be54cc"]]),wc=r=>(et("data-v-cb12f217"),r=r(),tt(),r),Ec={key:1,class:"single-knowledge-space"},vc=wc(()=>P("div",{class:"form-item-bottom"},null,-1)),Tc=H({__name:"SingleKnowledgeSpace",props:{knowledgeSpaceConfig:{type:Object,default:{}},cateSlugs:{type:Array,default:[]}},emits:["emitSyncSingleCateSlugs"],setup(r,{emit:a}){const t=r,s=B("single-knowledge-space"),{t:e}=K(),o=Z(null),i=ae({knowledgeSpaceConfig:t.knowledgeSpaceConfig,cateSlugs:t.cateSlugs,cate:{categorySelected:"",categoryList:[]},ksKeyword:"",isCateLoading:!1,isInit:!1}),n=Ha(()=>{var y;return((y=i==null?void 0:i.knowledgeSpaceConfig)==null?void 0:y.cfg.knowledgeSpaceTitle)??e("main.cat")}),l=g=>{const y=g;s.debug("value=>",y),s.debug("label=>",y);const u=[];u.push(y),i.cateSlugs=u,s.debug("cateSlugs=>",i.cateSlugs),a("emitSyncSingleCateSlugs",u)},p=async()=>{try{i.isCateLoading=!0,s.debug("reload categories for single category woth search"),i.cate.categoryList=[],i.cate.categorySelected=void 0,await c(!1),o.value.visible=!0}catch(g){s.error("知识空间加载失败",g)}finally{i.isCateLoading=!1,i.isInit=!0}},c=async g=>{var b;let y=[];const u=i.knowledgeSpaceConfig.cfg;y=await(await de.getAdaptor(i.knowledgeSpaceConfig.apiType,u)).getCategories(i.ksKeyword),s.debug("getCategories for single category",y),y.length>0&&(i.cate.categoryList=y.map(h=>({value:h.categoryId,label:h.categoryName})),g&&(i.cate.categorySelected=((b=i.cateSlugs)==null?void 0:b[0])??u.blogid??"",s.debug("读取已有知识空间 =>",{cateSlugs:te(i.cateSlugs)})))};return qe(async()=>{try{i.isCateLoading=!0,await c(!0)}catch(g){s.error("知识空间加载失败",g)}finally{i.isCateLoading=!1,i.isInit=!0}}),(g,y)=>{var T,S;const u=qt,d=be,b=Ee,h=Je,E=Xe,v=Ie;return i.isInit?(w(),N("div",Ec,[!i.knowledgeSpaceConfig.readonlyMode&&((S=(T=i.knowledgeSpaceConfig)==null?void 0:T.cfg)!=null&&S.cateSearchEnabled)?(w(),k(b,{key:0,class:"cate-input",label:"搜索关键词"},{default:_(()=>[f(d,{modelValue:i.ksKeyword,"onUpdate:modelValue":y[0]||(y[0]=M=>i.ksKeyword=M),placeholder:"请输入["+n.value+"]搜索关键词，输入完成后请按Enter键或者移走光标",onChange:p},null,8,["modelValue","placeholder"])]),_:1})):z("",!0),f(b,{label:n.value},{default:_(()=>[f(E,{modelValue:i.cate.categorySelected,"onUpdate:modelValue":y[1]||(y[1]=M=>i.cate.categorySelected=M),placeholder:"请选择","no-data-text":"暂无数据",class:"m-2",size:"default",onChange:l,disabled:i.knowledgeSpaceConfig.readonlyMode,loading:i.isCateLoading,"loading-text":"加载中...",ref_key:"singleCateSelect",ref:o},{default:_(()=>[(w(!0),N(_e,null,Te(i.cate.categoryList,M=>(w(),k(h,{key:M.value,label:M.label,value:M.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","disabled","loading"])]),_:1},8,["label"]),i.knowledgeSpaceConfig.readonlyMode?(w(),k(b,{key:1},{default:_(()=>[f(v,{closable:!1,title:t.knowledgeSpaceConfig.readonlyModeTip,class:"form-item-tip",type:"warning"},null,8,["title"])]),_:1})):z("",!0),vc])):(w(),k(u,{key:0,class:"placeholder",rows:1,animated:""}))}}});const Pc=ue(Tc,[["__scopeId","data-v-cb12f217"]]),kc={key:0},Sc={key:1},Ac={key:2},Cc=H({__name:"PublishKnowledgeSpace",props:{knowledgeSpaceType:{type:String,default:R.CategoryType_None},knowledgeSpaceConfig:{type:Object,default:{}},cateSlugs:{type:Array,default:[]}},emits:["emitSyncCateSlugs"],setup(r,{emit:a}){const t=r,s=B("publish-categories"),e=ae({knowledgeSpaceType:t.knowledgeSpaceType,knowledgeSpaceConfig:t.knowledgeSpaceConfig,cateSlugs:t.cateSlugs}),o=i=>{s.debug("sync single cateSlugs =>",{cateSlugs:te(i)}),a("emitSyncCateSlugs",i)};return(i,n)=>{const l=Pc,p=bc;return e.knowledgeSpaceType===m(R).CategoryType_Single?(w(),N("div",kc,[f(l,{"knowledge-space-config":e.knowledgeSpaceConfig,"onUpdate:knowledgeSpaceConfig":n[0]||(n[0]=c=>e.knowledgeSpaceConfig=c),"cate-slugs":e.cateSlugs,"onUpdate:cateSlugs":n[1]||(n[1]=c=>e.cateSlugs=c),onEmitSyncSingleCateSlugs:o},null,8,["knowledge-space-config","cate-slugs"])])):e.knowledgeSpaceType===m(R).CategoryType_Tree_Single?(w(),N("div",Sc,[f(p,{"knowledge-space-config":e.knowledgeSpaceConfig,"onUpdate:knowledgeSpaceConfig":n[2]||(n[2]=c=>e.knowledgeSpaceConfig=c),"cate-slugs":e.cateSlugs,"onUpdate:cateSlugs":n[3]||(n[3]=c=>e.cateSlugs=c),onEmitSyncTreeSingleCateSlugs:o},null,8,["knowledge-space-config","cate-slugs"])])):(w(),N("div",Ac))}}}),Dc={key:1,id:"batch-publish-index"},Uc={class:"publish-form"},Oc={key:1,class:"normal-mode"},Mc={key:2,class:"complex-mode"},Ic=["href","title"],xc=H({__name:"SinglePublishDoPublish",setup(r){const a=B("single-publish-do-publish"),{t}=K(),s=$e(),{query:e}=$e(),{kernelApi:o}=We(),{doSinglePublish:i,doSingleDelete:n,initPublishMethods:l,doForceSingleDelete:p}=ro(),c=ct(),{getPublishCfg:g}=as(),y=xe.systemCfg.map(I=>I.platformKey),u=ae(s.params),d=u.key,b=u.id,h=ae({isInit:!1,method:e.method,isPublishLoading:!1,isDeleteLoading:!1,siyuanPost:{},platformPost:{},mergedPost:{},publishCfg:{},categoryConfig:{},knowledgeSpaceConfig:{},postPreviewUrl:"",changeTips:{title:""},useAi:!1,editType:Ge.EditMode_simple,actionEnable:!0}),E=async()=>{try{h.isPublishLoading=!0,h.actionEnable=!1,a.info("保存到系统平台开始");for(const U of y){const Se=await g(U),Le=ye.cloneDeep(h.mergedPost);await i(U,b,Se,Le)}a.info("保存到系统平台结束"),a.info("单个常规发布开始"),await $();const I=await i(d,b,h.publishCfg,h.mergedPost);a.info("normal publish processResult =>",I),a.info("单个常规发布结束"),I.status?h.method===He.METHOD_ADD?Y.success("文章发布成功！如需编辑请重新打开"):(h.actionEnable=!0,Y.success("文章更新成功！")):(h.actionEnable=!0,Y.error(I.errMsg),a.error(I.errMsg))}catch(I){Y.error(I.message),a.error(t("main.opt.failure")+"=>",I)}finally{h.isPublishLoading=!1}},v=async()=>{const I=J(),U=le();Kt.confirm(`确认要删除 [${I} - ${U}] 下的这篇文章吗，此平台的文章数据将永久删除 ？`,"温馨提示",{type:"error",icon:Ft(Es),confirmButtonText:t("main.opt.ok"),cancelButtonText:t("main.opt.cancel")}).then(async()=>{await T()}).catch(()=>{})},T=async()=>{try{h.isDeleteLoading=!0,h.actionEnable=!1;const I=await n(d,b,h.publishCfg);if(I.status){const U=J(),Se=le();Y.success(`[${U} - ${Se}] 文章删除成功`),setTimeout(()=>{h.method=He.METHOD_ADD,window.location.href=ht.setUrlParameter(window.location.href,"method",h.method),window.location.reload()},200)}else h.actionEnable=!0,Y.error(I.errMsg),a.error(I.errMsg)}catch(I){Y.error(I.message),a.error(t("main.opt.failure")+"=>",I)}finally{h.isDeleteLoading=!1}},S=async()=>{try{await p(d,b,h.publishCfg);const I=J(),U=le();Y.success(`[${I} - ${U}] 文章信息已强制删除`),setTimeout(()=>{h.method=He.METHOD_ADD,window.location.href=ht.setUrlParameter(window.location.href,"method",h.method),window.location.reload()},200)}catch(I){Y.error(I.message)}finally{h.isDeleteLoading=!1}},M=async()=>{await V(),await $(),Y.success("属性已经成功同步到思源")},V=async()=>{const I={[Ke.Sys_memo]:h.mergedPost.shortDesc,[Ke.Sys_tags]:h.mergedPost.mt_keywords,[Ke.Custom_categories]:h.mergedPost.categories.join(",")};await o.setBlockAttrs(b,I),a.debug("保存内置平台属性",I)},$=async()=>{const I=h.mergedPost.yaml,U=St(d);await o.setSingleBlockAttr(b,U,I),a.debug("保存当前平台属性",{yaml:te(I)})},J=()=>{var U;const I=(U=h.publishCfg)==null?void 0:U.dynCfg;return(I==null?void 0:I.platformName)||""},le=()=>{var Se,Le,gt,W,dt,ee;const I=(Se=h.publishCfg)==null?void 0:Se.cfg;let U=(I==null?void 0:I.blogName)||"";if(I.knowledgeSpaceEnabled&&((gt=(Le=h.mergedPost)==null?void 0:Le.cate_slugs)==null?void 0:gt.length)>0){let Ne;((dt=(W=h.mergedPost)==null?void 0:W.categories)==null?void 0:dt.length)>0?Ne=(ee=h.mergedPost)==null?void 0:ee.categories[0]:Ne="",U=Ne??""}return U},re=Ha(()=>{const I=J(),U=le();let Se="当前操作的平台为 - ";return Se+=I||d,U&&(Se+=" - "+U),Se}),ve=async I=>{h.editType=I,a.debug("syncEditMode in single publish")},F=I=>{h.mergedPost.title=I,a.debug("syncPublishTitle in single publish")},j=I=>{h.mergedPost.shortDesc=I,h.mergedPost.mt_text_more=I,h.mergedPost.mt_excerpt=I,a.debug("syncDesc in single publish")},O=I=>{h.mergedPost.mt_keywords=I==null?void 0:I.join(","),a.debug("syncTags in single publish")},ie=I=>{h.mergedPost.tags_slugs=I==null?void 0:I.join(","),a.debug("syncTagSlugs in single publish")},X=I=>{h.mergedPost.categories=I,a.debug("syncCates in single publish")},Ve=I=>{h.mergedPost.cate_slugs=I,a.debug("syncCateSlugs in single publish")},De=(I,U)=>{h.mergedPost.dateCreated=I,h.mergedPost.dateUpdated=U,a.debug("syncPublishTime in single publish")},ne=I=>{h.mergedPost=I,a.debug("syncPost in single publish")},Ue=()=>{const I="/publish/singlePublish";a.info("will go to =>",I);const U={path:I,query:{id:b}};c.push(U)},Fe=async()=>{try{const{mergedPost:I,postPreviewUrl:U}=await l.doInitSinglePage(d,b,h.method,h.publishCfg);h.mergedPost=I,h.postPreviewUrl=U}catch(I){const U=t("main.opt.failure")+"=>"+I;throw a.error(t("main.opt.failure")+"=>",I),await o.pushErrMsg({msg:U,timeout:7e3}),I}},lt=()=>{let I=!1,U=0;for(;!I&&U<3;)try{ut(),I=!0}catch(Se){a.error(`${t("main.opt.failure")} => ${Se}`),U++}return a.info(`第${U}次尝试就检测AI状态: ${I}`),I};return qe(async()=>{var U,Se;a.info("获取到的ID为=>",b),h.publishCfg=await g(d),await Fe(),h.mergedPost=await l.assignInitAttrs(h.mergedPost,b,h.publishCfg),h.isInit=!0;const I=h.publishCfg.cfg;h.categoryConfig={cateEnabled:I.cateEnabled,readonlyMode:h.method===He.METHOD_EDIT&&!I.allowCateChange,readonlyModeTip:(U=I==null?void 0:I.placeholder)==null?void 0:U.cateReadonlyModeTip,apiType:d,cfg:I},h.knowledgeSpaceConfig={cateEnabled:I.knowledgeSpaceEnabled,readonlyMode:h.method===He.METHOD_EDIT&&!I.allowKnowledgeSpaceChange,readonlyModeTip:(Se=I==null?void 0:I.placeholder)==null?void 0:Se.knowledgeSpaceReadonlyModeTip,apiType:d,cfg:I},a.debug("single publish inited mergedPost =>",te(h.mergedPost)),h.useAi=lt(),h.editType=Ge.EditMode_simple}),(I,U)=>{const Se=qt,Le=Ie,gt=ti,W=rc,dt=Eo,ee=be,Ne=Ee,di=Go,mi=Bo,hi=ac,Lt=we,yi=Re,fi=vo,_i=To;return w(),k(Oe,{title:"常规发布","has-back-emit":!0,onBackEmit:Ue},{default:_(()=>[h.isInit?(w(),N("div",Dc,[f(Le,{class:"top-tip",title:re.value,type:"info",closable:!1},null,8,["title"]),h.useAi?(w(),k(Le,{key:0,class:"top-tip",title:m(t)("category.ai.enabled"),type:"success",closable:!1},null,8,["title"])):z("",!0),f(_i,null,{default:_(()=>[f(fi,null,{default:_(()=>[P("div",Uc,[f(yi,{"label-width":"100px"},{default:_(()=>[f(si,{"edit-type":h.editType,"onUpdate:editType":U[0]||(U[0]=q=>h.editType=q),onEmitSyncEditMode:ve},null,8,["edit-type"]),h.editType===m(Ge).EditMode_source?(w(),k(gt,{key:0,modelValue:h.mergedPost,"onUpdate:modelValue":U[1]||(U[1]=q=>h.mergedPost=q),"api-type":m(d),"page-id":m(b),cfg:h.publishCfg.cfg,onEmitSyncPost:ne},null,8,["modelValue","api-type","page-id","cfg"])):(w(),N("div",Oc,[f(oi,{"use-ai":h.useAi,"onUpdate:useAi":U[2]||(U[2]=q=>h.useAi=q),modelValue:h.mergedPost.title,"onUpdate:modelValue":U[3]||(U[3]=q=>h.mergedPost.title=q),md:h.mergedPost.markdown,"onUpdate:md":U[4]||(U[4]=q=>h.mergedPost.markdown=q),html:h.mergedPost.html,"onUpdate:html":U[5]||(U[5]=q=>h.mergedPost.html=q),onEmitSyncPublishTitle:F},null,8,["use-ai","modelValue","md","html"]),h.publishCfg.cfg.knowledgeSpaceEnabled?(w(),k(Cc,{key:0,"knowledge-space-type":h.publishCfg.cfg.knowledgeSpaceType,"onUpdate:knowledgeSpaceType":U[6]||(U[6]=q=>h.publishCfg.cfg.knowledgeSpaceType=q),"knowledge-space-config":h.knowledgeSpaceConfig,"onUpdate:knowledgeSpaceConfig":U[7]||(U[7]=q=>h.knowledgeSpaceConfig=q),"cate-slugs":h.mergedPost.cate_slugs,"onUpdate:cateSlugs":U[8]||(U[8]=q=>h.mergedPost.cate_slugs=q),onEmitSyncCateSlugs:Ve},null,8,["knowledge-space-type","knowledge-space-config","cate-slugs"])):z("",!0),h.publishCfg.cfg.tagSlugEnabled?(w(),k(W,{key:1,cfg:h.publishCfg.cfg,"onUpdate:cfg":U[9]||(U[9]=q=>h.publishCfg.cfg=q),"api-type":m(d),"onUpdate:apiType":U[10]||(U[10]=q=>At(d)?d.value=q:null),"tag-slugs":h.mergedPost.tags_slugs,"onUpdate:tagSlugs":U[11]||(U[11]=q=>h.mergedPost.tags_slugs=q),onEmitSyncTagSlugs:ie},null,8,["cfg","api-type","tag-slugs"])):z("",!0),f(dt,{"border-style":"dashed"}),h.editType===m(Ge).EditMode_complex?(w(),N("div",Mc,[f(Ne,{label:m(t)("main.slug")},{default:_(()=>[f(ee,{modelValue:h.mergedPost.wp_slug,"onUpdate:modelValue":U[12]||(U[12]=q=>h.mergedPost.wp_slug=q),disabled:!0},null,8,["modelValue"])]),_:1},8,["label"]),f(di,{"use-ai":h.useAi,"onUpdate:useAi":U[13]||(U[13]=q=>h.useAi=q),"page-id":m(b),"onUpdate:pageId":U[14]||(U[14]=q=>At(b)?b.value=q:null),desc:h.mergedPost.shortDesc,"onUpdate:desc":U[15]||(U[15]=q=>h.mergedPost.shortDesc=q),md:h.mergedPost.markdown,"onUpdate:md":U[16]||(U[16]=q=>h.mergedPost.markdown=q),html:h.mergedPost.html,"onUpdate:html":U[17]||(U[17]=q=>h.mergedPost.html=q),onEmitSyncDesc:j},null,8,["use-ai","page-id","desc","md","html"]),h.publishCfg.cfg.tagEnabled?(w(),k(mi,{key:0,"use-ai":h.useAi,"onUpdate:useAi":U[18]||(U[18]=q=>h.useAi=q),"page-id":m(b),"onUpdate:pageId":U[19]||(U[19]=q=>At(b)?b.value=q:null),tags:h.mergedPost.mt_keywords,"onUpdate:tags":U[20]||(U[20]=q=>h.mergedPost.mt_keywords=q),md:h.mergedPost.markdown,"onUpdate:md":U[21]||(U[21]=q=>h.mergedPost.markdown=q),html:h.mergedPost.html,"onUpdate:html":U[22]||(U[22]=q=>h.mergedPost.html=q),onEmitSyncTags:O},null,8,["use-ai","page-id","tags","md","html"])):z("",!0),h.publishCfg.cfg.cateEnabled?(w(),k(hi,{key:1,"use-ai":h.useAi,"onUpdate:useAi":U[23]||(U[23]=q=>h.useAi=q),"category-type":h.publishCfg.cfg.categoryType,"onUpdate:categoryType":U[24]||(U[24]=q=>h.publishCfg.cfg.categoryType=q),"category-config":h.categoryConfig,"onUpdate:categoryConfig":U[25]||(U[25]=q=>h.categoryConfig=q),categories:h.mergedPost.categories,"onUpdate:categories":U[26]||(U[26]=q=>h.mergedPost.categories=q),md:h.mergedPost.markdown,"onUpdate:md":U[27]||(U[27]=q=>h.mergedPost.markdown=q),html:h.mergedPost.html,"onUpdate:html":U[28]||(U[28]=q=>h.mergedPost.html=q),onEmitSyncCates:X},null,8,["use-ai","category-type","category-config","categories","md","html"])):z("",!0),f(ai,{modelValue:h.mergedPost,"onUpdate:modelValue":U[29]||(U[29]=q=>h.mergedPost=q),onEmitSyncPublishTime:De},null,8,["modelValue"]),f(dt,{"border-style":"dashed"})])):z("",!0)])),f(Ne,{"label-width":"100px",class:"form-action"},{default:_(()=>[f(Lt,{type:"primary",loading:h.isPublishLoading,onClick:E,disabled:!h.actionEnable},{default:_(()=>[G(L(h.method===m(He).METHOD_ADD?m(t)("main.publish"):m(t)("main.update")),1)]),_:1},8,["loading","disabled"]),h.method===m(He).METHOD_EDIT?(w(),k(Lt,{key:0,type:"danger",loading:h.isDeleteLoading,onClick:v,disabled:!h.actionEnable,class:"btn-rm-action"},{default:_(()=>[G(L(m(t)("main.cancel")),1)]),_:1},8,["loading","disabled"])):z("",!0),h.method===m(He).METHOD_EDIT?(w(),k(Lt,{key:1,type:"danger",onClick:S,disabled:!h.actionEnable,class:"btn-rm-action"},{default:_(()=>[G(L(m(t)("main.force.cancel")),1)]),_:1},8,["disabled"])):z("",!0),f(Lt,{type:"warning",onClick:M,disabled:!h.actionEnable},{default:_(()=>[G(" 同步修改到思源笔记 ")]),_:1},8,["disabled"])]),_:1}),f(Ne,null,{default:_(()=>[f(Lt,{type:h.method===m(He).METHOD_EDIT?"success":"danger",text:"",disabled:""},{default:_(()=>[G(L(h.method===m(He).METHOD_EDIT?m(t)("main.publish.status.published"):m(t)("main.publish.status.unpublish")),1)]),_:1},8,["type"]),h.method===m(He).METHOD_EDIT?(w(),N("a",{key:0,href:h.postPreviewUrl,title:h.postPreviewUrl,target:"_blank"},L(m(t)("main.publish.see.preview")),9,Ic)):z("",!0)]),_:1})]),_:1})])]),_:1})]),_:1})])):(w(),k(Se,{key:0,class:"placeholder",rows:5,animated:""}))]),_:1})}}});const Vc=ue(xc,[["__scopeId","data-v-fee51d14"]]),co=()=>{const{t:r}=K(),a=dr(r),t=[...xe.commonCfg,...xe.githubCfg,...xe.gitlabCfg,...xe.metaweblogCfg,...xe.wordpressCfg,...xe.customCfg];return{platformTypeList:a,getPlatformType:i=>a.find(n=>n.type===i),getPrePlatformList:i=>t.filter(n=>n.platformType===i),getPrePlatform:i=>t.find(n=>n.platformKey===i)}},Nc=r=>(et("data-v-c90d836a"),r=r(),tt(),r),Bc=["href"],Gc=Nc(()=>P("a",{href:"https://img1.terwer.space/api/public/202309051734289.png",target:"_blank"},"此图片",-1)),$c=H({__name:"CookieSetting",props:{apiType:"",setting:{},settingCfg:{}},emits:["emitHideDlg"],setup(r,{emit:a}){const t=r,s=B("cookie-setting"),{t:e}=K(),{updateSetting:o}=me(),i=Z(),n=ae({key:t.apiType,settingData:t.setting,settingCfgData:t.settingCfg}),l=ae({}),p=async c=>{if(!(!c||!await c.validate((y,u)=>{y?s.debug("校验成功"):s.error(e("main.opt.failure"),u)}))){if(A.isEmptyString(n.key)){Y.error("平台key不能为空，请排查。如有问题，请联系作者");return}n.settingData[n.key]=n.settingCfgData,await o(n.settingData),a&&a("emitHideDlg"),Y.success(e("main.opt.success"))}};return(c,g)=>{const y=Ie,u=Ee,d=be,b=we,h=Re;return w(),N("div",null,[f(h,{class:"add-form",ref_key:"formRef",ref:i,"label-width":"100px",model:n.settingCfgData,rules:l},{default:_(()=>[f(y,{class:"top-tip",title:"检测到当前为浏览器页面或者受平台技术限制，无法获取Cookie，请手动粘贴平台Cookie。本插件承诺，所有数据仅在您的本地存储，我们不会上传或者分享你的任何数据，请放心使用。如有疑问请查看帮助文档。",type:"error",closable:!1}),f(u,null,{default:_(()=>[G(" 特别提示：受平台限制，当前无法自动获取cookie，请在Chrome浏览器手动打开   "),P("a",{href:n.settingCfgData.home,target:"_blank"},L(n.settingCfgData.home),9,Bc),G("  并登录，然后使用开发者工具找到cookie，最后复制粘贴到下方文本框，可参考 "),Gc,G(" 的指引。 ")]),_:1}),f(u,{label:"平台Cookie"},{default:_(()=>[f(d,{modelValue:n.settingCfgData.password,"onUpdate:modelValue":g[0]||(g[0]=E=>n.settingCfgData.password=E),style:{width:"75%","margin-right":"16px"},placeholder:"请直接粘贴平台cookie，为了您的隐私安全，请勿泄露cookie给任何人",type:"textarea",rows:10},null,8,["modelValue"])]),_:1}),f(u,null,{default:_(()=>[f(b,{type:"primary",onClick:g[1]||(g[1]=E=>p(i.value))},{default:_(()=>[G(L(m(e)("setting.blog.save")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])])}}});const Lc=ue($c,[["__scopeId","data-v-c90d836a"]]),is=r=>(et("data-v-f26800bf"),r=r(),tt(),r),jc={class:"publish-setting-body"},Hc={class:"publish-setting-right-content"},Rc={key:0},Fc=["src"],Kc={class:"right-card-text"},Yc={class:"text-desc"},zc={class:"add-btn"},Wc={key:1},qc={key:2},Jc={class:"publish-right-setting"},Xc={class:"platform-item"},Zc=["innerHTML"],Qc={class:"item-right"},ep={class:"text"},tp=["onClick"],sp=["innerHTML"],ap={class:"actions"},op={class:"commmon-action"},ip={class:"import-pre-action"},np={class:"log-message-box"},lp={class:"right-setting-tips"},rp={class:"el-alert el-alert--warning is-light",role:"alert"},cp={class:"el-alert__content"},pp={class:"el-alert__title"},up=is(()=>P("h2",null,"FAQ:",-1)),gp=is(()=>P("div",{class:"setting-help"},[G(" 不会配置，或者配置遇到问题？ 请加QQ群 "),P("span",{style:{"font-weight":"bold",color:"red"}},[P("a",{href:"https://qm.qq.com/cgi-bin/qm/qr?_wv=1027&k=1Q1-wOLkBaG-iD0MBnNhNL25tbLSCwZx&authKey=tBdJDGuWuXK%2B77hHlwwT6y8UAp9AGZTwQq6RzUa%2ByX81HCSHu4XVGqY0gbsBUcW0&noverify=0&group_code=895063267",target:"_blank"}," 895063267 ")]),G(" 讨论。 ")],-1)),dp=is(()=>P("div",{class:"setting-help"},[G(" 需要详细的配置指导？请查看在线文档 "),P("a",{href:"https://blog.terwer.space/s/20230810132040-nn4q7vs",target:"_blank"},"平台配置指南")],-1)),mp=is(()=>P("div",{class:"tips-form"},[G(" 我想要的平台这里没有？"),P("a",{href:"https://terwergreen.feishu.cn/share/base/form/shrcnGRdThUiqnhBg15xgclMM0c",target:"_blank"}," 点击这里提交发布工具平台适配跟踪表 ")],-1)),hp=is(()=>P("div",{class:"tips-form"},[G(" 我还有其他问题或者想私下沟通作者？"),P("a",{href:"mailto:youweics@163.com"}," 直接发邮件到：youweics@163.com ")],-1)),yp=H({__name:"PublishSetting",setup(r){const a=B("publish-setting"),{t}=K(),s=ct(),{getSetting:e,updateSetting:o,deleteKey:i}=me(),{platformTypeList:n}=co(),{isInSiyuanWidget:l,isInChromeExtension:p}=wt(),c=ae({setting:{},showAdd:!1,platformTypeList:n,dynamicConfigArray:[],webAuthLoadingMap:{},isImportLoading:!1,showLogMessage:!1,logMessage:"",cookieSettingFormVisible:!1,dlgCookieTitle:"",dlgKey:"",dlgSettingCfg:{}}),g=()=>{c.showAdd=!0},y=()=>{c.showAdd=!1},u=O=>{s.push({path:`/setting/platform/quickadd/${O}`,query:{showBack:"true"}})},d=O=>{Kt.confirm(`确认要删除【${O.platformName}】吗，所有与此平台相关的配置都将永久删除？`,"温馨提示",{type:"error",icon:Ft(Es),confirmButtonText:t("main.opt.ok"),cancelButtonText:t("main.opt.cancel")}).then(async()=>{c.dynamicConfigArray=il(c.dynamicConfigArray,O.platformKey);const ie=ot(c.dynamicConfigArray);c.setting[Me]=ie,delete c.setting[O.platformKey],i(O.platformKey),await o(c.setting),await j(),Y.success(t("main.opt.success"))}).catch(()=>{})},b=O=>{s.push({path:`/setting/platform/update/${O.platformKey}`,query:{showBack:"true"}})},h=async O=>{c.dynamicConfigArray=yt(c.dynamicConfigArray,O.platformKey,O);const ie=ot(c.dynamicConfigArray);c.setting[Me]=ie,await o(c.setting)},E=async O=>{const ie=O.platformKey;await s.push({path:`/setting/platform/single/${ie}`,query:{showBack:"true"}})},v=async O=>{O.cookieLimit?await M(O):l()?await T(O):p()?S(O):await M(O)},T=async O=>{Kt.confirm(`将打开 [${O.platformName}] 登录授权页面，您需要在新页面完成登录，然后点击验证查看授权结果，是否继续？`,"网页授权",{type:"warning",icon:Ft(po),confirmButtonText:t("main.opt.ok"),cancelButtonText:t("main.opt.cancel")}).then(async()=>{if(O.isAuth){O.isAuth=!1,c.dynamicConfigArray=yt(c.dynamicConfigArray,O.platformKey,O);const ie=ot(c.dynamicConfigArray);c.setting[Me]=ie,await o(c.setting),a.info("已授权，将清空状态，并重新进行授权，授权完成需要重新验证")}else a.info("未授权，准备开始授权");uo(O.authUrl)}).catch(()=>{})},S=O=>{Kt.confirm(`将打开 [${O.platformName}] 登录授权页面，您需要在新页面完成登录，然后点击验证查看授权结果，是否继续？`,"网页授权",{type:"warning",icon:Ft(po),confirmButtonText:t("main.opt.ok"),cancelButtonText:t("main.opt.cancel")}).then(async()=>{if(O.isAuth){O.isAuth=!1,c.dynamicConfigArray=yt(c.dynamicConfigArray,O.platformKey,O);const ie=ot(c.dynamicConfigArray);c.setting[Me]=ie,await o(c.setting),a.info("已授权，将清空状态，并重新进行授权，授权完成需要重新验证")}else a.info("未授权，准备开始授权");window.open(O.authUrl)}).catch(()=>{})},M=async O=>{if(O.isAuth){O.isAuth=!1,c.dynamicConfigArray=yt(c.dynamicConfigArray,O.platformKey,O);const Ve=ot(c.dynamicConfigArray);c.setting[Me]=Ve,await o(c.setting),a.info("已授权，将清空状态，并重新进行授权，授权完成需要重新验证")}else a.info("未授权，准备开始授权");const ie=oe.safeParse(c.setting[O.platformKey],{}),X=await de.getCfg(O.platformKey,ie);c.dlgKey=O.platformKey,c.dlgSettingCfg=X,c.dlgCookieTitle=`${O.platformName} Cookie 设置`,c.cookieSettingFormVisible=!0},V=async O=>{O.cookieLimit?await le(O):l()?$(O):p()?await J(O):await le(O)},$=O=>{const ie=async(X,Ve)=>{a.debug("get cookie result=>",Ve),c.webAuthLoadingMap[X.platformKey]=!0;try{const ne=new ge,Ue=await de.getCfg(X.platformKey),Fe=await de.getAdaptor(X.platformKey,Ue),lt=C.webApi(ne,Fe),I=await lt.buildCookie(Ve),U=Ue;U.password=I,c.setting[X.platformKey]=U,await o(c.setting),lt.updateCfg(U);const Se=await lt.getMetaData();if(a.debug("get meta data=>",Se),Se.flag){X.isAuth=!0;const Le=oe.safeParse(c.setting[X.platformKey],{});Le.metadata=Se,c.setting[X.platformKey]=Le,await o(c.setting),a.info("已更新最新的metadata"),Y.success("验证成功，该平台可正常使用")}else X.isAuth=!1,Y.error("验证失败，该平台将不可用")}catch(ne){X.isAuth=!1,Y.error(t("main.opt.failure")+"=>"+ne),a.error(t("main.opt.failure")+"=>",ne)}c.dynamicConfigArray=yt(c.dynamicConfigArray,X.platformKey,X);const De=ot(c.dynamicConfigArray);c.setting[Me]=De,await o(c.setting),c.webAuthLoadingMap[X.platformKey]=!1};uo(O.authUrl,O,ie)},J=async O=>{c.webAuthLoadingMap[O.platformKey]=!0;try{const X=new ge,Ve=await de.getCfg(O.platformKey),De=await de.getAdaptor(O.platformKey,Ve),Ue=await C.webApi(X,De).getMetaData();if(Ue.flag){O.isAuth=!0;const Fe=Ve;Fe.metadata=Ue,c.setting[O.platformKey]=Fe,await o(c.setting),a.info("已更新最新的metadata"),Y.success("验证成功，该平台可正常使用")}else O.isAuth=!1,Y.error("验证失败，该平台将不可用")}catch(X){O.isAuth=!1,Y.error(t("main.opt.failure")+"=>"+X),a.error(t("main.opt.failure")+"=>",X)}c.dynamicConfigArray=yt(c.dynamicConfigArray,O.platformKey,O);const ie=ot(c.dynamicConfigArray);c.setting[Me]=ie,await o(c.setting),c.webAuthLoadingMap[O.platformKey]=!1},le=async O=>{await J(O)},re=()=>{c.cookieSettingFormVisible=!1},ve=O=>{for(const ie of O){const X=ie.platformKey;if($o(c.dynamicConfigArray,X)){c.logMessage+=`${X} 已经存在，忽略导入
`;continue}const De=ye.cloneDeep(ie);c.dynamicConfigArray.push(De),c.logMessage+=`${X} 已加入导入列表
`,c.setting[De.platformKey]={},c.logMessage+=`${X} 初始化
`}},F=async()=>{c.showLogMessage=!0,c.isImportLoading=!0,ve(xe.commonCfg),ve(xe.githubCfg),ve(xe.gitlabCfg),ve(xe.metaweblogCfg),ve(xe.wordpressCfg),ve(xe.customCfg);const O=ot(c.dynamicConfigArray);c.setting[Me]=O,await o(c.setting),c.isImportLoading=!1,c.logMessage+=`全部导入成功并保存
`},j=async()=>{c.setting=await e(),a.info("get setting from platform setting",c.setting);const O=oe.safeParse(c.setting[Me],{});c.dynamicConfigArray=(O==null?void 0:O.totalCfg)||[],a.debug("dynamic init page=>",c.dynamicConfigArray)};return qe(async()=>{await j()}),(O,ie)=>{const X=Ri,Ve=Fi,De=ko,ne=we,Ue=Ka,Fe=So,lt=Ie,I=Ts,U=Fa,Se=Po,Le=Ct,gt=be,W=Ki,dt=Oe;return w(),k(dt,{title:m(t)("service.tab.publish.setting")},{default:_(()=>[P("div",jc,[f(Fe,{gutter:20,class:"row-item"},{default:_(()=>[f(De,{span:2,class:"col-item"},{default:_(()=>[f(Ve,{class:"publish-setting-left-menu"},{default:_(()=>[f(X,{class:_t(c.showAdd?"left-menu-item":"left-menu-item menu-item-selected"),onClick:y},{title:_(()=>[P("span",null,L(m(t)("service.tab.publish.setting")),1)]),_:1},8,["class"]),f(X,{class:_t(c.showAdd?"left-menu-item menu-item-selected":"left-menu-item"),onClick:g},{title:_(()=>[P("span",null," + "+L(m(t)("setting.platform.add")),1)]),_:1},8,["class"])]),_:1})]),_:1}),f(De,{span:22,class:"col-item"},{default:_(()=>[P("div",Hc,[c.showAdd?(w(),N("div",Rc,[f(Fe,{gutter:20,class:"row-item"},{default:_(()=>[(w(!0),N(_e,null,Te(c.platformTypeList,ee=>(w(),k(De,{key:ee.type,span:12,class:"col-item",onClick:Ne=>u(ee.type)},{default:_(()=>[f(Ue,{class:"platform-right-card"},{default:_(()=>[P("img",{src:ee.img,class:"image",alt:""},null,8,Fc),P("div",Kc,[P("span",null,L(ee.title),1),P("div",null,[P("div",Yc,L(ee.description),1),P("div",zc,[f(ne,{size:"small",type:"primary"},{default:_(()=>[G(L(m(t)("setting.platform.add.this")),1)]),_:1})])])])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})])):c.dynamicConfigArray.length===0?(w(),N("div",Wc,[f(lt,{class:"no-tip",type:"error",title:m(t)("platform.must.select.one")},null,8,["title"])])):(w(),N("div",qc,[P("div",Jc,[f(Fe,{gutter:20,class:"platform-list"},{default:_(()=>[(w(!0),N(_e,null,Te(c.dynamicConfigArray,ee=>(w(),k(De,{key:ee.platformKey,span:11,class:"platform-item-box"},{default:_(()=>[P("div",Xc,[f(I,{class:"item-left-icon"},{default:_(()=>[P("span",{class:"item-icon",innerHTML:ee.platformIcon},null,8,Zc)]),_:2},1024),P("div",Qc,[P("div",ep,[f(Se,{value:ee.isAuth?"已授权":ee.authMode===m(pe).API?"设置无效":"没有授权",class:"badge-item",type:ee.isAuth?"success":"danger"},{default:_(()=>[P("span",null,L(ee.platformName),1),P("span",{class:"name-edit",onClick:Ne=>b(ee)},[f(I,null,{default:_(()=>[P("span",{innerHTML:m(fe).iconIFEdit},null,8,sp)]),_:1})],8,tp),f(U,{type:ee.authMode===m(pe).API?"primary":"info",class:"auth-mode-text"},{default:_(()=>[G(L(ee.authMode===m(pe).API?"API授权":"网页授权"),1)]),_:2},1032,["type"])]),_:2},1032,["value","type"])]),P("div",ap,[f(Le,{modelValue:ee.isEnabled,"onUpdate:modelValue":Ne=>ee.isEnabled=Ne,"inline-prompt":"",size:"small",class:"action-btn action-switch","active-text":"已启用","inactive-text":"未启用",onChange:Ne=>h(ee)},null,8,["modelValue","onUpdate:modelValue","onChange"]),ee.isEnabled&&ee.authMode===m(pe).API?(w(),k(U,{key:0,class:"action-btn action-setting",onClick:Ne=>E(ee)},{default:_(()=>[f(I,null,{default:_(()=>[f(m(Cs))]),_:1}),G(" 设置 ")]),_:2},1032,["onClick"])):z("",!0),ee.isEnabled&&ee.authMode===m(pe).WEBSITE&&ee.isAuth?(w(),k(U,{key:1,class:"action-btn action-setting",onClick:Ne=>E(ee)},{default:_(()=>[f(I,null,{default:_(()=>[f(m(Cs))]),_:1}),G(" 设置 ")]),_:2},1032,["onClick"])):z("",!0),ee.isEnabled&&ee.authMode===m(pe).WEBSITE?(w(),k(U,{key:2,class:"action-btn action-web-setting",onClick:Ne=>v(ee)},{default:_(()=>[f(I,null,{default:_(()=>[f(m(Cs))]),_:1}),G(" "+L(ee.isAuth?"再次授权":"授权"),1)]),_:2},1032,["onClick"])):z("",!0),ee.isEnabled&&ee.authMode===m(pe).WEBSITE&&!ee.isAuth?(w(),k(ne,{key:3,class:"action-btn action-web-auth",onClick:Ne=>V(ee),size:"small",loading:c.webAuthLoadingMap[ee.platformKey]===!0},{default:_(()=>[f(I,null,{default:_(()=>[f(m(Di))]),_:1}),G(" 验证 ")]),_:2},1032,["onClick","loading"])):z("",!0),ee.isEnabled?z("",!0):(w(),k(U,{key:4,class:"action-btn action-del",onClick:Ne=>d(ee)},{default:_(()=>[f(I,null,{default:_(()=>[f(m(Es))]),_:1}),G(" 删除 ")]),_:2},1032,["onClick"]))])])])]),_:2},1024))),128))]),_:1})])])),P("div",op,[f(Fe,null,{default:_(()=>[f(De,null,{default:_(()=>[P("div",ip,[f(ne,{size:"small",type:"primary",loading:c.isImportLoading,onClick:F},{default:_(()=>[G("导入预定义平台")]),_:1},8,["loading"])]),P("div",np,[c.showLogMessage?(w(),k(gt,{key:0,modelValue:c.logMessage,"onUpdate:modelValue":ie[0]||(ie[0]=ee=>c.logMessage=ee),type:"textarea",rows:10,placeholder:"日志信息"},null,8,["modelValue"])):z("",!0)]),P("div",lp,[P("div",rp,[P("div",cp,[P("div",pp,[P("div",null,L(m(t)("setting.platform.right.tips0")),1),P("div",null,L(m(t)("setting.platform.right.tips1")),1),P("div",null,L(m(t)("setting.platform.right.tips2")),1),P("div",null,L(m(t)("setting.platform.right.tips3")),1),P("div",null,L(m(t)("setting.platform.right.tips4")),1)])])]),up,gp,dp,mp,hp])]),_:1})]),_:1})])])]),_:1})]),_:1}),f(W,{modelValue:c.cookieSettingFormVisible,"onUpdate:modelValue":ie[4]||(ie[4]=ee=>c.cookieSettingFormVisible=ee),title:c.dlgCookieTitle},{default:_(()=>[f(Lc,{"api-type":c.dlgKey,"onUpdate:apiType":ie[1]||(ie[1]=ee=>c.dlgKey=ee),setting:c.setting,"onUpdate:setting":ie[2]||(ie[2]=ee=>c.setting=ee),"setting-cfg":c.dlgSettingCfg,"onUpdate:settingCfg":ie[3]||(ie[3]=ee=>c.dlgSettingCfg=ee),onEmitHideDlg:re},null,8,["api-type","setting","setting-cfg"])]),_:1},8,["modelValue","title"])])]),_:1},8,["title"])}}});const ii=ue(yp,[["__scopeId","data-v-f26800bf"]]),fp=H({__name:"SetIndex",setup(r){return(a,t)=>(w(),k(ii))}}),_p=H({__name:"Setting",setup(r){return(a,t)=>(w(),k(fp))}}),bp=H({__name:"PostBind",setup(r){const a=B("post-bind"),{t}=K(),{query:s}=$e(),{getPublishCfg:e}=as(),{updateSetting:o}=me(),i=s.id??os(),n=Z(),l=ae({}),p=ae({}),c=ae({dynamicConfigArray:[],postIdMap:{}}),g=async y=>{if(A.isEmptyString(i)){Y.error("");return}try{const d=(await e()).setting,b=se.getProperty(d,i,{});c.dynamicConfigArray=c.dynamicConfigArray.map(h=>{const E=c.postIdMap[h.platformKey],v=se.getProperty(d,h.platformKey,{}),T=v==null?void 0:v.posidKey;return!A.isEmptyString(T)&&!A.isEmptyString(i)&&(b[T]=E),h}),d[i]=b,a.debug("prepare to save setting =>",{setting:te(d)}),await o(d),Y.success(t("main.opt.success"))}catch(u){a.error(t("main.opt.failure")+"=>",u),Y.error(t("main.opt.failure")+"=>"+u)}};return qe(async()=>{const y=await e(),u=y.setting;c.dynamicConfigArray=y.dynamicConfigArray;const d=se.getProperty(u,i,{});c.dynamicConfigArray.forEach(b=>{let h="";const E=se.getProperty(u,b.platformKey,{}),v=E==null?void 0:E.posidKey;!A.isEmptyString(v)&&!A.isEmptyString(i)&&(h=se.getProperty(d,v)),c.postIdMap[b.platformKey]=h})}),(y,u)=>{const d=Ie,b=be,h=Ee,E=we,v=Re;return w(),k(v,{"label-width":"85px",class:"post-bind-form",ref_key:"ruleFormRef",ref:n,model:l,rules:p,"status-icon":""},{default:_(()=>[f(d,{class:"top-tip",title:m(t)("post.bind.auto.tips"),type:"error",closable:!1},null,8,["title"]),(w(!0),N(_e,null,Te(c.dynamicConfigArray,(T,S)=>Ui((w(),k(h,{key:S,label:T.platformName},{default:_(()=>[f(b,{modelValue:c.postIdMap[T.platformKey],"onUpdate:modelValue":M=>c.postIdMap[T.platformKey]=M},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"])),[[Oi,T.isEnabled&&T.isEnabled]])),128)),f(h,null,{default:_(()=>[f(E,{type:"primary",onClick:u[0]||(u[0]=T=>g(n.value))},{default:_(()=>[G(L(m(t)("post.bind.conf.save")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])}}});const wp=ue(bp,[["__scopeId","data-v-14b9d258"]]),Ep={class:"locale-changer"},vp=H({__name:"ChangeLocal",async setup(r){let a,t;const s=B("change-local"),{getSetting:e,updateSetting:o}=me(),{t:i,locale:n}=K(),l=[{value:"zh_CN",label:"简体中文"},{value:"en_US",label:"English"}],p=([a,t]=Pe(()=>e()),a=await a,t(),a),c=async g=>{n.value=g,p.lang=g,await o(p),s.info("lang changed to",g)};return Mi(()=>{p!=null&&p.lang&&(n.value=p==null?void 0:p.lang)}),(g,y)=>{const u=Je,d=Xe,b=Ee,h=Re;return w(),N("div",Ep,[f(h,{"label-width":"85px"},{default:_(()=>[f(b,{label:m(i)("lang.choose")},{default:_(()=>[f(d,{modelValue:m(n),"onUpdate:modelValue":y[0]||(y[0]=E=>At(n)?n.value=E:null),placeholder:m(i)("lang.choose.placeholder"),onChange:c},{default:_(()=>[(w(),N(_e,null,Te(l,(E,v)=>f(u,{key:v,label:E.label,value:E.value},null,8,["label","value"])),64))]),_:1},8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})])}}}),ni=H({__name:"SiyuanSetting",setup(r){const{t:a}=K(),{getSiyuanSetting:t}=Lo(),s=t();return(e,o)=>{const i=be,n=Ee,l=Re;return w(),k(l,{"label-width":"125px",class:"siyuan-setting-form"},{default:_(()=>[f(n,{label:m(a)("setting.blog.siyuan.apiurl"),prop:"apiUrl"},{default:_(()=>[f(i,{modelValue:m(s).apiUrl,"onUpdate:modelValue":o[0]||(o[0]=p=>m(s).apiUrl=p),autocomplete:"off",placeholder:m(a)("setting.blog.siyuan.apiurl.tip")},null,8,["modelValue","placeholder"])]),_:1},8,["label"]),f(n,{label:m(a)("setting.blog.siyuan.password"),prop:"pwd"},{default:_(()=>[f(i,{modelValue:m(s).password,"onUpdate:modelValue":o[1]||(o[1]=p=>m(s).password=p),type:"password",autocomplete:"off",placeholder:m(a)("setting.blog.siyuan.password.tip"),"show-password":""},null,8,["modelValue","placeholder"])]),_:1},8,["label"])]),_:1})}}}),Tp=r=>(et("data-v-d45fe393"),r=r(),tt(),r),Pp=Tp(()=>P("div",{class:"form-item-bottom"},null,-1)),kp=H({__name:"AiSetting",setup(r){const{t:a}=K(),{getPublishPreferenceSetting:t}=Xt(),s=t();return(e,o)=>{const i=be,n=Ee,l=Ie,p=Re;return w(),k(p,{"label-width":"135px",class:"ai-setting-form"},{default:_(()=>[f(n,{label:m(a)("pref.setting.aicode")},{default:_(()=>[f(i,{modelValue:m(s).experimentalAICode,"onUpdate:modelValue":o[0]||(o[0]=c=>m(s).experimentalAICode=c),type:"password",autocomplete:"off",placeholder:m(a)("pref.setting.aicode.tip"),disabled:m(s).experimentalUseSiyuanNoteAIConfig},null,8,["modelValue","placeholder","disabled"])]),_:1},8,["label"]),f(n,{label:m(a)("pref.setting.ai.baseurl")},{default:_(()=>[f(i,{modelValue:m(s).experimentalAIBaseUrl,"onUpdate:modelValue":o[1]||(o[1]=c=>m(s).experimentalAIBaseUrl=c),autocomplete:"off",placeholder:m(a)("pref.setting.ai.baseurl.tip"),disabled:m(s).experimentalUseSiyuanNoteAIConfig},null,8,["modelValue","placeholder","disabled"])]),_:1},8,["label"]),f(n,{label:m(a)("pref.setting.ai.proxy.url")},{default:_(()=>[f(i,{modelValue:m(s).experimentalAIProxyUrl,"onUpdate:modelValue":o[2]||(o[2]=c=>m(s).experimentalAIProxyUrl=c),autocomplete:"off",placeholder:m(a)("pref.setting.ai.proxy.url.tip"),disabled:m(s).experimentalUseSiyuanNoteAIConfig},null,8,["modelValue","placeholder","disabled"])]),_:1},8,["label"]),m(s).experimentalUseSiyuanNoteAIConfig?(w(),k(n,{key:0},{default:_(()=>[f(l,{closable:!1,title:m(a)("config.ai.use.siyuan"),class:"form-item-tip",type:"warning"},null,8,["title"])]),_:1})):z("",!0),Pp]),_:1})}}});const Sp=ue(kp,[["__scopeId","data-v-d45fe393"]]),Ap=H({__name:"PreferenceSetting",setup(r){const{t:a}=K(),{getPublishPreferenceSetting:t}=Xt(),s=t();return(e,o)=>{const i=Ct,n=Ee,l=Re;return w(),k(l,{inline:"","label-width":"125px",class:"publish-preference-setting-form"},{default:_(()=>[f(n,{label:m(a)("preference.setting.fixTitle")},{default:_(()=>[f(i,{modelValue:m(s).fixTitle,"onUpdate:modelValue":o[0]||(o[0]=p=>m(s).fixTitle=p)},null,8,["modelValue"])]),_:1},8,["label"]),f(n,{label:m(a)("preference.setting.keepTitle")},{default:_(()=>[f(i,{modelValue:m(s).keepTitle,"onUpdate:modelValue":o[1]||(o[1]=p=>m(s).keepTitle=p)},null,8,["modelValue"])]),_:1},8,["label"]),f(n,{label:m(a)("preference.setting.removeH1")},{default:_(()=>[f(i,{modelValue:m(s).removeFirstH1,"onUpdate:modelValue":o[2]||(o[2]=p=>m(s).removeFirstH1=p)},null,8,["modelValue"])]),_:1},8,["label"]),f(n,{label:m(a)("preference.setting.removeWidgetTag")},{default:_(()=>[f(i,{modelValue:m(s).removeMdWidgetTag,"onUpdate:modelValue":o[3]||(o[3]=p=>m(s).removeMdWidgetTag=p)},null,8,["modelValue"])]),_:1},8,["label"])]),_:1})}}}),Cp=H({__name:"GeneralSetting",setup(r){const{t:a}=K();return(t,s)=>{const e=Yi,o=Sp,i=ni,n=vp,l=wp,p=zi,c=Oe;return w(),k(c,{title:m(a)("service.tab.change.local")},{default:_(()=>[f(p,{"tab-position":"left",class:"general-setting-box"},{default:_(()=>[f(e,{label:m(a)("service.tab.change.local")},{default:_(()=>[f(Ap)]),_:1},8,["label"]),f(e,{label:m(a)("sys.config.ai")},{default:_(()=>[f(o)]),_:1},8,["label"]),f(e,{label:m(a)("siyuan.config.setting")},{default:_(()=>[f(i)]),_:1},8,["label"]),f(e,{label:m(a)("lang.choose")},{default:_(()=>[f(n)]),_:1},8,["label"]),f(e,{label:m(a)("service.tab.post.bind")},{default:_(()=>[f(l)]),_:1},8,["label"])]),_:1})]),_:1},8,["title"])}}});const Dp=ue(Cp,[["__scopeId","data-v-1598226e"]]),Up=["href"],Op=["href"],Mp=H({__name:"CommonBlogSetting",props:{apiType:{type:String,default:""},cfg:{type:Object,default:null}},emits:["onHomeChange"],setup(r,{emit:a}){const t=r,s=B("commonblog-setting"),e=new ge,{t:o}=K(),{getSetting:i,updateSetting:n}=me(),l=v=>{a&&a("onHomeChange",v,g.cfg)},p=Z(!1),c=Z(null),g=ae({cfg:{},ksKeyword:"",isCateLoading:!1,kwSpaces:[],settingTips:"",dynCfg:{},setting:{},dynamicConfigArray:[],isInit:!1});Ye(()=>g.cfg.blogid,(v,T)=>{v!==T&&(y(v),s.debug("Watch logic triggered:",v))},{immediate:!0});const y=v=>{var M;const T=o("setting.blog.platform.support.common")+t.apiType+" ";let S=g.cfg.blogName;if((M=t.cfg)!=null&&M.knowledgeSpaceEnabled){const V=g.kwSpaces.find($=>$.value===v);console.log(V),S=V?V.label:g.cfg.blogid??g.cfg.blogName,g.cfg.blogName=S}g.settingTips=T+S},u=async()=>{var T;p.value=!0;let v;try{const S=await de.getAdaptor(t.apiType,g.cfg);s.debug("commonblogApiAdaptor=>",S);const V=await C.blogApi(e,S).getUsersBlogs(g.ksKeyword);if(V&&V.length>0){if(A.isEmptyString((T=g.cfg)==null?void 0:T.blogid)){g.kwSpaces.length==0&&V.forEach(J=>{const le={label:J.blogName,value:J.blogid};g.kwSpaces.push(le)});const $=V[0];g.cfg.blogid=$.blogid,g.cfg.blogName=$.blogName}g.cfg.apiStatus=!0}else v="接口返回信息不完整，请检查接口适配器",g.cfg.apiStatus=!1}catch(S){g.cfg.apiStatus=!1,v=S,s.error(o("main.opt.failure")+"=>",S)}g.cfg.apiStatus?Y.success(o("main.opt.success")):(s.error(v.toString()),Y.error(o("setting.blog.vali.error")+"=>"+v)),g.dynCfg.isAuth=g.cfg.apiStatus,await d(!0),p.value=!1,s.debug("Commonblog通用Setting验证完毕")},d=async v=>{s.debug("prepare to store cfg=>",{cfg:te(g.cfg)}),s.debug("Commonblog通用Setting保存配置"),g.setting[t.apiType]=g.cfg;const T=ot(g.dynamicConfigArray);g.setting[Me]=T,await n(g.setting),v!==!0&&Y.success(o("main.opt.success"))},b=async v=>{try{const T=await de.getAdaptor(t.apiType,g.cfg);s.debug("commonblogApiAdaptor=>",T);const M=await C.blogApi(e,T).getUsersBlogs(v);M&&M.length>0&&(M.forEach(V=>{const $={label:V.blogName,value:V.blogid};g.kwSpaces.push($)}),y(g.cfg.blogid),s.debug("已强制刷新"))}catch(T){s.error(o("main.opt.failure"),T)}},h=async()=>{var v;try{g.isCateLoading=!0,s.debug("reload categories for single category woth search"),g.kwSpaces=[],g.cfg.blogid=void 0,(v=t.cfg)!=null&&v.knowledgeSpaceEnabled&&await b(g.ksKeyword),c.value.visible=!0}catch(T){s.error("知识空间加载失败",T)}finally{g.isCateLoading=!1,g.isInit=!0}},E=async()=>{var S;g.setting=await i();const v=oe.safeParse(g.setting[Me],{});g.dynamicConfigArray=(v==null?void 0:v.totalCfg)||[],g.dynCfg=qa(g.dynamicConfigArray,t.apiType),s.debug("Commonblog通用Setting配置初始化");let T=t.cfg;if(se.isEmptyObject(T)){const M=g.setting[t.apiType];T=oe.safeParse(M,{})}T?(s.debug("get setting conf=>",T),g.cfg=T,(S=t.cfg)!=null&&S.knowledgeSpaceEnabled&&await b(g.ksKeyword)):Y.error("Read init config error, your config may not work")};return qe(async()=>{await E(),g.isInit=!0}),(v,T)=>{const S=qt,M=Ie,V=be,$=Ee,J=bo,le=wo,re=Je,ve=Xe,F=we,j=Re;return g.isInit?(w(),k(j,{key:1,"label-width":"120px"},{default:_(()=>{var O,ie,X,Ve,De;return[f(M,{closable:!1,title:g.settingTips,class:"top-tip",type:"info"},null,8,["title"]),(O=t.cfg)!=null&&O.knowledgeSpaceEnabled?(w(),k(M,{key:0,closable:!1,title:m(o)("knowledgeSpaceEnabled.Tips").replace(/\[knowledge-space-title\]/g,(ie=t.cfg)==null?void 0:ie.knowledgeSpaceTitle),class:"top-tip",type:"info"},null,8,["title"])):z("",!0),rt(v.$slots,"header",{cfg:g.cfg},void 0,!0),f($,{label:m(o)("setting.common.home")},{default:_(()=>{var ne;return[f(V,{modelValue:g.cfg.home,"onUpdate:modelValue":T[0]||(T[0]=Ue=>g.cfg.home=Ue),placeholder:(ne=t.cfg)==null?void 0:ne.placeholder.homePlaceholder,onInput:l},null,8,["modelValue","placeholder"])]}),_:1},8,["label"]),f($,{label:m(o)("setting.common.apiurl")},{default:_(()=>{var ne;return[f(V,{modelValue:g.cfg.apiUrl,"onUpdate:modelValue":T[1]||(T[1]=Ue=>g.cfg.apiUrl=Ue),placeholder:(ne=t.cfg)==null?void 0:ne.placeholder.apiUrlPlaceholder},null,8,["modelValue","placeholder"])]}),_:1},8,["label"]),t.cfg.usernameEnabled?(w(),k($,{key:1,label:m(o)("setting.common.username")},{default:_(()=>{var ne;return[f(V,{modelValue:g.cfg.username,"onUpdate:modelValue":T[2]||(T[2]=Ue=>g.cfg.username=Ue),placeholder:(ne=t.cfg)==null?void 0:ne.placeholder.usernamePlaceholder},null,8,["modelValue","placeholder"])]}),_:1},8,["label"])):z("",!0),g.cfg.passwordType===m(Ce).PasswordType_Password?(w(),k($,{key:2,label:m(o)("setting.common.password")},{default:_(()=>[f(V,{type:"password",modelValue:g.cfg.password,"onUpdate:modelValue":T[3]||(T[3]=ne=>g.cfg.password=ne),"show-password":"",placeholder:t.cfg.placeholder.passwordPlaceholder},null,8,["modelValue","placeholder"]),g.cfg.showTokenTip?(w(),N("a",{key:0,href:g.cfg.tokenSettingUrl,target:"_blank"},L(m(o)("setting.common.username.gen"))+"："+L(g.cfg.tokenSettingUrl),9,Up)):z("",!0)]),_:1},8,["label"])):g.cfg.passwordType===m(Ce).PasswordType_Token?(w(),k($,{key:3,label:m(o)("setting.common.token")},{default:_(()=>[f(V,{type:"password",modelValue:g.cfg.password,"onUpdate:modelValue":T[4]||(T[4]=ne=>g.cfg.password=ne),"show-password":"",placeholder:t.cfg.placeholder.passwordPlaceholder},null,8,["modelValue","placeholder"]),g.cfg.showTokenTip?(w(),N("a",{key:0,href:g.cfg.tokenSettingUrl,target:"_blank"},L(m(o)("setting.common.token.gen"))+"："+L(g.cfg.tokenSettingUrl),9,Op)):z("",!0)]),_:1},8,["label"])):(w(),k($,{key:4,label:"平台Cookie"},{default:_(()=>[f(V,{modelValue:g.cfg.password,"onUpdate:modelValue":T[5]||(T[5]=ne=>g.cfg.password=ne),style:{width:"75%","margin-right":"16px"},placeholder:"请直接粘贴平台cookie，为了您的隐私安全，请勿泄露cookie给任何人",type:"textarea",rows:10,disabled:!0},null,8,["modelValue"]),f(M,{closable:!1,title:"此处数据为网页授权自动生成，仅在您本地浏览器存储，不支持修改。为了您的安全，请勿泄露此处信息给任何人。",class:"inline-tip",type:"error"})]),_:1})),rt(v.$slots,"main",{cfg:g.cfg},void 0,!0),f($,{label:m(o)("setting.blog.previewUrl")},{default:_(()=>{var ne;return[f(V,{modelValue:g.cfg.previewUrl,"onUpdate:modelValue":T[6]||(T[6]=Ue=>g.cfg.previewUrl=Ue),placeholder:(ne=t.cfg)==null?void 0:ne.placeholder.previewUrlPlaceholder,disabled:!t.cfg.allowPreviewUrlChange},null,8,["modelValue","placeholder","disabled"])]}),_:1},8,["label"]),f($,{label:m(o)("setting.blog.pageType")},{default:_(()=>[f(le,{modelValue:g.cfg.pageType,"onUpdate:modelValue":T[7]||(T[7]=ne=>g.cfg.pageType=ne),class:"ml-4"},{default:_(()=>[f(J,{label:m(ce).Markdown,size:"large"},{default:_(()=>[G("Markdown")]),_:1},8,["label"]),f(J,{label:m(ce).Html,size:"large"},{default:_(()=>[G("HTML")]),_:1},8,["label"])]),_:1},8,["modelValue"])]),_:1},8,["label"]),(X=t.cfg)!=null&&X.cateSearchEnabled?(w(),k($,{key:5,class:"cate-input",label:"搜索关键词"},{default:_(()=>{var ne;return[f(V,{modelValue:g.ksKeyword,"onUpdate:modelValue":T[8]||(T[8]=Ue=>g.ksKeyword=Ue),placeholder:"请输入["+((ne=t.cfg)==null?void 0:ne.knowledgeSpaceTitle)+"]搜索关键词，输入完成后请按Enter键或者移走光标",onChange:h},null,8,["modelValue","placeholder"])]}),_:1})):z("",!0),(Ve=t.cfg)!=null&&Ve.knowledgeSpaceEnabled?(w(),k($,{key:6,label:(De=t.cfg)==null?void 0:De.knowledgeSpaceTitle},{default:_(()=>[f(ve,{modelValue:g.cfg.blogid,"onUpdate:modelValue":T[9]||(T[9]=ne=>g.cfg.blogid=ne),class:"m-2",placeholder:m(o)("main.opt.select"),"no-data-text":m(o)("main.data.empty"),loading:g.isCateLoading,"loading-text":"加载中...",ref_key:"singleCateSelect",ref:c},{default:_(()=>[(w(!0),N(_e,null,Te(g.kwSpaces,ne=>(w(),k(re,{key:ne.value,label:ne.label,value:ne.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue","placeholder","no-data-text","loading"])]),_:1},8,["label"])):z("",!0),f($,{label:m(o)("setting.blog.middlewareUrl")},{default:_(()=>[f(V,{modelValue:g.cfg.middlewareUrl,"onUpdate:modelValue":T[10]||(T[10]=ne=>g.cfg.middlewareUrl=ne),placeholder:m(o)("setting.blog.middlewareUrl.tip")},null,8,["modelValue","placeholder"]),f(M,{closable:!1,title:m(o)("setting.blog.middlewareUrl.my.tip"),class:"top-tip",type:"info"},null,8,["title"])]),_:1},8,["label"]),f($,null,{default:_(()=>[f(F,{type:"primary",loading:p.value,onClick:u},{default:_(()=>[G(L(p.value?m(o)("setting.blog.vali.ing"):m(o)("setting.blog.vali")),1)]),_:1},8,["loading"]),g.cfg.apiStatus?z("",!0):(w(),k(M,{key:0,title:m(o)("setting.blog.vali.tip.metaweblog"),type:"warning",closable:!1},null,8,["title"])),g.cfg.apiStatus?(w(),k(M,{key:1,title:m(o)("setting.blog.vali.ok.metaweblog"),type:"success",closable:!1},null,8,["title"])):z("",!0)]),_:1}),f($,null,{default:_(()=>[f(F,{type:"primary",onClick:d},{default:_(()=>[G(L(m(o)("setting.blog.save")),1)]),_:1}),f(F,null,{default:_(()=>[G(L(m(o)("setting.blog.cancel")),1)]),_:1})]),_:1}),rt(v.$slots,"footer",{cfg:g.cfg},void 0,!0)]}),_:3})):(w(),k(S,{key:0,class:"placeholder",rows:5,animated:""}))}}});const Bt=ue(Mp,[["__scopeId","data-v-024d80dd"]]),ns=H({__name:"CustomWebSetting",props:{apiType:{type:String,default:""},cfg:{type:Object,default:null}},setup(r){const a=r;return(t,s)=>{const e=Bt;return w(),k(e,{"api-type":a.apiType,cfg:a.cfg},null,8,["api-type","cfg"])}}});class Ip extends xt{}const xp=H({__name:"JuejinSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>$a(s.apiType)),a=await a,t(),a),i=o,n=new Ip;return n.homePlaceholder=e("setting.juejin.home.tip"),n.apiUrlPlaceholder=e("setting.juejin.apiUrl.tip"),n.passwordPlaceholder=e("setting.juejin.password.tip"),n.previewUrlPlaceholder=e("setting.juejin.previewUrl.tip"),i.placeholder=n,(l,p)=>(w(),k(ns,{"api-type":s.apiType,cfg:m(i)},null,8,["api-type","cfg"]))}});class Vp extends xt{}const Np=H({__name:"JianshuSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>Ga(s.apiType)),a=await a,t(),a),i=o,n=new Vp;return n.homePlaceholder=e("setting.jianshu.home.tip"),n.apiUrlPlaceholder=e("setting.jianshu.apiUrl.tip"),n.passwordPlaceholder=e("setting.jianshu.password.tip"),n.previewUrlPlaceholder=e("setting.jianshu.previewUrl.tip"),i.placeholder=n,(l,p)=>(w(),k(ns,{"api-type":s.apiType,cfg:m(i)},null,8,["api-type","cfg"]))}});class Bp extends xt{}const Gp=H({__name:"WechatSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>Ba(s.apiType)),a=await a,t(),a),i=o,n=new Bp;return n.homePlaceholder=e("setting.wechat.home.tip"),n.apiUrlPlaceholder=e("setting.wechat.apiUrl.tip"),n.passwordPlaceholder=e("setting.wechat.password.tip"),n.previewUrlPlaceholder=e("setting.wechat.previewUrl.tip"),i.placeholder=n,(l,p)=>(w(),k(ns,{"api-type":s.apiType,cfg:m(i)},null,8,["api-type","cfg"]))}});class $p extends xt{}const Lp=H({__name:"CsdnSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>Na(s.apiType)),a=await a,t(),a),i=o,n=new $p;return n.homePlaceholder=e("setting.csdn.home.tip"),n.apiUrlPlaceholder=e("setting.csdn.apiUrl.tip"),n.passwordPlaceholder=e("setting.csdn.password.tip"),n.previewUrlPlaceholder=e("setting.csdn.previewUrl.tip"),i.placeholder=n,(l,p)=>(w(),k(ns,{"api-type":s.apiType,cfg:m(i)},null,8,["api-type","cfg"]))}});class jp extends xt{}const Hp=H({__name:"ZhihuSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>Ia(s.apiType)),a=await a,t(),a),i=o,n=new jp;return n.homePlaceholder=e("setting.zhihu.home.tip"),n.apiUrlPlaceholder=e("setting.zhihu.apiUrl.tip"),n.usernamePlaceholder=e("setting.zhihu.username.tip"),n.passwordPlaceholder=e("setting.zhihu.password.tip"),n.previewUrlPlaceholder=e("setting.zhihu.previewUrl.tip"),i.placeholder=n,(l,p)=>(w(),k(ns,{"api-type":s.apiType,cfg:m(i)},null,8,["api-type","cfg"]))}}),As=H({__name:"MetaweblogSetting",props:{apiType:{type:String,default:""},cfg:{type:Object,default:null}},setup(r){const a=r;return(t,s)=>{const e=Bt;return w(),k(e,{"api-type":a.apiType,cfg:a.cfg},null,8,["api-type","cfg"])}}});class Rp extends Zt{}const Fp=H({__name:"WordpressSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,e=(p,c)=>{const{home:g,apiUrl:y}=eo.parseHomeAndUrl(p);c.home=g,c.apiUrl=y,A.isEmptyString(c.home)&&(c.apiUrl="")},{t:o}=K(),{cfg:i}=([a,t]=Pe(()=>Ua(s.apiType)),a=await a,t(),a),n=i,l=new Rp;return l.homePlaceholder=o("setting.wordpress.home.tip"),l.usernamePlaceholder=o("setting.wordpress.username.tip"),l.passwordPlaceholder=o("setting.wordpress.password.tip"),l.apiUrlPlaceholder=o("setting.wordpress.apiUrl.tip"),l.previewUrlPlaceholder=o("setting.wordpress.previewUrl.tip"),n.placeholder=l,(p,c)=>(w(),k(As,{"api-type":s.apiType,cfg:m(n),onOnHomeChange:e},null,8,["api-type","cfg"]))}});class Kp extends Zt{}const Yp=H({__name:"TypechoSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,e=(p,c)=>{const{home:g,apiUrl:y}=to.parseHomeAndUrl(p);c.home=g,c.apiUrl=y,A.isEmptyString(c.home)&&(c.apiUrl="")},{t:o}=K(),{cfg:i}=([a,t]=Pe(()=>Oa(s.apiType)),a=await a,t(),a),n=i,l=new Kp;return l.homePlaceholder=o("setting.typecho.home.tip"),l.usernamePlaceholder=o("setting.typecho.username.tip"),l.passwordPlaceholder=o("setting.typecho.password.tip"),l.apiUrlPlaceholder=o("setting.typecho.apiUrl.tip"),l.previewUrlPlaceholder=o("setting.typecho.previewUrl.tip"),n.placeholder=l,(p,c)=>(w(),k(As,{"api-type":s.apiType,cfg:m(n),onOnHomeChange:e},null,8,["api-type","cfg"]))}});class zp extends Zt{}const Wp=H({__name:"CnblogsSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>Da(s.apiType)),a=await a,t(),a),i=o,n=new zp;return n.homePlaceholder=e("setting.cnblogs.home.tip"),n.usernamePlaceholder=e("setting.cnblogs.username.tip"),n.passwordPlaceholder=e("setting.cnblogs.password.tip"),n.apiUrlPlaceholder=e("setting.cnblogs.apiUrl.tip"),n.previewUrlPlaceholder=e("setting.cnblogs.previewUrl.tip"),i.placeholder=n,(l,p)=>(w(),k(As,{"api-type":s.apiType,cfg:m(i)},null,8,["api-type","cfg"]))}}),qp=H({__name:"OthermetaSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>xa(s.apiType)),a=await a,t(),a),i=o,n=new Zt;return n.homePlaceholder=e("setting.metaweblog.home.tip"),n.usernamePlaceholder=e("setting.metaweblog.username.tip"),n.passwordPlaceholder=e("setting.metaweblog.password.tip"),n.apiUrlPlaceholder=e("setting.metaweblog.apiUrl.tip"),n.previewUrlPlaceholder=e("setting.metaweblog.previewUrl.tip"),i.placeholder=n,(l,p)=>(w(),k(As,{"api-type":s.apiType,cfg:m(i)},null,8,["api-type","cfg"]))}}),Jp={key:0},Xp=H({__name:"CommonGithubSetting",props:{apiType:{type:String,default:""},cfg:{type:Object,default:null}},setup(r){const a=r,t=B("common-blog-setting"),{t:s}=K(),e=ae({showAdvancedConfig:!1,advanceBtnText:"显示更多配置"}),o=()=>{e.showAdvancedConfig?(e.showAdvancedConfig=!e.showAdvancedConfig,e.advanceBtnText="显示更多配置"):(e.showAdvancedConfig=!e.showAdvancedConfig,e.advanceBtnText="隐藏更多配置")},i=n=>{n.blogid=n.defaultPath,t.debug("sync defaultPath to blogid",{cfg:te(n)})};return(n,l)=>{const p=be,c=Ee,g=Ct,y=Bt;return w(),k(y,{"api-type":a.apiType,cfg:a.cfg},{header:_(u=>[rt(n.$slots,"header",{cfg:u.cfg},void 0,!0)]),main:_(u=>[f(c,{label:m(s)("setting.blog.type.github.repo")},{default:_(()=>[f(p,{modelValue:u.cfg.githubRepo,"onUpdate:modelValue":d=>u.cfg.githubRepo=d,placeholder:m(s)("setting.blog.type.github.repo.tip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"]),f(c,{label:m(s)("setting.blog.yamlLinkEnabled")},{default:_(()=>[f(g,{modelValue:u.cfg.yamlLinkEnabled,"onUpdate:modelValue":d=>u.cfg.yamlLinkEnabled=d},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1032,["label"]),f(c,null,{default:_(()=>[P("a",{href:"javascript:;",onClick:o},L(e.advanceBtnText),1)]),_:1}),f(c,{label:m(s)("setting.blog.type.github.default.branch")},{default:_(()=>[f(p,{modelValue:u.cfg.githubBranch,"onUpdate:modelValue":d=>u.cfg.githubBranch=d,placeholder:m(s)("setting.blog.type.github.default.branch.tip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"]),f(c,{label:m(s)("setting.blog.type.github.default.path")},{default:_(()=>[f(p,{modelValue:u.cfg.defaultPath,"onUpdate:modelValue":d=>u.cfg.defaultPath=d,onInput:d=>i(u.cfg),placeholder:m(s)("setting.blog.type.github.default.path.tip")},null,8,["modelValue","onUpdate:modelValue","onInput","placeholder"])]),_:2},1032,["label"]),e.showAdvancedConfig?(w(),N("div",Jp,[f(c,{label:m(s)("setting.blog.type.github.msg")},{default:_(()=>[f(p,{modelValue:u.cfg.defaultMsg,"onUpdate:modelValue":d=>u.cfg.defaultMsg=d,placeholder:m(s)("setting.blog.type.github.msg.tip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"]),f(c,{label:m(s)("setting.blog.type.github.author")},{default:_(()=>[f(p,{modelValue:u.cfg.author,"onUpdate:modelValue":d=>u.cfg.author=d,placeholder:m(s)("setting.blog.type.github.author")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"]),f(c,{label:m(s)("setting.blog.type.github.email")},{default:_(()=>[f(p,{modelValue:u.cfg.email,"onUpdate:modelValue":d=>u.cfg.email=d,placeholder:m(s)("setting.blog.type.github.email.tip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"]),f(c,{label:m(s)("setting.blog.mdFilenameRule")},{default:_(()=>[f(p,{modelValue:u.cfg.mdFilenameRule,"onUpdate:modelValue":d=>u.cfg.mdFilenameRule=d,placeholder:m(s)("setting.blog.mdFilenameRule.tip"),disabled:!0},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"]),f(c,{label:m(s)("setting.blog.previewPostUrl")},{default:_(()=>[f(p,{modelValue:u.cfg.previewPostUrl,"onUpdate:modelValue":d=>u.cfg.previewPostUrl=d,placeholder:m(s)("setting.blog.previewPostUrl.tip")},null,8,["modelValue","onUpdate:modelValue","placeholder"])]),_:2},1032,["label"])])):z("",!0),rt(n.$slots,"main",{cfg:u.cfg},void 0,!0)]),footer:_(u=>[rt(n.$slots,"footer",{cfg:u.cfg},void 0,!0)]),_:3},8,["api-type","cfg"])}}});const st=ue(Xp,[["__scopeId","data-v-6f1315db"]]);class Gt extends Mt{}class li extends Gt{}class Zp extends li{}const Qp=H({__name:"GitlabvitepressSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>ws(s.apiType)),a=await a,t(),a),i=o,n=new Zp;n.homePlaceholder=e("setting.blog.gitlab.url.tip"),n.usernamePlaceholder=e("setting.blog.type.gitlab.user.tip"),n.passwordPlaceholder=e("setting.blog.type.gitlab.token.tip"),n.apiUrlPlaceholder=e("setting.blog.gitlab.apiurl.tip"),n.previewUrlPlaceholder=e("setting.blog.gitlab.previewUrl.tip"),i.placeholder=n;const l=(p,c)=>{A.isEmptyString(c.home)?c.apiUrl="":(c.apiUrl=c.home,c.tokenSettingUrl=`${c.home}/-/profile/personal_access_tokens`)};return(p,c)=>{const g=st;return w(),k(g,{"api-type":s.apiType,cfg:m(i),onOnHomeChange:l},{header:_(y=>[]),main:_(y=>[]),footer:_(y=>[]),_:1},8,["api-type","cfg"])}}});class ri extends Gt{}class ci extends ri{}const eu=H({__name:"Gitlabvuepress2Setting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>bs(s.apiType)),a=await a,t(),a),i=o,n=new ci;n.homePlaceholder=e("setting.blog.gitlab.url.tip"),n.usernamePlaceholder=e("setting.blog.type.gitlab.user.tip"),n.passwordPlaceholder=e("setting.blog.type.gitlab.token.tip"),n.apiUrlPlaceholder=e("setting.blog.gitlab.apiurl.tip"),n.previewUrlPlaceholder=e("setting.blog.gitlab.previewUrl.tip"),i.placeholder=n;const l=(p,c)=>{A.isEmptyString(c.home)?c.apiUrl="":(c.apiUrl=c.home,c.tokenSettingUrl=`${c.home}/-/profile/personal_access_tokens`)};return(p,c)=>{const g=st;return w(),k(g,{"api-type":s.apiType,cfg:m(i),onOnHomeChange:l},{header:_(y=>[]),main:_(y=>[]),footer:_(y=>[]),_:1},8,["api-type","cfg"])}}}),tu=H({__name:"GitlabvuepressSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>ys(s.apiType)),a=await a,t(),a),i=o,n=new ci;n.homePlaceholder=e("setting.blog.gitlab.url.tip"),n.usernamePlaceholder=e("setting.blog.type.gitlab.user.tip"),n.passwordPlaceholder=e("setting.blog.type.gitlab.token.tip"),n.apiUrlPlaceholder=e("setting.blog.gitlab.apiurl.tip"),n.previewUrlPlaceholder=e("setting.blog.gitlab.previewUrl.tip"),i.placeholder=n;const l=(p,c)=>{A.isEmptyString(c.home)?c.apiUrl="":(c.apiUrl=c.home,c.tokenSettingUrl=`${c.home}/-/profile/personal_access_tokens`)};return(p,c)=>{const g=st;return w(),k(g,{"api-type":s.apiType,cfg:m(i),onOnHomeChange:l},{header:_(y=>[]),main:_(y=>[]),footer:_(y=>[]),_:1},8,["api-type","cfg"])}}});class pi extends Gt{}class su extends pi{}const au=H({__name:"GitlabjekyllSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>ms(s.apiType)),a=await a,t(),a),i=o,n=new su;n.homePlaceholder=e("setting.blog.gitlab.url.tip"),n.usernamePlaceholder=e("setting.blog.type.gitlab.user.tip"),n.passwordPlaceholder=e("setting.blog.type.gitlab.token.tip"),n.apiUrlPlaceholder=e("setting.blog.gitlab.apiurl.tip"),n.previewUrlPlaceholder=e("setting.blog.gitlab.previewUrl.tip"),i.placeholder=n;const l=(p,c)=>{A.isEmptyString(c.home)?c.apiUrl="":(c.apiUrl=c.home,c.tokenSettingUrl=`${c.home}/-/profile/personal_access_tokens`)};return(p,c)=>{const g=st;return w(),k(g,{"api-type":s.apiType,cfg:m(i),onOnHomeChange:l},{header:_(y=>[]),main:_(y=>[]),footer:_(y=>[]),_:1},8,["api-type","cfg"])}}});class ui extends Gt{}class ou extends ui{}const iu=H({__name:"GitlabhugoSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>gs(s.apiType)),a=await a,t(),a),i=o,n=new ou;n.homePlaceholder=e("setting.blog.gitlab.url.tip"),n.usernamePlaceholder=e("setting.blog.type.gitlab.user.tip"),n.passwordPlaceholder=e("setting.blog.type.gitlab.token.tip"),n.apiUrlPlaceholder=e("setting.blog.gitlab.apiurl.tip"),n.previewUrlPlaceholder=e("setting.blog.gitlab.previewUrl.tip"),i.placeholder=n;const l=(p,c)=>{A.isEmptyString(c.home)?c.apiUrl="":(c.apiUrl=c.home,c.tokenSettingUrl=`${c.home}/-/profile/personal_access_tokens`)};return(p,c)=>{const g=st;return w(),k(g,{"api-type":s.apiType,cfg:m(i),onOnHomeChange:l},{header:_(y=>[]),main:_(y=>[]),footer:_(y=>[]),_:1},8,["api-type","cfg"])}}});class gi extends Gt{}class nu extends gi{}const lu=H({__name:"GitlabhexoSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>ps(s.apiType)),a=await a,t(),a),i=o,n=new nu;n.homePlaceholder=e("setting.blog.gitlab.url.tip"),n.usernamePlaceholder=e("setting.blog.type.gitlab.user.tip"),n.passwordPlaceholder=e("setting.blog.type.gitlab.token.tip"),n.apiUrlPlaceholder=e("setting.blog.gitlab.apiurl.tip"),n.previewUrlPlaceholder=e("setting.blog.gitlab.previewUrl.tip"),i.placeholder=n;const l=(p,c)=>{A.isEmptyString(c.home)?c.apiUrl="":(c.apiUrl=c.home,c.tokenSettingUrl=`${c.home}/-/profile/personal_access_tokens`)};return(p,c)=>{const g=st;return w(),k(g,{"api-type":s.apiType,cfg:m(i),onOnHomeChange:l},{header:_(y=>[]),main:_(y=>[]),footer:_(y=>[]),_:1},8,["api-type","cfg"])}}}),ru=H({__name:"VitepressSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>_s(s.apiType)),a=await a,t(),a),i=o,n=new li;return n.homePlaceholder=e("setting.blog.github.url.tip"),n.usernamePlaceholder=e("setting.blog.type.github.user.tip"),n.passwordPlaceholder=e("setting.blog.type.github.token.tip"),n.apiUrlPlaceholder=e("setting.blog.github.apiurl.tip"),n.previewUrlPlaceholder=e("setting.blog.previewUrl.tip"),i.placeholder=n,(l,p)=>{const c=st;return w(),k(c,{"api-type":s.apiType,cfg:m(i)},{header:_(g=>[]),main:_(g=>[]),footer:_(g=>[]),_:1},8,["api-type","cfg"])}}});class cu extends Gt{}const pu=H({__name:"Vuepress2Setting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>fs(s.apiType)),a=await a,t(),a),i=o,n=new cu;return n.homePlaceholder=e("setting.blog.github.url.tip"),n.usernamePlaceholder=e("setting.blog.type.github.user.tip"),n.passwordPlaceholder=e("setting.blog.type.github.token.tip"),n.apiUrlPlaceholder=e("setting.blog.github.apiurl.tip"),n.previewUrlPlaceholder=e("setting.blog.previewUrl.tip"),i.placeholder=n,(l,p)=>{const c=st;return w(),k(c,{"api-type":s.apiType,cfg:m(i)},{header:_(g=>[]),main:_(g=>[]),footer:_(g=>[]),_:1},8,["api-type","cfg"])}}}),uu=H({__name:"VuepressSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>hs(s.apiType)),a=await a,t(),a),i=o,n=new ri;return n.homePlaceholder=e("setting.blog.github.url.tip"),n.usernamePlaceholder=e("setting.blog.type.github.user.tip"),n.passwordPlaceholder=e("setting.blog.type.github.token.tip"),n.apiUrlPlaceholder=e("setting.blog.github.apiurl.tip"),n.previewUrlPlaceholder=e("setting.blog.previewUrl.tip"),i.placeholder=n,(l,p)=>{const c=st;return w(),k(c,{"api-type":s.apiType,cfg:m(i)},{header:_(g=>[]),main:_(g=>[]),footer:_(g=>[]),_:1},8,["api-type","cfg"])}}}),gu=H({__name:"JekyllSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>ds(s.apiType)),a=await a,t(),a),i=o,n=new pi;return n.homePlaceholder=e("setting.blog.github.url.tip"),n.usernamePlaceholder=e("setting.blog.type.github.user.tip"),n.passwordPlaceholder=e("setting.blog.type.github.token.tip"),n.apiUrlPlaceholder=e("setting.blog.github.apiurl.tip"),n.previewUrlPlaceholder=e("setting.blog.previewUrl.tip"),i.placeholder=n,(l,p)=>{const c=st;return w(),k(c,{"api-type":s.apiType,cfg:m(i)},{header:_(g=>[]),main:_(g=>[]),footer:_(g=>[]),_:1},8,["api-type","cfg"])}}}),du=H({__name:"HugoSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>us(s.apiType)),a=await a,t(),a),i=o,n=new ui;return n.homePlaceholder=e("setting.blog.github.url.tip"),n.usernamePlaceholder=e("setting.blog.type.github.user.tip"),n.passwordPlaceholder=e("setting.blog.type.github.token.tip"),n.apiUrlPlaceholder=e("setting.blog.github.apiurl.tip"),n.previewUrlPlaceholder=e("setting.blog.previewUrl.tip"),i.placeholder=n,(l,p)=>{const c=st;return w(),k(c,{"api-type":s.apiType,cfg:m(i)},{header:_(g=>[]),main:_(g=>[]),footer:_(g=>[]),_:1},8,["api-type","cfg"])}}}),mu=H({__name:"HexoSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>cs(s.apiType)),a=await a,t(),a),i=o,n=new gi;return n.homePlaceholder=e("setting.blog.github.url.tip"),n.usernamePlaceholder=e("setting.blog.type.github.user.tip"),n.passwordPlaceholder=e("setting.blog.type.github.token.tip"),n.apiUrlPlaceholder=e("setting.blog.github.apiurl.tip"),n.previewUrlPlaceholder=e("setting.blog.previewUrl.tip"),i.placeholder=n,(l,p)=>{const c=st;return w(),k(c,{"api-type":s.apiType,cfg:m(i)},{header:_(g=>[]),main:_(g=>[]),footer:_(g=>[]),_:1},8,["api-type","cfg"])}}});class hu extends Mt{}const yu=H({__name:"HaloSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>La(s.apiType)),a=await a,t(),a),i=o,n=new hu;n.homePlaceholder=e("setting.halo.home.tip"),n.usernamePlaceholder=e("setting.halo.username.tip"),n.passwordPlaceholder=e("setting.halo.password.tip"),n.apiUrlPlaceholder=e("setting.halo.apiUrl.tip"),n.previewUrlPlaceholder=e("setting.halo.previewUrl.tip"),i.placeholder=n;const l=(p,c)=>{A.isEmptyString(c.home)?c.apiUrl="":c.apiUrl=c.home};return(p,c)=>(w(),k(Bt,{"api-type":s.apiType,cfg:m(i),onOnHomeChange:l},null,8,["api-type","cfg"]))}});class fu extends Mt{}const _u=H({__name:"NotionSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>Va(s.apiType)),a=await a,t(),a),i=o,n=new fu;return n.homePlaceholder=e("setting.notion.home.tip"),n.passwordPlaceholder=e("setting.notion.password.tip"),n.apiUrlPlaceholder=e("setting.notion.apiurl.tip"),n.previewUrlPlaceholder=e("setting.notion.previewUrl.tip"),i.placeholder=n,(l,p)=>(w(),k(Bt,{"api-type":s.apiType,cfg:m(i)},null,8,["api-type","cfg"]))}});class bu extends Mt{}const wu=H({__name:"YuqueSetting",props:{apiType:{type:String,default:""}},async setup(r){let a,t;const s=r,{t:e}=K(),{cfg:o}=([a,t]=Pe(()=>Ma(s.apiType)),a=await a,t(),a),i=o,n=new bu;return n.homePlaceholder=e("setting.yuque.home.tip"),n.usernamePlaceholder=e("setting.yuque.username.tip"),n.passwordPlaceholder=e("setting.yuque.password.tip"),n.apiUrlPlaceholder=e("setting.yuque.apiurl.tip"),n.previewUrlPlaceholder=e("setting.yuque.previewUrl.tip"),i.placeholder=n,(l,p)=>(w(),k(Bt,{"api-type":s.apiType,cfg:m(i)},null,8,["api-type","cfg"]))}}),Eu={key:24},vu=H({__name:"SingleSettingIndex",setup(r){const{t:a}=K(),t=$e(),e=ae(t.params).key,o=ls(e);return(i,n)=>{const l=wu,p=_u,c=yu,g=mu,y=du,u=gu,d=uu,b=pu,h=ru,E=lu,v=iu,T=au,S=tu,M=eu,V=Qp,$=qp,J=Wp,le=Yp,re=Fp,ve=Hp,F=Lp,j=Gp,O=Np,ie=xp,X=Ie;return w(),k(Oe,{title:m(a)("setting.entry.title")+m(e)},{default:_(()=>[m(o)===m(D).Common_Yuque?(w(),k(l,{key:0,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Common_Notion?(w(),k(p,{key:1,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Common_Halo?(w(),k(c,{key:2,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Github_Hexo?(w(),k(g,{key:3,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Github_Hugo?(w(),k(y,{key:4,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Github_Jekyll?(w(),k(u,{key:5,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Github_Vuepress?(w(),k(d,{key:6,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Github_Vuepress2?(w(),k(b,{key:7,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Github_Vitepress?(w(),k(h,{key:8,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Gitlab_Hexo?(w(),k(E,{key:9,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Gitlab_Hugo?(w(),k(v,{key:10,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Gitlab_Jekyll?(w(),k(T,{key:11,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Gitlab_Vuepress?(w(),k(S,{key:12,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Gitlab_Vuepress2?(w(),k(M,{key:13,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Gitlab_Vitepress?(w(),k(V,{key:14,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Metaweblog_Metaweblog?(w(),k($,{key:15,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Metaweblog_Cnblogs?(w(),k(J,{key:16,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Metaweblog_Typecho?(w(),k(le,{key:17,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Wordpress_Wordpress?(w(),k(re,{key:18,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Custom_Zhihu?(w(),k(ve,{key:19,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Custom_CSDN?(w(),k(F,{key:20,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Custom_Wechat?(w(),k(j,{key:21,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Custom_Jianshu?(w(),k(O,{key:22,"api-type":m(e)},null,8,["api-type"])):m(o)===m(D).Custom_Juejin?(w(),k(ie,{key:23,"api-type":m(e)},null,8,["api-type"])):(w(),N("span",Eu,[f(X,{closable:!1,title:m(a)("setting.entry.not.supported"),class:"top-tip",type:"error"},null,8,["title"])]))]),_:1},8,["title"])}}});const Tu=ue(vu,[["__scopeId","data-v-89cad104"]]),Pu={key:0},ku=["innerHTML"],Su={key:0},Au=H({__name:"PlatformAddForm",setup(r){const a=B("platform-add-form"),{t}=K(),s=ct(),e=$e(),{query:o}=$e(),{getPlatformType:i,getPrePlatform:n}=co(),{getSetting:l,updateSetting:p,checkKeyExists:c}=me(),g=ae(e.params),y=g.type,u=Z(),d=ae({setting:{},ptype:y,subtype:void 0,subtypeOptions:[],isPre:!1,dynCfg:new Ht(y,Rt(y,void 0),"None-1"),dynamicConfigArray:[]}),b=ae({platformName:[{required:!0,message:()=>t("form.validate.name.required")}],authMode:[{required:!0,message:()=>t("form.validate.name.required")}],platformIcon:[{required:!0,message:()=>t("form.validate.name.required")}]}),h=M=>{if(!d.subtype)return Y.error("请选择子平台类型"),!1;const V=d.dynCfg.platformKey;return c(V)?(Y.error(t("dynamic.platform.opt.key.exist")),!1):!0},E=async M=>{if(!M||!h()||!await M.validate((le,re)=>{le?a.debug("校验成功"):a.error(t("main.opt.failure"),re)}))return;const $=d.dynCfg;d.dynamicConfigArray.push($);const J=ot(d.dynamicConfigArray);d.setting[Me]=J,d.setting[$.platformKey]={},await p(d.setting),Y.success(t("main.opt.success")),await s.push({path:"/setting/publish"})},v=async()=>{await T(d.ptype,d.subtype)},T=async(M,V)=>{const $=o.key;d.setting=await l();const J=oe.safeParse(d.setting[Me],{});if(d.dynamicConfigArray=(J==null?void 0:J.totalCfg)||[],!d.ptype){Y.error("平台类型不能为空");return}const le=i(d.ptype);let re=A.isEmptyString(le.img)?fe.iconEPPlus:`<img src="${le.img}" alt="platform-icon" class="img-platform-icon" style="width: 32px;height: 32px;"/>`;if($&&V)if(d.subtype=V,$o(d.dynamicConfigArray,$)){const F=n($);re=F.platformIcon;const j=Rt(M,V),O=new Ht(M,j,j,V,re);O.authMode=F.authMode,O.authUrl=F.authUrl??"",O.domain=F.domain??"",d.dynCfg=O,a.debug("pkey already exists, initialize the new one")}else{const F=n($);d.dynCfg=F,d.isPre=!0,a.debug("Initialized via pkey")}else if(V){d.subtype=V;const ve=Rt(M,V);d.dynCfg=new Ht(M,ve,ve,V,re),a.debug("Initialized by subtype")}else{d.subtypeOptions=ol(M);const ve=Rt(M,V);d.dynCfg=new Ht(M,ve,ve,V,re),a.debug("Initialize by selecting a subtype")}};return(async()=>{const M=g.type,V=o.sub;await T(M,V)})(),(M,V)=>{const $=Ie,J=Je,le=Xe,re=Ee,ve=be,F=Ts,j=Ct,O=we,ie=Re;return w(),k(Oe,{title:"新增自定义平台 - "+m(y)},{default:_(()=>[f(ie,{class:"add-form",ref_key:"formRef",ref:u,"label-width":"100px",model:d.dynCfg,rules:b},{default:_(()=>[d.isPre?(w(),k($,{key:0,class:"top-tip",title:"当前为初次添加，将导入该平台的预定义模板；如果再次添加，将生成可修改的新实例",type:"error",closable:!1})):z("",!0),f($,{class:"top-tip",title:"当前平台类型为=>"+m(y),type:"info",closable:!1},null,8,["title"]),d.subtypeOptions.length>0?(w(),k(re,{key:1,label:"子平台类型"},{default:_(()=>[f(le,{modelValue:d.subtype,"onUpdate:modelValue":V[0]||(V[0]=X=>d.subtype=X),class:"m-2",placeholder:"请选择",onChange:v},{default:_(()=>[(w(!0),N(_e,null,Te(d.subtypeOptions,X=>(w(),k(J,{key:X,label:X,value:X},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),_:1})):(w(),k($,{key:2,class:"top-tip",title:"子平台类型为=>"+d.subtype,type:"info",closable:!1},null,8,["title"])),f(re,{label:m(t)("dynamic.platform.key"),prop:"platformKey"},{default:_(()=>[G(L(d.dynCfg.platformKey),1)]),_:1},8,["label"]),f(re,{label:"平台名称",prop:"platformName"},{default:_(()=>[d.isPre?(w(),N("span",Pu,L(d.dynCfg.platformName),1)):(w(),k(ve,{key:1,modelValue:d.dynCfg.platformName,"onUpdate:modelValue":V[1]||(V[1]=X=>d.dynCfg.platformName=X)},null,8,["modelValue"]))]),_:1}),f(re,{label:"平台图标",prop:"platformIcon",class:"cfg-icon"},{default:_(()=>[d.isPre?z("",!0):(w(),k(ve,{key:0,modelValue:d.dynCfg.platformIcon,"onUpdate:modelValue":V[2]||(V[2]=X=>d.dynCfg.platformIcon=X),style:{width:"75%","margin-right":"16px"},placeholder:"直接粘贴svg代码或者img标签代码",type:"textarea",rows:10},null,8,["modelValue"])),f(F,null,{default:_(()=>[P("span",{innerHTML:d.dynCfg.platformIcon},null,8,ku)]),_:1})]),_:1}),f(re,{label:"授权方式",prop:"authMode"},{default:_(()=>[d.isPre?(w(),N("span",Su,L(d.dynCfg.authMode===m(pe).API?"API授权":"网页授权"),1)):(w(),k(le,{key:1,modelValue:d.dynCfg.authMode,"onUpdate:modelValue":V[3]||(V[3]=X=>d.dynCfg.authMode=X),placeholder:"请选择"},{default:_(()=>[f(J,{value:m(pe).API,label:"API授权"},null,8,["value"]),f(J,{value:m(pe).WEBSITE,label:"网页授权"},null,8,["value"])]),_:1},8,["modelValue"]))]),_:1}),d.dynCfg.authMode===m(pe).WEBSITE?(w(),k(re,{key:3,label:"登录地址",prop:"authUrl"},{default:_(()=>[f(ve,{modelValue:d.dynCfg.authUrl,"onUpdate:modelValue":V[4]||(V[4]=X=>d.dynCfg.authUrl=X),placeholder:"请输入该平台的网页登录地址"},null,8,["modelValue"])]),_:1})):z("",!0),d.dynCfg.authMode===m(pe).WEBSITE?(w(),k(re,{key:4,label:"主域名",prop:"domain"},{default:_(()=>[f(ve,{modelValue:d.dynCfg.domain,"onUpdate:modelValue":V[5]||(V[5]=X=>d.dynCfg.domain=X),placeholder:"请输入该平台的主域名"},null,8,["modelValue"])]),_:1})):z("",!0),f(re,{label:"是否启用"},{default:_(()=>[f(j,{modelValue:d.dynCfg.isEnabled,"onUpdate:modelValue":V[6]||(V[6]=X=>d.dynCfg.isEnabled=X)},null,8,["modelValue"])]),_:1}),f(re,null,{default:_(()=>[f(O,{type:"primary",onClick:V[7]||(V[7]=X=>E(u.value))},{default:_(()=>[G(L(m(t)("dynamic.platform.opt.add")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])}}});const Cu=ue(Au,[["__scopeId","data-v-28e31b41"]]),Du=["innerHTML"],Uu=H({__name:"PlatformUpdateForm",setup(r){const a=B("platform-update-form"),{t}=K(),s=ct(),e=$e(),{getSetting:o,updateSetting:i}=me(),l=ae(e.params).key,p=Z(),c=ae({key:l,dynCfg:new Ht(he.Common,Rt(he.Common,void 0),"None-1"),setting:{},dynamicConfigArray:[]}),g=ae({platformName:[{required:!0,message:()=>t("form.validate.name.required")}],authMode:[{required:!0,message:()=>t("form.validate.name.required")}],platformIcon:[{required:!0,message:()=>t("form.validate.name.required")}]}),y=async b=>{if(!b||!await b.validate((T,S)=>{T?a.debug("校验成功"):a.error(t("main.opt.failure"),S)}))return;const E=c.dynCfg;yt(c.dynamicConfigArray,l,E);const v=ot(c.dynamicConfigArray);c.setting[Me]=v,await i(c.setting),Y.success(t("main.opt.success")),await s.push({path:"/setting/publish"})},u=async b=>{c.setting=await o();const h=oe.safeParse(c.setting[Me],{});c.dynamicConfigArray=(h==null?void 0:h.totalCfg)||[],c.dynCfg=qa(c.dynamicConfigArray,b)};return(async()=>{await u(c.key)})(),(b,h)=>{const E=Ie,v=Ee,T=be,S=Ts,M=Je,V=Xe,$=Ct,J=we,le=Re;return w(),k(Oe,{title:"修改平台定义 - "+m(l)},{default:_(()=>[f(le,{class:"update-form",ref_key:"formRef",ref:p,"label-width":"100px",model:c.dynCfg,rules:g},{default:_(()=>[f(E,{class:"top-tip",title:"当前平台类型为=>"+c.dynCfg.platformKey,type:"info",closable:!1},null,8,["title"]),f(E,{class:"top-tip",title:"子平台类型为=>"+c.dynCfg.subPlatformType,type:"info",closable:!1},null,8,["title"]),f(E,{class:"top-tip",title:"注意：为了保留配置信息的完整性，编辑平台时授权方式不可修改，如需切换，请新建新的实例",type:"warning",closable:!1}),f(v,{label:m(t)("dynamic.platform.key"),prop:"platformKey"},{default:_(()=>[G(L(c.dynCfg.platformKey),1)]),_:1},8,["label"]),f(v,{label:"平台名称",prop:"platformName"},{default:_(()=>[f(T,{modelValue:c.dynCfg.platformName,"onUpdate:modelValue":h[0]||(h[0]=re=>c.dynCfg.platformName=re)},null,8,["modelValue"])]),_:1}),f(v,{label:"平台图标",prop:"platformIcon",class:"cfg-icon"},{default:_(()=>[f(T,{modelValue:c.dynCfg.platformIcon,"onUpdate:modelValue":h[1]||(h[1]=re=>c.dynCfg.platformIcon=re),style:{width:"75%","margin-right":"16px"},placeholder:"直接粘贴svg代码或者img标签代码",type:"textarea",rows:10},null,8,["modelValue"]),f(S,null,{default:_(()=>[P("span",{innerHTML:c.dynCfg.platformIcon},null,8,Du)]),_:1})]),_:1}),f(v,{label:"授权方式",prop:"authMode"},{default:_(()=>[f(V,{modelValue:c.dynCfg.authMode,"onUpdate:modelValue":h[2]||(h[2]=re=>c.dynCfg.authMode=re),placeholder:"请选择",disabled:!0},{default:_(()=>[f(M,{value:m(pe).API,label:"API授权"},null,8,["value"]),f(M,{value:m(pe).WEBSITE,label:"网页授权"},null,8,["value"])]),_:1},8,["modelValue"])]),_:1}),c.dynCfg.authMode===m(pe).WEBSITE?(w(),k(v,{key:0,label:"登录地址",prop:"authUrl"},{default:_(()=>[f(T,{modelValue:c.dynCfg.authUrl,"onUpdate:modelValue":h[3]||(h[3]=re=>c.dynCfg.authUrl=re),placeholder:"请输入该平台的网页登录地址"},null,8,["modelValue"])]),_:1})):z("",!0),c.dynCfg.authMode===m(pe).WEBSITE?(w(),k(v,{key:1,label:"主域名",prop:"domain"},{default:_(()=>[f(T,{modelValue:c.dynCfg.domain,"onUpdate:modelValue":h[4]||(h[4]=re=>c.dynCfg.domain=re),placeholder:"请输入该平台的主域名"},null,8,["modelValue"])]),_:1})):z("",!0),f(v,{label:"是否启用"},{default:_(()=>[f($,{modelValue:c.dynCfg.isEnabled,"onUpdate:modelValue":h[5]||(h[5]=re=>c.dynCfg.isEnabled=re)},null,8,["modelValue"])]),_:1}),f(v,null,{default:_(()=>[f(J,{type:"primary",onClick:h[6]||(h[6]=re=>y(p.value))},{default:_(()=>[G(L(m(t)("dynamic.platform.opt.add")),1)]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["title"])}}});const Ou=ue(Uu,[["__scopeId","data-v-224610e7"]]),Mu={class:"platform-title"},Iu={class:"platform-desc"},xu={class:"icon-list"},Vu={class:"el-icon"},Nu=["innerHTML"],Bu={class:"add-action"},Gu=H({__name:"PlatformQuickAdd",setup(r){K();const a=ct(),t=$e(),{getPlatformType:s,getPrePlatformList:e}=co(),o=ae(t.params),i=ae({ptype:{},pre:[]}),n=p=>{const g={path:`/setting/platform/add/${o.type}`,query:{showBack:"true",key:p==null?void 0:p.platformKey,sub:p==null?void 0:p.subPlatformType}};a.push(g)};return(()=>{const p=o.type;i.ptype=s(p),i.pre=e(p)})(),(p,c)=>{const g=Ie,y=Fa,u=Wi,d=we,b=Ka;return w(),k(Oe,{title:"新增平台 - "+o.type},{default:_(()=>[f(b,{class:"platform-add-card"},{default:_(()=>[P("div",Mu,L(i.ptype.title),1),P("div",Iu,[P("p",null,L(i.ptype.description),1),P("p",null,[f(g,{class:"desc-tip",type:"info",title:"点击图标快速添加，或者点击下方按钮自定义添加"})])]),P("div",xu,[f(u,{direction:"horizontal",class:"platform-box"},{default:_(()=>[(w(!0),N(_e,null,Te(i.pre,h=>(w(),k(y,{class:"define-item",onClick:E=>n(h)},{default:_(()=>[P("i",Vu,[P("span",{innerHTML:h==null?void 0:h.platformIcon},null,8,Nu)]),G(" "+L(h.platformName),1)]),_:2},1032,["onClick"]))),256))]),_:1})]),P("div",Bu,[f(d,{type:"primary",size:"large",onClick:c[0]||(c[0]=h=>n(void 0))},{default:_(()=>[G(" 添加自定义 "+L(i.ptype.title)+" 对接 ",1)]),_:1})])]),_:1})]),_:1},8,["title"])}}});const $u=ue(Gu,[["__scopeId","data-v-9d69326c"]]),Lu=r=>(et("data-v-5c9b2f5b"),r=r(),tt(),r),ju={id:"quick-publish-box"},Hu={class:"publish-tips"},Ru={key:0,class:"is-loading info-tips"},Fu=Lu(()=>P("i",{class:"el-icon is-loading"},[P("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 1024 1024"},[P("path",{fill:"currentColor",d:"M512 64a32 32 0 0 1 32 32v192a32 32 0 0 1-64 0V96a32 32 0 0 1 32-32zm0 640a32 32 0 0 1 32 32v192a32 32 0 1 1-64 0V736a32 32 0 0 1 32-32zm448-192a32 32 0 0 1-32 32H736a32 32 0 1 1 0-64h192a32 32 0 0 1 32 32zm-640 0a32 32 0 0 1-32 32H96a32 32 0 0 1 0-64h192a32 32 0 0 1 32 32zM195.2 195.2a32 32 0 0 1 45.248 0L376.32 331.008a32 32 0 0 1-45.248 45.248L195.2 240.448a32 32 0 0 1 0-45.248zm452.544 452.544a32 32 0 0 1 45.248 0L828.8 783.552a32 32 0 0 1-45.248 45.248L647.744 692.992a32 32 0 0 1 0-45.248zM828.8 195.264a32 32 0 0 1 0 45.184L692.992 376.32a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0zm-452.544 452.48a32 32 0 0 1 0 45.248L240.448 828.8a32 32 0 0 1-45.248-45.248l135.808-135.808a32 32 0 0 1 45.248 0z"})])],-1)),Ku={key:1,class:"success-tips"},Yu=["href"],zu={key:2,class:"fail-tips"},Wu=H({__name:"QuickPublish",setup(r){const a=B("quick-publish-worker"),t=$e(),{singleFormData:s,doSinglePublish:e,initPublishMethods:o}=ro(),{blogApi:i}=We(),{getPublishCfg:n}=as(),l=xe.systemCfg.map(u=>u.platformKey),p=ae(t.params),c=p.key,g=p.id,y=ae({processResult:{}});return qe(async()=>{s.isPublishLoading=!0,setTimeout(async()=>{const u=await n(c);let d=await i.getPost(g);d=await o.assignInitAttrs(d,g,u),a.debug("quick publish inited siyuanPost =>",te(d)),a.info("保存到系统平台开始");for(const b of l){const h=await n(b);await e(b,g,h,d)}a.info("保存到系统平台结束"),a.info("单个快速发布开始"),y.processResult=await e(c,g,u,d),a.info("单个快速发布结束"),s.isPublishLoading=!1},200)}),(u,d)=>(w(),N("div",ju,[P("div",Hu,[m(s).isPublishLoading?(w(),N("div",Ru,[Fu,G(" 发布中，请稍后...： ")])):m(s).publishProcessStatus?(w(),N("div",Ku,[G(L(m(s).isAdd?"发布到":"更新文章到")+" ["+L(y.processResult.key)+"] "+L(m(A).isEmptyString(y.processResult.name)?"":`[${y.processResult.name}]`)+" 成功， ",1),P("a",{href:y.processResult.previewUrl,target:"_blank"},"查看文章",8,Yu)])):(w(),N("div",zu,L(m(s).isAdd?"发布到":"更新文章到")+" ["+L(y.processResult.key)+"] "+L(m(A).isEmptyString(y.processResult.name)?"":`[${y.processResult.name}]`)+" 失败！ ",1))])]))}});const qu=ue(Wu,[["__scopeId","data-v-5c9b2f5b"]]),Ju={id:"other-test"},Xu=`

​​![image](https://img1.terwer.space/api/public/202308142037187.png)​​

dfgvdfgfd

地方GV发的

​![image](https://img1.terwer.space/api/public/202308142036226.png)​

‍

​![](https://img1.terwer.space/202308142041443.png)​
`,Zu=H({__name:"OtherTest",setup(r){const a=ae({content:Xu}),t=()=>{const s=a.content,e=Vo.markdownToNotion(s);console.log("notionObject =>",e)};return(s,e)=>{const o=be,i=Ee,n=we,l=Re,p=Oe;return w(),k(p,{title:"其他测试"},{default:_(()=>[P("div",Ju,[f(l,null,{default:_(()=>[f(i,null,{default:_(()=>[f(o,{modelValue:a.content,"onUpdate:modelValue":e[0]||(e[0]=c=>a.content=c),style:{width:"75%","margin-right":"16px"},type:"textarea",rows:10},null,8,["modelValue"])]),_:1}),f(i,null,{default:_(()=>[f(n,{onClick:t},{default:_(()=>[G("测试Notion")]),_:1})]),_:1})]),_:1})])]),_:1})}}});const Qu=ue(Zu,[["__scopeId","data-v-d3239933"]]),eg={id:"picgo-test"},tg=H({__name:"PicgoTest",props:{pageId:{type:String,default:""}},setup(r){const a=r,t=B("picgo-test"),{handlePicgo:s}=Xa(),{query:e}=$e(),o=e.id??os(),i=async()=>{const n=A.isEmptyString(a.pageId)?o:a.pageId,l=await s(n);t.debug("图片处理完毕, md =>",l)};return(n,l)=>{const p=we,c=Oe;return w(),k(c,{title:"Picgo测试"},{default:_(()=>[P("div",eg,[f(p,{onClick:i},{default:_(()=>[G("测试")]),_:1})])]),_:1})}}});const sg=ue(tg,[["__scopeId","data-v-21d58747"]]),ag={id:"cnblogs-test"},og={class:"method-list"},ig={class:"item"},ng={class:"item"},lg={class:"item"},rg={key:0,class:"item"},cg={class:"item"},pg={class:"item"},Ds="getUsersBlogs",Us="getRecentPostsCount",Os="getRecentPosts",Ms="newPost",Is="getPost",xs="editPost",Vs="deletePost",Ns="getCategories",Bs="getPreviewUrl",Gs="newMediaObject",ug=H({__name:"CnblogsTest",setup(r){const a=B("cnblogs-test"),{t}=K(),s=Z("{}"),e=Z(!1),o=Z(null),i=Z(""),n=Z(!1),l=Z("getUsersBlogs"),p=ae({options:[{value:Ds,label:"获取博客信息"},{value:Us,label:"获取最新文章数目"},{value:Os,label:"获取最新文章列表"},{value:Ms,label:"发布文章"},{value:Is,label:"获取文章详情"},{value:xs,label:"编辑文章"},{value:Vs,label:"删除文章"},{value:Ns,label:"获取分类列表"},{value:Bs,label:"获取文章预览地址"},{value:Gs,label:"上传资源文件"}]}),c=u=>{switch(e.value=!1,u){case Ds:{s.value="{}";break}case Us:{s.value="{}";break}case Os:{s.value=JSON.stringify({numOfPosts:10});break}case Ms:{s.value=JSON.stringify({title:"自动发布的测试标题",description:"自动发布的测试内容",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]});break}case Is:{s.value=JSON.stringify({postid:"17593464"});break}case xs:{s.value=JSON.stringify({postid:"17593464",post:{title:"自动发布的测试标题2",description:"自动发布的测试内容2",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]}});break}case Vs:{s.value=JSON.stringify({postid:"17593463"});break}case Ns:{s.value="{}";break}case Bs:{s.value=JSON.stringify({postid:"17243968"});break}case Gs:{s.value="{}",e.value=!0;break}default:{s.value="{}";break}}},g=async u=>{const d=u.target;d.files&&d.files[0]&&(o.value=d.files[0])},y=async()=>{n.value=!0,i.value="",i.value="cnblogs requesting...";try{const u=new ge;switch(a.info("appInstance=>",u),l.value){case Ds:{const d="metaweblog_Cnblogs",b=await de.getAdaptor(d),h=C.blogApi(u,b);a.info("cnblogsApi=>",h);const E=await h.getUsersBlogs();i.value=JSON.stringify(E),a.info("cnblogs users blogs=>",E);break}case Us:{const d="metaweblog_Cnblogs",b=await de.getAdaptor(d),h=C.blogApi(u,b);a.info("cnblogsApi=>",h);const E=await h.getRecentPostsCount();i.value=JSON.stringify(E),a.info("cnblogs getRecentPostsCount=>",E);break}case Os:{const d="metaweblog_Cnblogs",b=await de.getAdaptor(d),h=C.blogApi(u,b);a.info("cnblogsApi=>",h);const E=await h.getRecentPosts(10);i.value=JSON.stringify(E),a.info("cnblogs getRecentPosts=>",E);break}case Ms:{const d=JSON.parse(s.value);let b=new ze;b={...b,...d};const h="metaweblog_Cnblogs",E=await de.getAdaptor(h),T=await C.blogApi(u,E).newPost(b);i.value=JSON.stringify(T),a.info("cnblogs newPost=>",T);break}case Is:{const d="metaweblog_Cnblogs",b=await de.getAdaptor(d),h=C.blogApi(u,b);a.info("cnblogsApi=>",h);const v=JSON.parse(s.value).postid,T=await h.getPost(v);i.value=JSON.stringify(T),a.info("cnblogs getPost=>",T);break}case xs:{const d="metaweblog_Cnblogs",b=await de.getAdaptor(d),h=C.blogApi(u,b);a.info("cnblogsApi=>",h);const E=JSON.parse(s.value),v=E.postid;let T=new ze;T={...T,...E.post};const S=await h.editPost(v,T);i.value=JSON.stringify(S);break}case Vs:{const d="metaweblog_Cnblogs",b=await de.getAdaptor(d),h=C.blogApi(u,b);a.info("cnblogsApi=>",h);const v=JSON.parse(s.value).postid,T=await h.deletePost(v);i.value=JSON.stringify(T);break}case Ns:{const d="metaweblog_Cnblogs",b=await de.getAdaptor(d),h=C.blogApi(u,b);a.info("cnblogsApi=>",h);const E=await h.getCategories();i.value=JSON.stringify(E),a.info("cnblogs getCategories=>",E);break}case Bs:{const d="metaweblog_Cnblogs",b=await de.getAdaptor(d),h=C.blogApi(u,b);a.info("cnblogsApi=>",h);const v=JSON.parse(s.value).postid,T=await h.getPreviewUrl(v);i.value=JSON.stringify(T),a.info("cnblogs getPreviewUrl=>",T);break}case Gs:{const d="metaweblog_Cnblogs",b=await de.getAdaptor(d),h=C.blogApi(u,b);a.info("cnblogsApi=>",h);const v=await Za("https://static-rs-terwer.oss-cn-beijing.aliyuncs.com/test/image-20230812091531-hibwr1g.png"),T=v.imageBase64;a.debug("imageBase64=>",{imageBase64:T});const S=Qa(T);a.debug("bits=>",S);const M=new Dt(v.imageName,v.mimeType,S);a.info("mediaObject=>",M);const V=await h.newMediaObject(M);i.value=JSON.stringify(V),a.info("cnblogs new mediaObject result=>",V);break}default:break}n.value=!1}catch(u){i.value=u,a.error(t("main.opt.failure")+"=>",u),n.value=!1}};return(u,d)=>{const b=Je,h=Xe,E=we,v=be,T=Oe;return w(),k(T,{title:"博客园测试"},{default:_(()=>[P("div",ag,[P("div",og,[f(h,{modelValue:l.value,"onUpdate:modelValue":d[0]||(d[0]=S=>l.value=S),class:"m-2",placeholder:"请选择方法名称",onChange:c},{default:_(()=>[(w(!0),N(_e,null,Te(p.options,S=>(w(),k(b,{key:S.value,label:S.label,value:S.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),P("div",ig,[f(E,{type:"primary",loading:n.value,onClick:y},{default:_(()=>[G("开始测试cnblogs")]),_:1},8,["loading"])]),P("div",ng,[f(E,null,{default:_(()=>[G("入参")]),_:1})]),P("div",lg,[f(v,{modelValue:s.value,"onUpdate:modelValue":d[1]||(d[1]=S=>s.value=S),type:"textarea",rows:5},null,8,["modelValue"])]),e.value?(w(),N("div",rg,[P("input",{type:"file",onChange:g},null,32)])):z("",!0),P("div",cg,[f(E,null,{default:_(()=>[G("结果")]),_:1})]),P("div",pg,[f(v,{modelValue:i.value,"onUpdate:modelValue":d[2]||(d[2]=S=>i.value=S),type:"textarea",rows:10,placeholder:"日志信息"},null,8,["modelValue"])])])]),_:1})}}});const gg=ue(ug,[["__scopeId","data-v-4331baa2"]]),dg={id:"siyuan-test"},mg={class:"method-list"},hg={class:"item"},yg={class:"item"},fg={class:"item"},_g={key:0,class:"item"},bg={class:"item"},wg={class:"item"},$s="getUsersBlogs",Ls="getRecentPostsCount",js="getRecentPosts",Hs="newPost",Rs="getPost",Fs="editPost",Ks="deletePost",Ys="getCategories",zs="getPreviewUrl",Ws="newMediaObject",Eg=H({__name:"SiyuanTest",setup(r){const a=B("siyuan-test"),{t}=K(),s=Z("{}"),e=Z(!1),o=Z(null),i=Z(""),n=Z(!1),l=Z("getUsersBlogs"),p=ae({options:[{value:$s,label:"获取博客信息"},{value:Ls,label:"获取最新文章数目"},{value:js,label:"获取最新文章列表"},{value:Hs,label:"发布文章"},{value:Rs,label:"获取文章详情"},{value:Fs,label:"编辑文章"},{value:Ks,label:"删除文章"},{value:Ys,label:"获取分类列表"},{value:zs,label:"获取文章预览地址"},{value:Ws,label:"上传资源文件"}]}),c=u=>{switch(e.value=!1,u){case $s:{s.value="{}";break}case Ls:{s.value="{}";break}case js:{s.value=JSON.stringify({numOfPosts:10});break}case Hs:{s.value=JSON.stringify({title:"自动发布的测试标题",description:"自动发布的测试内容",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]});break}case Rs:{s.value=JSON.stringify({postid:"20230526221603-3mgotyw"});break}case Fs:{s.value=JSON.stringify({postid:"20230527202519-k09a4gx",post:{title:"自动发布的测试标题2",description:"自动发布的测试内容2",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]}});break}case Ks:{s.value=JSON.stringify({postid:"20230528192554-mlcxbe8"});break}case Ys:{s.value="{}";break}case zs:{s.value=JSON.stringify({postid:"20230528192554-mlcxbe8"});break}case Ws:{s.value="{}",e.value=!0;break}default:{s.value="{}";break}}},g=async u=>{const d=u.target;d.files&&d.files[0]&&(o.value=d.files[0])},y=async()=>{n.value=!0,i.value="",i.value="siyuan requesting...";try{const u=new ge;switch(a.info("appInstance=>",u),l.value){case $s:{const d=new Ze("http://127.0.0.1:6806",""),b=new at(d),E=await C.blogApi(u,b).getUsersBlogs();i.value=JSON.stringify(E),a.info("siyuan users blogs=>",E);break}case Ls:{const d=new Ze("http://127.0.0.1:6806",""),b=new at(d),E=await C.blogApi(u,b).getRecentPostsCount();i.value=JSON.stringify(E),a.info("siyuan recent post count=>",E);break}case js:{const d=new Ze("http://127.0.0.1:6806",""),b=new at(d),h=C.blogApi(u,b),E=JSON.parse(s.value),v=await h.getRecentPosts(E.numOfPosts);i.value=JSON.stringify(v),a.info("siyuan recent post=>",v);break}case Hs:{const d=new Ze("http://127.0.0.1:6806","");d.notebook="20230506132031-qbtyjdk";const b=new at(d),h=C.blogApi(u,b),E=JSON.parse(s.value);let v=new ze;v={...v,...E};const T=await h.newPost(v);i.value=JSON.stringify(T);break}case Rs:{const d=new Ze("http://127.0.0.1:6806",""),b=new at(d),h=C.blogApi(u,b),v=JSON.parse(s.value).postid,T=await h.getPost(v);i.value=JSON.stringify(T),a.info("siyuan post=>",T);break}case Fs:{const d=new Ze("http://127.0.0.1:6806","");d.notebook="20230506132031-qbtyjdk";const b=new at(d),h=C.blogApi(u,b),E=JSON.parse(s.value),v=E.postid;let T=new ze;T={...T,...E.post};const S=await h.editPost(v,T);i.value=JSON.stringify(S);break}case Ks:{const d=new Ze("http://127.0.0.1:6806","");d.notebook="20230506132031-qbtyjdk";const b=new at(d),h=C.blogApi(u,b),v=JSON.parse(s.value).postid,T=await h.deletePost(v);i.value=JSON.stringify(T);break}case Ys:{const d=new Ze("http://127.0.0.1:6806",""),b=new at(d),E=await C.blogApi(u,b).getCategories();i.value=JSON.stringify(E),a.info("siyuan categories=>",E);break}case zs:{const d=new Ze("http://127.0.0.1:6806",""),b=new at(d),h=C.blogApi(u,b),v=JSON.parse(s.value).postid,T=await h.getPreviewUrl(v);i.value=JSON.stringify(T),a.info("siyuan preview url=>",T);break}case Ws:{const d=new Ze("http://127.0.0.1:6806",""),b=new at(d),h=C.blogApi(u,b),E=o.value,v=await es(E),T=new Dt(E.name,E.type,v);a.info("mediaObject=>",T);const S=await h.newMediaObject(T,async()=>{const M=new FormData,V=new Blob([T.bits]);return M.append("file[]",V,T.name),M.append("assetsDirPath","/assets/"),await new Do(d).uploadAsset(M)});i.value=JSON.stringify(S),a.info("siyuan new mediaObject result=>",S);break}default:break}n.value=!1}catch(u){i.value=u,a.error(t("main.opt.failure")+"=>",u),n.value=!1}};return(u,d)=>{const b=Je,h=Xe,E=we,v=be,T=Oe;return w(),k(T,{title:"siyuan测试"},{default:_(()=>[P("div",dg,[P("div",mg,[f(h,{modelValue:l.value,"onUpdate:modelValue":d[0]||(d[0]=S=>l.value=S),class:"m-2",placeholder:"请选择方法名称",onChange:c},{default:_(()=>[(w(!0),N(_e,null,Te(p.options,S=>(w(),k(b,{key:S.value,label:S.label,value:S.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),P("div",hg,[f(E,{type:"primary",loading:n.value,onClick:y},{default:_(()=>[G("开始测试siyuan")]),_:1},8,["loading"])]),P("div",yg,[f(E,null,{default:_(()=>[G("入参")]),_:1})]),P("div",fg,[f(v,{modelValue:s.value,"onUpdate:modelValue":d[1]||(d[1]=S=>s.value=S),type:"textarea",rows:5},null,8,["modelValue"])]),e.value?(w(),N("div",_g,[P("input",{type:"file",onChange:g},null,32)])):z("",!0),P("div",bg,[f(E,null,{default:_(()=>[G("结果")]),_:1})]),P("div",wg,[f(v,{modelValue:i.value,"onUpdate:modelValue":d[2]||(d[2]=S=>i.value=S),type:"textarea",rows:10,placeholder:"日志信息"},null,8,["modelValue"])])])]),_:1})}}});const vg=ue(Eg,[["__scopeId","data-v-cfa9acd3"]]),Tg={id:"wordpress-test"},Pg={class:"method-list"},kg={class:"item"},Sg={class:"item"},Ag={class:"item"},Cg={key:0,class:"item"},Dg={class:"item"},Ug={class:"item"},qs="getUsersBlogs",Js="getRecentPostsCount",Xs="getRecentPosts",Zs="newPost",Qs="getPost",ea="editPost",ta="deletePost",sa="getCategories",aa="getPreviewUrl",oa="newMediaObject",Og=H({__name:"WordpressTest",setup(r){const a=B("wordpress-test"),{t}=K(),s=Z("{}"),e=Z(!1),o=Z(null),i=Z(""),n=Z(!1),l=Z("getUsersBlogs"),p=ae({options:[{value:qs,label:"获取博客信息"},{value:Js,label:"获取最新文章数目"},{value:Xs,label:"获取最新文章列表"},{value:Zs,label:"发布文章"},{value:Qs,label:"获取文章详情"},{value:ea,label:"编辑文章"},{value:ta,label:"删除文章"},{value:sa,label:"获取分类列表"},{value:aa,label:"获取文章预览地址"},{value:oa,label:"上传资源文件"}]}),c=u=>{switch(e.value=!1,u){case qs:{s.value="{}";break}case Js:{s.value="{}";break}case Xs:{s.value=JSON.stringify({numOfPosts:10});break}case Zs:{s.value=JSON.stringify({title:"自动发布的测试标题",description:"自动发布的测试内容",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]});break}case Qs:{s.value=JSON.stringify({postid:"20230526221603-3mgotyw"});break}case ea:{s.value=JSON.stringify({postid:"20230527202519-k09a4gx",post:{title:"自动发布的测试标题2",description:"自动发布的测试内容2",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]}});break}case ta:{s.value=JSON.stringify({postid:"20230528192554-mlcxbe8"});break}case sa:{s.value="{}";break}case aa:{s.value=JSON.stringify({postid:"20230528192554-mlcxbe8"});break}case oa:{s.value="{}",e.value=!0;break}default:{s.value="{}";break}}},g=async u=>{const d=u.target;d.files&&d.files[0]&&(o.value=d.files[0])},y=async()=>{n.value=!0,i.value="",i.value="wordpress requesting...";try{const u=new ge;switch(a.info("appInstance=>",u),l.value){case qs:{const d="wordpress_Wordpress",b=await de.getAdaptor(d),E=await C.blogApi(u,b).getUsersBlogs();i.value=JSON.stringify(E),a.info("wordpress users blogs=>",E);break}case Js:break;case Xs:{const d="wordpress_Wordpress",b=await de.getAdaptor(d),E=await C.blogApi(u,b).getRecentPosts(10);i.value=JSON.stringify(E),a.info("wordpress recent post=>",E);break}case Zs:break;case Qs:break;case ea:break;case ta:break;case sa:break;case aa:break;case oa:{const d="wordpress_Wordpress",b=o.value,h=await es(b),E=new Dt(b.name,b.type,h);a.info("mediaObject=>",E);const v={name:E.name,type:E.type,bits:E.bits,overwrite:!0},T=await de.getAdaptor(d),M=await C.blogApi(u,T).newMediaObject(v);i.value=JSON.stringify(M),a.info("wordpress new mediaObject result=>",M);break}default:break}n.value=!1}catch(u){i.value=u,a.error(t("main.opt.failure")+"=>",u),n.value=!1}};return(u,d)=>{const b=Je,h=Xe,E=we,v=be,T=Oe;return w(),k(T,{title:"WordPress测试"},{default:_(()=>[P("div",Tg,[P("div",Pg,[f(h,{modelValue:l.value,"onUpdate:modelValue":d[0]||(d[0]=S=>l.value=S),class:"m-2",placeholder:"请选择方法名称",onChange:c},{default:_(()=>[(w(!0),N(_e,null,Te(p.options,S=>(w(),k(b,{key:S.value,label:S.label,value:S.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),P("div",kg,[f(E,{type:"primary",loading:n.value,onClick:y},{default:_(()=>[G("开始测试wordpress")]),_:1},8,["loading"])]),P("div",Sg,[f(E,null,{default:_(()=>[G("入参")]),_:1})]),P("div",Ag,[f(v,{modelValue:s.value,"onUpdate:modelValue":d[1]||(d[1]=S=>s.value=S),type:"textarea",rows:5},null,8,["modelValue"])]),e.value?(w(),N("div",Cg,[P("input",{type:"file",onChange:g},null,32)])):z("",!0),P("div",Dg,[f(E,null,{default:_(()=>[G("结果")]),_:1})]),P("div",Ug,[f(v,{modelValue:i.value,"onUpdate:modelValue":d[2]||(d[2]=S=>i.value=S),type:"textarea",rows:10,placeholder:"日志信息"},null,8,["modelValue"])])])]),_:1})}}});const Mg=ue(Og,[["__scopeId","data-v-c35adef3"]]),Ig={id:"typecho-test"},xg={class:"method-list"},Vg={class:"item"},Ng={class:"item"},Bg={class:"item"},Gg={key:0,class:"item"},$g={class:"item"},Lg={class:"item"},ia="getUsersBlogs",na="getRecentPostsCount",la="getRecentPosts",ra="newPost",ca="getPost",pa="editPost",ua="deletePost",ga="getCategories",da="getPreviewUrl",ma="newMediaObject",jg=H({__name:"TypechoTest",setup(r){const a=B("typecho-test"),t=Z("{}"),s=Z(!1),e=Z(null),o=Z(""),i=Z(!1),n=Z("getUsersBlogs"),l=ae({options:[{value:ia,label:"获取博客信息"},{value:na,label:"获取最新文章数目"},{value:la,label:"获取最新文章列表"},{value:ra,label:"发布文章"},{value:ca,label:"获取文章详情"},{value:pa,label:"编辑文章"},{value:ua,label:"删除文章"},{value:ga,label:"获取分类列表"},{value:da,label:"获取文章预览地址"},{value:ma,label:"上传资源文件"}]}),p=y=>{switch(s.value=!1,y){case ia:{t.value="{}";break}case na:{t.value="{}";break}case la:{t.value=JSON.stringify({numOfPosts:10});break}case ra:{t.value=JSON.stringify({title:"自动发布的测试标题",description:"自动发布的测试内容",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]});break}case ca:{t.value=JSON.stringify({postid:"20230526221603-3mgotyw"});break}case pa:{t.value=JSON.stringify({postid:"20230527202519-k09a4gx",post:{title:"自动发布的测试标题2",description:"自动发布的测试内容2",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]}});break}case ua:{t.value=JSON.stringify({postid:"20230528192554-mlcxbe8"});break}case ga:{t.value="{}";break}case da:{t.value=JSON.stringify({postid:"20230528192554-mlcxbe8"});break}case ma:{t.value="{}",s.value=!0;break}default:{t.value="{}";break}}},c=async y=>{const u=y.target;u.files&&u.files[0]&&(e.value=u.files[0])},g=async()=>{i.value=!0,o.value="",o.value="typecho requesting...";try{const y=new ge;switch(a.info("appInstance=>",y),n.value){case ia:{const u="metaweblog_Typecho",d=await de.getAdaptor(u),h=await C.blogApi(y,d).getUsersBlogs();o.value=JSON.stringify(h),a.info("typecho users blogs=>",h);break}case na:break;case la:break;case ra:break;case ca:break;case pa:break;case ua:break;case ga:break;case da:break;case ma:{const u="metaweblog_Typecho",d=await de.getAdaptor(u),b="https://static-rs-terwer.oss-cn-beijing.aliyuncs.com/test/image-20230812091531-hibwr1g.png",h=b.substring(b.lastIndexOf("/")+1),v=(await Za(b)).imageBase64;a.debug("imageBase64=>",{imageBase64:v});const T=Qa(v);a.debug("bits=>",T);const S=new Dt(h,"image/png",T);a.info("mediaObject=>",S);const M=C.blogApi(y,d);a.info("typechoApi=>",M);const V=await M.newMediaObject(S);o.value=JSON.stringify(V),a.info("typecho new mediaObject result=>",V);break}default:break}i.value=!1}catch(y){o.value=y,a.error(y),i.value=!1}};return(y,u)=>{const d=Je,b=Xe,h=we,E=be,v=Oe;return w(),k(v,{title:"Typecho测试"},{default:_(()=>[P("div",Ig,[P("div",xg,[f(b,{modelValue:n.value,"onUpdate:modelValue":u[0]||(u[0]=T=>n.value=T),class:"m-2",placeholder:"请选择方法名称",onChange:p},{default:_(()=>[(w(!0),N(_e,null,Te(l.options,T=>(w(),k(d,{key:T.value,label:T.label,value:T.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),P("div",Vg,[f(h,{type:"primary",loading:i.value,onClick:g},{default:_(()=>[G("开始测试typecho")]),_:1},8,["loading"])]),P("div",Ng,[f(h,null,{default:_(()=>[G("入参")]),_:1})]),P("div",Bg,[f(E,{modelValue:t.value,"onUpdate:modelValue":u[1]||(u[1]=T=>t.value=T),type:"textarea",rows:5},null,8,["modelValue"])]),s.value?(w(),N("div",Gg,[P("input",{type:"file",onChange:c},null,32)])):z("",!0),P("div",$g,[f(h,null,{default:_(()=>[G("结果")]),_:1})]),P("div",Lg,[f(E,{modelValue:o.value,"onUpdate:modelValue":u[2]||(u[2]=T=>o.value=T),type:"textarea",rows:10,placeholder:"日志信息"},null,8,["modelValue"])])])]),_:1})}}});const Hg=ue(jg,[["__scopeId","data-v-bd526ffb"]]),Rg={id:"yuque-test"},Fg={class:"method-list"},Kg={class:"item"},Yg={class:"item"},zg={class:"item"},Wg={key:0,class:"item"},qg={class:"item"},Jg={class:"item"},ha="getUsersBlogs",ya="getRecentPostsCount",fa="getRecentPosts",_a="newPost",ba="getPost",wa="editPost",Ea="deletePost",va="getCategories",Ta="getPreviewUrl",Pa="newMediaObject",Xg=H({__name:"YuqueTest",setup(r){const a=B("yuque-test"),{t}=K(),s=Z("{}"),e=Z(!1),o=Z(null),i=Z(""),n=Z(!1),l=Z("getUsersBlogs"),p=ae({options:[{value:ha,label:"获取博客信息"},{value:ya,label:"获取最新文章数目"},{value:fa,label:"获取最新文章列表"},{value:_a,label:"发布文章"},{value:ba,label:"获取文章详情"},{value:wa,label:"编辑文章"},{value:Ea,label:"删除文章"},{value:va,label:"获取分类列表"},{value:Ta,label:"获取文章预览地址"},{value:Pa,label:"上传资源文件"}]}),c=u=>{switch(e.value=!1,u){case ha:{s.value="{}";break}case ya:{s.value="{}";break}case fa:{s.value=JSON.stringify({numOfPosts:10});break}case _a:{s.value=JSON.stringify({title:"自动发布的测试标题",description:"自动发布的测试内容",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]});break}case ba:{s.value=JSON.stringify({postid:"20230526221603-3mgotyw"});break}case wa:{s.value=JSON.stringify({postid:"20230527202519-k09a4gx",post:{title:"自动发布的测试标题2",description:"自动发布的测试内容2",mt_keywords:"标签1,标签2",categories:["分类1","分类2"]}});break}case Ea:{s.value=JSON.stringify({postid:"20230528192554-mlcxbe8"});break}case va:{s.value="{}";break}case Ta:{s.value=JSON.stringify({postid:"20230528192554-mlcxbe8"});break}case Pa:{s.value="{}",e.value=!0;break}default:{s.value="{}";break}}},g=async u=>{const d=u.target;d.files&&d.files[0]&&(o.value=d.files[0])},y=async()=>{n.value=!0,i.value="",i.value="yuque requesting...";try{const u=new ge;switch(a.info("appInstance=>",u),l.value){case ha:{const d="common_Yuque",b=await de.getAdaptor(d),E=await C.blogApi(u,b).getUsersBlogs();i.value=JSON.stringify(E),a.info("yuque users blogs=>",E);break}case ya:break;case fa:break;case _a:break;case ba:break;case wa:break;case Ea:break;case va:break;case Ta:break;case Pa:{const d=o.value,b=await es(d),h=new Dt(d.name,d.type,b);a.info("mediaObject=>",h);const E={name:h.name,type:h.type,bits:h.bits,overwrite:!0},v="http://127.0.0.1:3000/xmlrpc.php",S=await new Uo(v,"",{}).methodCall("metaWeblog.newMediaObject",["","terwer","123456",E]);i.value=JSON.stringify(S),a.info("yuque new mediaObject result=>",S);break}default:break}n.value=!1}catch(u){i.value=u,a.error(t("main.opt.failure")+"=>",u),n.value=!1}};return(u,d)=>{const b=Je,h=Xe,E=we,v=be,T=Oe;return w(),k(T,{title:"语雀测试"},{default:_(()=>[P("div",Rg,[P("div",Fg,[f(h,{modelValue:l.value,"onUpdate:modelValue":d[0]||(d[0]=S=>l.value=S),class:"m-2",placeholder:"请选择方法名称",onChange:c},{default:_(()=>[(w(!0),N(_e,null,Te(p.options,S=>(w(),k(b,{key:S.value,label:S.label,value:S.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),P("div",Kg,[f(E,{type:"primary",loading:n.value,onClick:y},{default:_(()=>[G("开始测试yuque")]),_:1},8,["loading"])]),P("div",Yg,[f(E,null,{default:_(()=>[G("入参")]),_:1})]),P("div",zg,[f(v,{modelValue:s.value,"onUpdate:modelValue":d[1]||(d[1]=S=>s.value=S),type:"textarea",rows:5},null,8,["modelValue"])]),e.value?(w(),N("div",Wg,[P("input",{type:"file",onChange:g},null,32)])):z("",!0),P("div",qg,[f(E,null,{default:_(()=>[G("结果")]),_:1})]),P("div",Jg,[f(v,{modelValue:i.value,"onUpdate:modelValue":d[2]||(d[2]=S=>i.value=S),type:"textarea",rows:10,placeholder:"日志信息"},null,8,["modelValue"])])])]),_:1})}}});const Zg=ue(Xg,[["__scopeId","data-v-52e82541"]]),Qg={id:"zhihu-test"},ed={class:"method-list"},td={class:"item"},sd={class:"item"},ad={class:"item"},od={key:0,class:"item"},id={class:"item"},nd={class:"item"},ka="getMetaData",ld=H({__name:"ZhihuTest",setup(r){const a=B("zhihu-test"),{t}=K(),s=Z("{}"),e=Z(!1),o=Z(null),i=Z(""),n=Z(!1),l=Z("getMetaData"),p=ae({options:[{value:ka,label:"获取元数据信息"}]}),c=u=>{switch(e.value=!1,u){case ka:{s.value="{}";break}default:{s.value="{}";break}}},g=async u=>{const d=u.target;d.files&&d.files[0]&&(o.value=d.files[0])},y=async()=>{n.value=!0,i.value="",i.value="zhihu requesting...";try{const u=new ge;switch(a.info("appInstance=>",u),l.value){case ka:{const d="custom_Zhihu",b=await de.getAdaptor(d),E=await C.webApi(u,b).getMetaData();i.value=JSON.stringify(E),a.info("zhihu meta data=>",E);break}default:break}n.value=!1}catch(u){i.value=u,a.error(t("main.opt.failure")+"=>",u),n.value=!1}};return(u,d)=>{const b=Je,h=Xe,E=we,v=be,T=Oe;return w(),k(T,{title:"知乎测试"},{default:_(()=>[P("div",Qg,[P("div",ed,[f(h,{modelValue:l.value,"onUpdate:modelValue":d[0]||(d[0]=S=>l.value=S),class:"m-2",placeholder:"请选择方法名称",onChange:c},{default:_(()=>[(w(!0),N(_e,null,Te(p.options,S=>(w(),k(b,{key:S.value,label:S.label,value:S.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),P("div",td,[f(E,{type:"primary",loading:n.value,onClick:y},{default:_(()=>[G("开始测试zhihu")]),_:1},8,["loading"])]),P("div",sd,[f(E,null,{default:_(()=>[G("入参")]),_:1})]),P("div",ad,[f(v,{modelValue:s.value,"onUpdate:modelValue":d[1]||(d[1]=S=>s.value=S),type:"textarea",rows:5},null,8,["modelValue"])]),e.value?(w(),N("div",od,[P("input",{type:"file",onChange:g},null,32)])):z("",!0),P("div",id,[f(E,null,{default:_(()=>[G("结果")]),_:1})]),P("div",nd,[f(v,{modelValue:i.value,"onUpdate:modelValue":d[2]||(d[2]=S=>i.value=S),type:"textarea",rows:10,placeholder:"日志信息"},null,8,["modelValue"])])])]),_:1})}}});const rd=ue(ld,[["__scopeId","data-v-4c16df45"]]),cd={id:"test-list",class:"test-list-container"},pd=H({__name:"Test",setup(r){const a=ct(),t=[{title:"思源笔记测试",path:"/test/siyuan"},{title:"博客园测试",path:"/test/cnblogs"},{title:"WordPress测试",path:"/test/wordpress"},{title:"Typecho测试",path:"/test/typecho"},{title:"语雀测试",path:"/test/yuque"},{title:"知乎测试",path:"/test/zhihu"},{title:"CSDN测试",path:"/test/csdn"},{title:"Picgo测试",path:"/test/picgo"},{title:"其他测试",path:"/test/other"},{title:"ChatGPT测试",path:"/test/chat"}],s=async e=>{await a.push({path:e.path,query:{showBack:"true"}})};return(e,o)=>{const i=we,n=Oe;return w(),k(n,{title:"组件测试"},{default:_(()=>[P("div",cd,[(w(),N(_e,null,Te(t,l=>f(i,{onClick:p=>s(l),type:"primary",size:"large",class:"test-button"},{default:_(()=>[G(L(l.title),1)]),_:2},1032,["onClick"])),64))])]),_:1})}}});const ud=ue(pd,[["__scopeId","data-v-9ca673a2"]]),gd=""+new URL("assets/icon.png",import.meta.url).href,$t=r=>(et("data-v-aa18966e"),r=r(),tt(),r),dd={id:"about-box"},md=$t(()=>P("div",{class:"logo"},[P("img",{src:gd,alt:"logo"})],-1)),hd={class:"notice"},yd={class:"title"},fd={class:"param slogan"},_d=$t(()=>P("div",{class:"space"},null,-1)),bd=$t(()=>P("div",{class:"param"},[G("Created by "),P("a",{href:"https://terwer.space/about.html",target:"_blank"},"terwer")],-1)),wd=$t(()=>P("div",{class:"space"},null,-1)),Ed={class:"third-libs"},vd=$t(()=>P("div",{class:"lib-title"},"Thanks for third party libraries:",-1)),Td={class:"lib-container"},Pd={class:"lib-item"},kd={key:0,class:"lib-item"},Sd=$t(()=>P("a",{target:"_blank",href:"https://github.com/terwer/siyuan-plugin-publisher/blob/main/package.json#L54"},"more... ",-1)),Ad=[Sd],Cd=H({__name:"About",setup(r){const{t:a}=K(),t=ae({v:No,deps:Object.entries(kn).slice(0,24)});return(s,e)=>{const o=Oe;return w(),k(o,{title:"关于作者"},{default:_(()=>[P("div",dd,[md,P("div",hd,[P("p",yd,"发布工具 v"+L(t.v),1),P("div",fd,[P("span",null,L(m(a)("slogan.make.written.fun")),1)]),_d,bd,wd,P("div",Ed,[vd,P("div",Td,[(w(!0),N(_e,null,Te(t.deps,i=>(w(),N("div",Pd,L(i),1))),256)),t.deps.length>=24?(w(),N("div",kd,Ad)):z("",!0)])])])])]),_:1})}}});const Dd=ue(Cd,[["__scopeId","data-v-aa18966e"]]),Ud={class:"chat-output"},Od=H({__name:"ChatgptTest",setup(r){const a=B("chatgpt-test"),{t}=K(),s=Z(""),e=Z(""),o=ae({isLoading:!1}),i=async()=>{if(s.value.trim()===""){Y.error("请输入文本");return}o.isLoading=!0;try{const{chat:l}=ut(),p=await l(s.value);if(A.isEmptyString(p)){Y.error("请求错误，请在底部偏好设置修改请求地址和ChatGPT key！");return}e.value+=`> ${s.value}
${p}

`,s.value=""}catch(l){a.error(t("main.opt.failure")+"=>",l),Y.error(t("main.opt.failure")+"=>"+l)}finally{o.isLoading=!1}},n=()=>{e.value=""};return(l,p)=>{const c=be,g=Ee,y=we,u=Re,d=Oe;return w(),k(d,{title:"AI聊天"},{default:_(()=>[f(u,{class:"chatgpt-form"},{default:_(()=>[f(g,null,{default:_(()=>[f(c,{modelValue:s.value,"onUpdate:modelValue":p[0]||(p[0]=b=>s.value=b),autosize:{minRows:4,maxRows:16},type:"textarea",class:"chat-input",placeholder:"请输入文本..."},null,8,["modelValue"])]),_:1}),f(g,null,{default:_(()=>[f(y,{type:"primary",onClick:i,loading:o.isLoading},{default:_(()=>[G("发送消息")]),_:1},8,["loading"]),f(y,{type:"danger",onClick:n},{default:_(()=>[G("清屏")]),_:1})]),_:1}),f(g,null,{default:_(()=>[P("div",Ud,[P("pre",null,L(e.value),1)])]),_:1})]),_:1})]),_:1})}}});const Md=ue(Od,[["__scopeId","data-v-e49ecba0"]]),Id={key:0},xd={class:"chat-output"},Vd=H({__name:"AiChat",setup(r){const a=B("chatgpt-test"),{t}=K(),{query:s}=$e(),{blogApi:e}=We(),o=s.id??os(),i=Z(""),n=Z(""),l=ae({isLoading:!1,showPage:!A.isEmptyString(o),usePage:!1,siyuanPost:{}}),p=async()=>{if(i.value.trim()===""){Y.error("请输入文本");return}l.isLoading=!0;try{const{chat:g}=ut();let y=i.value;l.usePage&&(A.isEmptyString(l.siyuanPost.markdown)||(y=`${l.siyuanPost.markdown}
${y}`,a.info("使用当前文档作为上下文")));const u=await g(y);if(A.isEmptyString(u)){Y.error("请求错误，请在偏好设置配置请求地址和ChatGPT key！");return}n.value+=`> ${i.value}
${u}

`,i.value=""}catch(g){a.error(t("main.opt.failure")+"=>",g),Y.error(t("main.opt.failure")+"=>"+g)}finally{l.isLoading=!1}},c=()=>{n.value=""};return qe(async()=>{if(l.showPage){const g=await e.getPost(o);l.siyuanPost=g}}),(g,y)=>{const u=Ie,d=be,b=Ee,h=Ct,E=we,v=Re,T=Oe;return w(),k(T,{title:"AI聊天"},{default:_(()=>[l.usePage&&l.showPage&&!m(A).isEmptyString(l.siyuanPost.markdown)?(w(),k(u,{key:0,closable:!1,title:`当前为上下文模式，文档上下文为《${l.siyuanPost.title}》`,class:"top-tip",type:"success"},null,8,["title"])):(w(),k(u,{key:1,closable:!1,title:"当前为自由聊天模式",class:"top-tip",type:"info"})),f(v,{class:"chatgpt-form"},{default:_(()=>[f(b,null,{default:_(()=>[f(d,{modelValue:i.value,"onUpdate:modelValue":y[0]||(y[0]=S=>i.value=S),autosize:{minRows:4,maxRows:16},type:"textarea",class:"chat-input",placeholder:"请输入文本..."},null,8,["modelValue"])]),_:1}),f(b,null,{default:_(()=>[l.showPage&&!m(A).isEmptyString(l.siyuanPost.markdown)?(w(),N("div",Id,[f(h,{modelValue:l.usePage,"onUpdate:modelValue":y[1]||(y[1]=S=>l.usePage=S),class:"use-context"},null,8,["modelValue"]),G("   使用当前文档作为上下文 ")])):z("",!0)]),_:1}),f(b,null,{default:_(()=>[f(E,{type:"primary",onClick:p,loading:l.isLoading},{default:_(()=>[G("发送消息")]),_:1},8,["loading"]),f(E,{type:"danger",onClick:c},{default:_(()=>[G("清屏")]),_:1})]),_:1}),f(b,null,{default:_(()=>[P("div",xd,[P("pre",null,L(n.value),1)])]),_:1})]),_:1})]),_:1})}}});const Nd=ue(Vd,[["__scopeId","data-v-0d4becd1"]]),Bd={id:"csdn-test"},Gd={class:"method-list"},$d={class:"item"},Ld={class:"item"},jd={class:"item"},Hd={key:0,class:"item"},Rd={class:"item"},Fd={class:"item"},Sa="getMetaData",Aa="getUsersBlogs",Kd=H({__name:"CsdnTest",setup(r){const a=B("csdn-test"),{t}=K(),s=Z("{}"),e=Z(!1),o=Z(null),i=Z(""),n=Z(!1),l=Z("getMetaData"),p=ae({options:[{value:Sa,label:"获取元数据信息"},{value:Aa,label:"获取博客信息"}]}),c=u=>{switch(e.value=!1,u){case Sa:{s.value="{}";break}case Aa:{s.value="{}";break}default:{s.value="{}";break}}},g=async u=>{const d=u.target;d.files&&d.files[0]&&(o.value=d.files[0])},y=async()=>{n.value=!0,i.value="",i.value="csdn requesting...";try{const u=new ge;switch(a.info("appInstance=>",u),l.value){case Sa:{const d="custom_Csdn",b=await de.getAdaptor(d),E=await C.webApi(u,b).getMetaData();i.value=JSON.stringify(E),a.info("csdn meta data=>",E);break}case Aa:{const d="custom_Csdn",b=await de.getAdaptor(d),E=await C.webApi(u,b).getUsersBlogs();i.value=JSON.stringify(E),a.info("csdn users blogs=>",E);break}default:break}n.value=!1}catch(u){i.value=u,a.error(t("main.opt.failure")+"=>",u),n.value=!1}};return(u,d)=>{const b=Je,h=Xe,E=we,v=be,T=Oe;return w(),k(T,{title:"CSDN测试"},{default:_(()=>[P("div",Bd,[P("div",Gd,[f(h,{modelValue:l.value,"onUpdate:modelValue":d[0]||(d[0]=S=>l.value=S),class:"m-2",placeholder:"请选择方法名称",onChange:c},{default:_(()=>[(w(!0),N(_e,null,Te(p.options,S=>(w(),k(b,{key:S.value,label:S.label,value:S.value},null,8,["label","value"]))),128))]),_:1},8,["modelValue"])]),P("div",$d,[f(E,{type:"primary",loading:n.value,onClick:y},{default:_(()=>[G("开始测试csdn")]),_:1},8,["loading"])]),P("div",Ld,[f(E,null,{default:_(()=>[G("入参")]),_:1})]),P("div",jd,[f(v,{modelValue:s.value,"onUpdate:modelValue":d[1]||(d[1]=S=>s.value=S),type:"textarea",rows:5},null,8,["modelValue"])]),e.value?(w(),N("div",Hd,[P("input",{type:"file",onChange:g},null,32)])):z("",!0),P("div",Rd,[f(E,null,{default:_(()=>[G("结果")]),_:1})]),P("div",Fd,[f(v,{modelValue:i.value,"onUpdate:modelValue":d[2]||(d[2]=S=>i.value=S),type:"textarea",rows:10,placeholder:"日志信息"},null,8,["modelValue"])])])]),_:1})}}});const Yd=ue(Kd,[["__scopeId","data-v-6e5e83d6"]]),zd=[{path:"/workers/quickPublish/:key/:id",component:qu},{path:"/publish/singlePublish",component:Yr},{path:"/publish/singlePublish/doPublish/:key/:id",component:Vc},{path:"/",component:go},{path:"/publish/batchPublish",component:go},{path:"/ai/chat",component:Nd},{path:"/test",component:ud},{path:"/test/siyuan",component:vg},{path:"/test/cnblogs",component:gg},{path:"/test/wordpress",component:Mg},{path:"/test/typecho",component:Hg},{path:"/test/yuque",component:Zg},{path:"/test/zhihu",component:rd},{path:"/test/csdn",component:Yd},{path:"/test/picgo",component:sg},{path:"/test/other",component:Qu},{path:"/test/chat",component:Md},{path:"/setting",component:_p},{path:"/setting/publish",component:ii},{path:"/setting/platform/quickadd/:type",component:$u},{path:"/setting/platform/add/:type",component:Cu},{path:"/setting/platform/update/:key",component:Ou},{name:"setting-platform-single",path:"/setting/platform/single/:key",component:Tu},{path:"/setting/general",component:Dp},{path:"/setting/siyuan",component:ni},{path:"/about",component:Dd}],Wd=()=>Gi({history:$i(),routes:zd}),qd={"lang.choose":"语言选择","lang.choose.placeholder":"请选择语言","theme.mode.choose":"切换模式","theme.mode.dark":"暗黑模式","theme.mode.light":"浅色模式","service.tab.publish.service":"发布服务","service.tab.publish.setting":"发布配置","service.tab.platform.setting":"平台配置","service.tab.post.bind":"文章绑定","service.tab.service.switch":"服务开关","service.tab.change.local":"偏好设置","main.publish.editmode":"编辑模式","main.publish.editmode.simple":"简洁模式","main.publish.editmode.complex":"详细模式","main.publish.editmode.source":"源码模式","main.publish.vuepress.tip":"推荐Vuepress的V1版本，配合 vuepress-theme-vdoing 使用，后续bug也只会对V1和此主题进行更新","main.publish.github.error.tip":"配置错误或者api不可用，请检查。若修改过配置，请刷新页面","main.publish.github":"发布页面","main.publish.github.tip":"自动将文章的markdown文本发布到Vuepress对应的Github仓库（需要先进行相关配置）","main.publish.github.no.tip":"您未开启Github pages发布，请切换源码模式复制YAML以及Markdown文本","main.publish.github.choose.path":"选择目录","main.publish.github.published.path":"发布路径","main.publish.github.choose.path.use.default":"默认目录","main.publish.github.choose.path.use.default.tip":"使用默认目录，则默认所有文章都发布在配置好的默认目录下（可在发布配置设置），无需每次发布的时候来选择目录，当前平台的默认目录为：","main.publish.github.choose.title":"文件名称","main.publish.github.choose.title.tip":"Vuepress-theme-vdoing支持文件名加上序号来标识，如果你不清楚此用法，请不要修改文件名","main.publish.github.failure":"发布失败，请自行复制右侧文本","main.publish.see.preview":"点击这里查看最新文章","main.publish.see.md.preview":"点击这里查看MD文件","main.publish.see.real.preview":"点击这里查看最新文章","main.publish.to.wordpress":"发布到Wordpress","main.title":"文章标题","main.slug":"文章别名","main.auto.fetch.slug":"自动生成别名","main.use.google.translate":"使用Google翻译API","main.use.hash":"别名后缀","main.use.hash.tip":"不使用hash会展示更有意义的url，但是可能导致文章别名重复（后果是Vuepress会Build失败除非手动解决别名唯一问题），请知悉。","main.force.refresh":"刷新别名","main.force.refresh.tip":"为了防止误操作更新别名，别名不为空的时候默认不会更新别名，如需更新，请勾选刷新别名。","main.desc":"文章摘要","main.auto.fetch.desc":"自动提取摘要","main.create.time":"发布时间","main.update.time":"更新时间","main.create.time.placeholder":"请选择发布时间","main.update.time.placeholder":"请选择更新时间","main.tag":"文章标签","main.tag.new":"新标签","main.auto.fetch.tag":"自动提取标签","main.tag.auto.switch":"自动标签","main.tag.auto.switch.no.tip":"自动标签已关闭，将不会自动生成标签","main.cat":"文章分类","main.cat.empty":"暂无分类","main.cat.select":"请选择分类","main.yaml.formatter":"YAML Formatter","main.siyuan.to.yaml":"文章属性转YAML","main.yaml.to.siyuan":"YAML转文章属性","main.save.attr.to.siyuan":"保存属性到思源","main.copy":"复制","main.publish":"发布","main.publish.loading":"发布中...","main.loading":"加载中...","main.update":"更新","main.cancel":"取消","main.publish.oneclick.attr":"一键生成属性","main.publish.oneclick.attr.finish":"属性已生成","main.publish.status.unpublish":"未发布","main.publish.status.published":"已发布","main.publish.to.vuepress":"发布到Vuepress","main.publish.to.hugo":"发布到Hugo","main.publish.to.hexo":"发布到Hexo","main.publish.to.jekyll":"发布到Jekyll","main.publish.to.jvue":"发布到JVue","main.publish.to.conf":"发布到Confluence","main.publish.to.cnblogs":"发布到博客园","main.publish.to.liandi":"发布到链滴","main.publish.to.yuque":"发布到语雀","main.publish.to.kms":"发布到KMS","main.opt.success":"操作成功","main.opt.failure":"操作失败","main.copy.success":"复制成功","main.copy.failure":"复制失败","main.opt.quick":"快捷操作","main.opt.status.publish":"文章已发布","main.opt.status.updated":"文章已更新","main.opt.status.cancel":"文章发布已取消","main.opt.loading":"操作中...","main.opt.warning":"警告信息","main.opt.tip":"温馨提示","main.opt.ok":"确认","main.opt.cancel":"取消","main.opt.select":"请选择","main.opt.warning.tip":"此操作不可恢复，是否继续？","setting.noneed":"无需配置","setting.blog.setting":"设置","setting.blog.index":"偏好设置","setting.blog.type":"博客类型","setting.blog.type.placeholder":"请选择博客类型","setting.blog.type.wordpress.value":"Wordpress","setting.blog.type.wordpress.label":"Wordpress","setting.blog.type.metaweblog.value":"MetaweblogApi","setting.blog.type.metaweblog.label":"Metaweblog API","setting.blog.type.github.value":"Github","setting.blog.type.github.label":"Github","setting.blog.type.github.user":"Github用户名","setting.blog.type.github.user.tip":"Github用户名，例如：terwer","setting.blog.type.github.repo":"git仓库名","setting.blog.type.github.repo.tip":"git仓库名，例如：hexo-blog","setting.blog.type.github.token":"Github令牌","setting.blog.type.github.token.tip":"Github令牌，例如：ghp_XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX","setting.blog.type.github.token.gen":"Github 个人令牌生成地址","setting.blog.type.github.default.branch":"默认分支","setting.blog.type.github.default.branch.tip":"默认分支（旧版仓库为master，新版仓库默认为main），例如：main","setting.blog.type.github.default.path":"存储目录","setting.blog.type.github.default.path.tip":"存储目录（相对于仓库根目录的相对路径，默认所有文章都发布在这里），例如：docs/_posts","setting.blog.type.github.msg":"提交信息","setting.blog.type.github.msg.tip":"提交信息，例如：auto published by siyuan-publish-publisher","setting.blog.type.github.author":"作者","setting.blog.type.github.author.tip":"作者，例如：terwer","setting.blog.type.github.email":"邮箱","setting.blog.type.github.email.tip":"邮箱","setting.blog.url":"博客网址","setting.blog.github.url.tip":"Github首页地址","setting.blog.username":"账号","setting.blog.password":"密码/Token","setting.blog.apiurl":"API地址","setting.blog.github.apiurl.tip":"Github 的 REST API 地址，通常是：https://api.github.com","setting.blog.previewPostUrl":"文章预览规则","setting.blog.previewPostUrl.tip":"预览规则（占位符：[yyyy] [MM] [dd] [postid]），例如：/post/[postid].html 或者 /[cats]/[yyyy]/[mm]/[dd]/[postid].html","setting.blog.previewUrl":"预览规则","setting.blog.previewUrl.tip":"如果不明白原理，请勿修改此选项。MD文件预览规则（占位符：[user] [repo] [branch] [docpath]），通常是：/[user]/[repo]/blob/[branch]/[docpath]","setting.blog.mdFilenameRule":"文件规则","setting.blog.mdFilenameRule.tip":"Markdown文件名规则（占位符：[yyyy] [MM] [dd] [slug] [filename] ），例如：[filename].md 或者 [yyyy]-[mm]-[dd]-[slug].md","setting.blog.pageType":"发布格式","setting.blog.validate":"验证","setting.blog.save":"保存","setting.blog.vali":"验证","setting.blog.vali.tip":"强烈建议保存之前先验证配置以保证api的可用性，验证过程中将发送一篇测试文章，您可以稍后在平台手动删除它。您也可以先保存，稍后修改，但是在验证通过之前该api将不可使用。","setting.blog.vali.tip.metaweblog":"配置错误或者api不可用，请检查。若修改过配置，请刷新页面","setting.blog.vali.ing":"验证中...","setting.blog.vali.ok":"验证通过，不要忘了点击下方保存哟(*^▽^*)","setting.blog.vali.ok.metaweblog":"配置已保存并验证通过","setting.blog.vali.error":"API验证失败，请检查配置","setting.blog.platform.support.github":"您当前操作的是支持Github的平台：","setting.blog.platform.support.metaweblog":"您当前操作的是支持metaweblog的平台：","setting.blog.cancel":"取消","setting.vuepress":"Vuepress","setting.hugo":"Hugo","setting.hexo":"Hexo","setting.jekyll":"Jekyll","setting.jvue":"JVue","setting.conf":"Confluence","setting.conf.tip":"发布到Confluence需要配合我的另一个适配器项目使用（强烈推荐），请参考：https://github.com/terwer/node-metaweblog-api-adaptor","setting.cnblogs":"博客园","setting.wordpress":"Wordpress","setting.liandi":"链滴","setting.yuque":"语雀","setting.kms":"KMS","setting.other1":"其他1","service.switch.vuepress":"Vuepress","service.switch.hugo":"Hugo","service.switch.hexo":"Hexo","service.switch.jekyll":"Jekyll","service.switch.jvue":"JVue","service.switch.conf":"Confluence","service.switch.cnblogs":"博客园","service.switch.wordpress":"Wordpress","service.switch.yuque":"语雀","service.switch.liandi":"链滴","service.switch.wechat":"微信聊天","service.switch.wemp":"微信公众号","service.switch.zhihu":"知乎","service.switch.kms":"知识仓库","service.switch.must.select.one":"您必须选择一个至少平台","post.bind.vuepress.slug":"Vuepress别名","post.bind.hugo.slug":"Hugo别名","post.bind.hexo.slug":"Hexo别名","post.bind.jekyll.slug":"Jekyll别名","post.bind.cnblogs.postid":"博客园别名","post.bind.jvue.postid":"JVue的ID","post.bind.conf.postid":"Conf的ID","post.bind.wordpress.postid":"WP的ID","post.bind.liandi.postid":"链滴的ID","post.bind.yuque.postid":"语雀的ID","post.bind.kms.postid":"KMS的ID","post.bind.conf.save":"保存","post.bind.conf.cancel":"取消","form.validate.name.required":"请输入名称","form.validate.name.length":"长度必须在0到1之间","form.validate.github.auto.delete":"自动删除","dynamic.platform.new":"平台管理","dynamic.platform.tip":"如果内置的发布服务无法满足或者需要添加多个实例，您可以在这里添加受支持的平台，目前支持通用平台（Zhihu、语雀、CSDN等）、Github（HUGO、HEXO、Jekyll等）、metaweblog API（开源中国等）和Wordpress API","dynamic.platform.type":"平台类型[必选]","dynamic.platform.subtype":"子平台名称","dynamic.platform.type.metaweblog":"metaweblog API","dynamic.platform.type.wordpress":"Wordpress","dynamic.platform.type.github":"Github","dynamic.platform.type.common":"通用平台","dynamic.platform.type.custom":"自定义","dynamic.platform.key":"平台key","dynamic.platform.key.tip":"平台唯一标识，不能重复，例如：myblog","dynamic.platform.name":"平台名称","dynamic.platform.name.tip":"平台名称，例如：我的博客","dynamic.platform.opt.add":"提交","dynamic.platform.opt.noselect":"请选择平台类型","dynamic.platform.opt.key.exist":"平台key已经存在","dynamic.platform.opt.del.confirm":"删除此平台将会彻底移除此平台相关配置信息，是否继续？","dynamic.platform.opt.del.select":"删除","dynamic.platform.opt.item.select":"未选择","dynamic.platform.opt.item.select.tip":"当前选择的是：","dynamic.platform.opt.item.no.select.tip":"请选择要删除的行","setting.common.home":"平台首页","setting.common.tip":"平台首页，用于预览文章，例如：https://terwer.space","setting.common.apiurl":"API地址","setting.common.token":"鉴权token","setting.common.token.gen":"Token生成地址","setting.common.username":"用户名","setting.common.username.gen":"访问策略设置","setting.common.password":"密码","setting.blog.platform.support.common":"您当前操作的平台是：","platform.must.select.one":"哇哦，离使用就差一步啦 o(╥﹏╥)o ，您必须添加并启用至少一个平台。如果列出的平台没有你想要的，可以点击新增按钮添加。有任何疑问欢迎邮件 youweics#163.com ","blog.list.toptip":"温馨提示：单击表格行可以进入文章详情页，详情页有发布按钮哦! (〃'▽'〃)","config.error.msg":"配置错误，请前往对应发布配置修改","config.platform.none":"没有启用的发布平台，请前往服务开关开启","post.delete.by.platform":"文章已被平台自行删除，请点击取消强制解除关联","blog.top-data-tip":"温馨提示：1. 0.1.0+ 以后，可通过【偏好设置->思源地址】来修改默认伺服配置，支持本地和远程；如果是远程还需要设置token，如果使用浏览器插件或者挂件之外的访问方式还需要设置跨域请求代理。 2、升级新版之前强烈建议导出配置，防止配置丢失。 3、如果出现新版本不兼容的异常情况，建议清空配置。此操作不可恢复，请谨慎操作！","blog.top-data-tip.siyuan":"温馨提示：1、当前处于挂件模式，从 0.1.0 版本开始，无需在所有页面引用挂件了，只需要在父级页面引用一个挂件即可。具体规则如下：(1). 如果检测到没有子文档，会兼容 0.0.3 版本以前的方式，展示当前文档的发布页面。 (2). 如果检测到有子文档，会以列表加分页的方式展示所有子文档列表。可单独选择某个子文档进行发布操作。 2、升级新版之前强烈建议导出配置，防止配置丢失。 3、如果出现新版本不兼容的异常情况，建议清空配置。此操作不可恢复，请谨慎操作！","blog.newwin.open":"页签模式","blog.change.siyuan.api":"思源地址","setting.blog.siyuan.current.apiurl":"当前API地址=>","setting.blog.middlewareUrl":"跨域请求代理","setting.blog.middlewareUrl.tip":"某些场景下需要（例如自部署模式，Nginx伺服等、vite开发环境伺服等），其他情况可忽略","setting.blog.middlewareUrl.my.tip":"大部分情况下不需要，部分场景在浏览器环境下可能需要。如果没有部署代理，可以使用我的共享地址：https://api.terwer.space/api/middleware 。出于性能考虑，建议自己部署一份，请使用 https://github.com/terwer/node-metaweblog-api-adaptor 进行部署。","setting.conf.export":"导出配置","setting.conf.import":"导入配置","setting.conf.transport":"导入导出","setting.conf.clear":"清空配置","page.no.id":"请求非法，原因：pageId获取失败","yaml.show.type.yaml":"YAML","yaml.show.type.md":"MD正文","yaml.show.type.yamlmd":"YAML+MD正文","yaml.show.type.html":"HTML正文","main.read.mode":"只读模式","main.edit.mode":"编辑模式","main.read.mode.tip1":"温馨提示：为了数据一致性，多平台分发或者未提供YAML适配器时无法处理平台属性，YAML将仅显示公共属性且只能只读。","main.read.mode.tip2":"YAML如有修改，请务必点击保存按钮，否则修改内容将丢失！","main.read.mode.tip3":"为了标识文章的唯一性，slug修改将忽略，其他属性可同步。","main.read.mode.tip4":"如需删除了内置的YAML属性，删除之后请务必先同步到思源笔记，否则切换模式会还原。","main.opt.onclick.confirm.tip":"此操作默认将重新生成除别名以外的所有属性，如果只想修改个别属性，请在详细模式点击单独的功能按钮进行对应操作，是否继续？","main.cat.list.error":"分类获取失败","main.yaml.no.save":"您编辑过YAML，点击确认可同步YAML到属性，取消将丢失YAML修改，是否继续？","setting.github.baseUrl":"Git平台地址","setting.github.baseUrl.tip":"Git平台地址，用于MD文件预览，默认是：https://github.com","preference.setting.fixTitle":"去除标题编号","preference.setting.removeH1":"去除正文H1","preference.setting.removeH1.tip":"删除H1可能会误删除Markdown里面的#开头的注释，如需开启，请使用2个以上的#注释，是否继续？","preference.setting.newWin":"新窗口操作","siyuan.browser.show.close.btn":"显示关闭按钮","siyuan.browser.menu.quick.btn":"一键快速发布","siyuan.browser.menu.publish.btn":"文章发布（自动检测，有子文档->列表页；无子文档->发布页）","siyuan.browser.menu.preview.btn":"文章预览（当前文章只读预览）","siyuan.browser.menu.manage.btn":"文章管理（全部文章统一管理）","siyuan.browser.menu.anki.btn":"Anki标记（配合ankisiyuan生成Anki标记）","siyuan.browser.menu.picture.btn":"PicGO图床（支持图床配置与图片上传）","siyuan.browser.menu.setting.btn":"偏好设置（系统设置统一入口）","anki.siyuan.deck":"牌组","anki.siyuan.deck.new":"新牌组","anki.siyuan.tag":"标签","anki.siyuan.tag.new":"新标签","picgo.chrome.tip":"您当前使用的是浏览器插件，需要从这里下载配置 PicGO 客户端：https://github.com/Molunerfinn/PicGo/releases","picgo.siyuan.tip":"您当前使用的是思源笔记挂件，PicGO已内置，只需配置即可","post.detail.button.copy.id":"复制本文ID","post.detail.button.share.link":"复制分享链接","post.detail.button.browser.open":"默认浏览器打开","post.detail.button.pic.manage":"图片管理","post.detail.button.anki.mark":"Anki标记","post.detail.index.send.to.publish":"发布到其他平台","post.detail.index.export.to.pdf":"导出为PDF","picgo.upload.status":"上传状态","picgo.upload.select.pic":"选择图片","picgo.upload.clipboard":"剪贴板图片","picgo.upload.onclick":"一键上传本地图片到图床","picgo.download.onclick":"一键下载远程图片到本地","picgo.download.local.to.bed":"上传本地图片到图床","picgo.download.bed.to.local":"下载远程图片到本地","picgo.pic.preview":"图片预览","picgo.pic.setting":"图床设置","picgo.pic.setting.no.tip":"由于您当前使用的是浏览器插件，无法直接集成 PicGO ，只能通过 HTTP 请求间接调用本地 PicGO 客户端上图片，请直接在本地 PicGO 客户端进行设置。如需体验更加完整的功能，请通过思源笔记挂件版挂载菜单打开新窗口的方式使用。详情请参考：https://docs.publish.terwer.space/post/the-pendant-mode-is-used-in-the-method-of-mounting-menu-169wrw.html","github.use.permalink":"永久链接","github.use.permalink.no.warn":"您已关闭永久链接，formatter将不会生成标记，这在某些特殊场景下可能有用，大部分情况下需要开启此选项，注意：目前仅仅在HUGO平台生效，主要是适配Docsy","github.menu.title":"菜单标题","github.menu.title.placeholder":"菜单栏标题（HUGO平台专用，为空则不显示在菜单）","github.weight":"显示权重","github.weight.placeholder":"权重（决定显示顺序，越小显示越靠前）","github.use.date":"显示日期","github.use.date.no.warn":"您已关闭日期显示，将不会在formatter生成date字段","github.post.picgo.use":"使用图床","github.post.picgo.use.tip":"启用此选项，将会自动将此文档包含的所有本地图片上传至自定义图床（远程图片不上传），请确保PicGO图床配置正确","github.post.picgo.start.upload":"图床已开启，即将上传本地图片到图床","github.post.picgo.picbed.error":"文档可能已经成功发布，但是图片上传失败或者当前场景不支持图片上传，详细信息","setting.yuque.home.tip":"语雀平台首页，通常固定是：https://www.yuque.com/","setting.yuque.username.tip":"语雀平台用户名，注意是【账户设置】里面固定连接里面的用户名，不是用户昵称哦(*^▽^*)","setting.yuque.password.tip":"语雀平台的Token，请按照链接点击获取，只需要勾选【读取你的知识库】和【修改和读取你的文档】两个权限即可","setting.yuque.apiurl.tip":"语雀平台的API地址，通常固定是：https://www.yuque.com/api/v2","setting.yuque.previewUrl.tip":"语雀平台的文章预览规则，通常是：/[notebook]/[postid]","setting.notion.home.tip":"Notion平台首页，通常固定是：https://www.notion.so/","setting.notion.password.tip":"Notion平台的Token，请按照链接点击获取，需要勾选【Read content】、【Update content】、【Insert content】三个权限","setting.notion.apiurl.tip":"Notion平台的API地址，通常固定是：https://api.notion.com/v1","setting.notion.previewUrl.tip":"Notion平台的文章预览规则，通常是：/[postid]","setting.liandi.home.tip":"链滴平台首页，通常固定是：https://ld246.com/","setting.liandi.username.tip":"链滴平台用户名，注意是点击【个人主页】之后URL上member后面显示的用户名，不是用户昵称哦(*^▽^*)","setting.liandi.password.tip":"链滴平台的Token，请按照链接点击获取","setting.liandi.apiurl.tip":"链滴平台的API地址，通常固定是：https://ld246.com/api/v2","setting.kms.home.tip":"KMS平台首页，例如：http://localhost:9564/kms16_release/kms/multidoc","setting.kms.username.tip":"KMS平台Rest账户用户名，请按照链接指示创建","setting.kms.password.tip":"KMS平台Rest账户密码，请按照链接指示创建","setting.kms.apiurl.tip":"KMS平台的API地址，例如：http://localhost:9564/kms16_release/api/kms-multidoc/kmsMultidocKnowledgeRestService","siyuan.local.share.tip":"温馨提示：如果发现分享链接或者浏览器打开无法显示或者网络连接被拒绝，请按照下面操作排查。1：思源笔记->设置->关于->打开网络伺服；2：在浏览器打开之后，点击底部思源地址，修改对应地址为局域网ip地址。","setting.cnblogs.home.tip":"您的博客园首页，通常是：https://www.cnblogs.com/<您的用户名>","setting.cnblogs.username.tip":"您的博客园MetaWeblog登录名，可前往您的博客园后台->设置查看，注意：是登录名，不是用户昵称哦(*^▽^*)","setting.cnblogs.password.tip":"您的博客园MetaWeblog访问令牌，可前往您的博客园后台->设置查看","setting.cnblogs.apiUrl.tip":"您的博客园MetaWeblog访问地址，可前往您的博客园后台->设置查看，通常是：https://rpc.cnblogs.com/metaweblog/<您的用户名>","setting.cnblogs.previewUrl.tip":"博客园平台的文章预览规则，通常是：/p/[postid].html","setting.wordpress.home.tip":"WordPress首页","setting.wordpress.username.tip":"WordPress登录名，注意：是登录名，不是用户昵称哦(*^▽^*)","setting.wordpress.password.tip":"WordPress登录密码","setting.wordpress.apiUrl.tip":"WordPress的xmlrpc远程发布地址，通常是：https://<WordPress博客地址>/xmlrpc.php","setting.wordpress.previewUrl.tip":"WordPress平台的文章预览规则，通常是：?p=[postid]","setting.oschina.home.tip":"开源中国首页，通常是：https://my.oschina.net/<您的用户名>","setting.oschina.username.tip":"开源中国登录名，可以输入登录邮箱","setting.oschina.password.tip":"开源中国登录密码","setting.oschina.apiUrl.tip":"开源中国的xmlrpc远程发布地址，通常固定是：https://www.oschina.net/action/xmlrpc","setting.oschina.previewUrl.tip":"开源中国平台的文章预览规则，通常是：/blog/[postid]","setting.typecho.home.tip":"Typecho平台的首页","setting.typecho.username.tip":"Typecho平台登录名","setting.typecho.password.tip":"Typecho平台密码","setting.typecho.apiUrl.tip":"Typecho平台的xmlrpc远程发布地址，通常固定是：https://<平台地址>/index.php/action/xmlrpc","setting.typecho.previewUrl.tip":"Typecho平台的文章预览规则，通常是：/index.php/archives/[postid]","setting.metaweblog.home.tip":"Metaweblog平台的首页","setting.metaweblog.username.tip":"Metaweblog平台登录名","setting.metaweblog.password.tip":"Metaweblog平台密码","setting.metaweblog.apiUrl.tip":"Metaweblog平台的xmlrpc远程发布地址","setting.metaweblog.previewUrl.tip":"Metaweblog平台的文章预览规则，[postid]可作文文章ID占位符","setting.jvue.home.tip":"JVue平台的首页","setting.jvue.username.tip":"JVue平台登录名","setting.jvue.password.tip":"JVue平台密码","setting.jvue.apiUrl.tip":"JVue平台的xmlrpc远程发布地址，通常固定是：https://<平台地址>/xmlrpc","setting.jvue.previewUrl.tip":"JVue平台的文章预览规则，通常是：/post/[postid].html","setting.conf.home.tip":"Confluence Cloud，首页，通常是：https://<您的用户名>.atlassian.net/wiki/spaces/<空间名>","setting.conf.username.tip":"Confluence登录名，可前往您的atlassian账户获取","setting.conf.password.tip":"Confluence访问令牌，可前往您的atlassian账户获取","setting.conf.apiUrl.tip":"可前往 https://developer.atlassian.com/cloud/confluence/rest/v1/#api-wiki-rest-api-content-get 查看文档","setting.conf.previewUrl.tip":"Confluence平台文章预览规则，通常是：/pages/[postid]","setting.zhihu.home.tip":"知乎专栏首页地址，通常固定","setting.zhihu.username.tip":"知乎用户名，必须设置正确，否则无法获取专栏","setting.zhihu.password.tip":"知乎Cookie，请勿修改","setting.zhihu.apiUrl.tip":"通常固定，请勿修改","setting.zhihu.previewUrl.tip":"知乎平台文章预览规则，通常是：/[postid]","setting.csdn.home.tip":"CSDN博客首页地址，通常固定","setting.csdn.password.tip":"CSDN的Cookie，请勿修改","setting.csdn.apiUrl.tip":"通常固定，请勿修改","setting.csdn.previewUrl.tip":"CSDN平台文章预览规则","setting.wechat.home.tip":"微信公众号首页地址，通常固定","setting.wechat.password.tip":"微信公众号的Cookie，请勿修改","setting.wechat.apiUrl.tip":"通常固定，请勿修改","setting.wechat.previewUrl.tip":"微信公众号平台文章预览规则","setting.jianshu.home.tip":"简书首页地址，通常固定","setting.jianshu.password.tip":"简书的Cookie，请勿修改","setting.jianshu.apiUrl.tip":"通常固定，请勿修改","setting.jianshu.previewUrl.tip":"简书平台文章预览规则","setting.juejin.home.tip":"掘金首页地址，通常固定","setting.juejin.password.tip":"掘金的Cookie，请勿修改","setting.juejin.apiUrl.tip":"通常固定，请勿修改","setting.juejin.previewUrl.tip":"掘金平台文章预览规则","setting.halo.home.tip":"Halo首页地址，需要包括域名端口，例如：http://localhost:8090","setting.halo.username.tip":"Halo博客登录名","setting.halo.password.tip":"Halo博客登录密码","setting.halo.apiUrl.tip":"Halo博客API地址，一般与Halo首页相同","setting.halo.previewUrl.tip":"Halo博客文章预览规则，默认 /archives/{slug}，占位符有 {slug} {name} {year} {month} {day}，可在 [halo-home-url]/console/settings?tab=routeRules设置","setting.picgo.refer.to":"详情请参考：","setting.picgo.refer.to.online.doc":"PicGO配置在线文档","setting.picgo.picbed":"图床设置","setting.picgo.picgo":"PicGO设置","main.opt.edit":"编辑","main.opt.delete":"删除","setting.picgo.picgo.open.config.file":"打开配置文件","setting.picgo.picgo.click.to.open":"点击打开","setting.picgo.picgo.choose.showed.picbed":"请选择显示的图床","setting.picgo.picbed.selected.tip":"已选中","setting.picgo.picbed.unselected.tip":"未选中","setting.picgo.picbed.set.default":"设为默认图床","setting.picgo.picbed.current.selected.tip":"已选中图床：","setting.picgo.picbed.current.tip":"当前默认图床是：","setting.picgo.picbed.uploader.config.name":"图床配置名","setting.picgo.picbed.uploader.config.name.placeholder":"请输入配置名称","setting.picgo.config.name":"配置名称","setting.picgo.config.name.placeholder":"请输入配置名称","setting.picgo.index.tip":"注意：1、此处上传的图片不会自动插入文档中，请手动点击按钮复制链接，然后 Ctrl+V 粘贴到文档中。2、对于文档当中原本已经存在的本地图片，点击上传之后不会直接替换原始图片，只会存储本地图片与图床图片的映射信息，需要在发布文章时手动勾选【使用图床】才会进行临时链接替换，请知悉。这样做是为了不破坏其他地方对文档图片的处理。当然，您也可以手动复制图床链接，然后删除原图片，替换为图床图片。3、该图片列表仅展示此文档包含的图片。","setting.picgo.index.copy.link":"复制链接","setting.picgo.setting.timestamp.rename":"时间戳重命名","setting.picgo.setting.close":"关","setting.picgo.setting.open":"开","setting.picgo.setting.log.file":"日志文件","setting.picgo.plugin":"插件设置","setting.picgo.plugin.list":"插件列表","setting.picgo.plugin.import.local":"导入本地插件","setting.picgo.plugin.install":"安装","setting.picgo.plugin.installing":"安装中","setting.picgo.plugin.installed":"已安装","setting.picgo.plugin.doing.something":"进行中","setting.picgo.plugin.search.placeholder":"搜索npm上的PicGo插件，或者点击上方按钮查看优秀插件列表。推荐：watermark-elec、s3","setting.picgo.plugin.gui.not.implemented":"该插件未对可视化界面进行优化, 是否继续安装?","setting.picgo.setting.node.path":"Node安装路径","setting.picgo.setting.node.path.tip":"请输入Node安装完整路径，例如：/opt/node16/bin，Node版本>=16","setting.picgo.setting.node.registry":"NPM的registry","setting.picgo.setting.node.registry.tip":"国内推荐：https://registry.npmmirror.com","setting.picgo.setting.node.proxy":"NPM代理","setting.picgo.setting.node.proxy.tip":"一般可留空，如有特殊需求可设置自定义代理","setting.picgo.setting.config.tip":"注意：横线以上的属性会改变上传图片的行为，配置可自动保存。横线以下的属性仅仅在安装插件时用到，并且需要点击【确认】按钮才能保存。","setting.picgo.plugin.install.success":"插件已经成功安装，请清除搜索关键字刷新列表。点击插件对应【设置】图标可查看插件详情，并对插件进行自定义设置。如果是图床扩展，请关闭重新打开，然后启用图床并进行设置。","syp.about":"关于作者","setting.picgo.plugin.uninstall":"卸载插件","setting.picgo.plugin.uninstall.success":"插件已经成功卸载。","setting.picgo.plugin.enable":"启用插件","setting.picgo.plugin.disable":"禁用插件","setting.picgo.plugin.update":"更新插件","setting.picgo.plugin.config.setting":"插件设置","setting.picgo.plugin.work":"已兼容","setting.picgo.plugin.nowork":"不兼容","setting.picgo.plugin.nouse":"不可用","setting.picgo.plugin.update.success":"更新成功","setting.conf.import.syp":"导入挂件配置","setting.conf.import.picgo":"导入PicGO配置","setting.conf.export.syp":"导出挂件配置","setting.conf.export.picgo":"导出PicGO配置","setting.conf.import.syp.tip":"请选择有效的历史备份json文件进行导入。注意：挂件配置会进行配置替换。","setting.conf.import.picgo.tip":"请选择有效的历史备份json文件进行导入。注意：PicGO插件的注册信息不导入。为了配置的兼容性，请卸载所有插件之后，进行PicGO配置导出操作。卸载PicGO插件不会删除插件配置，只会删除插件文件以及插件注册记录。请放心卸载。","setting.conf.export.syp.tip":"将导出对应的json配置文件，强烈建议定期进行配置备份。原则上支持向后兼容。如有不兼容问题，会特别说明。","setting.conf.export.picgo.tip":"将导出对应的json配置文件，强烈建议定期进行配置备份。原则上支持向后兼容。如有不兼容问题，会特别说明。","setting.conf.clear.syp":"清空挂件配置","setting.conf.clear.picgo":"清空PicGO配置","setting.conf.clear.tip":"清空配置不可恢复，请谨慎操作。强烈建议先备份配置。","setting.conf.clear.picgo.tip":"清空配置不可恢复，请谨慎操作。强烈建议先备份配置。此操作会删除PicGO相关配置文件夹，包括配置、插件、缓存等，仅在PicGO加载发生异常，并且完全无法使用的时候使用，否则丢失配置后果自负！","setting.main.background":"挂件背景","setting.main.background.tip":"支持16进制和rgb，例如：#000000，未设置或者留空不变。如果新窗口设置，请重新刷新文档。","setting.picgo.manage":"图床管理","setting.platform.add":"新增平台","setting.platform.add.this":"新增此平台","setting.platform.universal":"通用平台","setting.platform.universal.desc":"目前支持的通用平台有：语雀、Notion等，采用API授权。这些平台通常提供了现代化的REST API，可以方便的进行集成。","setting.platform.wordpress":"WordPress","setting.platform.wordpress.desc":"Wordpress 通过Xmlrpc API支持，采用 API 授权。WordPress是一个自由开源的博客软件和内容管理系统，具有数量众多的优质插件和主题。","setting.platform.github":"Github","setting.platform.github.desc":"目前支持Github发布的的平台有：Hexo、Hugo、Jekyll、Vitepress等，采用 API 授权。GitHub 是一个使用 Git 进行软件开发和版本控制的代码平台。","setting.platform.gitlab":"Gitlab","setting.platform.gitlab.desc":"Gitlab基本上与Github的使用方式类似，唯一的区别是Gitlab支持自己本地部署或者云服务器部署。","setting.platform.metaweblog":"Metaweblog","setting.platform.metaweblog.desc":"目前支持Metaweblog的平台有：博客园、Typecho等，采用 API 授权。MetaWeblog API 作为XML-RPC Web 服务实现，是目前公认的开放博客标准。","setting.platform.custom":"自定义 HTTP 协议","setting.platform.custom.desc":"目前支持自定义HTTP协议的平台有：知乎等，采用网页授权。自定义HTTP协议通过类似 WeChatSync 的方式实现。","setting.platform.right.tips0":"特别提示：","setting.platform.right.tips1":"1、在这里可以进行发布配置，直接点击 [设置图标] 即可进行配置。","setting.platform.right.tips2":"2、如需新增平台，直接点击左侧 + 按钮即可。","setting.platform.right.tips3":"3、目前支持 网页授权 和 API 授权两种方式，API授权 复杂点但是相对稳定，网页授权简单但是可能会失效。网页授权模式实现思路类似 wechatsync 。","setting.platform.right.tips4":"4、如需兼容其他平台，请联系我：youweics@163.com 或者填写下面的表单。","setting.entry.title":"平台统一设置 - ","setting.entry.not.supported":"不支持的平台","setting.upgrade.syp.tip1":"准备开始迁移...","setting.upgrade.syp.tip2":"迁移成功.","setting.upgrade.syp.tip3":"已经是最新，无需迁移.","setting.upgrade.syp.tip4":"迁移失败，错误如下","setting.upgrade.syp.tip5":"迁移操作完成.","setting.upgrade.syp.doTip1":"检测配置文件是否为最新版本","setting.upgrade.syp.doTip2":"检测到旧配置，准备升级配置文件","setting.upgrade.syp.doTip3":"旧配置升级","setting.upgrade.syp.doTip4":"没有版本更新，跳过升级","main.publish.start":"开始同步","main.publish.remove":"批量删除","setting.blog.knowledge.space":"知识空间/知识库","main.data.empty":"暂无数据","knowledgeSpaceEnabled.Tips":"验证通过之后，将列出可用的 [[knowledge-space-title]] 列表，您可以根据需要修改默认 [[knowledge-space-title]] 并保存","post.bind.auto.tips":"此处ID为发布工具自动保存，仅作为修复数据使用，如果您不清楚原理，请勿修改","siyuan.config.setting":"思源设置","setting.blog.siyuan.apiurl":"思源API地址","setting.blog.siyuan.apiurl.tip":"思源笔记的API地址，包括端口，默认是：http://127.0.0.1:6806","setting.blog.siyuan.password":"思源Token","setting.blog.siyuan.password.tip":"思源笔记鉴权Token，请从【设置->关于】复制，如果是本地笔记留空即可","slogan.make.written.fun":"让创作回归乐趣","category.batch.not.supported":"注意：批量分发模式部分平台不支持公共分类，例如语雀、知乎等","yuque.edit.cate.no.change":"由于语雀平台的限制，暂时不支持编辑所属知识库。如果您想移动文档，请先点击取消删除该文档，然后重新选择新的知识库发布","main.commonn.cate.title":"公共分类","main.cate.new":"新增分类","pref.setting.aicode":"ChatGPT请求key","pref.setting.aicode.tip":"ChatGPT请求key或者第三方代理key，如果是代理key，请设置请求地址","pref.setting.ai.baseurl":"ChatGPT请求地址","pref.setting.ai.baseurl.tip":"ChatGPT请求地址，如果是ChatGPT官方，可留空","preference.setting.removeWidgetTag":"去除挂件HTML","pref.setting.ai.proxy.url":"ChatGPT代理地址","pref.setting.ai.proxy.url.tip":"可留空，注意：填写了代理会忽略ChatGPT请求地址","main.auto.fetch.title":"自动提取标题","main.auto.fetch.cate":"自动提取分类","category.ai.hand":"由于各平台分类体系不一致，分类需要手动进行校准，不会自动保存","category.ai.enabled":"检测到您已经配置AI，可请前往详细模式进行操作","sys.config.ai":"AI设置","config.ai.use.siyuan":"思源笔记内部，直接使用思源笔记配置，无需配置","setting.blog.yamlLinkEnabled":"YAML永久链接","distri.type.overide.warn":"注意：覆盖模式下会用当前数据覆盖所有选择的平台，请谨慎操作。","distri.type.merge.warn":"注意：为了保留平台数据，合并模式下，标题和摘要的修改无效，您可在在常规发布单独修改对应平台的标题和摘要，标签和分类会与所选择的平台数据合并。","preference.setting.keepTitle":"不更新原始标题","setting.blog.gitlab.url.tip":"Gitlab首页，例如：http://localhost:8002","setting.blog.type.gitlab.user.tip":"Gitlab的用户名","setting.blog.type.gitlab.token.tip":"Gitlab的token，请参考下面链接设置，并保证有api权限","setting.blog.gitlab.apiurl.tip":"Gitlab的API地址，一般与首页相同","setting.blog.gitlab.previewUrl.tip":"文章预览地址，一般默认即可","main.force.cancel":"强制删除"},Jd={"lang.choose":"Choose lang","lang.choose.placeholder":"Please select language","theme.mode.choose":"Mode","theme.mode.dark":"Dark mode","theme.mode.light":"Light mode","service.tab.publish.service":"Publish service","service.tab.publish.setting":"Publish setting","service.tab.platform.setting":"Platform setting","service.tab.post.bind":"Post bind","service.tab.service.switch":"Service switch","service.tab.change.local":"Change language","main.publish.editmode":"Edit mode","main.publish.editmode.simple":"Simple","main.publish.editmode.complex":"Complex","main.publish.editmode.source":"Source","main.publish.vuepress.tip":"Recommends use it with vuepress-theme-vdoing , and the subsequent bug will only update this theme","main.publish.github.error.tip":"Configure error or API is not available, please check. If you modify the configuration, please refresh the page","main.publish.github":"Send Github","main.publish.github.tip":"Checking the Markdown text of the article to the GitHub warehouse corresponding to Vuepress (need to perform related configuration first, unsatisfactory or configuration error will be ignored)","main.publish.github.choose.path":"Choose path","main.publish.github.published.path":"Published path","main.publish.github.choose.path.use.default":"Default path","main.publish.github.choose.path.use.default.tip":"Using the default directory, all articles are published in the configuration default directory, no need to select the directory every time it is published","main.publish.github.no.tip":"You have not opened github release, please copy the right text on your own","main.publish.github.choose.title":"File name","main.publish.github.choose.title.tip":"Vuepress-theme-VDoing support file name plus serial number to identify. If you don’t know this usage, please do not modify the file name","main.publish.see.preview":"Click here see new post","main.publish.see.md.preview":"Click here see new md file","main.publish.see.real.preview":"Click here see new post","main.publish.to.wordpress":"Send to WP","main.title":"Post title","main.slug":"Post slug","main.auto.fetch.slug":"Auto fetch slug","main.use.google.translate":"Use Google translate API","main.use.hash":"Use hash","main.use.hash.tip":"Do not use HASH to show more meaningful URLs, but it may cause the only path of the article to repeat (the consequence is that Vuepress will build a failure unless manual solution to the other problem), please know","main.force.refresh":"Force refresh","main.force.refresh.tip":"In order to prevent the wrongdoing aliases by mistake, the attribute will not be updated by default. If you need to update, please check for compulsory refresh.","main.desc":"Post desc","main.auto.fetch.desc":"Auto fetch desc","main.create.time":"Pub time","main.update.time":"Update time","main.create.time.placeholder":"Please select time","main.update.time.placeholder":"Please select time","main.tag":"Post tag","main.tag.new":"New tag","main.auto.fetch.tag":"Auto fetch tag","main.tag.auto.switch":"Tag switch","main.tag.auto.switch.no.tip":"Auto tag is closed","main.cat":"Category","main.cat.empty":"No Category","main.cat.select":"Please select category","main.yaml.formatter":"YAML Formatter","main.siyuan.to.yaml":"Siyuan attr to YAML","main.yaml.to.siyuan":"YAML to Siyuan attr","main.save.attr.to.siyuan":"Save attr to Siyuan","main.copy":"Copy","main.publish":"Publish","main.publish.loading":"Publishing...","main.loading":"Loading...","main.update":"Update","main.cancel":"Cancel","main.publish.oneclick.attr":"Click to attr","main.publish.oneclick.attr.finish":"Make attr finished","main.publish.status.unpublish":"Unpublish","main.publish.status.published":"Published","main.publish.to.vuepress":"Send to Vuepress","main.publish.to.hugo":"Send to Hugo","main.publish.to.hexo":"Send to Hexo","main.publish.to.jekyll":"Send to Jekyll","main.publish.to.jvue":"Send to JVue","main.publish.to.conf":"Send to Confluence","main.publish.to.cnblogs":"Send to Cnblogs","main.publish.to.liandi":"Send to Liandi","main.publish.to.yuque":"Send to Yuque","main.publish.to.kms":"Send to KMS","main.opt.success":"Success","main.opt.failure":"Error","main.copy.success":"Copy Success","main.copy.failure":"Copy Error","main.opt.quick":"Quick","main.opt.status.publish":"Post published success","main.opt.status.cancel":"Post publishing has been canceled","main.opt.loading":"Loading...","main.opt.warning":"Warning","main.opt.ok":"Confirm","main.opt.cancel":"Cancel","main.opt.select":"Select","main.opt.warning.tip":"The operation will delete the data, whether to continue?","main.opt.tip":"Tips","setting.noneed":"No need setting","setting.blog.setting":" Setting","setting.blog.index":"System setting","setting.blog.type":"Blog type","setting.blog.type.placeholder":"Please select type","setting.blog.type.wordpress.value":"Wordpress","setting.blog.type.wordpress.label":"Wordpress","setting.blog.type.metaweblog.value":"MetaweblogApi","setting.blog.type.metaweblog.label":"Metaweblog API","setting.blog.type.github.value":"Github","setting.blog.type.github.label":"Github","setting.blog.type.github.user":"Github user","setting.blog.type.github.user.tip":"Github user, eg:terwer","setting.blog.type.github.repo":"Github repo","setting.blog.type.github.repo.tip":"Github repo, eg:hexo-blog","setting.blog.type.github.token":"Github token","setting.blog.type.github.token.tip":"Github token, eg:ghp_XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX","setting.blog.type.github.token.gen":"Generate Github Personal Token","setting.blog.type.github.default.path":"Doc path","setting.blog.type.github.default.path.tip":"Doc path, eg:docs/_posts","setting.blog.type.github.msg":"Commit msg","setting.blog.type.github.msg.tip":"Commit msg, eg:auto published by sy-post-publisher","setting.blog.type.github.author":"Author","setting.blog.type.github.author.tip":"Author, eg:terwer","setting.blog.type.github.email":"Email","setting.blog.type.github.email.tip":"Email","setting.blog.url":"Blog addr","setting.blog.github.url.tip":"Github homepage address","setting.blog.github.apiurl.tip":"Github's REST API address, typically: https://api.github.com","setting.blog.previewPostUrl":"Preview rule","setting.blog.previewPostUrl.tip":"Preview Rules (place occupied: [yyyy] [mm] [dd] [postid]), for example:/post/[postid].html or /[cats]/[yyyy]/[mm]/[dd]/[[dd]/[postid].html","setting.blog.previewUrl":"MD preview rule","setting.blog.previewUrl.tip":"MD file preview rules (place occupied: [user] [repo] [Branch] [docpath]), for example:/[user]/[repo]/blob/[branch]/[docpath]","setting.blog.mdFilenameRule":"File rule","setting.blog.mdFilenameRule.tip":"Markdown File Name Rules (Plasma: [yyyy] [MM] [dd] [slug] [filename]), for example: [filename].md or [yyyy]-[MM]-[dd]-[slug].md","setting.blog.username":"Username","setting.blog.password":"Password","setting.blog.apiurl":"API Url","setting.blog.pageType":"Page Type","setting.blog.validate":"Validate","setting.blog.save":"Save","setting.blog.vali":"Validate","setting.blog.vali.tip":"Please verify the configuration to ensure the availability of the API, and it will not be used without verification.","setting.blog.vali.tip.metaweblog":"Please verify the configuration to ensure the availability of the API, and it will not be used without verification.","setting.blog.vali.ing":"Validating...","setting.blog.vali.ok":"Available","setting.blog.vali.ok.metaweblog":"The configuration has been saved and verified","setting.blog.vali.error":"Validate error","setting.blog.platform.support.github":"Current github supported platform:","setting.blog.platform.support.metaweblog":"Current metaweblog supported platform:","setting.blog.cancel":"Cancel","setting.vuepress":"Vuepress","setting.hugo":"Hugo","setting.hexo":"Hexo","setting.jekyll":"Jekyll","setting.jvue":"JVue","setting.conf":"Confluence","setting.conf.tip":"Published to Confluence needs to cooperate with my other adapter project (strong recommendation), please refer to:https://github.com/terwer/node-metaweblog-api-adaptor","setting.cnblogs":"Cnblogs","setting.wordpress":"Wordpress","setting.liandi":"Liandi","setting.yuque":"Yuque","setting.kms":"KMS","setting.other1":"Other1","service.switch.vuepress":"Vuepress","service.switch.hugo":"Hugo","service.switch.hexo":"Hexo","service.switch.jekyll":"Jekyll","service.switch.jvue":"JVue","service.switch.conf":"Confluence","service.switch.cnblogs":"Cnblogs","service.switch.wordpress":"Wordpress","service.switch.yuque":"Yuque","service.switch.liandi":"Liandi","service.switch.wechat":"WeChat","service.switch.wemp":"WeMedia","service.switch.zhihu":"Zhihu","service.switch.kms":"LandrayKms","service.switch.must.select.one":"You must add at least one platform","post.bind.vuepress.slug":"Vuepress slug","post.bind.hugo.slug":"Hugo slug","post.bind.hexo.slug":"Hexo slug","post.bind.jekyll.slug":"Jekyll slug","post.bind.cnblogs.postid":"Cnblogs ID","post.bind.jvue.postid":"JVue ID","post.bind.conf.postid":"Conf ID","post.bind.wordpress.postid":"WP ID","post.bind.liandi.postid":"Liandi ID","post.bind.yuque.postid":"Yuque ID","post.bind.kms.postid":"KMS ID","post.bind.conf.save":"Save","post.bind.conf.cancel":"Cancel","form.validate.name.required":"Please input name","form.validate.name.length":"Length should be 0 to 1","form.validate.github.auto.delete":"Auto delete","dynamic.platform.new":"New platform","dynamic.platform.tip":"If the built -in release service cannot be satisfied or multiple instances need to be added, you can add supporting platforms here. Currently supporting Metaweblog API and WordPress API","dynamic.platform.type":"Platform type","dynamic.platform.subtype":"Platform subtype","dynamic.platform.type.metaweblog":"metaweblog API","dynamic.platform.type.wordpress":"Wordpress","dynamic.platform.type.common":"Common","dynamic.platform.type.custom":"Custom","dynamic.platform.key":"Platform key","dynamic.platform.key.tip":"The unique logo of the platform, cannot be repeated, for example: myblog","dynamic.platform.type.github":"Github","dynamic.platform.name":"Platform name","dynamic.platform.name.tip":"Platform name, for example: my blog","dynamic.platform.opt.add":"Submit","dynamic.platform.opt.noselect":"Please select platform type","dynamic.platform.opt.key.exist":"Platform key exists","dynamic.platform.opt.del.select":"Delete","dynamic.platform.opt.del.confirm":"Deleting this platform will completely remove the relevant configuration information of this platform. Do you continue?","dynamic.platform.opt.item.select":"Item no select","dynamic.platform.opt.item.select.tip":"The current selection is:","dynamic.platform.opt.item.no.select.tip":"Please select the line to be deleted","setting.common.home":"Home","setting.common.tip":"The platform homepage is used to preview articles, for example: https://terwork.space","setting.common.apiurl":"API","setting.common.token":"Token","setting.common.token.gen":"Token addr","setting.common.username":"Username","setting.common.username.gen":"Username setting","setting.common.password":"Password","setting.blog.platform.support.common":"Current platform：","platform.must.select.one":"You must enable at least one platform","blog.list.toptip":"Reminder: Click the table line to enter the article details page. The details page has the release button! (〃'▽'〃)","config.error.msg":"Network or config error, no data fetched","config.platform.none":"No available platform, please go to switch","post.delete.by.platform":"The article has been deleted by the platform by itself, please click to cancel the compulsory lifting connection","blog.top-data-tip":"Reminder: Please ensure that the Siyuan notes are started and opened the servo. The default servo address: http://127.0.0.0.1: 6806.0.0. Note: The modification will cover the value of the startup setting.","blog.top-data-tip.siyuan":"It is currently in the pendant mode. Starting from version 0.1.0, there is no need to reference the pendant on all pages. You only need to reference a pendant on the parent page. The specific rules are as follows: 1. If there are no subsidiaries, it will be compatible with the previous method of version 0.0.3 to display the release page of the current document. 2. If a subsidiary document is detected, all the subsidiaries will be displayed in a list and paging. You can choose a sub -document separately for release operations.","blog.newwin.open":"Open in a new window","blog.change.siyuan.api":"Modify Siyuan API address","setting.blog.siyuan.current.apiurl":"Current apiUrl=>","setting.conf.export":"Export config","setting.conf.import":"Import config","setting.conf.transport":"Transport","setting.conf.clear":"Clear config","page.no.id":"pageId fetch error","main.read.mode":"Readonly","main.edit.mode":"Editable","main.read.mode.tip1":"Tips: The multi-platform distribution mode will display the built-in public YAML, and the general release can display the platform's custom YAML.","main.read.mode.tip2":"To identify the uniqueness of the article, slug modifications are ignored and other attributes can be synchronized.","main.read.mode.tip3":"！！！ This feature is advanced, if you are unclear about the YAML syntax and purpose, do not modify it!!","main.opt.onclick.confirm.tip":"This operation will re -generate all attributes other than alias. If you just want to modify individual attributes, please click the individual function button to operate in the detailed mode. Do you continue?","main.cat.list.error":"Category list get error","main.yaml.no.save":"Have you edited YAML, do you synchronize to attributes, and cancel the loss of YAML modification?","setting.github.baseUrl":"Git repo index","setting.github.baseUrl.tip":"Git platform address is used for md file preview, the default is: https://github.com","preference.setting.fixTitle":"Fix title","preference.setting.removeH1":"Remove h1","preference.setting.removeH1.tip":"Delete H1 may accidentally delete the beginning of the beginning of Markdown. If you need to open it, please use more than 2 ones.","preference.setting.newWin":"New win","siyuan.browser.show.close.btn":"Show close btn","siyuan.browser.menu.quick.btn":"Quick publish","siyuan.browser.menu.publish.btn":"Publish","siyuan.browser.menu.preview.btn":"Preview","siyuan.browser.menu.manage.btn":"Manage","siyuan.browser.menu.anki.btn":"Anki","siyuan.browser.menu.picture.btn":"PicGO","siyuan.browser.menu.setting.btn":"Setting","anki.siyuan.deck":"Deck","anki.siyuan.deck.new":"New deck","anki.siyuan.tag":"Tag","anki.siyuan.tag.new":"New tag","picgo.chrome.tip":"If you are using a browser plug -in, you need to download the configuration Picgo client from here: https://github.com/Molunerfinn/PicGo/releases","picgo.siyuan.tip":"If you are using Siyuan notes pendants, you need to configure your own integration of PICGO. The pendant version of the PICGO configuration file is:`[Siyuan Workspace]/data/widgets/sy-post-publisher/lib/picgo/picgo.cfg.json`，Please refer to the official picgo document for configuration：https://picgo.github.io/PicGo-Core-Doc/zh/guide/config.html#%E6%89%8B%E5%8A%A8%E7%94%9F%E6%88%90","post.detail.button.copy.id":"Copy post ID","post.detail.button.share.link":"Copy share link","post.detail.button.browser.open":"Open with default browser","post.detail.button.pic.manage":"Picture manage","post.detail.button.anki.mark":"Anki mark","post.detail.index.send.to.publish":"Send to other platform","post.detail.index.export.to.pdf":"Export to PDF","picgo.upload.status":"Upload status","picgo.upload.select.pic":"Select picture","picgo.upload.clipboard":"Clipboard picture","picgo.upload.onclick":"One click upload","picgo.download.onclick":"One click download","picgo.download.local.to.bed":"Upload picture to bed","picgo.download.bed.to.local":"Upload picture from bed","picgo.pic.preview":"Picture preview","picgo.pic.setting":"Picture setting","picgo.pic.setting.no.tip":"You are currently using the browser plug -in and cannot inherit PicGo. You can only call the local Picgo client on the local Picgo client through HTTP","github.use.permalink":"Use permalink","github.use.permalink.no.warn":"You have closed the permanent link, and Formatter will not generate a mark, which may be useful in some scenarios","github.menu.title":"Menu title","github.menu.title.placeholder":"The menu column title (HUGO platform is dedicated, but the empty is not displayed in the menu)","github.weight":"Weight","github.weight.placeholder":"Weight (decide to display the order, the smaller the display, the more upward)","github.use.date":"Show date","github.use.date.no.warn":"You have closed the date show that it will not generate the date field in Formatter","github.post.picgo.use":"Use picbed","github.post.picgo.use.tip":"To enable this option, the local picture will be uploaded to the custom diagram bed (the remote picture is not uploaded), please make sure that the PICGO diagram bed configuration is correct","github.post.picgo.start.upload":"The picture bed has been opened, and the picture bed is about to upload the picture bed to the bed","github.post.picgo.picbed.error":"The picture uploaded to the picture bed failed, it may be an error in the configuration of the graph, please check the picture bed configuration","setting.yuque.home.tip":"The homepage of the language bird platform is usually fixed: https://www.yuque.com/","setting.yuque.username.tip":"The user name of the spark platform, note that the user name is fixed in [account settings], not the user nickname (*^▽^*)","setting.yuque.password.tip":"For the token of the spark platform, please follow the link to get it. You only need to grant the document to read and modify the two permissions.","setting.yuque.apiurl.tip":"The API address of the language bird platform is usually fixed: https://www.yuque.com/api/v2","setting.yuque.previewUrl.tip":"Article preview rules for the Yuque platform, Usually: /[notebook]/[postid]","setting.notion.home.tip":"The homepage of the Notion platform is usually fixed: https://www.notion.so/","setting.notion.password.tip":"For the token of the Notion platform, please click the link to get it, you need to check the three permissions of [Read content], [Update content], and [Insert content].","setting.notion.apiurl.tip":"The API address of the Notion platform is usually fixed: https://api.notion.com/v1","setting.notion.previewUrl.tip":"Article preview rules for the Notion platform, usually:/[postid]","setting.liandi.home.tip":"The homepage of the chain drop platform is usually fixed: https://ld246.com/","setting.liandi.username.tip":"The user name of the chain drop platform, note that after clicking [Personal Homepage], the user name displayed behind the MEMBER on the URL is not a user nickname (*^▽^*)","setting.liandi.password.tip":"Token on the chain drop platform, please click on the link to get","setting.liandi.apiurl.tip":"The API address of the chain drop platform is usually fixed: https://ld246.com/api/v2","setting.kms.home.tip":"KMS platform homepage, for example: http:// localhost: 9564/kms16_release/kms/multidoc","setting.kms.username.tip":"KMS platform REST account user name, please create according to the link instruction","setting.kms.password.tip":"KMS platform REST account password, please create according to the link instruction","setting.kms.apiurl.tip":"The API address of the KMS platform, for example: http:// localhost: 9564/kms16_release/API/KMS-Multidoc/KMSMultidOWRESTSERVICE","siyuan.local.share.tip":"Reminder: If you find that the sharing link or the browser can be displayed or the network connection is rejected, please check according to the following operation. 1: Siyuan Note-> Settings-> About-> Open the network servo; 2: After the browser is opened, click the bottom Siyuan address at the bottom to modify the corresponding address to the local area network IP address.","setting.cnblogs.home.tip":"The homepage of your blog park is usually: https://www.cnblogs.com/ <your username>","setting.cnblogs.username.tip":"Your blog garden MetaWeblog login name, you can go to your blog garden background-> Settings, note: login name, not a user nickname (*^▽^*)","setting.cnblogs.password.tip":"Your blog garden Metaweblog access token, you can go to your blog garden backstage-> Settings","setting.cnblogs.apiUrl.tip":"Your blog garden Metaweblog access address, you can go to your blog park background-> settings, usually: https://rpc.cnblogs.com/metaweblog/ <Your username>","setting.cnblogs.previewUrl.tip":"Preview rules for your blog garden article","setting.wordpress.home.tip":"Wordpress homepage","setting.wordpress.username.tip":"WordPress login name, note: it is login name, not a user nickname (*^▽^*)","setting.wordpress.password.tip":"Wordpress login password","setting.wordpress.apiUrl.tip":"WordPress's XMLRPC remote release address, usually: https:// <WordPress blog address> /xmlrpc.php","setting.wordpress.previewUrl.tip":"The preview rules of the WordPress platform are usually :? P = [Postid]","setting.oschina.home.tip":"Homepage of open source China, usually: https://my.oschina.net/ <Your username>","setting.oschina.username.tip":"Open source China login name, you can enter the login mailbox","setting.oschina.password.tip":"Open source China login password","setting.oschina.apiUrl.tip":"Open source China XMLRPC remote publishing address, usually fixed: https://www.oschina.net/ACTION/xmlrpc","setting.oschina.previewUrl.tip":"The preview rules of the open source China platform are usually:/blog/[postid]","setting.typecho.home.tip":"Homepage of the Typecho platform","setting.typecho.username.tip":"Typecho platform login name","setting.typecho.password.tip":"Typecho platform password","setting.typecho.apiUrl.tip":"The XMLRPC remote publishing address of the Typecho platform is usually fixed: https: // <platform address> /index.php/xmlrpc","setting.typecho.previewUrl.tip":"The preview rules of the Typecho platform are usually: /index.php/archives/ [Postid]","setting.metaweblog.home.tip":"The homepage of the Metaweblog platform","setting.metaweblog.username.tip":"Metaweblog platform login","setting.metaweblog.password.tip":"Metaweblog platform password","setting.metaweblog.apiUrl.tip":"The xmlrpc remote publishing address for the Metaweblog platform","setting.metaweblog.previewUrl.tip":"Article preview rules for the Metaweblog platform, [postid] can be composed article ID placeholder","setting.jvue.home.tip":"Homepage of the Jvue platform","setting.jvue.username.tip":"Jvue platform login name","setting.jvue.password.tip":"Jvue platform password","setting.jvue.apiUrl.tip":"The XMLRPC remote release address of the JVUE platform is usually fixed: https: // <platform address>/xmlrpc","setting.jvue.previewUrl.tip":"The preview rules of the Jvue platform are usually:/post/[postid] .html","setting.conf.home.tip":"Confluence Cloud, homepage, usually: https: // <your user name> .atlassian.net/wiki/spaces/<Space name>","setting.conf.username.tip":"CONFLUENCE login name, you can go to your Atlassian account to get","setting.conf.password.tip":"Confluence access token, you can go to your Atlassian account to get","setting.conf.apiUrl.tip":"You can go to https://developper.atlassian.com/Cloud/confluence/rest/v1/1/1/","setting.conf.previewUrl.tip":"CONFLUENCE platform articles preview rules, usually:/pages/[postid]","setting.zhihu.home.tip":"The address of the front page of the column, usually fixed","setting.zhihu.username.tip":"Zhihu username, must be set correctly, otherwise you cannot get the column","setting.zhihu.password.tip":"Know cookies, please do not modify them","setting.zhihu.apiUrl.tip":"Usually fixed, do not modify","setting.zhihu.previewUrl.tip":"Zhihu platform article preview rules, usually: //[postid]","setting.csdn.home.tip":"CSDN blog homepage address, usually fixed","setting.csdn.password.tip":"CSDN cookies, do not modify","setting.csdn.apiUrl.tip":"Usually fixed, do not modify","setting.csdn.previewUrl.tip":"CSDN Platform Article Preview Rules","setting.wechat.home.tip":"The address of the home page of the WeChat public account is usually fixed","setting.wechat.password.tip":"Please do not modify the cookies of WeChat official account","setting.wechat.apiUrl.tip":"Usually fixed, do not modify","setting.wechat.previewUrl.tip":"WeChat official account platform article preview rules","setting.jianshu.home.tip":"Jianshu homepage address, usually fixed","setting.jianshu.password.tip":"Jianshu's Cookie, do not modify","setting.jianshu.apiUrl.tip":"Usually fixed, do not modify","setting.jianshu.previewUrl.tip":"Jianshu platform article preview rules","setting.juejin.home.tip":"Juejin homepage address, usually fixed","setting.juejin.password.tip":"Juejin's Cookie, do not modify","setting.juejin.apiUrl.tip":"Usually fixed, do not modify","setting.juejin.previewUrl.tip":"Juejin platform article preview rules","setting.halo.home.tip":"Halo homepage address, should include the domain and port, for example: http://localhost:8090","setting.halo.username.tip":"Halo blog login name","setting.halo.password.tip":"Halo blog login password","setting.halo.apiUrl.tip":"Halo blog API address, typically the same as the Halo homepage","setting.halo.previewUrl.tip":"Halo blog article preview rule, default /archives/{slug}, with placeholders {slug} {name} {year} {month} {day}, can be set in [halo-home-url]/console/settings?tab=routeRules","setting.picgo.refer.to":"For details, please refer to:","setting.picgo.refer.to.online.doc":"Picgo configuration online documentation","setting.picgo.picbed":"Picbed setting","setting.picgo.picgo":"PicGO setting","main.opt.edit":"Edit","main.opt.delete":"Delete","setting.picgo.picgo.open.config.file":"Open config file","setting.picgo.picgo.click.to.open":"Click open","setting.picgo.picgo.choose.showed.picbed":"Please select showed picbed","setting.picgo.picbed.selected.tip":"Selected","setting.picgo.picbed.unselected.tip":"Unselected","setting.picgo.picbed.set.default":"Set as default picbed","setting.picgo.picbed.current.selected.tip":"Current selected picbed is:","setting.picgo.picbed.current.tip":"Current picbed is:","setting.picgo.picbed.uploader.config.name":"Picbed config name","setting.picgo.picbed.uploader.config.name.placeholder":"Please input config name","setting.picgo.config.name":"Config name","setting.picgo.config.name.placeholder":"Please input config name","setting.picgo.index.tip":"Note: The image uploaded here will not be automatically inserted into the document. Please manually click the copy button to copy the link, and then Ctrl+V to paste it into the document. This picture list only shows the pictures contained in this document.","setting.picgo.index.copy.link":"Copy link","setting.picgo.setting.timestamp.rename":"Timestamp rename","setting.picgo.setting.close":"Close","setting.picgo.setting.open":"Open","setting.picgo.setting.log.file":"Log file","setting.picgo.plugin":"Plugin setting","setting.picgo.plugin.list":"Plugin list","setting.picgo.plugin.import.local":"Import local plugin","setting.picgo.plugin.install":"Install","setting.picgo.plugin.installing":"Installing","setting.picgo.plugin.installed":"Installed","setting.picgo.plugin.doing.something":"Loading","setting.picgo.plugin.search.placeholder":"Search the picgo plug -in on NPM, or click the button above to view the excellent plug -in list","setting.picgo.plugin.gui.not.implemented":"This plug -in does not optimize the visual interface, is it continued to be installed?","setting.picgo.setting.node.path":"Node install path","setting.picgo.setting.node.path.tip":"Please enter Node to install the full path, for example: /opt/node-v16.14.0-darwin-x64/bin, node version> = 16","setting.picgo.setting.node.registry":"NPM registry","setting.picgo.setting.node.registry.tip":"Mainland recommend：https://registry.npmmirror.com","setting.picgo.setting.node.proxy":"NPM proxy","setting.picgo.setting.node.proxy.tip":"Generally, you can leave empty. If you have special needs, you can set a custom agent","setting.picgo.setting.config.tip":"Note: The attributes above the horizontal line will change the behavior of uploading pictures, and the configuration can be stored automatically. The attribute below the horizontal line is only used when installing the plug -in, and you need to click the [Confirm] button to save.","setting.picgo.plugin.install.success":"The plug -in has been successfully installed, please clear the search keyword refresh list. Click the plug -in corresponding [Settings] icon to view the plug -in details and customize the plug -in","syp.about":"About me","setting.picgo.plugin.uninstall":"Uninstall plugin","setting.picgo.plugin.uninstall.success":"Plugin is uninstalled successfully","setting.picgo.plugin.enable":"Enable plugin","setting.picgo.plugin.disable":"Disable plugin","setting.picgo.plugin.update":"Update plugin","setting.picgo.plugin.config.setting":"Plugin setting","setting.picgo.plugin.work":"Work","setting.picgo.plugin.nowork":"Nowork","setting.picgo.plugin.nouse":"Nouse","setting.picgo.plugin.update.success":"Update success","setting.conf.import.syp":"Import pendant configuration","setting.conf.import.picgo":"Import picgo configuration","setting.conf.export.syp":"Export pendant configuration","setting.conf.export.picgo":"Export picgo configuration","setting.conf.import.syp.tip":"Please select effective historical backup JSON files for import. Note: The pendant configuration will be replaced.","setting.conf.import.picgo.tip":"Please select effective historical backup JSON files for import. Note: PICGO configuration will be replaced directly. For the compatibility of configuration, please uninstall all plug -in and perform the picgo configuration export operation. Uninstall the PICGO plugin will not delete the plug -in configuration, only the plug -in file and the plug -in registration record will be deleted. Please rest assured.","setting.conf.export.syp.tip":"The corresponding JSON configuration file will be exported, and configuration backups are strongly recommended. In principle, support is compatible. If there is any compatibility problem, it will be specifically explained.","setting.conf.export.picgo.tip":"The corresponding JSON configuration file will be exported, and configuration backups are strongly recommended. In principle, support is compatible. If there is any compatibility problem, it will be specifically explained.","setting.conf.clear.syp":"Clear pendant configuration","setting.conf.clear.picgo":"Clear picgo configuration","setting.conf.clear.tip":"Clear configuration cannot be restored, please do it carefully. It is strongly recommended to backup configuration first.","setting.conf.clear.picgo.tip":"Clear configuration cannot be restored, please do it carefully. It is strongly recommended to backup configuration first. This operation will delete PicGo -related configuration folders, including configuration, plug -in, cache, etc. It is used only when picgo is completely unavailable, otherwise the consequences of the loss of configuration will be at your own risk!","setting.main.background":"Widget background","setting.main.background.tip":"Support hexadecimal and RGB, for example: #000000, no settings or staying empty unchanged","setting.platform.gitlab":"Gitlab","setting.platform.gitlab.desc":"Gitlab is basically similar to Github, except that Gitlab supports its own on-premises or cloud server deployment","setting.picgo.manage":"Picture manage","setting.platform.add":"Add platform","setting.platform.add.this":"Add this platform","setting.platform.universal":"Universal platform","setting.platform.universal.desc":"Currently supported general platforms include Zhihu, Yuque, CSDN, etc. Click the icon to quickly add, or click the button below to customize and add","setting.platform.wordpress":"WordPress","setting.platform.wordpress.desc":"WordPress is a free and open source blog software and Content management system based on PHP and MySQL. WordPress has a plugin architecture and template system. As of April 2018, over 30.6% of the top 10 million websites used WordPress. WordPress is the most popular website Content management system. Approximately 40% of global websites (7500 million) are built using WordPress. WordPress is currently the most popular blog system on the Internet. WordPress stands out in the most famous stage of online publishing. Today, it is used on over 70 million sites.","setting.platform.github":"Github","setting.platform.github.desc":"At present, the platforms that support Github release are: Hexo, Hugo, Jekyll, Vitepress, etc., using API authorization. GitHub is a platform and cloud-based service that uses Git for software development and version control, allowing developers to store and manage their code.","setting.platform.metaweblog":"Metaweblog","setting.platform.metaweblog.desc":"At present, the platforms that support Metaweblog are: Blog Park, Typecho, etc., using API authorization. The MetaWeblog API is an application programming interface created by software developer Dave Winer that allows writing, editing, and deletion using Web services. The API is implemented as an XML-RPC Web service with three methods whose names describe its functionality: metaweblog.newPost(), metaweblog.getPost(), and metaweblog.editPost(). These methods take parameters that specify the username and password of the blogger and information related to a single blog entry.","setting.platform.custom":"Customization","setting.platform.custom.desc":"Customize the HTTP protocol, stay tuned","setting.platform.right.tips0":"Special Notes:","setting.platform.right.tips1":"1. You can publish the configuration here, and you can directly click the menu or the following icons to configure it.","setting.platform.right.tips2":"2. If you need to add a new platform, click the left button directly.","setting.platform.right.tips3":"3. At present, we support webpage authorization and API authorization. The complex points of API authorization are relatively stable. The webpage authorization is simple but may fail. Surprise: Webpage authorization mode 100 compatible","setting.platform.right.tips4":"4. If you need to be compatible with other platforms, please contact me","setting.entry.title":"Platform Unified Settings - ","setting.entry.not.supported":"Unsupported platforms","setting.upgrade.syp.tip1":"Ready to start migration ...","setting.upgrade.syp.tip2":"Migration successfully.","setting.upgrade.syp.tip3":"It is already the latest, no need to migrate.","setting.upgrade.syp.tip4":"Migration failed, the error is as follows","setting.upgrade.syp.tip5":"The migration operation is completed.","setting.upgrade.syp.doTip1":"Detect whether the configuration file is the latest version","setting.upgrade.syp.doTip2":"Detected old configuration, preparation to upgrade the configuration file","setting.upgrade.syp.doTip3":"Old configuration upgraded","setting.upgrade.syp.doTip4":"No update for version, skip upgrade","main.publish.start":"Start syncing","main.publish.remove":"Remove","setting.blog.knowledge.space":"Knowledge space/Knowledge base","main.data.empty":"No data","knowledgeSpaceEnabled.Tips":"After validation, a list of available knowledge spaces is listed, and you can modify the default knowledge spaces as needed and save them","post.bind.auto.tips":"The ID here is automatically saved by the publishing tool, if you are not clear about the principle, please do not modify it","siyuan.config.setting":"Source settings","setting.blog.siyuan.apiurl":"Siyuan API address","setting.blog.siyuan.apiurl.tip":"The API address of Siyuan Note, including ports, The default address of Siyuan API is: http://127.0.0.1;6806","setting.blog.siyuan.password":"Siyuan Token","setting.blog.siyuan.password.tip":"Siyuan Token, which is empty by default","slogan.make.written.fun":"Let creation return to fun","category.batch.not.supported":"Note: Some platforms in the bulk distribution mode do not support public classification, such as Yuque and Zhihu","yuque.edit.cate.no.change":"Due to the limitations of the Yuque platform, editing the knowledge base is not supported at the moment. If you want to move a document, click Undelete and then select the new knowledge base publication again","main.commonn.cate.title":"Public category","main.cate.new":"New category","pref.setting.aicode":"ChatGPT request key","pref.setting.aicode.tip":"ChatGPT request key or third-party proxy key, if it is a proxy key, please set the request address","pref.setting.ai.baseurl":"ChatGPT request address","pref.setting.ai.baseurl.tip":"The ChatGPT request address, if it is official ChatGPT, can be left blank","preference.setting.removeWidgetTag":"Remove the widget HTML","pref.setting.ai.proxy.url":"ChatGPT proxy address","pref.setting.ai.proxy.url.tip":"Can be left blank, note: Filling in the proxy will ignore the ChatGPT request address","main.auto.fetch.title":"Auto fetch title","main.auto.fetch.cate":"Auto fetch category","category.ai.hand":"Due to inconsistent classification systems across platforms, classifications need to be calibrated manually and are not automatically saved","category.ai.enabled":"AI is available, please go to the detailed mode to operate","sys.config.ai":"AI configuration","config.ai.use.siyuan":"Inside Siyuan notes, you can directly use Siyuan notes to configure, no configuration is required","setting.blog.yamlLinkEnabled":"YAML permalink","distri.type.overide.warn":"Note: Please use caution when overwriting the selected platform with the current data.","distri.type.merge.warn":"Note: In merge mode, the title and abstract changes are not valid, and the labels and categories are merged with the selected platform data.","preference.setting.keepTitle":"Do not update the original title","setting.blog.gitlab.url.tip":"GitLab homepage, e.g., http://localhost:8002","setting.blog.type.gitlab.user.tip":"Username for GitLab","setting.blog.type.gitlab.token.tip":"Token for GitLab, please refer to the link below for setup and ensure API permissions are granted","setting.blog.gitlab.apiurl.tip":"GitLab API address, usually the same as the homepage","setting.blog.gitlab.previewUrl.tip":"Article preview address, usually the default","main.force.cancel":"Force delete"},mo=Bi({legacy:!1,locale:"zh_CN",fallbackLocale:"en_US",messages:{zh_CN:qd,en_US:Jd}}),Xd=async r=>{const a=Ii(Ln);a.use(mo);const t=hn();a.use(t);const s=Wd();return a.use(s),{i18n:mo,router:s,app:a}};(async()=>{const r=B("main");(await Xd()).app.mount("#app"),r.info("vue app created")})();
