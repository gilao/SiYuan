/*!
 * MIT License
 *
 * Copyright (c) 2023 SiYuan 思源笔记
 *
 * Permission is hereby granted, free of charge, to any person obtaining a copy
 * of this software and associated documentation files (the "Software"), to deal
 * in the Software without restriction, including without limitation the rights
 * to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
 * copies of the Software, and to permit persons to whom the Software is
 * furnished to do so, subject to the following conditions:
 *
 * The above copyright notice and this permission notice shall be included in all
 * copies or substantial portions of the Software.
 *
 * THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
 * IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
 * FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
 * AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
 * LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
 * OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
 * SOFTWARE.
 *
 */(()=>{var ft={965:k=>{/*! Pickr 1.8.2 MIT | https://github.com/Simonwep/pickr */(function(C,L){k.exports=L()})(self,function(){return(()=>{"use strict";var C={d:(h,t)=>{for(var e in t)C.o(t,e)&&!C.o(h,e)&&Object.defineProperty(h,e,{enumerable:!0,get:t[e]})},o:(h,t)=>Object.prototype.hasOwnProperty.call(h,t),r:h=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(h,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(h,"__esModule",{value:!0})}},L={};C.d(L,{default:()=>T});var J={};function et(h,t,e,r,a={}){t instanceof HTMLCollection||t instanceof NodeList?t=Array.from(t):Array.isArray(t)||(t=[t]),Array.isArray(e)||(e=[e]);for(const o of t)for(const i of e)o[h](i,r,{capture:!1,...a});return Array.prototype.slice.call(arguments,1)}C.r(J),C.d(J,{adjustableInputNumbers:()=>K,createElementFromString:()=>I,createFromTemplate:()=>ot,eventPath:()=>rt,off:()=>R,on:()=>A,resolveElement:()=>U});const A=et.bind(null,"addEventListener"),R=et.bind(null,"removeEventListener");function I(h){const t=document.createElement("div");return t.innerHTML=h.trim(),t.firstElementChild}function ot(h){const t=(r,a)=>{const o=r.getAttribute(a);return r.removeAttribute(a),o},e=(r,a={})=>{const o=t(r,":obj"),i=t(r,":ref"),p=o?a[o]={}:a;i&&(a[i]=r);for(const u of Array.from(r.children)){const l=t(u,":arr"),m=e(u,l?{}:p);l&&(p[l]||(p[l]=[])).push(Object.keys(m).length?m:u)}return a};return e(I(h))}function rt(h){let t=h.path||h.composedPath&&h.composedPath();if(t)return t;let e=h.target.parentElement;for(t=[h.target,e];e=e.parentElement;)t.push(e);return t.push(document,window),t}function U(h){return h instanceof Element?h:typeof h=="string"?h.split(/>>/g).reduce((t,e,r,a)=>(t=t.querySelector(e),r<a.length-1?t.shadowRoot:t),document):null}function K(h,t=e=>e){function e(r){const a=[.001,.01,.1][Number(r.shiftKey||2*r.ctrlKey)]*(r.deltaY<0?1:-1);let o=0,i=h.selectionStart;h.value=h.value.replace(/[\d.]+/g,(p,u)=>u<=i&&u+p.length>=i?(i=u,t(Number(p),a,o)):(o++,p)),h.focus(),h.setSelectionRange(i,i),r.preventDefault(),h.dispatchEvent(new Event("input"))}A(h,"focus",()=>A(window,"wheel",e,{passive:!1})),A(h,"blur",()=>R(window,"wheel",e))}const{min:Z,max:pt,floor:G,round:ut}=Math;function Y(h,t,e){t/=100,e/=100;const r=G(h=h/360*6),a=h-r,o=e*(1-t),i=e*(1-a*t),p=e*(1-(1-a)*t),u=r%6;return[255*[e,i,o,o,p,e][u],255*[p,e,e,i,o,o][u],255*[o,o,p,e,e,i][u]]}function nt(h,t,e){const r=(2-(t/=100))*(e/=100)/2;return r!==0&&(t=r===1?0:r<.5?t*e/(2*r):t*e/(2-2*r)),[h,100*t,100*r]}function q(h,t,e){const r=Z(h/=255,t/=255,e/=255),a=pt(h,t,e),o=a-r;let i,p;if(o===0)i=p=0;else{p=o/a;const u=((a-h)/6+o/2)/o,l=((a-t)/6+o/2)/o,m=((a-e)/6+o/2)/o;h===a?i=m-l:t===a?i=.3333333333333333+u-m:e===a&&(i=.6666666666666666+l-u),i<0?i+=1:i>1&&(i-=1)}return[360*i,100*p,100*a]}function P(h,t,e,r){return t/=100,e/=100,[...q(255*(1-Z(1,(h/=100)*(1-(r/=100))+r)),255*(1-Z(1,t*(1-r)+r)),255*(1-Z(1,e*(1-r)+r)))]}function O(h,t,e){t/=100;const r=2*(t*=(e/=100)<.5?e:1-e)/(e+t)*100,a=100*(e+t);return[h,isNaN(r)?0:r,a]}function ht(h){return q(...h.match(/.{2}/g).map(t=>parseInt(t,16)))}function it(h){h=h.match(/^[a-zA-Z]+$/)?function(a){if(a.toLowerCase()==="black")return"#000";const o=document.createElement("canvas").getContext("2d");return o.fillStyle=a,o.fillStyle==="#000"?null:o.fillStyle}(h):h;const t={cmyk:/^cmyk[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)/i,rgba:/^((rgba)|rgb)[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)[\D]*?([\d.]+|$)/i,hsla:/^((hsla)|hsl)[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)[\D]*?([\d.]+|$)/i,hsva:/^((hsva)|hsv)[\D]+([\d.]+)[\D]+([\d.]+)[\D]+([\d.]+)[\D]*?([\d.]+|$)/i,hexa:/^#?(([\dA-Fa-f]{3,4})|([\dA-Fa-f]{6})|([\dA-Fa-f]{8}))$/i},e=a=>a.map(o=>/^(|\d+)\.\d+|\d+$/.test(o)?Number(o):void 0);let r;t:for(const a in t){if(!(r=t[a].exec(h)))continue;const o=i=>!!r[2]==(typeof i=="number");switch(a){case"cmyk":{const[,i,p,u,l]=e(r);if(i>100||p>100||u>100||l>100)break t;return{values:P(i,p,u,l),type:a}}case"rgba":{const[,,,i,p,u,l]=e(r);if(i>255||p>255||u>255||l<0||l>1||!o(l))break t;return{values:[...q(i,p,u),l],a:l,type:a}}case"hexa":{let[,i]=r;i.length!==4&&i.length!==3||(i=i.split("").map(l=>l+l).join(""));const p=i.substring(0,6);let u=i.substring(6);return u=u?parseInt(u,16)/255:void 0,{values:[...ht(p),u],a:u,type:a}}case"hsla":{const[,,,i,p,u,l]=e(r);if(i>360||p>100||u>100||l<0||l>1||!o(l))break t;return{values:[...O(i,p,u),l],a:l,type:a}}case"hsva":{const[,,,i,p,u,l]=e(r);if(i>360||p>100||u>100||l<0||l>1||!o(l))break t;return{values:[i,p,u,l],a:l,type:a}}}}return{values:null,type:null}}function X(h=0,t=0,e=0,r=1){const a=(i,p)=>(u=-1)=>p(~u?i.map(l=>Number(l.toFixed(u))):i),o={h,s:t,v:e,a:r,toHSVA(){const i=[o.h,o.s,o.v,o.a];return i.toString=a(i,p=>`hsva(${p[0]}, ${p[1]}%, ${p[2]}%, ${o.a})`),i},toHSLA(){const i=[...nt(o.h,o.s,o.v),o.a];return i.toString=a(i,p=>`hsla(${p[0]}, ${p[1]}%, ${p[2]}%, ${o.a})`),i},toRGBA(){const i=[...Y(o.h,o.s,o.v),o.a];return i.toString=a(i,p=>`rgba(${p[0]}, ${p[1]}, ${p[2]}, ${o.a})`),i},toCMYK(){const i=function(p,u,l){const m=Y(p,u,l),b=m[0]/255,_=m[1]/255,y=m[2]/255,x=Z(1-b,1-_,1-y);return[100*(x===1?0:(1-b-x)/(1-x)),100*(x===1?0:(1-_-x)/(1-x)),100*(x===1?0:(1-y-x)/(1-x)),100*x]}(o.h,o.s,o.v);return i.toString=a(i,p=>`cmyk(${p[0]}%, ${p[1]}%, ${p[2]}%, ${p[3]}%)`),i},toHEXA(){const i=function(u,l,m){return Y(u,l,m).map(b=>ut(b).toString(16).padStart(2,"0"))}(o.h,o.s,o.v),p=o.a>=1?"":Number((255*o.a).toFixed(0)).toString(16).toUpperCase().padStart(2,"0");return p&&i.push(p),i.toString=()=>`#${i.join("").toUpperCase()}`,i},clone:()=>X(o.h,o.s,o.v,o.a)};return o}const W=h=>Math.max(Math.min(h,1),0);function st(h){const t={options:Object.assign({lock:null,onchange:()=>0,onstop:()=>0},h),_keyboard(o){const{options:i}=t,{type:p,key:u}=o;if(document.activeElement===i.wrapper){const{lock:l}=t.options,m=u==="ArrowUp",b=u==="ArrowRight",_=u==="ArrowDown",y=u==="ArrowLeft";if(p==="keydown"&&(m||b||_||y)){let x=0,E=0;l==="v"?x=m||b?1:-1:l==="h"?x=m||b?-1:1:(E=m?-1:_?1:0,x=y?-1:b?1:0),t.update(W(t.cache.x+.01*x),W(t.cache.y+.01*E)),o.preventDefault()}else u.startsWith("Arrow")&&(t.options.onstop(),o.preventDefault())}},_tapstart(o){A(document,["mouseup","touchend","touchcancel"],t._tapstop),A(document,["mousemove","touchmove"],t._tapmove),o.cancelable&&o.preventDefault(),t._tapmove(o)},_tapmove(o){const{options:i,cache:p}=t,{lock:u,element:l,wrapper:m}=i,b=m.getBoundingClientRect();let _=0,y=0;if(o){const H=o&&o.touches&&o.touches[0];_=o?(H||o).clientX:0,y=o?(H||o).clientY:0,_<b.left?_=b.left:_>b.left+b.width&&(_=b.left+b.width),y<b.top?y=b.top:y>b.top+b.height&&(y=b.top+b.height),_-=b.left,y-=b.top}else p&&(_=p.x*b.width,y=p.y*b.height);u!=="h"&&(l.style.left=`calc(${_/b.width*100}% - ${l.offsetWidth/2}px)`),u!=="v"&&(l.style.top=`calc(${y/b.height*100}% - ${l.offsetHeight/2}px)`),t.cache={x:_/b.width,y:y/b.height};const x=W(_/b.width),E=W(y/b.height);switch(u){case"v":return i.onchange(x);case"h":return i.onchange(E);default:return i.onchange(x,E)}},_tapstop(){t.options.onstop(),R(document,["mouseup","touchend","touchcancel"],t._tapstop),R(document,["mousemove","touchmove"],t._tapmove)},trigger(){t._tapmove()},update(o=0,i=0){const{left:p,top:u,width:l,height:m}=t.options.wrapper.getBoundingClientRect();t.options.lock==="h"&&(i=o),t._tapmove({clientX:p+l*o,clientY:u+m*i})},destroy(){const{options:o,_tapstart:i,_keyboard:p}=t;R(document,["keydown","keyup"],p),R([o.wrapper,o.element],"mousedown",i),R([o.wrapper,o.element],"touchstart",i,{passive:!1})}},{options:e,_tapstart:r,_keyboard:a}=t;return A([e.wrapper,e.element],"mousedown",r),A([e.wrapper,e.element],"touchstart",r,{passive:!1}),A(document,["keydown","keyup"],a),t}function $(h={}){h=Object.assign({onchange:()=>0,className:"",elements:[]},h);const t=A(h.elements,"click",e=>{h.elements.forEach(r=>r.classList[e.target===r?"add":"remove"](h.className)),h.onchange(e),e.stopPropagation()});return{destroy:()=>R(...t)}}const Q={variantFlipOrder:{start:"sme",middle:"mse",end:"ems"},positionFlipOrder:{top:"tbrl",right:"rltb",bottom:"btrl",left:"lrbt"},position:"bottom",margin:8},tt=(h,t,e)=>{const{container:r,margin:a,position:o,variantFlipOrder:i,positionFlipOrder:p}={container:document.documentElement.getBoundingClientRect(),...Q,...e},{left:u,top:l}=t.style;t.style.left="0",t.style.top="0";const m=h.getBoundingClientRect(),b=t.getBoundingClientRect(),_={t:m.top-b.height-a,b:m.bottom+a,r:m.right+a,l:m.left-b.width-a},y={vs:m.left,vm:m.left+m.width/2+-b.width/2,ve:m.left+m.width-b.width,hs:m.top,hm:m.bottom-m.height/2-b.height/2,he:m.bottom-b.height},[x,E="middle"]=o.split("-"),H=p[x],c=i[E],{top:n,left:s,bottom:d,right:f}=r;for(const g of H){const v=g==="t"||g==="b",w=_[g],[S,M]=v?["top","left"]:["left","top"],[B,F]=v?[b.height,b.width]:[b.width,b.height],[V,at]=v?[d,f]:[f,d],[z,N]=v?[n,s]:[s,n];if(!(w<z||w+B>V))for(const ct of c){const dt=y[(v?"v":"h")+ct];if(!(dt<N||dt+F>at))return t.style[M]=dt-b[M]+"px",t.style[S]=w-b[S]+"px",g+ct}}return t.style.left=u,t.style.top=l,null};function D(h,t,e){return t in h?Object.defineProperty(h,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):h[t]=e,h}class T{constructor(t){D(this,"_initializingActive",!0),D(this,"_recalc",!0),D(this,"_nanopop",null),D(this,"_root",null),D(this,"_color",X()),D(this,"_lastColor",X()),D(this,"_swatchColors",[]),D(this,"_setupAnimationFrame",null),D(this,"_eventListener",{init:[],save:[],hide:[],show:[],clear:[],change:[],changestop:[],cancel:[],swatchselect:[]}),this.options=t=Object.assign({...T.DEFAULT_OPTIONS},t);const{swatches:e,components:r,theme:a,sliders:o,lockOpacity:i,padding:p}=t;["nano","monolith"].includes(a)&&!o&&(t.sliders="h"),r.interaction||(r.interaction={});const{preview:u,opacity:l,hue:m,palette:b}=r;r.opacity=!i&&l,r.palette=b||u||l||m,this._preBuild(),this._buildComponents(),this._bindEvents(),this._finalBuild(),e&&e.length&&e.forEach(E=>this.addSwatch(E));const{button:_,app:y}=this._root;this._nanopop=((E,H,c)=>{const n=typeof E!="object"||E instanceof HTMLElement?{reference:E,popper:H,...c}:E;return{update(s=n){const{reference:d,popper:f}=Object.assign(n,s);if(!f||!d)throw new Error("Popper- or reference-element missing.");return tt(d,f,n)}}})(_,y,{margin:p}),_.setAttribute("role","button"),_.setAttribute("aria-label",this._t("btn:toggle"));const x=this;this._setupAnimationFrame=requestAnimationFrame(function E(){if(!y.offsetWidth)return requestAnimationFrame(E);x.setColor(t.default),x._rePositioningPicker(),t.defaultRepresentation&&(x._representation=t.defaultRepresentation,x.setColorRepresentation(x._representation)),t.showAlways&&x.show(),x._initializingActive=!1,x._emit("init")})}_preBuild(){const{options:t}=this;for(const e of["el","container"])t[e]=U(t[e]);this._root=(e=>{const{components:r,useAsButton:a,inline:o,appClass:i,theme:p,lockOpacity:u}=e.options,l=y=>y?"":'style="display:none" hidden',m=y=>e._t(y),b=ot(`
      <div :ref="root" class="pickr">

        ${a?"":'<button type="button" :ref="button" class="pcr-button"></button>'}

        <div :ref="app" class="pcr-app ${i||""}" data-theme="${p}" ${o?'style="position: unset"':""} aria-label="${m("ui:dialog")}" role="window">
          <div class="pcr-selection" ${l(r.palette)}>
            <div :obj="preview" class="pcr-color-preview" ${l(r.preview)}>
              <button type="button" :ref="lastColor" class="pcr-last-color" aria-label="${m("btn:last-color")}"></button>
              <div :ref="currentColor" class="pcr-current-color"></div>
            </div>

            <div :obj="palette" class="pcr-color-palette">
              <div :ref="picker" class="pcr-picker"></div>
              <div :ref="palette" class="pcr-palette" tabindex="0" aria-label="${m("aria:palette")}" role="listbox"></div>
            </div>

            <div :obj="hue" class="pcr-color-chooser" ${l(r.hue)}>
              <div :ref="picker" class="pcr-picker"></div>
              <div :ref="slider" class="pcr-hue pcr-slider" tabindex="0" aria-label="${m("aria:hue")}" role="slider"></div>
            </div>

            <div :obj="opacity" class="pcr-color-opacity" ${l(r.opacity)}>
              <div :ref="picker" class="pcr-picker"></div>
              <div :ref="slider" class="pcr-opacity pcr-slider" tabindex="0" aria-label="${m("aria:opacity")}" role="slider"></div>
            </div>
          </div>

          <div class="pcr-swatches ${r.palette?"":"pcr-last"}" :ref="swatches"></div>

          <div :obj="interaction" class="pcr-interaction" ${l(Object.keys(r.interaction).length)}>
            <input :ref="result" class="pcr-result" type="text" spellcheck="false" ${l(r.interaction.input)} aria-label="${m("aria:input")}">

            <input :arr="options" class="pcr-type" data-type="HEXA" value="${u?"HEX":"HEXA"}" type="button" ${l(r.interaction.hex)}>
            <input :arr="options" class="pcr-type" data-type="RGBA" value="${u?"RGB":"RGBA"}" type="button" ${l(r.interaction.rgba)}>
            <input :arr="options" class="pcr-type" data-type="HSLA" value="${u?"HSL":"HSLA"}" type="button" ${l(r.interaction.hsla)}>
            <input :arr="options" class="pcr-type" data-type="HSVA" value="${u?"HSV":"HSVA"}" type="button" ${l(r.interaction.hsva)}>
            <input :arr="options" class="pcr-type" data-type="CMYK" value="CMYK" type="button" ${l(r.interaction.cmyk)}>

            <input :ref="save" class="pcr-save" value="${m("btn:save")}" type="button" ${l(r.interaction.save)} aria-label="${m("aria:btn:save")}">
            <input :ref="cancel" class="pcr-cancel" value="${m("btn:cancel")}" type="button" ${l(r.interaction.cancel)} aria-label="${m("aria:btn:cancel")}">
            <input :ref="clear" class="pcr-clear" value="${m("btn:clear")}" type="button" ${l(r.interaction.clear)} aria-label="${m("aria:btn:clear")}">
          </div>
        </div>
      </div>
    `),_=b.interaction;return _.options.find(y=>!y.hidden&&!y.classList.add("active")),_.type=()=>_.options.find(y=>y.classList.contains("active")),b})(this),t.useAsButton&&(this._root.button=t.el),t.container.appendChild(this._root.root)}_finalBuild(){const t=this.options,e=this._root;if(t.container.removeChild(e.root),t.inline){const r=t.el.parentElement;t.el.nextSibling?r.insertBefore(e.app,t.el.nextSibling):r.appendChild(e.app)}else t.container.appendChild(e.app);t.useAsButton?t.inline&&t.el.remove():t.el.parentNode.replaceChild(e.root,t.el),t.disabled&&this.disable(),t.comparison||(e.button.style.transition="none",t.useAsButton||(e.preview.lastColor.style.transition="none")),this.hide()}_buildComponents(){const t=this,e=this.options.components,r=(t.options.sliders||"v").repeat(2),[a,o]=r.match(/^[vh]+$/g)?r:[],i=()=>this._color||(this._color=this._lastColor.clone()),p={palette:st({element:t._root.palette.picker,wrapper:t._root.palette.palette,onstop:()=>t._emit("changestop","slider",t),onchange(u,l){if(!e.palette)return;const m=i(),{_root:b,options:_}=t,{lastColor:y,currentColor:x}=b.preview;t._recalc&&(m.s=100*u,m.v=100-100*l,m.v<0&&(m.v=0),t._updateOutput("slider"));const E=m.toRGBA().toString(0);this.element.style.background=E,this.wrapper.style.background=`
                        linear-gradient(to top, rgba(0, 0, 0, ${m.a}), transparent),
                        linear-gradient(to left, hsla(${m.h}, 100%, 50%, ${m.a}), rgba(255, 255, 255, ${m.a}))
                    `,_.comparison?_.useAsButton||t._lastColor||y.style.setProperty("--pcr-color",E):(b.button.style.setProperty("--pcr-color",E),b.button.classList.remove("clear"));const H=m.toHEXA().toString();for(const{el:c,color:n}of t._swatchColors)c.classList[H===n.toHEXA().toString()?"add":"remove"]("pcr-active");x.style.setProperty("--pcr-color",E)}}),hue:st({lock:o==="v"?"h":"v",element:t._root.hue.picker,wrapper:t._root.hue.slider,onstop:()=>t._emit("changestop","slider",t),onchange(u){if(!e.hue||!e.palette)return;const l=i();t._recalc&&(l.h=360*u),this.element.style.backgroundColor=`hsl(${l.h}, 100%, 50%)`,p.palette.trigger()}}),opacity:st({lock:a==="v"?"h":"v",element:t._root.opacity.picker,wrapper:t._root.opacity.slider,onstop:()=>t._emit("changestop","slider",t),onchange(u){if(!e.opacity||!e.palette)return;const l=i();t._recalc&&(l.a=Math.round(100*u)/100),this.element.style.background=`rgba(0, 0, 0, ${l.a})`,p.palette.trigger()}}),selectable:$({elements:t._root.interaction.options,className:"active",onchange(u){t._representation=u.target.getAttribute("data-type").toUpperCase(),t._recalc&&t._updateOutput("swatch")}})};this._components=p}_bindEvents(){const{_root:t,options:e}=this,r=[A(t.interaction.clear,"click",()=>this._clearColor()),A([t.interaction.cancel,t.preview.lastColor],"click",()=>{this.setHSVA(...(this._lastColor||this._color).toHSVA(),!0),this._emit("cancel")}),A(t.interaction.save,"click",()=>{!this.applyColor()&&!e.showAlways&&this.hide()}),A(t.interaction.result,["keyup","input"],a=>{this.setColor(a.target.value,!0)&&!this._initializingActive&&(this._emit("change",this._color,"input",this),this._emit("changestop","input",this)),a.stopImmediatePropagation()}),A(t.interaction.result,["focus","blur"],a=>{this._recalc=a.type==="blur",this._recalc&&this._updateOutput(null)}),A([t.palette.palette,t.palette.picker,t.hue.slider,t.hue.picker,t.opacity.slider,t.opacity.picker],["mousedown","touchstart"],()=>this._recalc=!0,{passive:!0})];if(!e.showAlways){const a=e.closeWithKey;r.push(A(t.button,"click",()=>this.isOpen()?this.hide():this.show()),A(document,"keyup",o=>this.isOpen()&&(o.key===a||o.code===a)&&this.hide()),A(document,["touchstart","mousedown"],o=>{this.isOpen()&&!rt(o).some(i=>i===t.app||i===t.button)&&this.hide()},{capture:!0}))}if(e.adjustableNumbers){const a={rgba:[255,255,255,1],hsva:[360,100,100,1],hsla:[360,100,100,1],cmyk:[100,100,100,100]};K(t.interaction.result,(o,i,p)=>{const u=a[this.getColorRepresentation().toLowerCase()];if(u){const l=u[p],m=o+(l>=100?1e3*i:i);return m<=0?0:Number((m<l?m:l).toPrecision(3))}return o})}if(e.autoReposition&&!e.inline){let a=null;const o=this;r.push(A(window,["scroll","resize"],()=>{o.isOpen()&&(e.closeOnScroll&&o.hide(),a===null?(a=setTimeout(()=>a=null,100),requestAnimationFrame(function i(){o._rePositioningPicker(),a!==null&&requestAnimationFrame(i)})):(clearTimeout(a),a=setTimeout(()=>a=null,100)))},{capture:!0}))}this._eventBindings=r}_rePositioningPicker(){const{options:t}=this;if(!t.inline&&!this._nanopop.update({container:document.body.getBoundingClientRect(),position:t.position})){const e=this._root.app,r=e.getBoundingClientRect();e.style.top=(window.innerHeight-r.height)/2+"px",e.style.left=(window.innerWidth-r.width)/2+"px"}}_updateOutput(t){const{_root:e,_color:r,options:a}=this;if(e.interaction.type()){const o=`to${e.interaction.type().getAttribute("data-type")}`;e.interaction.result.value=typeof r[o]=="function"?r[o]().toString(a.outputPrecision):""}!this._initializingActive&&this._recalc&&this._emit("change",r,t,this)}_clearColor(t=!1){const{_root:e,options:r}=this;r.useAsButton||e.button.style.setProperty("--pcr-color","rgba(0, 0, 0, 0.15)"),e.button.classList.add("clear"),r.showAlways||this.hide(),this._lastColor=null,this._initializingActive||t||(this._emit("save",null),this._emit("clear"))}_parseLocalColor(t){const{values:e,type:r,a}=it(t),{lockOpacity:o}=this.options,i=a!==void 0&&a!==1;return e&&e.length===3&&(e[3]=void 0),{values:!e||o&&i?null:e,type:r}}_t(t){return this.options.i18n[t]||T.I18N_DEFAULTS[t]}_emit(t,...e){this._eventListener[t].forEach(r=>r(...e,this))}on(t,e){return this._eventListener[t].push(e),this}off(t,e){const r=this._eventListener[t]||[],a=r.indexOf(e);return~a&&r.splice(a,1),this}addSwatch(t){const{values:e}=this._parseLocalColor(t);if(e){const{_swatchColors:r,_root:a}=this,o=X(...e),i=I(`<button type="button" style="--pcr-color: ${o.toRGBA().toString(0)}" aria-label="${this._t("btn:swatch")}"/>`);return a.swatches.appendChild(i),r.push({el:i,color:o}),this._eventBindings.push(A(i,"click",()=>{this.setHSVA(...o.toHSVA(),!0),this._emit("swatchselect",o),this._emit("change",o,"swatch",this)})),!0}return!1}removeSwatch(t){const e=this._swatchColors[t];if(e){const{el:r}=e;return this._root.swatches.removeChild(r),this._swatchColors.splice(t,1),!0}return!1}applyColor(t=!1){const{preview:e,button:r}=this._root,a=this._color.toRGBA().toString(0);return e.lastColor.style.setProperty("--pcr-color",a),this.options.useAsButton||r.style.setProperty("--pcr-color",a),r.classList.remove("clear"),this._lastColor=this._color.clone(),this._initializingActive||t||this._emit("save",this._color),this}destroy(){cancelAnimationFrame(this._setupAnimationFrame),this._eventBindings.forEach(t=>R(...t)),Object.keys(this._components).forEach(t=>this._components[t].destroy())}destroyAndRemove(){this.destroy();const{root:t,app:e}=this._root;t.parentElement&&t.parentElement.removeChild(t),e.parentElement.removeChild(e),Object.keys(this).forEach(r=>this[r]=null)}hide(){return!!this.isOpen()&&(this._root.app.classList.remove("visible"),this._emit("hide"),!0)}show(){return!this.options.disabled&&!this.isOpen()&&(this._root.app.classList.add("visible"),this._rePositioningPicker(),this._emit("show",this._color),this)}isOpen(){return this._root.app.classList.contains("visible")}setHSVA(t=360,e=0,r=0,a=1,o=!1){const i=this._recalc;if(this._recalc=!1,t<0||t>360||e<0||e>100||r<0||r>100||a<0||a>1)return!1;this._color=X(t,e,r,a);const{hue:p,opacity:u,palette:l}=this._components;return p.update(t/360),u.update(a),l.update(e/100,1-r/100),o||this.applyColor(),i&&this._updateOutput(),this._recalc=i,!0}setColor(t,e=!1){if(t===null)return this._clearColor(e),!0;const{values:r,type:a}=this._parseLocalColor(t);if(r){const o=a.toUpperCase(),{options:i}=this._root.interaction,p=i.find(u=>u.getAttribute("data-type")===o);if(p&&!p.hidden)for(const u of i)u.classList[u===p?"add":"remove"]("active");return!!this.setHSVA(...r,e)&&this.setColorRepresentation(o)}return!1}setColorRepresentation(t){return t=t.toUpperCase(),!!this._root.interaction.options.find(e=>e.getAttribute("data-type").startsWith(t)&&!e.click())}getColorRepresentation(){return this._representation}getColor(){return this._color}getSelectedColor(){return this._lastColor}getRoot(){return this._root}disable(){return this.hide(),this.options.disabled=!0,this._root.button.classList.add("disabled"),this}enable(){return this.options.disabled=!1,this._root.button.classList.remove("disabled"),this}}return D(T,"utils",J),D(T,"version","1.8.2"),D(T,"I18N_DEFAULTS",{"ui:dialog":"color picker dialog","btn:toggle":"toggle color picker dialog","btn:swatch":"color swatch","btn:last-color":"use previous color","btn:save":"Save","btn:cancel":"Cancel","btn:clear":"Clear","aria:btn:save":"save and close","aria:btn:cancel":"cancel and close","aria:btn:clear":"clear and close","aria:input":"color input field","aria:palette":"color selection area","aria:hue":"hue selection slider","aria:opacity":"selection slider"}),D(T,"DEFAULT_OPTIONS",{appClass:null,theme:"classic",useAsButton:!1,padding:8,disabled:!1,comparison:!0,closeOnScroll:!1,outputPrecision:0,lockOpacity:!1,autoReposition:!0,container:"body",components:{interaction:{}},i18n:{},swatches:null,inline:!1,sliders:null,default:"#42445a",defaultRepresentation:null,position:"bottom-middle",adjustableNumbers:!0,showAlways:!1,closeWithKey:"Escape"}),D(T,"create",h=>new T(h)),L=L.default})()})}},mt={};function j(k){var C=mt[k];if(C!==void 0)return C.exports;var L=mt[k]={exports:{}};return ft[k](L,L.exports,j),L.exports}j.n=k=>{var C=k&&k.__esModule?()=>k.default:()=>k;return j.d(C,{a:C}),C},j.d=(k,C)=>{for(var L in C)j.o(C,L)&&!j.o(k,L)&&Object.defineProperty(k,L,{enumerable:!0,get:C[L]})},j.o=(k,C)=>Object.prototype.hasOwnProperty.call(k,C),j.r=k=>{typeof Symbol<"u"&&Symbol.toStringTag&&Object.defineProperty(k,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(k,"__esModule",{value:!0})};var lt={};(()=>{"use strict";j.r(lt),j.d(lt,{default:()=>H});const k=require("siyuan");function C(c,n){Array.from(c).forEach(function(s){n(s)})}function L(c,n){let s=Object.keys(c);Array.from(s).forEach(d=>{n(d,c[d])})}const J=document.querySelector(":root"),et=window.getComputedStyle(J);function A(c){return et.getPropertyValue(c)}function R(c){let n="",s=/color/,d=/background/;if(s.exec(c))n="color";else if(d.exec(c))n="background-color";else return console.log("getStyleByName \u672A\u80FD\u627E\u5230\u6216\u89E3\u6790",c),"";return n}function I(c,n){let d=/(font|pdf)-(\w+)/.exec(c),f=`--b3-${d[1]}-${d[2]}`,g=U(n,new RegExp(f+"\\)")),v={};g!=null&&(v=G(g));let w=R(c),S=A(f);return(v[w]===void 0||v[w]==="")&&(v[w]=S),v}function ot(c,n){let d=/(font|pdf)-(\w+)/.exec(c),f=`--b3-${d[1]}-${d[2]}`,g=U(n,new RegExp(f+"\\)")),v={},w="";g!=null&&(v=G(g),w=ht(g));let S=R(c),M=A(f);return(v[S]===void 0||v[S]==="")&&(w+=`
${S}:${M};`),w}function rt(c,n){let s=I(c,n),d="",f="",g=/background/;if(g.exec(c)!=null?f="background-color":f="color",d=s[f],d!=null&&d!="")return d;g=/(font|pdf)-(\w+)/;let v=g.exec(c),w=`--b3-${v[1]}-${v[2]}`;return d=A(w),d}function U(c,n){let s=c.cssRules,d=null;return C(s,f=>{let g=f.selectorText;n.exec(g)!=null&&(d=f)}),d}function K(c){let n=c.cssRules,s=[];return C(n,d=>{s.push(d.cssText)}),s.join(`
`)}function Z(c,n){return c.style.getPropertyValue(n)}function pt(c,n,s){return c.style.setProperty(n,s,"important"),c}function G(c){let n={};return C(c.style,s=>{let d=Z(c,s);n[s]=d}),n}function ut(c,n){c.style.cssText="";let s=Object.keys(n);return C(s,d=>{pt(c,d,n[d])}),c}function Y(c,n,s){let d=nt(n,s),f=[];return f.push(d+"{"),L(c,(g,v)=>{f.push(`${g}:${v} !important;`)}),f.push("}"),f.join(`
`)}function nt(c,n){let s="",d=/font-color/,f=/font-background/,g=/pdf-background/,v;if(n!="none"?v=`:root[data-theme-mode="${n}"] `:v="",d.exec(c))s=`[style*="color"][style*="var(--b3-${c})"]`;else if(f.exec(c))s=`[style*="background-color"][style*="var(--b3-${c})"]`;else if(g.exec(c))s=`[style*="background-color"][style*="var(--b3-${c})"]`;else return console.log("\u672A\u77E5\u89E3\u6790\u9009\u9879\uFF01"),"";return v+s}function q(c){let s=/var\(--b3-(font|pdf)-(\w+)\)/.exec(c);return s===null?(console.log("\u672A\u80FD\u89E3\u6790Dom\uFF01"),""):`${s[1]}-${s[2]}`}function P(c){let n=c.cssRules,s={};return C(n,d=>{let f=q(d.selectorText),g=G(d);s[f]=g}),s}function O(c,n,s="light"){let d=c.cssRules.length;for(var f=0;f<d;f++)c.deleteRule(0);return L(n,(g,v)=>{let w=Y(v,g,s);c.insertRule(w,0)}),c}function ht(c){let n=/:root\[.+?\].+?\{(.+?)\}/,s=/(.+?):(.+?;)/g,g=c.cssText.match(n)[1].match(s);return g?g.join(`
`).replaceAll(" !important",""):""}function it(c){let n=new RegExp("(?<name>.+?):(?<value>.+?);","g"),s=c.matchAll(n),d=[];for(let f of s){let{name:g,value:v}=f.groups;d.push(`"${g.trim()}":"${v.replace("!important","").trim()}"`)}return`{
`+d.join(`,
`)+`
}`}function X(c){let n=U(c,/12/);console.log(n);let s=G(n);console.log(s);let d=ut(n,s);console.log(d.style)}function W(c){let n=[],s=[];C(c,d=>{n.push(q(d))}),console.log(n),C(n,d=>{s.push(nt(d,"light"))}),console.log(s)}function st(c){let n=P(c);O(c,n)}const $={},Q=document.createElement("style");Q.id="colorSchemeLight";const tt=document.createElement("style");tt.id="colorSchemeDark";const D=document.createElement("style");D.id="colorSchemeCustom",document.head.appendChild(Q),document.head.appendChild(tt),$.light=Q.sheet,$.dark=tt.sheet,$.custom=()=>D.sheet,$.customInject=c=>(c.appendChild(D),D);var T=j(965),h=j.n(T);let t=`
    /*! Pickr 1.8.2 MIT | https://github.com/Simonwep/pickr */
    .pickr{position:relative;overflow:visible;transform:translateY(0)}.pickr *{box-sizing:border-box;outline:none;border:none;-webkit-appearance:none}.pickr .pcr-button{position:relative;height:2em;width:2em;padding:0.5em;cursor:pointer;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Helvetica Neue",Arial,sans-serif;border-radius:.15em;background:url('data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 50 50" stroke="%2342445A" stroke-width="5px" stroke-linecap="round"><path d="M45,45L5,5"></path><path d="M45,5L5,45"></path></svg>') no-repeat center;background-size:0;transition:all 0.3s}.pickr .pcr-button::before{position:absolute;content:'';top:0;left:0;width:100%;height:100%;background:url('data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 2"><path fill="white" d="M1,0H2V1H1V0ZM0,1H1V2H0V1Z"/><path fill="gray" d="M0,0H1V1H0V0ZM1,1H2V2H1V1Z"/></svg>');background-size:.5em;border-radius:.15em;z-index:-1}.pickr .pcr-button::before{z-index:initial}.pickr .pcr-button::after{position:absolute;content:'';top:0;left:0;height:100%;width:100%;transition:background 0.3s;background:var(--pcr-color);border-radius:.15em}.pickr .pcr-button.clear{background-size:70%}.pickr .pcr-button.clear::before{opacity:0}.pickr .pcr-button.clear:focus{box-shadow:0 0 0 1px rgba(255,255,255,0.85),0 0 0 3px var(--pcr-color)}.pickr .pcr-button.disabled{cursor:not-allowed}.pickr *,.pcr-app *{box-sizing:border-box;outline:none;border:none;-webkit-appearance:none}.pickr input:focus,.pickr input.pcr-active,.pickr button:focus,.pickr button.pcr-active,.pcr-app input:focus,.pcr-app input.pcr-active,.pcr-app button:focus,.pcr-app button.pcr-active{box-shadow:0 0 0 1px rgba(255,255,255,0.85),0 0 0 3px var(--pcr-color)}.pickr .pcr-palette,.pickr .pcr-slider,.pcr-app .pcr-palette,.pcr-app .pcr-slider{transition:box-shadow 0.3s}.pickr .pcr-palette:focus,.pickr .pcr-slider:focus,.pcr-app .pcr-palette:focus,.pcr-app .pcr-slider:focus{box-shadow:0 0 0 1px rgba(255,255,255,0.85),0 0 0 3px rgba(0,0,0,0.25)}.pcr-app{position:fixed;display:flex;flex-direction:column;z-index:10000;border-radius:0.1em;background:#fff;opacity:0;visibility:hidden;transition:opacity 0.3s, visibility 0s 0.3s;font-family:-apple-system,BlinkMacSystemFont,"Segoe UI","Roboto","Helvetica Neue",Arial,sans-serif;box-shadow:0 0.15em 1.5em 0 rgba(0,0,0,0.1),0 0 1em 0 rgba(0,0,0,0.03);left:0;top:0}.pcr-app.visible{transition:opacity 0.3s;visibility:visible;opacity:1}.pcr-app .pcr-swatches{display:flex;flex-wrap:wrap;margin-top:0.75em}.pcr-app .pcr-swatches.pcr-last{margin:0}@supports (display: grid){.pcr-app .pcr-swatches{display:grid;align-items:center;grid-template-columns:repeat(auto-fit, 1.75em)}}.pcr-app .pcr-swatches>button{font-size:1em;position:relative;width:calc(1.75em - 5px);height:calc(1.75em - 5px);border-radius:0.15em;cursor:pointer;margin:2.5px;flex-shrink:0;justify-self:center;transition:all 0.15s;overflow:hidden;background:transparent;z-index:1}.pcr-app .pcr-swatches>button::before{position:absolute;content:'';top:0;left:0;width:100%;height:100%;background:url('data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 2"><path fill="white" d="M1,0H2V1H1V0ZM0,1H1V2H0V1Z"/><path fill="gray" d="M0,0H1V1H0V0ZM1,1H2V2H1V1Z"/></svg>');background-size:6px;border-radius:.15em;z-index:-1}.pcr-app .pcr-swatches>button::after{content:'';position:absolute;top:0;left:0;width:100%;height:100%;background:var(--pcr-color);border:1px solid rgba(0,0,0,0.05);border-radius:0.15em;box-sizing:border-box}.pcr-app .pcr-swatches>button:hover{filter:brightness(1.05)}.pcr-app .pcr-swatches>button:not(.pcr-active){box-shadow:none}.pcr-app .pcr-interaction{display:flex;flex-wrap:wrap;align-items:center;margin:0 -0.2em 0 -0.2em}.pcr-app .pcr-interaction>*{margin:0 0.2em}.pcr-app .pcr-interaction input{letter-spacing:0.07em;font-size:0.75em;text-align:center;cursor:pointer;color:#75797e;background:#f1f3f4;border-radius:.15em;transition:all 0.15s;padding:0.45em 0.5em;margin-top:0.75em}.pcr-app .pcr-interaction input:hover{filter:brightness(0.975)}.pcr-app .pcr-interaction input:focus{box-shadow:0 0 0 1px rgba(255,255,255,0.85),0 0 0 3px rgba(66,133,244,0.75)}.pcr-app .pcr-interaction .pcr-result{color:#75797e;text-align:left;flex:1 1 8em;min-width:8em;transition:all 0.2s;border-radius:.15em;background:#f1f3f4;cursor:text}.pcr-app .pcr-interaction .pcr-result::-moz-selection{background:#4285f4;color:#fff}.pcr-app .pcr-interaction .pcr-result::selection{background:#4285f4;color:#fff}.pcr-app .pcr-interaction .pcr-type.active{color:#fff;background:#4285f4}.pcr-app .pcr-interaction .pcr-save,.pcr-app .pcr-interaction .pcr-cancel,.pcr-app .pcr-interaction .pcr-clear{color:#fff;width:auto}.pcr-app .pcr-interaction .pcr-save,.pcr-app .pcr-interaction .pcr-cancel,.pcr-app .pcr-interaction .pcr-clear{color:#fff}.pcr-app .pcr-interaction .pcr-save:hover,.pcr-app .pcr-interaction .pcr-cancel:hover,.pcr-app .pcr-interaction .pcr-clear:hover{filter:brightness(0.925)}.pcr-app .pcr-interaction .pcr-save{background:#4285f4}.pcr-app .pcr-interaction .pcr-clear,.pcr-app .pcr-interaction .pcr-cancel{background:#f44250}.pcr-app .pcr-interaction .pcr-clear:focus,.pcr-app .pcr-interaction .pcr-cancel:focus{box-shadow:0 0 0 1px rgba(255,255,255,0.85),0 0 0 3px rgba(244,66,80,0.75)}.pcr-app .pcr-selection .pcr-picker{position:absolute;height:18px;width:18px;border:2px solid #fff;border-radius:100%;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}.pcr-app .pcr-selection .pcr-color-palette,.pcr-app .pcr-selection .pcr-color-chooser,.pcr-app .pcr-selection .pcr-color-opacity{position:relative;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;display:flex;flex-direction:column;cursor:grab;cursor:-webkit-grab}.pcr-app .pcr-selection .pcr-color-palette:active,.pcr-app .pcr-selection .pcr-color-chooser:active,.pcr-app .pcr-selection .pcr-color-opacity:active{cursor:grabbing;cursor:-webkit-grabbing}.pcr-app[data-theme='monolith']{width:14.25em;max-width:95vw;padding:0.8em}.pcr-app[data-theme='monolith'] .pcr-selection{display:flex;flex-direction:column;justify-content:space-between;flex-grow:1}.pcr-app[data-theme='monolith'] .pcr-selection .pcr-color-preview{position:relative;z-index:1;width:100%;height:1em;display:flex;flex-direction:row;justify-content:space-between;margin-bottom:0.5em}.pcr-app[data-theme='monolith'] .pcr-selection .pcr-color-preview::before{position:absolute;content:'';top:0;left:0;width:100%;height:100%;background:url('data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 2"><path fill="white" d="M1,0H2V1H1V0ZM0,1H1V2H0V1Z"/><path fill="gray" d="M0,0H1V1H0V0ZM1,1H2V2H1V1Z"/></svg>');background-size:.5em;border-radius:.15em;z-index:-1}.pcr-app[data-theme='monolith'] .pcr-selection .pcr-color-preview .pcr-last-color{cursor:pointer;transition:background-color 0.3s, box-shadow 0.3s;border-radius:0.15em 0 0 0.15em;z-index:2}.pcr-app[data-theme='monolith'] .pcr-selection .pcr-color-preview .pcr-current-color{border-radius:0 0.15em 0.15em 0}.pcr-app[data-theme='monolith'] .pcr-selection .pcr-color-preview .pcr-last-color,.pcr-app[data-theme='monolith'] .pcr-selection .pcr-color-preview .pcr-current-color{background:var(--pcr-color);width:50%;height:100%}.pcr-app[data-theme='monolith'] .pcr-selection .pcr-color-palette{width:100%;height:8em;z-index:1}.pcr-app[data-theme='monolith'] .pcr-selection .pcr-color-palette .pcr-palette{border-radius:.15em;width:100%;height:100%}.pcr-app[data-theme='monolith'] .pcr-selection .pcr-color-palette .pcr-palette::before{position:absolute;content:'';top:0;left:0;width:100%;height:100%;background:url('data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 2"><path fill="white" d="M1,0H2V1H1V0ZM0,1H1V2H0V1Z"/><path fill="gray" d="M0,0H1V1H0V0ZM1,1H2V2H1V1Z"/></svg>');background-size:.5em;border-radius:.15em;z-index:-1}.pcr-app[data-theme='monolith'] .pcr-selection .pcr-color-chooser,.pcr-app[data-theme='monolith'] .pcr-selection .pcr-color-opacity{height:0.5em;margin-top:0.75em}.pcr-app[data-theme='monolith'] .pcr-selection .pcr-color-chooser .pcr-picker,.pcr-app[data-theme='monolith'] .pcr-selection .pcr-color-opacity .pcr-picker{top:50%;transform:translateY(-50%)}.pcr-app[data-theme='monolith'] .pcr-selection .pcr-color-chooser .pcr-slider,.pcr-app[data-theme='monolith'] .pcr-selection .pcr-color-opacity .pcr-slider{flex-grow:1;border-radius:50em}.pcr-app[data-theme='monolith'] .pcr-selection .pcr-color-chooser .pcr-slider{background:linear-gradient(to right, red, #ff0, lime, cyan, blue, #f0f, red)}.pcr-app[data-theme='monolith'] .pcr-selection .pcr-color-opacity .pcr-slider{background:linear-gradient(to right, transparent, black),url('data:image/svg+xml;utf8, <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 2 2"><path fill="white" d="M1,0H2V1H1V0ZM0,1H1V2H0V1Z"/><path fill="gray" d="M0,0H1V1H0V0ZM1,1H2V2H1V1Z"/></svg>');background-size:100%, 0.25em}
    `;function e(){return document.querySelector("html").getAttribute("data-theme-mode")}function r(c,n,s){const d="color-scheme-plugin";let f=$[e()],g=rt(n,f),v=ot(n,f);g=g?g.trim():null,c.attachShadow({mode:"open"}),c.shadowRoot.innerHTML=`
        <style>
        ${t}
        .pickrCheck div{
            border-radius: 4px;
        }
                </style>
                <div style="display:flex;align-items: center">
                    <span class="pickr"></span>
                    <span style="background-color:var(--b3-font-color27);margin:0px 4px;font-size:1.1em;" id="pickrShowText">
                    ${s.i18n.showText}
                    </span>
                </div>
                <div style="display:none" id="pickrMasterMode">
                    <div style="margin:10px 0px;">
                        <textarea 
                            spellcheck= "false"
                            style=" width: 98%; min-height: 100px;" 
                            class="b3-text-field fn__block" 
                            id="pickrTextarea">${v}</textarea>
                    </div>
                    <div class="b3-dialog__action" style="display:flex;">
                        <button class="b3-button b3-button--cancel" id="pickrCancel">${s.i18n.cancel}</button>
                        <button class="b3-button b3-button--text" id="pickrTestScheme">${s.i18n.testScheme}</button>
                        <button class="b3-button b3-button--text" id="pickrSave">${s.i18n.save}</button>
                    </div>
                </div>
                <span class="pickrCheck"></span>

        
        `;let w=c.shadowRoot.querySelector(".pickrCheck"),S=c.shadowRoot.querySelector(".pickr");return h().create({container:w,el:S,theme:"monolith",default:g,swatches:["rgba(244, 67, 54, 1)","rgba(233, 30, 99, 0.95)","rgba(156, 39, 176, 0.9)","rgba(103, 58, 183, 0.85)","rgba(63, 81, 181, 0.8)","rgba(33, 150, 243, 0.75)","rgba(3, 169, 244, 0.7)","rgba(0, 188, 212, 0.7)","rgba(0, 150, 136, 0.75)","rgba(76, 175, 80, 0.8)","rgba(139, 195, 74, 0.85)","rgba(205, 220, 57, 0.9)","rgba(255, 235, 59, 0.95)","rgba(255, 193, 7, 1)"],components:{preview:!0,opacity:!0,hue:!0,interaction:{hex:!0,rgba:!0,hsla:!0,hsva:!0,cmyk:!0,input:!0,clear:!1,save:!0}}}).on("save",B=>{let F=B?B.toHEXA().toString():"";o(n,F,s)}),c.shadowRoot.getElementById("pickrShowText").addEventListener("click",()=>{let B=l?"100%":"400px";c.parentElement.parentElement.style.minWidth=B,c.shadowRoot.getElementById("pickrMasterMode").style.cssText="",c.shadowRoot.getElementById("pickrCancel").addEventListener("click",a),c.shadowRoot.getElementById("pickrTestScheme").addEventListener("click",F=>{let z=F.target.getRootNode().getElementById("pickrTextarea").value,N=it(z);try{N=JSON.parse(N),p(n,N)}catch{(0,k.showMessage)(s.i18n.parseError)}}),c.shadowRoot.getElementById("pickrSave").addEventListener("click",F=>{let z=F.target.getRootNode().getElementById("pickrTextarea").value,N=it(z);try{N=JSON.parse(N),i(n,N,s)}catch{(0,k.showMessage)(s.i18n.parseError)}})}),c.shadowRoot}function a(){document.getElementById("pickrMenuItem").remove(),document.getElementById("commonMenu").style.cssText=""}function o(c,n,s){let d=R(c),f=$[e()],g=I(c,f);g[d]=n;let v=P(f);v[c]=g,O(f,v,e()),v={"font-color27":g},O($.custom(),v,"none"),s.saveCustomData()}function i(c,n,s){let d=$[e()],f=P(d);f[c]=n,O(d,f,e()),f={"font-color27":n},O($.custom(),f,"none"),s.saveCustomData()}function p(c,n){let s={"font-color27":n};O($.custom(),s,"none")}const u=(0,k.getFrontend)(),l=u==="mobile"||u==="browser-mobile";var m=Object.getPrototypeOf,b=Reflect.get,_=(c,n,s)=>b(m(c),s,n),y=(c,n,s)=>new Promise((d,f)=>{var g=S=>{try{w(s.next(S))}catch(M){f(M)}},v=S=>{try{w(s.throw(S))}catch(M){f(M)}},w=S=>S.done?d(S.value):Promise.resolve(S.value).then(g,v);w((s=s.apply(c,n)).next())});const x="menu-config",E={colorSchemeStyleId:"color-scheme-plugin",currentLight:"default",currentDark:"default",lightSchemes:{default:"\u7CFB\u7EDF\u9ED8\u8BA4"},darkSchemes:{default:"\u7CFB\u7EDF\u9ED8\u8BA4"}};class H extends k.Plugin{constructor(){super(...arguments),this.config=E}onload(){console.log(this.i18n.helloPlugin),this.addContext(),this.loadConfig(),this.loadCustomData();const n=this.addTopBar({icon:'<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" width="32" height="32"><path d="M19.2277 18.7321L20.9955 16.9644L22.7632 18.7321C23.7395 19.7084 23.7395 21.2914 22.7632 22.2677C21.7869 23.244 20.204 23.244 19.2277 22.2677C18.2514 21.2914 18.2514 19.7084 19.2277 18.7321ZM8.87861 1.07959L20.1923 12.3933C20.5828 12.7838 20.5828 13.417 20.1923 13.8075L11.707 22.2928C11.3165 22.6833 10.6833 22.6833 10.2928 22.2928L1.80754 13.8075C1.41702 13.417 1.41702 12.7838 1.80754 12.3933L9.58572 4.61512L7.4644 2.4938L8.87861 1.07959ZM10.9999 6.02934L3.92886 13.1004L10.9999 20.1715L18.071 13.1004L10.9999 6.02934Z"></path></svg>',title:this.i18n.addTopBarIcon,position:"right",callback:()=>{this.addMenu(n.getBoundingClientRect())}})}onunload(){console.log(this.i18n.byePlugin)}saveData(n,s){return super.saveData(n+".txt",s)}loadData(n){return y(this,null,function*(){let s=yield _(H.prototype,this,"loadData").call(this,n+".txt");return s===null||s===""||s===void 0?"":typeof s=="object"?s:JSON.parse(s)})}openSetting(){const n=this.config.lightSchemes,s=Object.keys(this.config.lightSchemes),d=this.config.darkSchemes,f=Object.keys(this.config.darkSchemes),g=new k.Dialog({title:this.name,content:`<div class="config__tab-container" data-name="common" style="height: unset !important;">
            <label class="fn__flex b3-label config__item">
                <div class="fn__flex-1">
                    ${this.i18n.choseLightScheme}
                    <div class="b3-label__text">${this.i18n.lightScheme}</div>
                </div> 
                <span class="fn__space"></span>
                <select class="b3-select fn__flex-center fn__size200" id="light-schemes-current">
                    ${s.map(B=>`<option value="${B}">${n[B]}</option>`).join(`
`)}
                </select>
            </label>
            <label class="fn__flex b3-label config__item">
                <div class="fn__flex-1">
                    ${this.i18n.choseDarkScheme}
                    <div class="b3-label__text">${this.i18n.darkScheme}</div>
                </div> 
                <span class="fn__space"></span>
                <select class="b3-select fn__flex-center fn__size200" id="dark-schemes-current">
                    ${f.map(B=>`<option value="${B}">${d[B]}</option>`).join(`
`)}
                </select>
            </label>
            <label class="fn__flex b3-label config__item">
                <div class="fn__flex-1">
                    \u4E0A\u4F20\u914D\u8272\u65B9\u6848
                    <div class="b3-label__text">\u5BFC\u5165\u793E\u533A\u63D0\u4F9B\u7684\u914D\u8272\u65B9\u6848</div>
                </div>
                <span class="fn__space"></span>
                <button class="b3-button b3-button--outline fn__flex-center fn__size200" id="color-schemes-upload-button">
                    \u70B9\u51FB\u4E0A\u4F20
                    <input class="b3-file fn__flex-center" type="file" id="color-schemes-file" style="display:none"/>
                    </button>
            </label>
        </div>`,width:l?"92vw":"520px"}),v=g.element.querySelector("#color-schemes-upload-button"),w=g.element.querySelector("#light-schemes-current");w.value=this.config.currentLight,w.addEventListener("change",B=>{const V=B.target.value;this.applyScheme(V,"light")});const S=g.element.querySelector("#dark-schemes-current");S.value=this.config.currentDark,S.addEventListener("change",B=>{const V=B.target.value;this.applyScheme(V,"dark")});const M=g.element.querySelector("#color-schemes-file");v.addEventListener("click",()=>{M.click()}),M.addEventListener("change",B=>y(this,null,function*(){let V=g.element.querySelector("#color-schemes-file").files[0];yield this.upload(V)}))}updateSelect(){return y(this,null,function*(){let n;const s=document.querySelector("#light-schemes-current"),d=this.config.lightSchemes;n=Object.keys(this.config.lightSchemes).map(S=>`<option value="${S}">${d[S]}</option>`).join(`
`),s.innerHTML=n;const g=document.querySelector("#dark-schemes-current"),v=this.config.darkSchemes;n=Object.keys(this.config.darkSchemes).map(S=>`<option value="${S}">${v[S]}</option>`).join(`
`),g.innerHTML=n})}addContext(){return y(this,null,function*(){let n=this;document.addEventListener("contextmenu",function(s){var d=s.target;if(d.className==="color__square"){let f=$[e()],g=d.style.cssText,v=q(g);const w=document.createElement("div");w.id="pickrMenuItem";let M={"font-color27":I(v,f)},B=r(w,v,n),F=$.customInject(B),V=new k.Menu("ColorSchemePlugin"),z=V.addItem({id:"pickrMenu"}).parentElement;z.innerHTML="",z.append(w),l?V.fullscreen():V.open({x:s.clientX,y:s.clientY,isLeft:!0}),O(F.sheet,M,"none")}})})}saveCustomData(){return y(this,null,function*(){let n=P($.light),s=P($.dark),d={name:"custom",light:n,dark:s};this.saveData("custom.json",JSON.stringify(d,(f,g)=>g,"	"))})}loadCustomData(){return y(this,null,function*(){let n=yield this.loadData("custom.json");if(n===""||n===void 0||n===null){this.saveCustomData();return}O($.light,n.light,"light"),O($.dark,n.dark,"dark")})}applyScheme(n,s){return y(this,null,function*(){if(console.log(n),n=="default"){switch(s){case"light":O($.light,{}),this.config.currentLight=n;break;case"dark":O($.dark,{}),this.config.currentDark=n;break}this.saveCustomData(),this.saveConfig();return}let d=yield this.loadData(`${n}.json`);switch(s){case"light":O($.light,d.light,"light"),this.config.currentLight=n;break;case"dark":O($.dark,d.dark,"dark"),this.config.currentDark=n;break}this.saveConfig(),this.saveCustomData()})}upload(n){return y(this,null,function*(){return new Promise(s=>{let d=new FileReader;d.addEventListener("load",f=>y(this,null,function*(){let g=f.target.result,v;try{v=JSON.parse(g)}catch{(0,k.showMessage)("Scheme parse failed",6e3,"error");return}const w=v.name;if(!w){(0,k.showMessage)("\u914D\u8272\u65B9\u6848\u65E0\u540D\u79F0",6e3,"error");return}if(w==="config"){(0,k.showMessage)("\u914D\u8272\u65B9\u6848\u540D\u79F0\u4E0D\u80FD\u53EBconfig",6e3,"error");return}if(v.light===void 0&&v.dark===void 0){(0,k.showMessage)("\u914D\u8272\u65B9\u6848\u683C\u5F0F\u4E0D\u6B63\u786E\uFF0C\u7F3A\u4E4F light\u3001dark\u5B57\u6BB5",6e3,"error");return}this.saveData(`${w}.json`,JSON.stringify(v,(S,M)=>M,"	")),(0,k.showMessage)(`\u914D\u8272\u65B9\u6848${w}\u4E0A\u4F20\u6210\u529F`,6e3,"info"),yield this.updateConfig(v)})),d.readAsText(n),s()})})}updateConfig(n){return y(this,null,function*(){let s=n.name;n.light!=null&&(this.config.lightSchemes[s]=s),n.dark!=null&&(this.config.darkSchemes[s]=s),this.updateSelect(),this.saveConfig()})}saveConfig(){this.saveData("config.json",JSON.stringify(this.config,(n,s)=>s,"	"))}loadConfig(){return y(this,null,function*(){let n=yield this.loadData("config.json");if(n===null||n===""||n===void 0){this.saveConfig();return}this.config=n})}addMenu(n){return y(this,null,function*(){this.data||(yield this.loadData(x));const s=new k.Menu("topBarSample",()=>{console.log(this.i18n.byeMenu)});s.addItem({label:this.i18n.exportCurrentScheme,click:()=>{let d=P($.light),f=P($.dark),g={name:"export",light:d,dark:f};_(H.prototype,this,"saveData").call(this,"export.json",JSON.stringify(g,(v,w)=>w,"	")),(0,k.showMessage)(this.i18n.exportSchemeSuccess)}}),s.addItem({label:this.i18n.exportCurrentCss,click:()=>{let d=K($.light),f=K($.dark),g=`           
/* light scheme */
${d}
/* light scheme */


/* dark scheme */
${f}
/* dark scheme */
                `;_(H.prototype,this,"saveData").call(this,"export.css",g),(0,k.showMessage)(this.i18n.exportCssSuccess)}}),s.addItem({label:this.i18n.resetScheme,click:()=>{this.applyScheme("default",e())}}),s.addItem({label:this.i18n.openSetting,click:()=>{this.openSetting()}}),l?s.fullscreen():s.open({x:n.right,y:n.bottom,isLeft:!0})})}}})(),module.exports=lt})();
