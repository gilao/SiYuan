{"ID":"20240406114113-osipvcx","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f432","id":"20240406114113-osipvcx","title":"3-34 Pytorch 与 nn 库","updated":"20240406152552"},"Children":[{"ID":"20240406114126-bnam1ig","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240406114126-bnam1ig","updated":"20240406114139"},"Children":[{"Type":"NodeText","Data":"torch.nn 库"}]},{"ID":"20240406114139-kqsq9wk","Type":"NodeList","ListData":{},"Properties":{"id":"20240406114139-kqsq9wk","updated":"20240406114141"},"Children":[{"ID":"20240406114141-ay65526","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406114141-ay65526","updated":"20240406114141"},"Children":[{"ID":"20240406114141-m4kq0b5","Type":"NodeParagraph","Properties":{"id":"20240406114141-m4kq0b5","updated":"20240406114204"},"Children":[{"Type":"NodeText","Data":"torch.nn 是专门为神经网络设计的模块化接口"}]}]},{"ID":"20240406114205-64vtvio","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406114205-64vtvio"},"Children":[{"ID":"20240406114205-cwkz1lm","Type":"NodeParagraph","Properties":{"id":"20240406114205-cwkz1lm","updated":"20240406114227"},"Children":[{"Type":"NodeText","Data":"nn 构建于autograd之上，可以用来定义和运行神经网络"}]},{"ID":"20240406114228-qlukmia","Type":"NodeList","ListData":{},"Properties":{"id":"20240406114228-qlukmia","updated":"20240406114230"},"Children":[{"ID":"20240406114230-2e9tqhk","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406114230-2e9tqhk","updated":"20240406114230"},"Children":[{"ID":"20240406114230-eq3sm8t","Type":"NodeParagraph","Properties":{"id":"20240406114230-eq3sm8t","updated":"20240406114236"},"Children":[{"Type":"NodeText","Data":"nn.Parameter"}]}]},{"ID":"20240406114236-bb5vo5f","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406114236-bb5vo5f"},"Children":[{"ID":"20240406114236-moe3jcg","Type":"NodeParagraph","Properties":{"id":"20240406114236-moe3jcg","updated":"20240406114252"},"Children":[{"Type":"NodeText","Data":"nn.Linear\u0026nn.conv2d等等"}]}]},{"ID":"20240406114252-b2x49ua","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406114252-b2x49ua"},"Children":[{"ID":"20240406114252-5w3brbb","Type":"NodeParagraph","Properties":{"id":"20240406114252-5w3brbb","updated":"20240406114258"},"Children":[{"Type":"NodeText","Data":"nn.functional"}]}]},{"ID":"20240406114259-9kc5rs2","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406114259-9kc5rs2"},"Children":[{"ID":"20240406114259-1xvrb7r","Type":"NodeParagraph","Properties":{"id":"20240406114259-1xvrb7r","updated":"20240406114303"},"Children":[{"Type":"NodeText","Data":"nn.Module"}]}]},{"ID":"20240406114304-4xsxmwj","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406114304-4xsxmwj"},"Children":[{"ID":"20240406114304-on2h4vq","Type":"NodeParagraph","Properties":{"id":"20240406114304-on2h4vq","updated":"20240406114310"},"Children":[{"Type":"NodeText","Data":"nn.Sequential "}]}]}]}]}]},{"ID":"20240406114311-pm4nj9z","Type":"NodeParagraph","Properties":{"id":"20240406114311-pm4nj9z","updated":"20240406114313"}},{"ID":"20240406114113-19azbrm","Type":"NodeList","ListData":{},"Properties":{"id":"20240406114113-19azbrm","updated":"20240406140330"},"Children":[{"ID":"20240406114329-opirfmm","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406114329-opirfmm","updated":"20240406140330"},"Children":[{"ID":"20240406114329-ewglkuv","Type":"NodeParagraph","Properties":{"id":"20240406114329-ewglkuv","updated":"20240406114339"},"Children":[{"Type":"NodeText","Data":"nn.Parameter"}]},{"ID":"20240406114339-j5hl2ui","Type":"NodeList","ListData":{},"Properties":{"id":"20240406114339-j5hl2ui","updated":"20240406140330"},"Children":[{"ID":"20240406114341-g5s5xea","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406114341-g5s5xea","updated":"20240406114341"},"Children":[{"ID":"20240406114341-yk2fw4v","Type":"NodeParagraph","Properties":{"id":"20240406114341-yk2fw4v","updated":"20240406114349"},"Children":[{"Type":"NodeText","Data":"定义可训练参数"}]}]},{"ID":"20240406114350-aga1oc7","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406114350-aga1oc7"},"Children":[{"ID":"20240406114350-km7r9hz","Type":"NodeParagraph","Properties":{"id":"20240406114350-km7r9hz","updated":"20240406114409"},"Children":[{"Type":"NodeText","Data":"self.my_paran = nn.Parameter(torch.randn(1))"}]}]},{"ID":"20240406114409-w12o931","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406114409-w12o931"},"Children":[{"ID":"20240406114409-hmdfh92","Type":"NodeParagraph","Properties":{"id":"20240406114409-hmdfh92","updated":"20240406114420"},"Children":[{"Type":"NodeText","Data":"self.register_parameter"}]}]},{"ID":"20240406114420-mjmw1e5","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406114420-mjmw1e5","updated":"20240406140330"},"Children":[{"ID":"20240406114420-390r46t","Type":"NodeParagraph","Properties":{"id":"20240406114420-390r46t","updated":"20240406114435"},"Children":[{"Type":"NodeText","Data":"nn.ParameterList \u0026 nn.ParamenterDict"}]},{"ID":"20240406114545-u456qzs","Type":"NodeList","ListData":{},"Properties":{"id":"20240406114545-u456qzs","updated":"20240406140330"},"Children":[{"ID":"20240406114547-jnapr8x","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406114547-jnapr8x","updated":"20240406140330"},"Children":[{"ID":"20240406114547-thhc56f","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240406114547-thhc56f","updated":"20240406114721"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cHl0aG9u"},{"Type":"NodeCodeBlockCode","Data":"self.params = nn.ParameterList([nn.Parameter(torch.randn(10,10)) for i in range(10)])\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240406114654-i8pp8ee","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240406114654-i8pp8ee","updated":"20240406140330"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cHl0aG9u"},{"Type":"NodeCodeBlockCode","Data":"self.params = nn.ParameterDict({\n  'left': nn.Parameter(torch.randn(5,10)),\n  'right': nn.Parameter(torch.randn(5,10))\n})\u0026\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]}]}]}]}]},{"ID":"20240406140220-r5r4kwz","Type":"NodeList","ListData":{},"Properties":{"id":"20240406140220-r5r4kwz","updated":"20240406145527"},"Children":[{"ID":"20240406140310-mj6jxkb","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406140310-mj6jxkb","updated":"20240406145527"},"Children":[{"ID":"20240406140310-u5zied0","Type":"NodeParagraph","Properties":{"id":"20240406140310-u5zied0","updated":"20240406140407"},"Children":[{"Type":"NodeText","Data":"nn.Linear\u0026nn.conv2d\u0026nn.ReLU\u0026nn.MaxPool2d(2)\u0026nn.MSELoss 等"}]},{"ID":"20240406140408-l7alkgw","Type":"NodeList","ListData":{},"Properties":{"id":"20240406140408-l7alkgw","updated":"20240406145527"},"Children":[{"ID":"20240406140411-5jnwh4x","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406140411-5jnwh4x","updated":"20240406140411"},"Children":[{"ID":"20240406140411-ray0sq0","Type":"NodeParagraph","Properties":{"id":"20240406140411-ray0sq0","updated":"20240406140550"},"Children":[{"Type":"NodeText","Data":"各种神经网络层的定义，继承于nn.Module 的子类"}]},{"ID":"20240406140550-w3q89p8","Type":"NodeList","ListData":{},"Properties":{"id":"20240406140550-w3q89p8","updated":"20240406140552"},"Children":[{"ID":"20240406140552-latq6oy","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406140552-latq6oy","updated":"20240406140552"},"Children":[{"ID":"20240406140552-pvcpxg0","Type":"NodeParagraph","Properties":{"id":"20240406140552-pvcpxg0","updated":"20240406140617"},"Children":[{"Type":"NodeText","Data":"self.conv1 = nn.Conv2d(1,6,(5,5))"}]}]},{"ID":"20240406145334-3xh5ver","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406145334-3xh5ver"},"Children":[{"ID":"20240406145334-2uibz5u","Type":"NodeParagraph","Properties":{"id":"20240406145334-2uibz5u","updated":"20240406145348"},"Children":[{"Type":"NodeText","Data":"调用时： self.conv1(x)"}]}]}]}]},{"ID":"20240406145351-k2haohp","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406145351-k2haohp","updated":"20240406145527"},"Children":[{"ID":"20240406145351-iymguhi","Type":"NodeParagraph","Properties":{"id":"20240406145351-iymguhi","updated":"20240406145407"},"Children":[{"Type":"NodeText","Data":"参数为 parameter类型"}]},{"ID":"20240406145407-6tbv1xk","Type":"NodeList","ListData":{},"Properties":{"id":"20240406145407-6tbv1xk","updated":"20240406145527"},"Children":[{"ID":"20240406145410-nzlporr","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406145410-nzlporr","updated":"20240406145410"},"Children":[{"ID":"20240406145410-b0ndt7e","Type":"NodeParagraph","Properties":{"id":"20240406145410-b0ndt7e","updated":"20240406145420"},"Children":[{"Type":"NodeText","Data":"layer = nn.Linear(1,1)"}]}]},{"ID":"20240406145421-2ehmumt","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406145421-2ehmumt"},"Children":[{"ID":"20240406145421-0yva3c4","Type":"NodeParagraph","Properties":{"id":"20240406145421-0yva3c4","updated":"20240406145459"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"layer.weight = nn.Parameter(torch.FloatTensor([[0]])"},{"Type":"NodeText","Data":"​"}]}]},{"ID":"20240406145501-bumnptx","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406145501-bumnptx","updated":"20240406145527"},"Children":[{"ID":"20240406145501-p2dh31c","Type":"NodeParagraph","Properties":{"id":"20240406145501-p2dh31c","updated":"20240406145527"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"layer.bias = nn.Parameter(torch.FloatTensor([0))"},{"Type":"NodeText","Data":"​"}]}]}]}]}]}]}]},{"ID":"20240406145643-c20ocvl","Type":"NodeList","ListData":{},"Properties":{"id":"20240406145643-c20ocvl","updated":"20240406145645"},"Children":[{"ID":"20240406145645-3192zu8","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406145645-3192zu8","updated":"20240406145645"},"Children":[{"ID":"20240406145645-5klxzwi","Type":"NodeParagraph","Properties":{"id":"20240406145645-5klxzwi","updated":"20240406145650"},"Children":[{"Type":"NodeText","Data":"nn.functional"}]},{"ID":"20240406145651-bzyi758","Type":"NodeList","ListData":{},"Properties":{"id":"20240406145651-bzyi758","updated":"20240406145654"},"Children":[{"ID":"20240406145654-nw0xl2n","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406145654-nw0xl2n","updated":"20240406145654"},"Children":[{"ID":"20240406145654-6731k64","Type":"NodeParagraph","Properties":{"id":"20240406145654-6731k64","updated":"20240406145727"},"Children":[{"Type":"NodeText","Data":"包含 torch.nn 库中所有函数，包含大量loss 和 activation function"}]},{"ID":"20240406145728-0ft5dj6","Type":"NodeList","ListData":{},"Properties":{"id":"20240406145728-0ft5dj6","updated":"20240406145729"},"Children":[{"ID":"20240406145729-qwmgbbh","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406145729-qwmgbbh","updated":"20240406145729"},"Children":[{"ID":"20240406145729-c63bhmz","Type":"NodeParagraph","Properties":{"id":"20240406145729-c63bhmz","updated":"20240406145822"},"Children":[{"Type":"NodeText","Data":"torch.nn.functional.conv2d(input,weight,bias=None,stride=1,padding=0,dilation=1,groups=1)"}]}]}]}]},{"ID":"20240406145823-g0yv7t6","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406145823-g0yv7t6"},"Children":[{"ID":"20240406145823-9avg87t","Type":"NodeParagraph","Properties":{"id":"20240406145823-9avg87t","updated":"20240406145846"},"Children":[{"Type":"NodeText","Data":"nn.functional.xxx 是函数接口"}]}]},{"ID":"20240406145846-jn49u4t","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406145846-jn49u4t"},"Children":[{"ID":"20240406145846-ib2pbv3","Type":"NodeParagraph","Properties":{"id":"20240406145846-ib2pbv3","updated":"20240406145909"},"Children":[{"Type":"NodeText","Data":"nn.functional.xxx 无法与 nn.Sequential 结合使用"}]}]},{"ID":"20240406145909-v69zj93","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406145909-v69zj93"},"Children":[{"ID":"20240406145909-9k51ff6","Type":"NodeParagraph","Properties":{"id":"20240406145909-9k51ff6","updated":"20240406150002"},"Children":[{"Type":"NodeText","Data":"没有学习参数的(eg.maxpool, loss_func,activation func ) 等根据个人选择使用 nn.functional.xxx 或 nn.Xxx"}]}]},{"ID":"20240406150002-7wvxymc","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406150002-7wvxymc"},"Children":[{"ID":"20240406150002-5ju6s8j","Type":"NodeParagraph","Properties":{"id":"20240406150002-5ju6s8j","updated":"20240406150036"},"Children":[{"Type":"NodeText","Data":"需要特别注意dropout 层 训练 推理"}]}]}]}]}]},{"ID":"20240406150126-z5rp93a","Type":"NodeList","ListData":{},"Properties":{"id":"20240406150126-z5rp93a","updated":"20240406150126"},"Children":[{"ID":"20240406150126-pfnn05r","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406150126-pfnn05r","updated":"20240406150126"},"Children":[{"ID":"20240406150116-0wnkg9y","Type":"NodeParagraph","Properties":{"id":"20240406150116-0wnkg9y","updated":"20240406150146"},"Children":[{"Type":"NodeText","Data":"nn 与 nn.functional 有什么区别？"}]},{"ID":"20240406150147-wv4y5m6","Type":"NodeList","ListData":{},"Properties":{"id":"20240406150147-wv4y5m6","updated":"20240406150148"},"Children":[{"ID":"20240406150148-kazx4fp","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406150148-kazx4fp","updated":"20240406150148"},"Children":[{"ID":"20240406150148-awhv90q","Type":"NodeParagraph","Properties":{"id":"20240406150148-awhv90q","updated":"20240406150158"},"Children":[{"Type":"NodeText","Data":"nn.functional.xxx 是函数接口"}]}]},{"ID":"20240406150159-n6hbxv7","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406150159-n6hbxv7"},"Children":[{"ID":"20240406150159-zlydpyx","Type":"NodeParagraph","Properties":{"id":"20240406150159-zlydpyx","updated":"20240406150243"},"Children":[{"Type":"NodeText","Data":"nn.Xxx 是 .nn.functional.xxx 的类封装，并且 nn.Xxx 都继承于一个共同祖先 nn.Module"}]}]},{"ID":"20240406150246-9s1fq3p","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406150246-9s1fq3p"},"Children":[{"ID":"20240406150246-2hingie","Type":"NodeParagraph","Properties":{"id":"20240406150246-2hingie","updated":"20240406150356"},"Children":[{"Type":"NodeText","Data":"nn.Xxx 除了具有 nn.functional.xxx 功能之外，内部附带 nn.Module 相关的属性和方法， eg.train(), eval(), load_state_dict ,state_dict"}]}]}]}]}]},{"ID":"20240406150401-bo4outh","Type":"NodeList","ListData":{},"Properties":{"id":"20240406150401-bo4outh","updated":"20240406150755"},"Children":[{"ID":"20240406150405-ulldqu6","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406150405-ulldqu6","updated":"20240406150755"},"Children":[{"ID":"20240406150405-8nol0yg","Type":"NodeParagraph","Properties":{"id":"20240406150405-8nol0yg","updated":"20240406150414"},"Children":[{"Type":"NodeText","Data":"nn.Sequential "}]},{"ID":"20240406150415-ikya43h","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240406150415-ikya43h","updated":"20240406150755"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cHl0aG9u"},{"Type":"NodeCodeBlockCode","Data":"# example of using Sequential\n# 串联\nmodel = nn.Sequential(\n                    nn.Conv2d(1,20,5),\n                    nn.ReLU(),\n                    nn.Conv2d(20,64,5),\n                    nn.ReLU()\n                  )\n\n# Example of using Sequential with OrderedDict\nmodel = nn.Sequential(OrderedDict([\n                                          ('conv1', nn.Conv2d(1,20,5)),\n                                          ('relu1', nn.ReLU()),\n                                          ('conv2', nn.Conv2d(20,64,5)),\n                                          ('relu2', nn.ReLU())\n ]))\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20240406150924-faqmtyz","Type":"NodeList","ListData":{},"Properties":{"id":"20240406150924-faqmtyz","updated":"20240406151256"},"Children":[{"ID":"20240406150927-yarc7zr","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406150927-yarc7zr","updated":"20240406150927"},"Children":[{"ID":"20240406150927-87ciur2","Type":"NodeParagraph","Properties":{"id":"20240406150927-87ciur2","updated":"20240406150933"},"Children":[{"Type":"NodeText","Data":"nn.ModuelList"}]}]},{"ID":"20240406150933-6t8xhta","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406150933-6t8xhta","updated":"20240406151256"},"Children":[{"ID":"20240406150933-owd6ioa","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240406150933-owd6ioa","updated":"20240406151256"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cHl0aG9u"},{"Type":"NodeCodeBlockCode","Data":"class MyModule(nn.Module):\n    def __init__(self):\n          super(MyModel, self).__init__()\n          self.linears = nn.ModuleList([nn.Linear(10, 10)  for i in range(10)])\n      \n   def forward(self, x):\n          # ModuleList can act as an iterable, or be indexed using ints\n          for i, l in enumerate(self.linears):\n              x = self.linears[i//2](x) + l(x)\n          return x\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}]},{"ID":"20240406151521-wdwidmm","Type":"NodeList","ListData":{},"Properties":{"id":"20240406151521-wdwidmm","updated":"20240406151532"},"Children":[{"ID":"20240406151522-87vz27o","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240406151522-87vz27o","updated":"20240406151532"},"Children":[{"ID":"20240406151522-gll5e9o","Type":"NodeParagraph","Properties":{"id":"20240406151522-gll5e9o","updated":"20240406151532"},"Children":[{"Type":"NodeText","Data":"nn.ModuleDict"}]}]}]},{"ID":"20240406152552-8u7o0cn","Type":"NodeParagraph","Properties":{"id":"20240406152552-8u7o0cn"}}]}