{"ID":"20230724003358-vu3djje","Spec":"1","Type":"NodeDocument","Properties":{"id":"20230724003358-vu3djje","title":"5. samba","updated":"20230724003358"},"Children":[{"ID":"20230724003359-izcgx98","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20230724003359-izcgx98","updated":"20230724003359"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"# ","Properties":{"id":""}},{"Type":"NodeText","Data":"5. Samba"}]},{"ID":"20230724003360-zuy7yv9","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20230724003360-zuy7yv9","updated":"20230724003360"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"1.安装服务端必需的软件"}]},{"ID":"20230724003361-6oohqb9","Type":"NodeParagraph","Properties":{"id":"20230724003361-6oohqb9","updated":"20230724003361"},"Children":[{"Type":"NodeText","Data":"yum install samba samba-client samba-common"}]},{"ID":"20230724003362-yfb8sp0","Type":"NodeList","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230724003362-yfb8sp0","updated":"20230724003362"},"Children":[{"ID":"20230724003363-itzcgz5","Type":"NodeListItem","Data":"-","ListData":{"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230724003363-itzcgz5","updated":"20230724003363"},"Children":[{"ID":"20230724003364-9wyo9j4","Type":"NodeParagraph","Properties":{"id":"20230724003364-9wyo9j4","updated":"20230724003364"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"amba"},{"Type":"NodeText","Data":"： 这个软体主要提供了SMB 服务器所需的各项服务程序(smbd 及nmbd)、 的文件、以及其他与SAMBA 相关的logrotate 配置文件及开机默认选项文件等；"}]}]},{"ID":"20230724003365-zhzwe8o","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230724003365-zhzwe8o","updated":"20230724003365"},"Children":[{"ID":"20230724003366-8z2ln2z","Type":"NodeParagraph","Properties":{"id":"20230724003366-8z2ln2z","updated":"20230724003366"},"Children":[{"Type":"NodeText","Data":"samba-client： 这个软体则提供了当Linux 做为SAMBA Client 端时，所需要的工具指令，例如挂载SAMBA 文件格式的mount.cifs、 取得类似网芳相关树状图的smbtree 等等；"}]}]},{"ID":"20230724003367-imnb10r","Type":"NodeListItem","Data":"-","ListData":{"Tight":true,"BulletChar":45,"Padding":2,"Marker":"LQ==","Num":-1},"Properties":{"id":"20230724003367-imnb10r","updated":"20230724003367"},"Children":[{"ID":"20230724003368-4mxz9xv","Type":"NodeParagraph","Properties":{"id":"20230724003368-4mxz9xv","updated":"20230724003368"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"samba-common"},{"Type":"NodeText","Data":"： 这个软体提供的则是服务器与用户端都会使用到的资料，包括SAMBA 的主要配置文件(smb.conf)、语法检验指令(testparm) 等等；"}]}]}]},{"ID":"20230724003369-iwfz02e","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20230724003369-iwfz02e","updated":"20230724003369"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"2. 常用的配置文件"}]},{"ID":"20230724003370-e70j3s0","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724003370-e70j3s0","updated":"20230724003370"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"/etc/samba/smb.conf"},{"Type":"NodeText","Data":"："}]},{"ID":"20230724003371-71f2uz4","Type":"NodeParagraph","Properties":{"id":"20230724003371-71f2uz4","updated":"20230724003371"},"Children":[{"Type":"NodeText","Data":"这是Samba 的主要配置文件，基本上，咱们的Samba 就仅有这个配置文件而已，且这个配置文件本身就是很详细的说明文件了，请用 vim 去查阅它吧！"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"主要的设定项目分为服务器的相关设定(global)，如工作群组、NetBIOS 名称与密码等级等， 以及分享的目录等相关设定，如实际目录、分享资源名称与权限等等两大部分。"}]},{"ID":"20230724003372-5lxhvrc","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724003372-5lxhvrc","updated":"20230724003372"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"/etc/samba/lmhosts："}]},{"ID":"20230724003373-c711es5","Type":"NodeParagraph","Properties":{"id":"20230724003373-c711es5","updated":"20230724003373"},"Children":[{"Type":"NodeText","Data":"早期的NetBIOS name 需额外设定，因此需要这个lmhosts 的NetBIOS name 对应的IP档。事实上它有点像是/etc/hosts 的功能！只不过这个lmhosts 对应的主机名称是NetBIOS name 喔！不要跟/etc/hosts 搞混了！"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"目前Samba 预设会去使用你的本机名称(hostname) 作为你的NetBIOS name，因此这个文件不设定也无所谓。"}]},{"ID":"20230724003374-6v1zz1i","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724003374-6v1zz1i","updated":"20230724003374"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"/etc/sysconfig/samba："}]},{"ID":"20230724003375-pzs91px","Type":"NodeParagraph","Properties":{"id":"20230724003375-pzs91px","updated":"20230724003375"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"提供启动smbd, nmbd 时，你还想要加入的相关服务参数。"}]},{"ID":"20230724003376-fvd74q8","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724003376-fvd74q8","updated":"20230724003376"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"/etc/samba/smbusers："}]},{"ID":"20230724003377-9zpaqnl","Type":"NodeParagraph","Properties":{"id":"20230724003377-9zpaqnl","updated":"20230724003377"},"Children":[{"Type":"NodeText","Data":"由于Windows 与Linux 在管理员与访客的帐号名称不一致，例如： administrator (windows) 及root(linux)， 为了对应这两者之间的帐号关系，可使用这个文件来设定"}]},{"ID":"20230724003378-j417jn4","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724003378-j417jn4","updated":"20230724003378"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"/var/lib/samba/private/{passdb.tdb,secrets.tdb}："}]},{"ID":"20230724003379-1iienuu","Type":"NodeParagraph","Properties":{"id":"20230724003379-1iienuu","updated":"20230724003379"},"Children":[{"Type":"NodeText","Data":"管理Samba 的使用者帐号/密码时，会用到的数据库文件；"}]},{"ID":"20230724003380-eti1exj","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724003380-eti1exj","updated":"20230724003380"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"/usr/share/doc/samba-\u003c版本\u003e"}]},{"ID":"20230724003381-i8gjckq","Type":"NodeParagraph","Properties":{"id":"20230724003381-i8gjckq","updated":"20230724003381"},"Children":[{"Type":"NodeText","Data":"这个目录包含了SAMBA 的所有相关的技术手册喔！也就是说，当你安装好了SAMBA 之后，你的系统里面就已经含有相当丰富而完整的 SAMBA 使用手册了！值得高兴吧！"},{"Type":"NodeSup","Children":[{"Type":"NodeSupOpenMarker","Data":"^"},{"Type":"NodeText","Data":"_"},{"Type":"NodeSupCloseMarker","Data":"^"}]},{"Type":"NodeText","Data":"，所以，赶紧自行参考喔！"}]},{"ID":"20230724003382-1qwt27t","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724003382-1qwt27t","updated":"20230724003382"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"至于常用的指令文件方面，若分为服务器与用户端功能，则主要有底下这几个资料："}]},{"ID":"20230724003383-06rt04w","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724003383-06rt04w","updated":"20230724003383"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"/usr/sbin/{smbd,nmbd}"}]},{"ID":"20230724003384-ey8jlze","Type":"NodeParagraph","Properties":{"id":"20230724003384-ey8jlze","updated":"20230724003384"},"Children":[{"Type":"NodeText","Data":"服务器功能，就是最重要的权限管理(smbd) 以及 NetBIOS name 查询(nmbd) 两个重要的服务程式；"}]},{"ID":"20230724003385-h1jlest","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724003385-h1jlest","updated":"20230724003385"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"/usr/bin/{tdbdump,tdbtool}"}]},{"ID":"20230724003386-1svnlbo","Type":"NodeParagraph","Properties":{"id":"20230724003386-1svnlbo","updated":"20230724003386"},"Children":[{"Type":"NodeText","Data":"服务器功能，在Samba 3.0 以后的版本中，"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"使用者的帐号与密码参数已经转为使用数据库了"},{"Type":"NodeText","Data":"！Samba 使用的数据库名称为TDB (Trivial DataBase)。既然是使用数据库，当然要使用数据库的控制指令来处理啰。"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"tdbdump 可以察看数据库的内容，tdbtool 则可以进入数据库操作介面直接手动修改帐密参数。不过，你得要安装tdb-tools 这个软体才行；"}]},{"ID":"20230724003387-va0949w","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724003387-va0949w","updated":"20230724003387"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"/usr/bin/smbstatus"}]},{"ID":"20230724003388-h5bl7ba","Type":"NodeParagraph","Properties":{"id":"20230724003388-h5bl7ba","updated":"20230724003388"},"Children":[{"Type":"NodeText","Data":"服务器功能，可以列出目前Samba 的连线状况， 包括每一条Samba 连线的PID, 分享的资源，使用的用户来源等等，让你轻松管理Samba 啦；"}]},{"ID":"20230724003389-68rlzhb","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724003389-68rlzhb","updated":"20230724003389"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"/usr/bin/{smbpasswd,pdbedit}"}]},{"ID":"20230724003390-4rdawu6","Type":"NodeParagraph","Properties":{"id":"20230724003390-4rdawu6","updated":"20230724003390"},"Children":[{"Type":"NodeText","Data":"服务器功能，在管理Samba 的使用者帐号密码时， 早期是使用smbpasswd 这个指令，不过因为后来使用TDB 数据库了，因此"},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"建议使用新的pdbedit 指令来管理用户资料；"}]},{"ID":"20230724003391-3jfzdy6","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724003391-3jfzdy6","updated":"20230724003391"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"/usr/bin/testparm"}]},{"ID":"20230724003392-2mbwopk","Type":"NodeParagraph","Properties":{"id":"20230724003392-2mbwopk","updated":"20230724003392"},"Children":[{"Type":"NodeText","Data":"服务器功能，这个指令主要在检验配置文件smb.conf 的语法正确与否，当你编辑过smb.conf 时，请务必使用这个指令来检查一次，避免因为打字错误引起的困扰啊！"}]},{"ID":"20230724003393-0hrv7rt","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724003393-0hrv7rt","updated":"20230724003393"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"/sbin/mount.cifs"}]},{"ID":"20230724003394-8bjk4lv","Type":"NodeParagraph","Properties":{"id":"20230724003394-8bjk4lv","updated":"20230724003394"},"Children":[{"Type":"NodeText","Data":"用户端功能，在Windows 上面我们可以设定『网路驱动器』来连接到自己的主机上面。在Linux 上面，我们则是透过mount (mount.cifs) 来将远端主机分享的文件与目录挂载到自己的Linux 主机上面哪！"}]},{"ID":"20230724003395-df2vdcj","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724003395-df2vdcj","updated":"20230724003395"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"strong","TextMarkTextContent":"/usr/bin/smbclient"}]},{"ID":"20230724003396-cov4qe3","Type":"NodeParagraph","Properties":{"id":"20230724003396-cov4qe3","updated":"20230724003396"},"Children":[{"Type":"NodeText","Data":"用户端功能，当你的Linux 主机想要通过『网上邻居』的功能来查看别台电脑所分享出来的目录与装置时，就可以使用smbclient 来查看啦！这个指令也可以使用在自己的SAMBA 主机上面，用来查看是否设定成功哩！"}]},{"ID":"20230724003397-12r0so9","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724003397-12r0so9","updated":"20230724003397"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"/usr/bin/nmblookup："}]},{"ID":"20230724003398-alg56h4","Type":"NodeParagraph","Properties":{"id":"20230724003398-alg56h4","updated":"20230724003398"},"Children":[{"Type":"NodeText","Data":"用户端功能，有点类似nslookup 啦！重点在查出 NetBIOS name 就是了。"}]},{"ID":"20230724003399-fjjcusn","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724003399-fjjcusn","updated":"20230724003399"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"/usr/bin/smbtree："}]},{"ID":"20230724003400-zs2botl","Type":"NodeParagraph","Properties":{"id":"20230724003400-zs2botl","updated":"20230724003400"},"Children":[{"Type":"NodeText","Data":"用户端功能，这玩意就有点像Windows 系统的网上邻居显示的结果，可以显示类似『靠近我的电脑』之类的资料， 能够查到工作群组与电脑名称的树状目录分布图！"}]}]}