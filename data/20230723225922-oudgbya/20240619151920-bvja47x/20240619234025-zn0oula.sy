{"ID":"20240619234025-zn0oula","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f9cb","id":"20240619234025-zn0oula","title":"Go语言主流ORM框架对比：GORM vs. Ent","type":"doc","updated":"20240619234044"},"Children":[{"ID":"20240619234044-2kneuy1","Type":"NodeParagraph","Properties":{"id":"20240619234044-2kneuy1","updated":"20240619234044"},"Children":[{"Type":"NodeText","Data":"GORM和Ent是Go语言中使用广泛的两种ORM（对象关系映射）框架。它们都有助于将数据库操作从底层SQL抽象出来，简化数据库交互，但它们的设计理念和使用方式有显著的不同。本文将详细介绍GORM和Ent的不同特点、使用示例，并比较它们在不同场景下的优劣。"}]},{"ID":"20240619234044-is6zoc7","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240619234044-is6zoc7","updated":"20240619234044"},"Children":[{"Type":"NodeText","Data":"GORM简介"}]},{"ID":"20240619234044-hn7d6bl","Type":"NodeParagraph","Properties":{"id":"20240619234044-hn7d6bl","updated":"20240619234045"},"Children":[{"Type":"NodeText","Data":"GORM是一个易于使用的ORM库，旨在提供简单、干净的API。它通过反射机制动态处理数据库操作，支持多种数据库驱动，如MySQL、PostgreSQL、SQLite等。"}]},{"ID":"20240619234044-cvbobul","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240619234044-cvbobul","updated":"20240619234045"},"Children":[{"Type":"NodeText","Data":"GORM的主要特点"}]},{"ID":"20240619234044-jarzfik","Type":"NodeList","ListData":{},"Properties":{"id":"20240619234044-jarzfik","updated":"20240619234045"},"Children":[{"ID":"20240619234044-bgyz8aw","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240619234044-bgyz8aw","updated":"20240619234044"},"Children":[{"ID":"20240619234044-br9hrh6","Type":"NodeParagraph","Properties":{"id":"20240619234044-br9hrh6","updated":"20240619234044"},"Children":[{"Type":"NodeTextMark","TextMarkType":"em","TextMarkTextContent":"简洁易用"},{"Type":"NodeText","Data":"：API设计直观，支持链式操作。"}]}]},{"ID":"20240619234044-e77jq3l","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240619234044-e77jq3l","updated":"20240619234044"},"Children":[{"ID":"20240619234044-pfve0ez","Type":"NodeParagraph","Properties":{"id":"20240619234044-pfve0ez","updated":"20240619234044"},"Children":[{"Type":"NodeTextMark","TextMarkType":"em","TextMarkTextContent":"自动迁移"},{"Type":"NodeText","Data":"：可以自动生成和维护数据库表结构。"}]}]},{"ID":"20240619234044-wth3vtw","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240619234044-wth3vtw","updated":"20240619234044"},"Children":[{"ID":"20240619234044-nmp0slr","Type":"NodeParagraph","Properties":{"id":"20240619234044-nmp0slr","updated":"20240619234044"},"Children":[{"Type":"NodeTextMark","TextMarkType":"em","TextMarkTextContent":"多数据库支持"},{"Type":"NodeText","Data":"：支持主流关系数据库。"}]}]},{"ID":"20240619234044-ct4275c","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240619234044-ct4275c","updated":"20240619234044"},"Children":[{"ID":"20240619234044-kkcnz6o","Type":"NodeParagraph","Properties":{"id":"20240619234044-kkcnz6o","updated":"20240619234044"},"Children":[{"Type":"NodeTextMark","TextMarkType":"em","TextMarkTextContent":"丰富的功能"},{"Type":"NodeText","Data":"：包括预加载、事务、钩子、软删除等。"}]}]},{"ID":"20240619234044-r2y9u70","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240619234044-r2y9u70","updated":"20240619234044"},"Children":[{"ID":"20240619234044-nkh66te","Type":"NodeParagraph","Properties":{"id":"20240619234044-nkh66te","updated":"20240619234044"},"Children":[{"Type":"NodeTextMark","TextMarkType":"em","TextMarkTextContent":"活跃的社区"},{"Type":"NodeText","Data":"：有丰富的文档和社区支持。"}]}]}]},{"ID":"20240619234044-jqdpscw","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240619234044-jqdpscw","updated":"20240619234045"},"Children":[{"Type":"NodeText","Data":"GORM使用示例"}]},{"ID":"20240619234044-6x88igf","Type":"NodeParagraph","Properties":{"id":"20240619234044-6x88igf","updated":"20240619234045"},"Children":[{"Type":"NodeText","Data":"以下是一个使用GORM的简单示例，展示了如何定义模型、连接数据库、执行CRUD操作。"}]},{"ID":"20240619234044-avmuvxd","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240619234044-avmuvxd","updated":"20240619234045"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"package main\n\nimport (\n    \"gorm.io/driver/sqlite\"\n    \"gorm.io/gorm\"\n)\n\n// 定义模型\ntype User struct {\n    ID    uint   `gorm:\"primaryKey\"`\n    Name  string\n    Email string\n}\n\nfunc main() {\n    // 连接数据库\n    db, err := gorm.Open(sqlite.Open(\"test.db\"), \u0026gorm.Config{})\n    if err != nil {\n        panic(\"failed to connect database\")\n    }\n\n    // 自动迁移\n    db.AutoMigrate(\u0026User{})\n\n    // 创建\n    db.Create(\u0026User{Name: \"John\", Email: \"john@example.com\"})\n\n    // 读取\n    var user User\n    db.First(\u0026user, 1) // 根据主键查询\n    db.First(\u0026user, \"name = ?\", \"John\") // 根据条件查询\n\n    // 更新\n    db.Model(\u0026user).Update(\"Email\", \"john_updated@example.com\")\n\n    // 删除\n    db.Delete(\u0026user, 1)\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240619234044-qq0z6fn","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240619234044-qq0z6fn","updated":"20240619234044"},"Children":[{"Type":"NodeText","Data":"Ent简介"}]},{"ID":"20240619234044-4t5dtdv","Type":"NodeParagraph","Properties":{"id":"20240619234044-4t5dtdv","updated":"20240619234045"},"Children":[{"Type":"NodeText","Data":"Ent是Facebook开源的一个图数据库框架，后来扩展为支持关系型数据库。Ent采用基于代码生成的方式，通过定义数据模型来生成类型安全的API，避免了运行时错误。"}]},{"ID":"20240619234044-ckesiz7","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240619234044-ckesiz7","updated":"20240619234045"},"Children":[{"Type":"NodeText","Data":"Ent的主要特点"}]},{"ID":"20240619234044-yr7idx3","Type":"NodeList","ListData":{},"Properties":{"id":"20240619234044-yr7idx3","updated":"20240619234045"},"Children":[{"ID":"20240619234044-eo5izmu","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240619234044-eo5izmu","updated":"20240619234044"},"Children":[{"ID":"20240619234044-85hfx8u","Type":"NodeParagraph","Properties":{"id":"20240619234044-85hfx8u","updated":"20240619234044"},"Children":[{"Type":"NodeTextMark","TextMarkType":"em","TextMarkTextContent":"类型安全"},{"Type":"NodeText","Data":"：通过代码生成保证类型安全，避免运行时错误。"}]}]},{"ID":"20240619234044-x42g24u","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240619234044-x42g24u","updated":"20240619234044"},"Children":[{"ID":"20240619234044-9x5zz21","Type":"NodeParagraph","Properties":{"id":"20240619234044-9x5zz21","updated":"20240619234044"},"Children":[{"Type":"NodeTextMark","TextMarkType":"em","TextMarkTextContent":"高性能"},{"Type":"NodeText","Data":"：生成的代码优化良好，性能优越。"}]}]},{"ID":"20240619234044-e2d2a9i","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240619234044-e2d2a9i","updated":"20240619234044"},"Children":[{"ID":"20240619234044-61qkg10","Type":"NodeParagraph","Properties":{"id":"20240619234044-61qkg10","updated":"20240619234044"},"Children":[{"Type":"NodeTextMark","TextMarkType":"em","TextMarkTextContent":"灵活的查询"},{"Type":"NodeText","Data":"：提供强大的查询"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"DSL"},{"Type":"NodeText","Data":"（领域特定语言）。"}]}]},{"ID":"20240619234044-zlof0eb","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240619234044-zlof0eb","updated":"20240619234044"},"Children":[{"ID":"20240619234044-6t4bufx","Type":"NodeParagraph","Properties":{"id":"20240619234044-6t4bufx","updated":"20240619234044"},"Children":[{"Type":"NodeTextMark","TextMarkType":"em","TextMarkTextContent":"模式迁移"},{"Type":"NodeText","Data":"：支持数据库表结构的自动迁移。"}]}]},{"ID":"20240619234044-i99xtpf","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240619234044-i99xtpf","updated":"20240619234044"},"Children":[{"ID":"20240619234044-pkiekrz","Type":"NodeParagraph","Properties":{"id":"20240619234044-pkiekrz","updated":"20240619234044"},"Children":[{"Type":"NodeTextMark","TextMarkType":"em","TextMarkTextContent":"良好的可扩展性"},{"Type":"NodeText","Data":"：通过插件机制可以轻松扩展。"}]}]}]},{"ID":"20240619234044-yv0xqpm","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240619234044-yv0xqpm","updated":"20240619234045"},"Children":[{"Type":"NodeText","Data":"Ent使用示例"}]},{"ID":"20240619234044-db64t3p","Type":"NodeParagraph","Properties":{"id":"20240619234044-db64t3p","updated":"20240619234045"},"Children":[{"Type":"NodeText","Data":"以下是一个使用Ent的简单示例，展示了如何定义模型、连接数据库、执行CRUD操作。"}]},{"ID":"20240619234044-vkwpnkf","Type":"NodeParagraph","Properties":{"id":"20240619234044-vkwpnkf","updated":"20240619234045"},"Children":[{"Type":"NodeText","Data":"首先，需要安装Ent的工具："}]},{"ID":"20240619234044-x9pbwz6","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240619234044-x9pbwz6","updated":"20240619234045"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"go get entgo.io/ent/cmd/ent\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240619234044-6g0meno","Type":"NodeParagraph","Properties":{"id":"20240619234044-6g0meno","updated":"20240619234045"},"Children":[{"Type":"NodeText","Data":"然后，使用Ent生成代码："}]},{"ID":"20240619234044-epoy7fj","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240619234044-epoy7fj","updated":"20240619234045"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"// ent/schema/user.go\npackage schema\n\nimport \"entgo.io/ent\"\n\n// 定义User模型\ntype User struct {\n    ent.Schema\n}\n\nfunc (User) Fields() []ent.Field {\n    return []ent.Field{\n        field.String(\"name\"),\n        field.String(\"email\"),\n    }\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240619234044-a4dwrpu","Type":"NodeParagraph","Properties":{"id":"20240619234044-a4dwrpu","updated":"20240619234045"},"Children":[{"Type":"NodeText","Data":"生成代码："}]},{"ID":"20240619234044-w73wmka","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240619234044-w73wmka","updated":"20240619234045"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"go generate ./ent\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240619234044-7n2ci20","Type":"NodeParagraph","Properties":{"id":"20240619234044-7n2ci20","updated":"20240619234045"},"Children":[{"Type":"NodeText","Data":"使用生成的代码进行数据库操作："}]},{"ID":"20240619234044-webb95t","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240619234044-webb95t","updated":"20240619234045"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"package main\n\nimport (\n    \"context\"\n    \"log\"\n\n    \"entgo.io/ent/examples/start/ent\"\n    _ \"github.com/mattn/go-sqlite3\"\n)\n\nfunc main() {\n    // 连接数据库\n    client, err := ent.Open(\"sqlite3\", \"file:ent?mode=memory\u0026cache=shared\u0026_fk=1\")\n    if err != nil {\n        log.Fatalf(\"failed opening connection to sqlite: %v\", err)\n    }\n    defer client.Close()\n\n    ctx := context.Background()\n\n    // 迁移数据库模式\n    if err := client.Schema.Create(ctx); err != nil {\n        log.Fatalf(\"failed creating schema resources: %v\", err)\n    }\n\n    // 创建User\n    user, err := client.User.Create().\n        SetName(\"John\").\n        SetEmail(\"john@example.com\").\n        Save(ctx)\n    if err != nil {\n        log.Fatalf(\"failed creating user: %v\", err)\n    }\n\n    log.Println(\"user created:\", user)\n\n    // 读取User\n    user, err = client.User.Get(ctx, user.ID)\n    if err != nil {\n        log.Fatalf(\"failed getting user: %v\", err)\n    }\n\n    log.Println(\"user found:\", user)\n\n    // 更新User\n    user, err = user.Update().\n        SetEmail(\"john_updated@example.com\").\n        Save(ctx)\n    if err != nil {\n        log.Fatalf(\"failed updating user: %v\", err)\n    }\n\n    log.Println(\"user updated:\", user)\n\n    // 删除User\n    err = client.User.DeleteOne(user).Exec(ctx)\n    if err != nil {\n        log.Fatalf(\"failed deleting user: %v\", err)\n    }\n\n    log.Println(\"user deleted\")\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240619234044-7mbi1pq","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240619234044-7mbi1pq","updated":"20240619234044"},"Children":[{"Type":"NodeText","Data":"GORM与Ent的对比"}]},{"ID":"20240619234044-62fjj9o","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240619234044-62fjj9o","updated":"20240619234045"},"Children":[{"Type":"NodeText","Data":"开发体验"}]},{"ID":"20240619234044-99mdjmd","Type":"NodeList","ListData":{},"Properties":{"id":"20240619234044-99mdjmd","updated":"20240619234045"},"Children":[{"ID":"20240619234044-she5434","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240619234044-she5434","updated":"20240619234044"},"Children":[{"ID":"20240619234044-ka26q4f","Type":"NodeParagraph","Properties":{"id":"20240619234044-ka26q4f","updated":"20240619234044"},"Children":[{"Type":"NodeText","Data":"GORM的API设计直观，容易上手，但由于大量使用反射，在代码中难以避免运行时错误。"}]}]},{"ID":"20240619234044-qwdwxmw","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240619234044-qwdwxmw","updated":"20240619234044"},"Children":[{"ID":"20240619234044-535mfrr","Type":"NodeParagraph","Properties":{"id":"20240619234044-535mfrr","updated":"20240619234044"},"Children":[{"Type":"NodeText","Data":"Ent依靠代码生成，提供类型安全的API，代码更具可读性和可维护性，但上手成本较高。"}]}]}]},{"ID":"20240619234044-1ccc7zs","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240619234044-1ccc7zs","updated":"20240619234045"},"Children":[{"Type":"NodeText","Data":"性能"}]},{"ID":"20240619234044-3aw5gs1","Type":"NodeList","ListData":{},"Properties":{"id":"20240619234044-3aw5gs1","updated":"20240619234045"},"Children":[{"ID":"20240619234044-t3ursxc","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240619234044-t3ursxc","updated":"20240619234044"},"Children":[{"ID":"20240619234044-ikkoyj5","Type":"NodeParagraph","Properties":{"id":"20240619234044-ikkoyj5","updated":"20240619234044"},"Children":[{"Type":"NodeText","Data":"GORM的性能在大多数场景下是足够的，但由于使用了反射，性能在某些高要求的场景下可能会受限。"}]}]},{"ID":"20240619234044-mmyd3q9","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240619234044-mmyd3q9","updated":"20240619234044"},"Children":[{"ID":"20240619234044-imsvhp0","Type":"NodeParagraph","Properties":{"id":"20240619234044-imsvhp0","updated":"20240619234044"},"Children":[{"Type":"NodeText","Data":"Ent生成的代码经过优化，性能优越，适合对性能有较高要求的场景。"}]}]}]},{"ID":"20240619234044-vhsgbwr","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240619234044-vhsgbwr","updated":"20240619234045"},"Children":[{"Type":"NodeText","Data":"灵活性"}]},{"ID":"20240619234044-6pjn04i","Type":"NodeList","ListData":{},"Properties":{"id":"20240619234044-6pjn04i","updated":"20240619234045"},"Children":[{"ID":"20240619234044-77ql2h2","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240619234044-77ql2h2","updated":"20240619234044"},"Children":[{"ID":"20240619234044-x48mbuh","Type":"NodeParagraph","Properties":{"id":"20240619234044-x48mbuh","updated":"20240619234044"},"Children":[{"Type":"NodeText","Data":"GORM支持多种数据库驱动和复杂的查询操作，适应范围广泛。"}]}]},{"ID":"20240619234044-xyefy5c","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240619234044-xyefy5c","updated":"20240619234044"},"Children":[{"ID":"20240619234044-og9cxy3","Type":"NodeParagraph","Properties":{"id":"20240619234044-og9cxy3","updated":"20240619234044"},"Children":[{"Type":"NodeText","Data":"Ent专注于类型安全和性能，通过插件机制也能提供足够的灵活性。"}]}]}]},{"ID":"20240619234044-z39ju6k","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240619234044-z39ju6k","updated":"20240619234045"},"Children":[{"Type":"NodeText","Data":"社区和生态"}]},{"ID":"20240619234044-7lhai6p","Type":"NodeList","ListData":{},"Properties":{"id":"20240619234044-7lhai6p","updated":"20240619234045"},"Children":[{"ID":"20240619234044-tgctll3","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240619234044-tgctll3","updated":"20240619234044"},"Children":[{"ID":"20240619234044-5nu3dim","Type":"NodeParagraph","Properties":{"id":"20240619234044-5nu3dim","updated":"20240619234044"},"Children":[{"Type":"NodeText","Data":"GORM拥有庞大的用户群体和丰富的文档，非常活跃的社区支持。"}]}]},{"ID":"20240619234044-0nx566s","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240619234044-0nx566s","updated":"20240619234044"},"Children":[{"ID":"20240619234044-92clzdq","Type":"NodeParagraph","Properties":{"id":"20240619234044-92clzdq","updated":"20240619234044"},"Children":[{"Type":"NodeText","Data":"Ent相对较新，但由于背靠Facebook，社区和文档也在快速发展。"}]}]}]},{"ID":"20240619234044-a1mbtb6","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240619234044-a1mbtb6","updated":"20240619234044"},"Children":[{"Type":"NodeText","Data":"结论"}]},{"ID":"20240619234044-k365edt","Type":"NodeParagraph","Properties":{"id":"20240619234044-k365edt","updated":"20240619234045"},"Children":[{"Type":"NodeText","Data":"在选择GORM与Ent时，开发者需根据具体项目需求进行权衡。如果你需要一个易于上手、功能强大的ORM，并且社区支持丰富，GORM是一个不错的选择。而如果你对类型安全和性能有更高要求，并且愿意花时间熟悉新的工具，Ent则是一个强有力的竞争者。"}]},{"ID":"20240619234044-5sqa3d2","Type":"NodeParagraph","Properties":{"id":"20240619234044-5sqa3d2","updated":"20240619234045"},"Children":[{"Type":"NodeText","Data":"无论选择哪一个框架，理解其设计理念、优缺点以及适用场景，才能更好地发挥它们的优势，提升开发效率和代码质量。"}]}]}