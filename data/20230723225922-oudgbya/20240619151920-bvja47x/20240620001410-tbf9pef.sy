{"ID":"20240620001410-tbf9pef","Spec":"1","Type":"NodeDocument","Properties":{"icon":"262f-fe0f","id":"20240620001410-tbf9pef","title":"Lura：基于 Gin 实现的下一代超高性能API网关，支持大量插件！","type":"doc","updated":"20240620001427"},"Children":[{"ID":"20240620001427-10e372q","Type":"NodeParagraph","Properties":{"id":"20240620001427-10e372q","updated":"20240620001427"},"Children":[{"Type":"NodeText","Data":"在快速发展的技术世界中，管理和分发服务变得愈发重要。API网关作为一种服务"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"架构模式"},{"Type":"NodeText","Data":"，为微服务架构提供了一种高效的管理方式。近年来，Lura（以前称为KrakenD）在开源社区崭露头角，以其轻量级和高性能称为热议的焦点。Lura项目不仅仅是一个API网关，它还提供了丰富的中间件，可以帮助开发者在Linux环境中更好地管理微服务。接下来我们将深入探讨Lura的技术架构，以及如何使用其提供的中间件来构建一个可靠、高效的API网关。"}]},{"ID":"20240620001427-velt3k8","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240620001427-velt3k8","updated":"20240620001427"},"Children":[{"Type":"NodeText","Data":"Lura的核心构架"}]},{"ID":"20240620001427-tmyeauw","Type":"NodeParagraph","Properties":{"id":"20240620001427-tmyeauw","updated":"20240620001428"},"Children":[{"Type":"NodeText","Data":"Lura是一个使用Go语言编写的高性能API网关，它专注于提供无服务架构下的高速网络传输。其核心特点包括以下几点："}]},{"ID":"20240620001427-t0zzug7","Type":"NodeList","ListData":{},"Properties":{"id":"20240620001427-t0zzug7","updated":"20240620001428"},"Children":[{"ID":"20240620001427-510w8jg","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240620001427-510w8jg","updated":"20240620001427"},"Children":[{"ID":"20240620001427-fxtaqha","Type":"NodeParagraph","Properties":{"id":"20240620001427-fxtaqha","updated":"20240620001427"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"高性能"},{"Type":"NodeText","Data":"：利用Go语言的并发模型，Lura可以承载高并发请求，减少延迟。"}]}]},{"ID":"20240620001427-woxm6jg","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240620001427-woxm6jg","updated":"20240620001427"},"Children":[{"ID":"20240620001427-lu7pn0k","Type":"NodeParagraph","Properties":{"id":"20240620001427-lu7pn0k","updated":"20240620001427"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"无状态"},{"Type":"NodeText","Data":"：Lura设计为无状态，易于水平扩展。"}]}]},{"ID":"20240620001427-927fjsc","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240620001427-927fjsc","updated":"20240620001427"},"Children":[{"ID":"20240620001427-ffu9q7e","Type":"NodeParagraph","Properties":{"id":"20240620001427-ffu9q7e","updated":"20240620001427"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"配置驱动"},{"Type":"NodeText","Data":"：通过YAML或JSON配置文件来声明API，无需编写代码。"}]}]},{"ID":"20240620001427-qgq6947","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240620001427-qgq6947","updated":"20240620001427"},"Children":[{"ID":"20240620001427-5l3p7bz","Type":"NodeParagraph","Properties":{"id":"20240620001427-5l3p7bz","updated":"20240620001427"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"扩展性"},{"Type":"NodeText","Data":"：通过中间件和插件，可以扩展Lura的功能。"}]}]}]},{"ID":"20240620001427-hxme8wx","Type":"NodeParagraph","Properties":{"id":"20240620001427-hxme8wx","updated":"20240620001428"},"Children":[{"Type":"NodeText","Data":"在它的架构中，Lura处理请求的流程可以概括为以下几步："}]},{"ID":"20240620001427-42jb3ab","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240620001427-42jb3ab","updated":"20240620001428"},"Children":[{"ID":"20240620001427-o5ibbnf","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240620001427-o5ibbnf","updated":"20240620001427"},"Children":[{"ID":"20240620001427-kyrak50","Type":"NodeParagraph","Properties":{"id":"20240620001427-kyrak50","updated":"20240620001427"},"Children":[{"Type":"NodeText","Data":"接收客户端请求；"}]}]},{"ID":"20240620001427-m7zllyq","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240620001427-m7zllyq","updated":"20240620001427"},"Children":[{"ID":"20240620001427-48cu7t2","Type":"NodeParagraph","Properties":{"id":"20240620001427-48cu7t2","updated":"20240620001427"},"Children":[{"Type":"NodeText","Data":"应用配置的中间件或插件处理请求；"}]}]},{"ID":"20240620001427-emfo8gq","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20240620001427-emfo8gq","updated":"20240620001427"},"Children":[{"ID":"20240620001427-pkvahp7","Type":"NodeParagraph","Properties":{"id":"20240620001427-pkvahp7","updated":"20240620001427"},"Children":[{"Type":"NodeText","Data":"路由请求到对应的服务；"}]}]},{"ID":"20240620001427-ztnq1k4","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20240620001427-ztnq1k4","updated":"20240620001427"},"Children":[{"ID":"20240620001427-76uxcu7","Type":"NodeParagraph","Properties":{"id":"20240620001427-76uxcu7","updated":"20240620001427"},"Children":[{"Type":"NodeText","Data":"聚合来自多个服务的响应；"}]}]},{"ID":"20240620001427-jo12dly","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NS4=","Num":5},"Properties":{"id":"20240620001427-jo12dly","updated":"20240620001427"},"Children":[{"ID":"20240620001427-n2qavoa","Type":"NodeParagraph","Properties":{"id":"20240620001427-n2qavoa","updated":"20240620001427"},"Children":[{"Type":"NodeText","Data":"返回处理后的响应给客户端。"}]}]}]},{"ID":"20240620001427-01y98t4","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240620001427-01y98t4","updated":"20240620001427"},"Children":[{"Type":"NodeText","Data":"使用Lura进行API聚合"}]},{"ID":"20240620001427-l61cswv","Type":"NodeParagraph","Properties":{"id":"20240620001427-l61cswv","updated":"20240620001428"},"Children":[{"Type":"NodeText","Data":"API聚合是Lura的一项核心功能，可以将多个API请求汇聚成单一请求。例如，如果有一个客户端需要同时从用户服务和产品服务获得数据，则可以配置一个Lura的聚合端点，代替客户端分别调用两个服务。如下示例展示了如何配置API聚合："}]},{"ID":"20240620001427-u58why2","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240620001427-u58why2","updated":"20240620001428"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"{\n  \"version\": 2,\n  \"timeout\": \"3s\",\n  \"cache_ttl\": \"300s\",\n  \"endpoints\": [{\n    \"endpoint\": \"/v1/aggregate\",\n    \"method\": \"GET\",\n    \"output_encoding\": \"json\",\n    \"backend\": [{\n        \"url_pattern\": \"/users/{user}\",\n        \"encoding\": \"json\",\n        \"host\": [\"http://users_service\"]\n      },\n      {\n        \"url_pattern\": \"/products/{product}\",\n        \"encoding\": \"json\",\n        \"host\": [\"http://products_service\"]\n      }\n    ]\n  }]\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240620001427-vilqn4i","Type":"NodeParagraph","Properties":{"id":"20240620001427-vilqn4i","updated":"20240620001428"},"Children":[{"Type":"NodeText","Data":"在上述配置中，客户端仅需请求"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/v1/aggregate"},{"Type":"NodeText","Data":"​，Lura会同步调用用户服务和产品服务，并将结果聚合后返回。"}]},{"ID":"20240620001427-5xx8qh8","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240620001427-5xx8qh8","updated":"20240620001427"},"Children":[{"Type":"NodeText","Data":"利用中间件增强网关功能"}]},{"ID":"20240620001427-uglbz21","Type":"NodeParagraph","Properties":{"id":"20240620001427-uglbz21","updated":"20240620001428"},"Children":[{"Type":"NodeText","Data":"Lura能够通过中间件来增加额外的功能，如日志记录、认证、限流等。中间件能够在请求处理的不同阶段被插入，从而对请求进行前处理和后处理。"}]},{"ID":"20240620001427-a7r8cz8","Type":"NodeParagraph","Properties":{"id":"20240620001427-a7r8cz8","updated":"20240620001428"},"Children":[{"Type":"NodeText","Data":"以下是一个使用JWT认证中间件的例子，在这个例子中，所有的请求都会进行JWT认证："}]},{"ID":"20240620001427-hz023b5","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240620001427-hz023b5","updated":"20240620001428"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"{\n  \"version\": 2,\n  \"timeout\": \"3s\",\n  \"middleware\": [{\n    \"name\": \"jwt\",\n    \"options\": {\n      \"secret\": \"MY_SECRET_KEY\"\n    }\n  }],\n  ...\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240620001427-aie04ai","Type":"NodeParagraph","Properties":{"id":"20240620001427-aie04ai","updated":"20240620001428"},"Children":[{"Type":"NodeText","Data":"通过配置这些中间件，可以灵活地拓展Lura的功能，构建安全且可维护的API网关。"}]},{"ID":"20240620001427-5mosytz","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240620001427-5mosytz","updated":"20240620001427"},"Children":[{"Type":"NodeText","Data":"高级配置和性能优化"}]},{"ID":"20240620001427-40hfjnb","Type":"NodeParagraph","Properties":{"id":"20240620001427-40hfjnb","updated":"20240620001428"},"Children":[{"Type":"NodeText","Data":"Lura的设计思想允许它在不牺牲性能的条件下进行灵活的配置。开发者可以对所有请求和响应的细节进行控制，优化性能。"}]},{"ID":"20240620001427-nf3yplm","Type":"NodeList","ListData":{},"Properties":{"id":"20240620001427-nf3yplm","updated":"20240620001428"},"Children":[{"ID":"20240620001427-nqoifhs","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240620001427-nqoifhs","updated":"20240620001427"},"Children":[{"ID":"20240620001427-0lt6ekw","Type":"NodeParagraph","Properties":{"id":"20240620001427-0lt6ekw","updated":"20240620001427"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"负载均衡"},{"Type":"NodeText","Data":"：通过配置不同的负载均衡策略实现请求分发。"}]}]},{"ID":"20240620001427-jokz2vh","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240620001427-jokz2vh","updated":"20240620001427"},"Children":[{"ID":"20240620001427-rendeis","Type":"NodeParagraph","Properties":{"id":"20240620001427-rendeis","updated":"20240620001427"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"缓存策略"},{"Type":"NodeText","Data":"：对常用的响应设置缓存，减少后端服务的压力。"}]}]},{"ID":"20240620001427-wh2ymk2","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240620001427-wh2ymk2","updated":"20240620001427"},"Children":[{"ID":"20240620001427-zw8k3tb","Type":"NodeParagraph","Properties":{"id":"20240620001427-zw8k3tb","updated":"20240620001427"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"熔断机制"},{"Type":"NodeText","Data":"：添加熔断器来避免系统雪崩。"}]}]},{"ID":"20240620001427-cr1pxsl","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240620001427-cr1pxsl","updated":"20240620001427"},"Children":[{"ID":"20240620001427-hyo5mh9","Type":"NodeParagraph","Properties":{"id":"20240620001427-hyo5mh9","updated":"20240620001427"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"健康检查"},{"Type":"NodeText","Data":"：定期对后端服务进行健康检查，保证系统稳定性。"}]}]}]},{"ID":"20240620001427-wf78038","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240620001427-wf78038","updated":"20240620001427"},"Children":[{"Type":"NodeText","Data":"Lura在实践中的应用"}]},{"ID":"20240620001427-ft8hrb2","Type":"NodeParagraph","Properties":{"id":"20240620001427-ft8hrb2","updated":"20240620001428"},"Children":[{"Type":"NodeText","Data":"为了更好地理解Lura的使用场景，我们可以考虑下面的示例："}]},{"ID":"20240620001427-is6qtpa","Type":"NodeParagraph","Properties":{"id":"20240620001427-is6qtpa","updated":"20240620001428"},"Children":[{"Type":"NodeText","Data":"假设我们正在构建一款电子商务平台，该平台需要从不同的微服务（用户信息、产品目录、订单处理等）获取数据。我们可以利用Lura配置一个单一的入口点，它可以按照我们的需要聚合和分发请求，减轻客户端的请求负担，同时保持后端服务的解耦。"}]},{"ID":"20240620001427-hq3vkty","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240620001427-hq3vkty","updated":"20240620001427"},"Children":[{"Type":"NodeText","Data":"结语"}]},{"ID":"20240620001427-tslbwar","Type":"NodeParagraph","Properties":{"id":"20240620001427-tslbwar","updated":"20240620001428"},"Children":[{"Type":"NodeText","Data":"Lura提供了一个强大可靠的API网关解决方案，无论是对于小规模项目还是企业级应用，其轻量级、高性能和高度可配置的特性，都使得它成为了服务管理的优秀选择。通过广泛的中间件支持，开发者可以构建出高度定制的API网关，以满足特定的业务需求。随着更多高级特性和社区的支持，Lura有望继续在API管理领域中保持其领导地位。"}]}]}