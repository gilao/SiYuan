{"ID":"20231229103204-q8w1q1u","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f96d","id":"20231229103204-q8w1q1u","tags":"Go-govulncheck,Go-漏洞管理和扫描","title":"Go 官方新玩具：漏洞管理和扫描，看看自己项目有没有坑？","updated":"20231229103856"},"Children":[{"ID":"20231229103204-5dlcvf1","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20231229103204-5dlcvf1","updated":"20231229103241"},"Children":[{"Type":"NodeText","Data":"govulncheck 是什么"}]},{"ID":"20231229103241-eq3zhdj","Type":"NodeParagraph","Properties":{"id":"20231229103241-eq3zhdj","updated":"20231229103339"},"Children":[{"Type":"NodeText","Data":"Go 安全团队在 2022 年 9 月，正式推出了 govulncheck 工具，可以根据背后的 Go 漏洞数据库去分析 Go 代码，对已知的问题发出警告，提醒开发者进行修复。"}]},{"ID":"20231229103342-lc03bsj","Type":"NodeParagraph","Properties":{"id":"20231229103342-lc03bsj","updated":"20231229103346"},"Children":[{"Type":"NodeText","Data":"以下是 govulncheck 的架构图："}]},{"ID":"20231229103402-8atyece","Type":"NodeParagraph","Properties":{"id":"20231229103402-8atyece","updated":"20231229103402"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20231229103402-s9ko430.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20231229103403-36nynej","Type":"NodeParagraph","Properties":{"id":"20231229103403-36nynej","updated":"20231229103423"},"Children":[{"Type":"NodeText","Data":"Go 漏洞管理由以下几个部分组成："}]},{"ID":"20231229103423-o2ox31g","Type":"NodeList","ListData":{},"Properties":{"id":"20231229103423-o2ox31g","updated":"20231229103425"},"Children":[{"ID":"20231229103425-4lrno4u","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231229103425-4lrno4u","updated":"20231229103425"},"Children":[{"ID":"20231229103425-rzti9zx","Type":"NodeParagraph","Properties":{"id":"20231229103425-rzti9zx","updated":"20231229103543"},"Children":[{"Type":"NodeText","Data":"数据源来自各个来源，例如 National Vulnerability Database（NVD）、GitHub Advisory Database，以及直接从Go软件包维护者处收集。"}]}]},{"ID":"20231229103544-yrq959w","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231229103544-yrq959w"},"Children":[{"ID":"20231229103544-yj8vykk","Type":"NodeParagraph","Properties":{"id":"20231229103544-yj8vykk","updated":"20231229103703"},"Children":[{"Type":"NodeText","Data":"漏洞数据库会基于上述第一点来做数据录入，所有的报告均由 Go Security 团队审核和整理。报告采用开源漏洞（OSV）格式，可通过API访问。"}]}]},{"ID":"20231229103704-hdhpo8y","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231229103704-hdhpo8y"},"Children":[{"ID":"20231229103704-96vf475","Type":"NodeParagraph","Properties":{"id":"20231229103704-96vf475","updated":"20231229103753"},"Children":[{"Type":"NodeText","Data":"pkg.go.dev 与 govulncheck 集成，让开发人员能发现项目中的漏洞。"}]}]}]},{"ID":"20231229103808-a04dwju","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20231229103808-a04dwju","updated":"20231229103817"},"Children":[{"Type":"NodeText","Data":"最简 Demo"}]},{"ID":"20231229103817-7ermnzm","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20231229103817-7ermnzm","updated":"20231229103828"},"Children":[{"Type":"NodeText","Data":"准备有缺陷的项目"}]},{"ID":"20231229103856-1fuevsk","Type":"NodeParagraph","Properties":{"id":"20231229103856-1fuevsk","updated":"20231229103856"},"Children":[{"Type":"NodeText","Data":"根据 Go 官方的示例，我们需要模拟一个例子来验证安全功能。创建一个 Go 项目 vuln-tutorial，写入如下代码："}]},{"ID":"20231229103856-f8isu7a","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231229103856-f8isu7a","updated":"20231229103903"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"import (\n ...\n \"golang.org/x/text/language\"\n)\n\nfunc main() {\n for _, arg := range os.Args[1:] {\n  tag, err := language.Parse(arg)\n  if err != nil {\n   fmt.Printf(\"%s: error: %v\\n\", arg, err)\n  } else if tag == language.Und {\n   fmt.Printf(\"%s: undefined\\n\", arg)\n  } else {\n   fmt.Printf(\"%s: tag %s\\n\", arg, tag)\n  }\n }\n}\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231229103856-s9p5h40","Type":"NodeParagraph","Properties":{"id":"20231229103856-s9p5h40","updated":"20231229103856"},"Children":[{"Type":"NodeText","Data":"拉取相关依赖："}]},{"ID":"20231229103856-ub5o8as","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231229103856-ub5o8as","updated":"20231229103908"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"$ go mod tidy \ngo: finding module for package golang.org/x/text/language\ngo: downloading golang.org/x/text v0.13.0\ngo: found golang.org/x/text/language in golang.org/x/text v0.13.0\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231229103856-olvv54o","Type":"NodeParagraph","Properties":{"id":"20231229103856-olvv54o","updated":"20231229103856"},"Children":[{"Type":"NodeText","Data":"将 golang.org/x/text 版本降级至 v0.3.5。这个版本存在已知的问题："}]},{"ID":"20231229103856-fx20tnd","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231229103856-fx20tnd","updated":"20231229103913"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"$ go get golang.org/x/text@v0.3.5\ngo: downloading golang.org/x/text v0.3.5\ngo: downgraded golang.org/x/text v0.13.0 =\u003e v0.3.5\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231229103856-j0shnad","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20231229103856-j0shnad","updated":"20231229103856"},"Children":[{"Type":"NodeText","Data":"快速运行 govulncheck"}]},{"ID":"20231229103856-a2txtie","Type":"NodeParagraph","Properties":{"id":"20231229103856-a2txtie","updated":"20231229103856"},"Children":[{"Type":"NodeText","Data":"安装 govulncheck："}]},{"ID":"20231229103856-mnofy0e","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231229103856-mnofy0e","updated":"20231229103916"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"$ go install golang.org/x/vuln/cmd/govulncheck@latest\ngo: downloading golang.org/x/vuln v1.0.1\ngo: downloading golang.org/x/tools v0.12.1-0.20230815132531-74c255bcf846\ngo: downloading golang.org/x/sys v0.11.0\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231229103856-hkytmiy","Type":"NodeParagraph","Properties":{"id":"20231229103856-hkytmiy","updated":"20231229103856"},"Children":[{"Type":"NodeText","Data":"对比一下，查看是否正常："}]},{"ID":"20231229103856-0o1rbyb","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231229103856-0o1rbyb","updated":"20231229103921"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"$ govulncheck -version\nGo: go1.20.5\nScanner: govulncheck@v1.0.1\nDB: https://vuln.go.dev\nDB updated: 2023-09-13 19:45:03 +0000 UTC\n\nNo vulnerabilities found.\n\nShare feedback at https://go.dev/s/govulncheck-feedback.\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231229103856-9rv8lw6","Type":"NodeParagraph","Properties":{"id":"20231229103856-9rv8lw6","updated":"20231229103856"},"Children":[{"Type":"NodeText","Data":"一切就绪，接下来正式开始。"}]},{"ID":"20231229103856-erant4m","Type":"NodeParagraph","Properties":{"id":"20231229103856-erant4m","updated":"20231229103856"},"Children":[{"Type":"NodeText","Data":"我们回到上一节创建的 vuln-tutorial 项目，在根目录执行如下命令："}]},{"ID":"20231229103856-32wmpjq","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231229103856-32wmpjq","updated":"20231229103924"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"➜  vuln-tutorial govulncheck ./...\nScanning your code and 46 packages across 1 dependent module for known vulnerabilities...\n\nVulnerability #1: GO-2021-0113\n    Out-of-bounds read in golang.org/x/text/language\n  More info: https://pkg.go.dev/vuln/GO-2021-0113\n  Module: golang.org/x/text\n    Found in: golang.org/x/text@v0.3.5\n    Fixed in: golang.org/x/text@v0.3.7\n    Example traces found:\n      #1: main.go:12:29: vuln.main calls language.Parse\n\n=== Informational ===\n\nFound 1 vulnerability in packages that you import, but there are no call\nstacks leading to the use of this vulnerability. You may not need to\ntake any action. See https://pkg.go.dev/golang.org/x/vuln/cmd/govulncheck\nfor details.\n\nVulnerability #1: GO-2022-1059\n    Denial of service via crafted Accept-Language header in\n    golang.org/x/text/language\n  More info: https://pkg.go.dev/vuln/GO-2022-1059\n  Module: golang.org/x/text\n    Found in: golang.org/x/text@v0.3.5\n    Fixed in: golang.org/x/text@v0.3.8\n\nYour code is affected by 1 vulnerability from 1 module.\n\nShare feedback at https://go.dev/s/govulncheck-feedback.\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231229103856-ngmybh4","Type":"NodeParagraph","Properties":{"id":"20231229103856-ngmybh4","updated":"20231229103856"},"Children":[{"Type":"NodeText","Data":"整个输出信息分两大块。"}]},{"ID":"20231229103856-0i7ptfs","Type":"NodeParagraph","Properties":{"id":"20231229103856-0i7ptfs","updated":"20231229103856"},"Children":[{"Type":"NodeText","Data":"第一块区域是 Vulnerability（漏洞），上述例子的扫描结果是发现了漏洞 #GO-2021-0113，告知了具体的原因、触发函数、发现的版本和修复的版本（方式）："}]},{"ID":"20231229103856-6z5cnf8","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231229103856-6z5cnf8","updated":"20231229103929"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"Vulnerability #1: GO-2021-0113\n    Out-of-bounds read in golang.org/x/text/language\n  More info: https://pkg.go.dev/vuln/GO-2021-0113\n  Module: golang.org/x/text\n    Found in: golang.org/x/text@v0.3.5\n    Fixed in: golang.org/x/text@v0.3.7\n    Example traces found:\n      #1: main.go:12:29: vuln.main calls language.Parse\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231229103856-6e6awxw","Type":"NodeParagraph","Properties":{"id":"20231229103856-6e6awxw","updated":"20231229103856"},"Children":[{"Type":"NodeText","Data":"第二块区域是 Informational（信息），可以理解为进一步的修复建议。上述例子的建议是基于漏洞 #GO-2022-1059，建议升级更新的版本："}]},{"ID":"20231229103856-cb0k50b","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231229103856-cb0k50b","updated":"20231229103932"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"Vulnerability #1: GO-2022-1059\n    Denial of service via crafted Accept-Language header in\n    golang.org/x/text/language\n  More info: https://pkg.go.dev/vuln/GO-2022-1059\n  Module: golang.org/x/text\n    Found in: golang.org/x/text@v0.3.5\n    Fixed in: golang.org/x/text@v0.3.8\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231229103856-yx9jivi","Type":"NodeParagraph","Properties":{"id":"20231229103856-yx9jivi","updated":"20231229103856"},"Children":[{"Type":"NodeText","Data":"当然，这部分是建议修复。因为不存在实际涉及到此漏洞的调用堆栈内容。可能仅是该包的漏洞进行了展示。"}]},{"ID":"20231229103856-14kdnr2","Type":"NodeParagraph","Properties":{"id":"20231229103856-14kdnr2","updated":"20231229103856"},"Children":[{"Type":"NodeText","Data":"最后部分在开头和结尾对本次扫描结果的统计输出和代码行数的描述性输出了。告诉你都扫描和识别了多少内容。"}]}]}