{"ID":"20231015151429-9v61ekj","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f386","id":"20231015151429-9v61ekj","scroll":"\u0026#123;\u0026quot;rootId\u0026quot;:\u0026quot;20231015151429-9v61ekj\u0026quot;,\u0026quot;startId\u0026quot;:\u0026quot;20231016091614-koa3q5i\u0026quot;,\u0026quot;endId\u0026quot;:\u0026quot;20231015231546-6cd6rjf\u0026quot;,\u0026quot;scrollTop\u0026quot;:2760.666748046875,\u0026quot;focusId\u0026quot;:\u0026quot;20231015161456-c0s860w\u0026quot;,\u0026quot;focusStart\u0026quot;:4,\u0026quot;focusEnd\u0026quot;:4\u0026#125;","title":"部署流程","updated":"20231016091656"},"Children":[{"ID":"20231016091614-koa3q5i","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20231016091614-koa3q5i","updated":"20231016091622"},"Children":[{"Type":"NodeText","Data":"查看CPU 内核"}]},{"ID":"20231016091622-neslyz1","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231016091622-neslyz1","updated":"20231016091656"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2hlbGw="},{"Type":"NodeCodeBlockCode","Data":"lscpu | grep \"^CPU(s):\" | head -n 1\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231015151436-7ji6a3f","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20231015151436-7ji6a3f","updated":"20231015151447"},"Children":[{"Type":"NodeText","Data":"获取 容器mac"}]},{"ID":"20231015151447-2456ese","Type":"NodeParagraph","Properties":{"id":"20231015151447-2456ese","updated":"20231015151450"},"Children":[{"Type":"NodeText","Data":"运行"}]},{"ID":"20231015153034-fq3whjq","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231015153034-fq3whjq","updated":"20231015153345"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2hlbGw="},{"Type":"NodeCodeBlockCode","Data":"go build -o getlicense .\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231015153818-lv72a9t","Type":"NodeParagraph","Properties":{"id":"20231015153818-lv72a9t","updated":"20231015153840"},"Children":[{"Type":"NodeText","Data":"将生成的getlicense 在容器中运行，获取mac地址"}]},{"ID":"20231015153819-ylud48l","Type":"NodeParagraph","Properties":{"id":"20231015153819-ylud48l"}},{"ID":"20231015153035-ep0umnq","Type":"NodeParagraph","Properties":{"id":"20231015153035-ep0umnq","updated":"20231015153231"},"Children":[{"Type":"NodeText","Data":"在 heavyoverloadModel 中修改 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"service/service.go 中 MACaddreess"},{"Type":"NodeText","Data":"​"}]},{"ID":"20231015155825-kl31j7y","Type":"NodeParagraph","Properties":{"id":"20231015155825-kl31j7y"}},{"ID":"20231016091139-eh5qfed","Type":"NodeParagraph","Properties":{"id":"20231016091139-eh5qfed","updated":"20231016091208"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-card-error-background); color: var(--b3-card-error-color);"},"TextMarkType":"text","TextMarkTextContent":"查看配置文件，设置日志等级"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-card-error-background); color: var(--b3-card-error-color);\"}"}]},{"ID":"20231016090924-hydeni6","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20231016090924-hydeni6"}},{"ID":"20231016090928-wk36liw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231016090928-wk36liw","updated":"20231016090929"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2hlbGw="},{"Type":"NodeCodeBlockCode","Data":"4be7e19588f3cc3bb64dba4e5bb1d54b0f206b81897a70ded29053f828371bac\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231015225648-g6era6y","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20231015225648-g6era6y","updated":"20231015225743"},"Children":[{"Type":"NodeText","Data":"设置要配置的路由名称"}]},{"ID":"20231015225704-xpfbf02","Type":"NodeParagraph","Properties":{"id":"20231015225704-xpfbf02","updated":"20231015225807"},"Children":[{"Type":"NodeText","Data":"更改 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"routers/api.go"},{"Type":"NodeText","Data":"​ 中的路由名称"}]},{"ID":"20231015153025-sw8gqtf","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20231015153025-sw8gqtf","updated":"20231015155848"},"Children":[{"Type":"NodeText","Data":"运行go build 生成go服务文件"}]},{"ID":"20231015155849-wpe8eed","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231015155849-wpe8eed","updated":"20231015160020"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2hlbGw="},{"Type":"NodeCodeBlockCode","Data":"go build -o heavyoverload \n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231015160029-cxq0oml","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20231015160029-cxq0oml","updated":"20231015160040"},"Children":[{"Type":"NodeText","Data":"进行部署流程"}]},{"ID":"20231015160040-lq933fu","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20231015160040-lq933fu","updated":"20231015160105"},"Children":[{"Type":"NodeText","Data":"docker部署"}]},{"ID":"20231015160105-js6umo7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231015160105-js6umo7","updated":"20231015160605"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2hlbGw="},{"Type":"NodeCodeBlockCode","Data":"mkdir grid_anhui \n\nmv grid_anhui.tar.gz ./grid_anhui\n\ncd grid_anhui\n\ntar -xzvf grid_anhui.tar.gz\n\nrm grid_anhui.tar.gz\n\ncd envs/ener_grpc\n\ntar -xzvf ener_grpc_env.tar.gz\n\nrm ener_grpc_env.tar.gz\n\ncd ../app\n\ntar -xvf app_prod.tar\n\ncd app/go\n\nchmod +X macLicense heavyoverload\n\nrm app_prod.tar \n\ncd images \n\ndocker load -i enlp_anhui-model-server_1.0.tar\n\nrm enlp_anhui-model-server_1.0.tar \n\nls\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231015160607-wgsbbk8","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20231015160607-wgsbbk8","updated":"20231015160620"},"Children":[{"Type":"NodeText","Data":"docker 启动命令"}]},{"ID":"20231015160620-13lfqop","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231015160620-13lfqop","updated":"20231015161424"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2hlbGw="},{"Type":"NodeCodeBlockCode","Data":"docker run -itd \\\n--name enlp-grid-anhui \\\n--restart always \\\n--privileged=true \\\n-p 35641:8080 \\\n-p 35642:8087 \\\n--cpus=16 \\\n--memory=32g \\\n-v  $PWD/envs:/opt/conda/envs \\\n-v $PWD/app:/app \\\nenlp/anhui-model-server:1.0\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231015161456-c0s860w","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20231015161456-c0s860w","updated":"20231015161506"},"Children":[{"Type":"NodeText","Data":"进入容器"}]},{"ID":"20231015161506-wnf4yv7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231015161506-wnf4yv7","updated":"20231015161542"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2hlbGw="},{"Type":"NodeCodeBlockCode","Data":"docker ps | grep enlp-grid-anhui\n\ndocker exec -it enlp-grid-anhui bash\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231015161553-44y7gwv","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20231015161553-44y7gwv","updated":"20231015161606"},"Children":[{"Type":"NodeText","Data":"执行python部分"}]},{"ID":"20231015161703-2f24dsa","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231015161703-2f24dsa","updated":"20231015161953"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2hlbGw="},{"Type":"NodeCodeBlockCode","Data":"conda env list \n\nconda activate ener_grpc\n\npip list | grpc grpc\npip list | grpc Flask\npip list | grep torch\n\nPWD/anhui/app/python/grid_understanding_prod/config/config.yaml（宿主机位置）：\n\ncd /app/python/grid_understanding_prod\n\npython grpc_server.py \u0026\n\ntail -f PWD/anhui/app/logs/model/model.log\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231015162034-9vdm8lx","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20231015162034-9vdm8lx","updated":"20231015162045"},"Children":[{"Type":"NodeText","Data":"执行 go部分"}]},{"ID":"20231015162045-j4xybwl","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231015162045-j4xybwl","updated":"20231015162126"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2hlbGw="},{"Type":"NodeCodeBlockCode","Data":"cd /app/go\n\n./macLicense \u0026\n\n./heavyoverload -pwd 9b7e86406c2b2a4b5aeda6c257ed8f76cd7ebacaf86d62a371e2a2c7ccdc3ece \u0026\n\ntail -f PWD/anhui/app/logs/api/Powermodel-web.log\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231015230731-dyxe7nl","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20231015230731-dyxe7nl","updated":"20231015230830"},"Children":[{"Type":"NodeText","Data":"测试服务 "}]},{"ID":"20231015230830-o9mjlvl","Type":"NodeParagraph","Properties":{"id":"20231015230830-o9mjlvl","updated":"20231015230849"},"Children":[{"Type":"NodeText","Data":"Powermodel-testing 项目"}]},{"ID":"20231015230851-ee4jx5c","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20231015230851-ee4jx5c","updated":"20231015230855"},"Children":[{"Type":"NodeText","Data":"注意"}]},{"ID":"20231015230856-mbxk8y6","Type":"NodeList","ListData":{},"Properties":{"id":"20231015230856-mbxk8y6","updated":"20231015231558"},"Children":[{"ID":"20231015230901-1fhs5qz","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231015230901-1fhs5qz","updated":"20231015230901"},"Children":[{"ID":"20231015230901-kt9y14c","Type":"NodeParagraph","Properties":{"id":"20231015230901-kt9y14c","updated":"20231015230914"},"Children":[{"Type":"NodeText","Data":"更改post 路由名"}]}]},{"ID":"20231015230947-5ofswip","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231015230947-5ofswip","updated":"20231015231558"},"Children":[{"ID":"20231015230947-mg1p97s","Type":"NodeParagraph","Properties":{"id":"20231015230947-mg1p97s","updated":"20231015231558"},"Children":[{"Type":"NodeText","Data":"更改测试问答语句 测试语句位置"}]}]}]},{"ID":"20231015231539-acis7fm","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231015231539-acis7fm","updated":"20231015231548"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2hlbGw="},{"Type":"NodeCodeBlockCode","Data":"E:\\工作文件\\安徽模型\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231015231546-6cd6rjf","Type":"NodeParagraph","Properties":{"id":"20231015231546-6cd6rjf"}}]}