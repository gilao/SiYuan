{"ID":"20240605203250-u7i9oep","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f986","id":"20240605203250-u7i9oep","title":"第五章 字符串本质与实现","type":"doc","updated":"20240605204445"},"Children":[{"ID":"20240605203330-82vyfdg","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240605203330-82vyfdg","updated":"20240605203402"},"Children":[{"Type":"NodeText","Data":"5.1 字符串的本质"}]},{"ID":"20240605203402-q0turqi","Type":"NodeParagraph","Properties":{"id":"20240605203402-q0turqi","updated":"20240605203449"},"Children":[{"Type":"NodeText","Data":"在编程语言中，字符串是一种重要的数据结构，通常由一系列字符组成。字符串一般有两种类型，"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"一种在编译时指定长度，不能修改。一种具有动态的长度，可以修改。"},{"Type":"NodeTextMark","Properties":{"style":"color: var(--b3-font-color1);"},"TextMarkType":"strong text","TextMarkTextContent":"但是在Go语言中，字符串不能被修改，只能被访问，不能采取如下方式对字符串进行修改。"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"color: var(--b3-font-color1);\"}"}]},{"ID":"20240605203433-eipr7hn","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240605203433-eipr7hn","updated":"20240605203520"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"var b = \"hello world\"\nb[1] = 'o'\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240605203250-jee0yyv","Type":"NodeParagraph","Properties":{"id":"20240605203250-jee0yyv","updated":"20240605203535"},"Children":[{"Type":"NodeText","Data":"字符串的终止有两种方式，"}]},{"ID":"20240605203538-3k9bl26","Type":"NodeParagraph","Properties":{"id":"20240605203538-3k9bl26","updated":"20240605203538"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"一种是C语言中的隐式申明，以字符“\\0”作为终止符。"}]},{"ID":"20240605203537-ct62gxq","Type":"NodeParagraph","Properties":{"id":"20240605203537-ct62gxq","updated":"20240605203543"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"一种是Go语言中的显式声明。"}]},{"ID":"20240605203540-cmjzopu","Type":"NodeParagraph","Properties":{"id":"20240605203540-cmjzopu","updated":"20240605203540"},"Children":[{"Type":"NodeText","Data":"Go语言运行时字符串string的表示结构如下。"}]},{"ID":"20240605203545-xpimtog","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240605203545-xpimtog","updated":"20240605203613"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"type StringHeader struct {\n  Data uinptr\n  Len int\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240605203627-8jc0du2","Type":"NodeParagraph","Properties":{"id":"20240605203627-8jc0du2","updated":"20240605203637"},"Children":[{"Type":"NodeText","Data":"其中，"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"Data指向底层的字符数组，Len代表字符串的长度。字符串在本质上是一串字符数组，每个字符在存储时都对应了一个或多个整数，这涉及字符集的编码方式。"}]},{"ID":"20240605203638-9lc72ud","Type":"NodeParagraph","Properties":{"id":"20240605203638-9lc72ud","updated":"20240605203710"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"Go语言中所有的文件都采用UTF-8的编码方式，同时字符常量使用UTF-8的字符编码集。UFT-8是一种长度可变的编码方式，可包含世界上大部分的字符。"}]},{"ID":"20240605203711-lzy4vmt","Type":"NodeParagraph","Properties":{"id":"20240605203711-lzy4vmt","updated":"20240605203807"},"Children":[{"Type":"NodeText","Data":"字母都只占据1字节，但是特殊的字符（例如大部分中文）会占据3字节。如下所示，变量b看起来只有4个字符，但是len（b）获取的长度为8，字符串b中每个中文都占据了3字节。"}]},{"ID":"20240605203808-xbwxurc","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240605203808-xbwxurc","updated":"20240605203908"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"var b = \"Go语言\"\nfor i := 0;i \u003c len(b);i++ {\n  fmt.Printf(\"%x \",b[i])\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240605203920-7x0f3vc","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240605203920-7x0f3vc","updated":"20240605203934"},"Children":[{"Type":"NodeText","Data":"5.2 符文类型"}]},{"ID":"20240605203935-8pbuk7p","Type":"NodeParagraph","Properties":{"id":"20240605203935-8pbuk7p","updated":"20240605204101"},"Children":[{"Type":"NodeText","Data":"Go语言的设计者认为[1]，用字符（character）表示字符串的组成元素可能产生歧义，因为有些字符非常相似，例如小写拉丁字母a与带重音符号的à。这些相似的字符真正的区别在于其编码后的整数是不相同的，a被表示为0x61，à被表示为0xE0。"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"因此在Go语言中使用符文（rune）类型来表示和区分字符串中的“字符”，rune其实是int32的别称。"}]},{"ID":"20240605204043-5i1qrlt","Type":"NodeParagraph","Properties":{"id":"20240605204043-5i1qrlt","updated":"20240605204128"},"Children":[{"Type":"NodeText","Data":"当用range轮询字符串时，轮询的不再是单字节，而是具体的rune。如下所示，对字符串b进行轮询，其第一个参数index代表每个rune的字节偏移量，而runeValue为int32，代表符文数。"}]},{"ID":"20240605204158-vdxkhfr","Type":"NodeParagraph","Properties":{"id":"20240605204158-vdxkhfr","updated":"20240605204158"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240605204158-gmjxrgx.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240605204159-u9pim92","Type":"NodeParagraph","Properties":{"id":"20240605204159-u9pim92","updated":"20240605204205"},"Children":[{"Type":"NodeText","Data":"fmt.Printf有一个特殊的格式化符＃U可用于打印符文数十六进制的Unicode编码方式及字符形状。如上例打印出："}]},{"ID":"20240605204213-fn946wn","Type":"NodeParagraph","Properties":{"id":"20240605204213-fn946wn","updated":"20240605204213"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240605204213-igrdiu7.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240605204217-a3xdeni","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240605204217-a3xdeni","updated":"20240605204346"},"Children":[{"Type":"NodeText","Data":"5.4 字符串底层原理"}]},{"ID":"20240605204346-aw5z82i","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240605204346-aw5z82i","updated":"20240605204352"},"Children":[{"Type":"NodeText","Data":"字符串解析"}]},{"ID":"20240605204352-4b123s9","Type":"NodeParagraph","Properties":{"id":"20240605204352-4b123s9","updated":"20240605204411"},"Children":[{"Type":"NodeText","Data":"整数是全为数字的常量，浮点数是带小数点的常量。字符串也有特殊标识，它有两种声明方式："}]},{"ID":"20240605204412-c4ejo3o","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240605204412-c4ejo3o","updated":"20240605204436"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"var a string = 'hello world'\nvar b string = \"hello world\"\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240605204438-j6puuke","Type":"NodeParagraph","Properties":{"id":"20240605204438-j6puuke","updated":"20240605204445"},"Children":[{"Type":"NodeText","Data":"字符串常量在词法解析阶段最终会被标记成StringLit类型的Token并被传递到编译的下一个阶段。"}]}]}