{"ID":"20240526233807-5oc5k74","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f342","id":"20240526233807-5oc5k74","title":"签名开关","type":"doc","updated":"20240526233839"},"Children":[{"ID":"20240526233822-7sp6i58","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240526233822-7sp6i58","updated":"20240526233822"},"Children":[{"Type":"NodeText","Data":"概述"}]},{"ID":"20240526233822-qldwc51","Type":"NodeParagraph","Properties":{"id":"20240526233822-qldwc51","updated":"20240526233822"},"Children":[{"Type":"NodeText","Data":"在 go-zero 中，我们通过 api 语言来声明 HTTP 服务，然后通过 goctl 生成 HTTP 服务代码，在之前我们系统性的介绍了 "},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://go-zero.dev/docs/tutorials","TextMarkTextContent":"API 规范"},{"Type":"NodeText","Data":"。"}]},{"ID":"20240526233822-zw6hin9","Type":"NodeParagraph","Properties":{"id":"20240526233822-zw6hin9","updated":"20240526233822"},"Children":[{"Type":"NodeText","Data":"在 go-zero 中，已经内置了签名功能，我们可以通过 api 语言来开启签名功能，然后通过 goctl 生成签名代码，这样我们就可以在 HTTP 服务中使用签名功能了。"}]},{"ID":"20240526233829-jgxwl4q","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240526233829-jgxwl4q","updated":"20240526233829"},"Children":[{"Type":"NodeText","Data":"签名开关"}]},{"ID":"20240526233829-3or6j1l","Type":"NodeParagraph","Properties":{"id":"20240526233829-3or6j1l","updated":"20240526233830"},"Children":[{"Type":"NodeText","Data":"在 api 语言中，我们可以通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"signature"},{"Type":"NodeText","Data":"​ 关键字来开启签名功能，假设我们有一个 signdemo 服务，我们有一个接口如下："}]},{"ID":"20240526233829-b445vtt","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240526233829-b445vtt","updated":"20240526233830"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"dW5kZWZpbmVk"},{"Type":"NodeCodeBlockCode","Data":"https://example.com/sign/demo\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240526233829-edc7qqe","Type":"NodeParagraph","Properties":{"id":"20240526233829-edc7qqe","updated":"20240526233830"},"Children":[{"Type":"NodeText","Data":"其对应的 api 语言如下："}]},{"ID":"20240526233829-42kedmz","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240526233829-42kedmz","updated":"20240526233830"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"syntax = \"v1\"\n\ntype (\n    SignDemoReq {\n        Msg string `json:\"msg\"`\n    }\n    SignDemoResp {\n        Msg string `json:\"msg\"`\n    }\n)\n\n@server (\n    signature: true // 通过 signature 关键字开启签名功能\n)\nservice sign-api {\n    @handler SignDemo\n    post /sign/demo (SignDemoReq) returns (SignDemoResp)\n}\n\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240526233829-zwni9dz","Type":"NodeParagraph","Properties":{"id":"20240526233829-zwni9dz","updated":"20240526233830"},"Children":[{"Type":"NodeText","Data":"我们来看一下生成的路由代码，完整代码点击 "},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://go-zero.dev/assets/files/signdemo-b31046624563c6c22ab870284d40a8b2.zip","TextMarkTextContent":"这里下载"}]},{"ID":"20240526233829-8iomimi","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240526233829-8iomimi","updated":"20240526233830"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"func RegisterHandlers(server *rest.Server, serverCtx *svc.ServiceContext) {\n    server.AddRoutes(\n        []rest.Route{\n            {\n                Method:  http.MethodPost,\n                Path:    \"/sign/demo\",\n                Handler: SignDemoHandler(serverCtx),\n            },\n        },\n        rest.WithSignature(serverCtx.Config.Signature),\n    )\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240526233829-x1iucaq","Type":"NodeParagraph","Properties":{"id":"20240526233829-x1iucaq","updated":"20240526233830"},"Children":[{"Type":"NodeText","Data":"可以看到，我们通过 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"rest.WithSignature"},{"Type":"NodeText","Data":"​ 来开启签名功能，这样我们就可以在 HTTP 服务中使用签名功能了。"}]}]}