{"ID":"20240527001958-79itwu6","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f993","id":"20240527001958-79itwu6","title":"基础服务配置","type":"doc","updated":"20240527002026"},"Children":[{"ID":"20240527002026-kor919u","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240527002026-kor919u","updated":"20240527002026"},"Children":[{"Type":"NodeText","Data":"service 概述"}]},{"ID":"20240527002026-t5aw4l7","Type":"NodeParagraph","Properties":{"id":"20240527002026-t5aw4l7","updated":"20240527002027"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://github.com/zeromicro/go-zero/blob/master/core/service/serviceconf.go","TextMarkTextContent":"ServiceConf"},{"Type":"NodeText","Data":" 这个配置是用来表示我们一个独立服务的配置。他被我们的 rest，zrpc 等引用，当然我们也可以自己简单定义自己的服务。"}]},{"ID":"20240527002026-5lx8s6m","Type":"NodeParagraph","Properties":{"id":"20240527002026-5lx8s6m","updated":"20240527002027"},"Children":[{"Type":"NodeText","Data":"例如："}]},{"ID":"20240527002026-dp9yca4","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240527002026-dp9yca4","updated":"20240527002027"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"package main\n\nimport (\n    \"github.com/zeromicro/go-zero/core/conf\"\n    \"github.com/zeromicro/go-zero/core/service\"\n    \"github.com/zeromicro/go-zero/zrpc\"\n)\n\ntype JobConfig struct {\n    service.ServiceConf\n    UserRpc zrpc.RpcClientConf\n}\n\nfunc main() {\n    var c JobConfig\n    conf.MustLoad(\"config.yaml\", \u0026c)\n\n    c.MustSetUp()\n    // do your job\n}\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240527002026-y3h602z","Type":"NodeParagraph","Properties":{"id":"20240527002026-y3h602z","updated":"20240527002027"},"Children":[{"Type":"NodeText","Data":"Copy"}]},{"ID":"20240527002026-uzxu3cd","Type":"NodeParagraph","Properties":{"id":"20240527002026-uzxu3cd","updated":"20240527002027"},"Children":[{"Type":"NodeText","Data":"如上，我们定义了一个 JobConfig，并且在启动的时候初始设置 "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"MustSetup"},{"Type":"NodeText","Data":"，这样我们就可以启动了一个服务 service，里面自动集成了 Metrics，Prometheus，Trace，DevServer，Log 等能力。"}]},{"ID":"20240527002026-l5t3le6","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240527002026-l5t3le6","updated":"20240527002026"},"Children":[{"Type":"NodeText","Data":"参数定义"}]},{"ID":"20240527002026-93gylbf","Type":"NodeParagraph","Properties":{"id":"20240527002026-93gylbf","updated":"20240527002027"},"Children":[{"Type":"NodeText","Data":"ServiceConf 配置定义如下:"}]},{"ID":"20240527002026-3f1vw19","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240527002026-3f1vw19","updated":"20240527002027"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"// A ServiceConf is a service config.\ntype ServiceConf struct {\n    Name       string\n    Log        logx.LogConf\n    Mode       string `json:\",default=pro,options=dev|test|rt|pre|pro\"`\n    MetricsUrl string `json:\",optional\"`\n    // Deprecated: please use DevServer\n    Prometheus prometheus.Config `json:\",optional\"`\n    Telemetry  trace.Config      `json:\",optional\"`\n    DevServer  devserver.Config  `json:\",optional\"`\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240527002026-j16ezwz","Type":"NodeParagraph","Properties":{"id":"20240527002026-j16ezwz","updated":"20240527002027"},"Children":[{"Type":"NodeText","Data":"Copy"}]},{"ID":"20240527002026-n4shhd1","Type":"NodeTable","TableAligns":[0,0,0,0,0],"Properties":{"colgroup":"||||","id":"20240527002026-n4shhd1","updated":"20240527002027"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"参数"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"类型"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"默认值"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"说明"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"枚举值"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"Name"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"string"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"-"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"定义服务的名称，会出现在 log 和 tracer 中"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"Log"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"logx.LogConf"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"-"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"参考 "},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://go-zero.dev/docs/tutorials/go-zero/configuration/log","TextMarkTextContent":"log"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"Mode"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"string"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"pro"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"服务的环境，目前我们预定义了 dev。在dev 环境我们会开启反射"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"dev,test,rt,pre, pro"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"MetricsUrl"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"string"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"空"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"打点上报，我们会将一些 metrics 上报到对应的地址，如果为空，则不上报"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"Prometheus"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"prometheus.Config"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"-"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"参考 "},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://go-zero.dev/docs/tutorials/monitor/index#%E6%8C%87%E6%A0%87%E7%9B%91%E6%8E%A7","TextMarkTextContent":"Prometheus.md"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"Telemetry"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"trace.Config"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"-"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"参考 "},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://go-zero.dev/docs/tutorials/monitor/index#%E9%93%BE%E8%B7%AF%E8%BF%BD%E8%B8%AA","TextMarkTextContent":"trace.md"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"DevServer"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"devserver.Config"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"-"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"go-zero 版本 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"v1.4.3"},{"Type":"NodeText","Data":"​ 及以上支持"}]},{"Type":"NodeTableCell","Data":"td"}]}]},{"ID":"20240527001958-jrcbivb","Type":"NodeParagraph","Properties":{"id":"20240527001958-jrcbivb","updated":"20240527002027"}}]}