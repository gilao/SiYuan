{"ID":"20240527002041-l1vrvgp","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f9e9","id":"20240527002041-l1vrvgp","title":"日志配置","type":"doc","updated":"20240527002056"},"Children":[{"ID":"20240527002056-nxtkav6","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240527002056-nxtkav6","updated":"20240527002056"},"Children":[{"Type":"NodeText","Data":"log 概述"}]},{"ID":"20240527002056-r0tv3mj","Type":"NodeParagraph","Properties":{"id":"20240527002056-r0tv3mj","updated":"20240527002056"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://github.com/zeromicro/go-zero/blob/master/core/logx/config.go#L4","TextMarkTextContent":"LogConf"},{"Type":"NodeText","Data":" 用于我们 log 相关的配置，"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"logx.MustSetup"},{"Type":"NodeText","Data":"提供了我们日志的基础配置能力，简单使用方式如下："}]},{"ID":"20240527002056-4ew6ys8","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240527002056-4ew6ys8","updated":"20240527002056"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"var c logx.LogConf\nlogx.MustSetup(c)\nlogx.Info(context.Background(), \"log\")\n// do your job\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240527002056-leyvw0x","Type":"NodeParagraph","Properties":{"id":"20240527002056-leyvw0x","updated":"20240527002056"},"Children":[{"Type":"NodeText","Data":"Copy"}]},{"ID":"20240527002056-i0m3yzs","Type":"NodeParagraph","Properties":{"id":"20240527002056-i0m3yzs","updated":"20240527002056"},"Children":[{"Type":"NodeText","Data":"我们 log 被 serviceConf 引用，他会在服务启动的时候自动初始化完成。"}]},{"ID":"20240527002056-eolvd2y","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240527002056-eolvd2y","updated":"20240527002056"},"Children":[{"Type":"NodeText","Data":"参数定义"}]},{"ID":"20240527002056-ydm0yqt","Type":"NodeParagraph","Properties":{"id":"20240527002056-ydm0yqt","updated":"20240527002056"},"Children":[{"Type":"NodeText","Data":"LogConf 配置定义如下："}]},{"ID":"20240527002056-q5n9xxu","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240527002056-q5n9xxu","updated":"20240527002056"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"package logx\n\n// A LogConf is a logging config.\ntype LogConf struct {\n    ServiceName         string `json:\",optional\"`\n    Mode                string `json:\",default=console,options=[console,file,volume]\"`\n    Encoding            string `json:\",default=json,options=[json,plain]\"`\n    TimeFormat          string `json:\",optional\"`\n    Path                string `json:\",default=logs\"`\n    Level               string `json:\",default=info,options=[debug,info,error,severe]\"`\n    MaxContentLength    uint32 `json:\",optional\"`\n    Compress            bool   `json:\",optional\"`\n    Stat                bool   `json:\",default=true\"` // go-zero 版本 \u003e= 1.5.0 才支持\n    KeepDays            int    `json:\",optional\"`\n    StackCooldownMillis int    `json:\",default=100\"`\n    // MaxBackups represents how many backup log files will be kept. 0 means all files will be kept forever.\n    // Only take effect when RotationRuleType is `size`.\n    // Even thougth `MaxBackups` sets 0, log files will still be removed\n    // if the `KeepDays` limitation is reached.\n    MaxBackups int `json:\",default=0\"`\n    // MaxSize represents how much space the writing log file takes up. 0 means no limit. The unit is `MB`.\n    // Only take effect when RotationRuleType is `size`\n    MaxSize int `json:\",default=0\"`\n    // RotationRuleType represents the type of log rotation rule. Default is `daily`.\n    // daily: daily rotation.\n    // size: size limited rotation.\n    Rotation string `json:\",default=daily,options=[daily,size]\"`\n}\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240527002056-5x07dgg","Type":"NodeParagraph","Properties":{"id":"20240527002056-5x07dgg","updated":"20240527002056"},"Children":[{"Type":"NodeText","Data":"Copy"}]},{"ID":"20240527002056-6c89be4","Type":"NodeTable","TableAligns":[0,0,0,0,0],"Properties":{"colgroup":"||||","id":"20240527002056-6c89be4","updated":"20240527002056"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"参数"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"类型"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"默认值"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"说明"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"枚举值"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"ServiceName"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"string"}]},{"Type":"NodeTableCell","Data":"td"},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"服务名称"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"Mode"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"string"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"console"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"日志打印模式，console 控制台"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"file, console"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"Encoding"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"string"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"json"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"日志格式, json 格式 或者 plain 纯文本"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"json, plain"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"TimeFormat"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"string"}]},{"Type":"NodeTableCell","Data":"td"},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"日期格式化"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"Path"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"string"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"logs"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"日志在文件输出模式下，日志输出路径"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"Level"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"string"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"info"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"日志输出级别"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"debug,info,error,severe"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"MaxContentLength"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"uint32"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"0"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"日志长度限制，打印单个日志的时候会对日志进行裁剪，只有对 content 进行裁剪"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"Compress"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"bool"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"false"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"是否压缩日志"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"Stat"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"bool"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"true"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"是否开启 stat 日志，go-zero 版本大于等于1.5.0才支持"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"KeepDays"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"int"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"0"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"日志保留天数，只有在文件模式才会生效"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"StackCooldownMillis"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"int"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"100"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"堆栈打印冷却时间"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"MaxBackups"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"int"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"0"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"文件输出模式，按照大小分割时，最多文件保留个数"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"MaxSize"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"int"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"0"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"文件输出模式，按照大小分割时，单个文件大小"}]},{"Type":"NodeTableCell","Data":"td"}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"Rotation"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"string"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"daily"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"文件分割模式， daily 按日期"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"daily,size"}]}]}]},{"ID":"20240527002041-h518tgk","Type":"NodeParagraph","Properties":{"id":"20240527002041-h518tgk","updated":"20240527002056"}}]}