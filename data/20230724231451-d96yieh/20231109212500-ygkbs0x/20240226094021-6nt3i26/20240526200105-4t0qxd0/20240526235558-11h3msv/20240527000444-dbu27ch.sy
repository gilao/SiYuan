{"ID":"20240527000444-dbu27ch","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f400","id":"20240527000444-dbu27ch","title":"goctl config","type":"doc","updated":"20240527000508"},"Children":[{"ID":"20240527000453-7obbpad","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240527000453-7obbpad","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"概述"}]},{"ID":"20240527000453-p0owrp7","Type":"NodeParagraph","Properties":{"id":"20240527000453-p0owrp7","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"goctl config 是 用于对 goctl 静态配置文件做管理。 goctl config 的目录是根据工程项目来寻找的，以 goctl 可执行文件当前所在工作目录，寻找当前工作目录处在的 go module 或者 go path空间，然后在该空间下对 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"goctl.yaml"},{"Type":"NodeText","Data":"​ 进行管理。 如果当前工作目录下没有 go module 则会自动根据工作目录名称创建 go.mod 文件。"}]},{"ID":"20240527000453-d0d2aw1","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240527000453-d0d2aw1","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"goctl config 指令"}]},{"ID":"20240527000453-4kbdkz6","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240527000453-4kbdkz6","updated":"20240527000509"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"$ goctl config --help\nUsage:\n  goctl config [command]\n\nAvailable Commands:\n  clean       Clean goctl config file\n  init        Initialize goctl config file\n\nFlags:\n  -h, --help   help for config\n\n\nUse \"goctl config [command] --help\" for more information about a command.\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240527000453-9ammaqg","Type":"NodeParagraph","Properties":{"id":"20240527000453-9ammaqg","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"Copy"}]},{"ID":"20240527000453-iwwcsme","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240527000453-iwwcsme","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"init"}]},{"ID":"20240527000453-wd0g5kz","Type":"NodeParagraph","Properties":{"id":"20240527000453-wd0g5kz","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"初始化 goctl 静态配置文件。"}]},{"ID":"20240527000453-diyfhyq","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240527000453-diyfhyq","updated":"20240527000509"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"$ goctl config init --help\nInitialize goctl config file\n\nUsage:\n  goctl config init [flags]\n\nFlags:\n  -h, --help   help for init\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240527000453-obygdpk","Type":"NodeParagraph","Properties":{"id":"20240527000453-obygdpk","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"Copy"}]},{"ID":"20240527000453-qnztf66","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240527000453-qnztf66","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"clean"}]},{"ID":"20240527000453-5ztojj3","Type":"NodeParagraph","Properties":{"id":"20240527000453-5ztojj3","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"删除 goctl 配置文件。"}]},{"ID":"20240527000453-9gxnc2o","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240527000453-9gxnc2o","updated":"20240527000509"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"$ goctl config clean --help\nClean goctl config file\n\nUsage:\n  goctl config clean [flags]\n\nFlags:\n  -h, --help   help for clean\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240527000453-u60usgg","Type":"NodeParagraph","Properties":{"id":"20240527000453-u60usgg","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"Copy"}]},{"ID":"20240527000453-z2cu8iq","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240527000453-z2cu8iq","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"配置说明"}]},{"ID":"20240527000453-l76xqyg","Type":"NodeParagraph","Properties":{"id":"20240527000453-l76xqyg","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"goctl config 目前暂时仅支持对 model 数据类型映射的配置，其他配置将根据需要加入。"}]},{"ID":"20240527000453-ykgtlax","Type":"NodeParagraph","Properties":{"id":"20240527000453-ykgtlax","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"goctl config 初始化后会在项目工程中创建一个 goctl.yaml 文件，其内容如下："}]},{"ID":"20240527000453-4vikmgv","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240527000453-4vikmgv","updated":"20240527000509"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eWFtbA=="},{"Type":"NodeCodeBlockCode","Data":"model:\n  types_map:\n    bigint:\n      null_type: sql.NullInt64\n      type: int64\n      unsigned_type: uint64\n    dec:\n      null_type: sql.NullFloat64\n      type: float64\n    decimal:\n      null_type: sql.NullFloat64\n      type: float64\n    double:\n      null_type: sql.NullFloat64\n      type: float64\n    float:\n      null_type: sql.NullFloat64\n      type: float64\n    float4:\n      null_type: sql.NullFloat64\n      type: float64\n    float8:\n      null_type: sql.NullFloat64\n      type: float64\n    int:\n      null_type: sql.NullInt64\n      type: int64\n      unsigned_type: uint64\n    int1:\n      null_type: sql.NullInt64\n      type: int64\n      unsigned_type: uint64\n    int2:\n      null_type: sql.NullInt64\n      type: int64\n      unsigned_type: uint64\n    int3:\n      null_type: sql.NullInt64\n      type: int64\n      unsigned_type: uint64\n    int4:\n      null_type: sql.NullInt64\n      type: int64\n      unsigned_type: uint64\n    int8:\n      null_type: sql.NullInt64\n      type: int64\n      unsigned_type: uint64\n    integer:\n      null_type: sql.NullInt64\n      type: int64\n      unsigned_type: uint64\n    mediumint:\n      null_type: sql.NullInt64\n      type: int64\n      unsigned_type: uint64\n    middleint:\n      null_type: sql.NullInt64\n      type: int64\n      unsigned_type: uint64\n    smallint:\n      null_type: sql.NullInt64\n      type: int64\n      unsigned_type: uint64\n    tinyint:\n      null_type: sql.NullInt64\n      type: int64\n      unsigned_type: uint64\n    date:\n      null_type: sql.NullTime\n      type: time.Time\n    datetime:\n      null_type: sql.NullTime\n      type: time.Time\n    timestamp:\n      null_type: sql.NullTime\n      type: time.Time\n    time:\n      null_type: sql.NullString\n      type: string\n    year:\n      null_type: sql.NullInt64\n      type: int64\n      unsigned_type: uint64\n    bit:\n      null_type: sql.NullByte\n      type: byte\n      unsigned_type: byte\n    bool:\n      null_type: sql.NullBool\n      type: bool\n    boolean:\n      null_type: sql.NullBool\n      type: bool\n    char:\n      null_type: sql.NullString\n      type: string\n    varchar:\n      null_type: sql.NullString\n      type: string\n    nvarchar:\n      null_type: sql.NullString\n      type: string\n    nchar:\n      null_type: sql.NullString\n      type: string\n    character:\n      null_type: sql.NullString\n      type: string\n    longvarchar:\n      null_type: sql.NullString\n      type: string\n    linestring:\n      null_type: sql.NullString\n      type: string\n    multilinestring:\n      null_type: sql.NullString\n      type: string\n    binary:\n      null_type: sql.NullString\n      type: string\n    varbinary:\n      null_type: sql.NullString\n      type: string\n    tinytext:\n      null_type: sql.NullString\n      type: string\n    text:\n      null_type: sql.NullString\n      type: string\n    mediumtext:\n      null_type: sql.NullString\n      type: string\n    longtext:\n      null_type: sql.NullString\n      type: string\n    enum:\n      null_type: sql.NullString\n      type: string\n    set:\n      null_type: sql.NullString\n      type: string\n    json:\n      null_type: sql.NullString\n      type: string\n    blob:\n      null_type: sql.NullString\n      type: string\n    longblob:\n      null_type: sql.NullString\n      type: string\n    mediumblob:\n      null_type: sql.NullString\n      type: string\n    tinyblob:\n      null_type: sql.NullString\n      type: string\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240527000453-ji6fy7r","Type":"NodeParagraph","Properties":{"id":"20240527000453-ji6fy7r","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"Copy"}]},{"ID":"20240527000453-iag5old","Type":"NodeTable","TableAligns":[0,0],"Properties":{"colgroup":"|","id":"20240527000453-iag5old","updated":"20240527000509"},"Children":[{"Type":"NodeTableHead","Data":"thead","Children":[{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"字段名称"}]},{"Type":"NodeTableCell","Data":"th","Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"说明"}]}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"model"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"model 配置"}]}]},{"Type":"NodeTableRow","Data":"tr","Children":[{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"model.types_map"}]},{"Type":"NodeTableCell","Data":"td","Children":[{"Type":"NodeText","Data":"model 配置之类型映射规则，是一个 map\u003cstring,obj\u003e 结构，key 为数据库类型，value 为映射对象"}]}]}]},{"ID":"20240527000453-7n25buq","Type":"NodeParagraph","Properties":{"id":"20240527000453-7n25buq","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"model 的 golang 结构体"}]},{"ID":"20240527000453-h9gckpz","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240527000453-h9gckpz","updated":"20240527000509"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"// Model defines the configuration for the model code generation.\nModel struct {\n    // 类型映射\n    TypesMap map[string]ModelTypeMapOption `yaml:\"types_map,omitempty\" `\n}\n\n// ModelTypeMapOption custom Type Options.\nModelTypeMapOption struct {\n    // 数据库类型名称，不需要附加约束（如：长度等）如 bigint,varchar\n    Type string `yaml:\"type\"`\n\n    // 当数据类型为 unsigned 修饰时需要映射的 golang 映射类型\n    UnsignedType string `yaml:\"unsigned_type,omitempty\"`\n\n    // 当数据类型允许为 null且没有默认值时需要映射的 golang 映射类型，此优先级高于 unsigned 约束\n    NullType string `yaml:\"null_type,omitempty\"`\n\n    // 当被映射的 golang 类型为外部包时，需要指定包名。\n    Pkg string `yaml:\"pkg,omitempty\"`\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240527000453-u5zsxlo","Type":"NodeParagraph","Properties":{"id":"20240527000453-u5zsxlo","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"Copy"}]},{"ID":"20240527000453-5qchdl7","Type":"NodeParagraph","Properties":{"id":"20240527000453-5qchdl7","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"数据库类型映射示例：将 decimal 映射为三方的 decimal.Decimal 包，其在 yaml 的表现为灰色底纹部分："}]},{"ID":"20240527000453-xji969y","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240527000453-xji969y","updated":"20240527000509"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"eWFtbA=="},{"Type":"NodeCodeBlockCode","Data":"model:\n  types_map:\n    bigint: # 当数据字段类型为 bigint 时，\n      # 1. 如果允许 null 且没有默认值时 golang 类型映射为 sql.NullInt64\n      # 2. 如果不允许 null 或者有默认值，则 golang 类型映射为 int64\n      # 3. 如果不允许 null 或者有默认值，且为 unsigned 修饰，则 golang 类型映射为 uint64\n      null_type: sql.NullInt64\n      type: int64\n      unsigned_type: uint64\n    dec:\n      null_type: sql.NullFloat64\n      type: float64\n    decimal:\n      null_type: decimal.NullDecimal\n      pkg: github.com/shopspring/decimal\n      type: decimal.Decimal\n    ...\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240527000453-t5lfffz","Type":"NodeParagraph","Properties":{"id":"20240527000453-t5lfffz","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"Copy"}]},{"ID":"20240527000453-u36uzfy","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240527000453-u36uzfy","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"使用示例"}]},{"ID":"20240527000453-uek9s5h","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240527000453-uek9s5h","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"在不存在 go module 的目录下初始化配置"}]},{"ID":"20240527000453-hdk28z7","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240527000453-hdk28z7","updated":"20240527000509"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"$ ll\ntotal 0\n$ goctl config init\ngoctl.yaml generated in ~/demo/goctl-config/goctl.yaml\n$ ls\ngo.mod     goctl.yaml\n$ cat go.mod\nmodule goctl-config\n\ngo 1.20\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240527000453-vn1vmpq","Type":"NodeParagraph","Properties":{"id":"20240527000453-vn1vmpq","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"Copy"}]},{"ID":"20240527000453-rcf51px","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240527000453-rcf51px","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"在存在 go module 的目录下初始化配置"}]},{"ID":"20240527000453-h4hxmfr","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240527000453-h4hxmfr","updated":"20240527000509"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"$ ll\ntotal 8\n-rw-r--r--  1 ***  staff    29B Apr 10 16:35 go.mod\n$ goctl config init\ngoctl.yaml generated in ~/demo/goctl-config/goctl.yaml\n$ ll\ntotal 16\n-rw-r--r--  1 ***  staff    29B Apr 10 16:35 go.mod\n-rw-r--r--  1 ***  staff   3.3K Apr 10 16:37 goctl.yaml\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240527000453-o5iui09","Type":"NodeParagraph","Properties":{"id":"20240527000453-o5iui09","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"Copy"}]},{"ID":"20240527000453-7inz7a5","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240527000453-7inz7a5","updated":"20240527000509"},"Children":[{"Type":"NodeText","Data":"清除配置"}]},{"ID":"20240527000453-npfsbtx","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240527000453-npfsbtx","updated":"20240527000509"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"YmFzaA=="},{"Type":"NodeCodeBlockCode","Data":"$ ll\ntotal 16\n-rw-r--r--  1 ***  staff    29B Apr 10 16:35 go.mod\n-rw-r--r--  1 ***  staff   3.3K Apr 10 16:37 goctl.yaml\n$ goctl config clean\n$ ll\ntotal 8\n-rw-r--r--  1 ***  staff    29B Apr 10 16:35 go.mod\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240527000444-lh1sqki","Type":"NodeParagraph","Properties":{"id":"20240527000444-lh1sqki","updated":"20240527000509"}}]}