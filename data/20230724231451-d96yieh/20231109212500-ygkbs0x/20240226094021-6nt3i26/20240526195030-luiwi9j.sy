{"ID":"20240526195030-luiwi9j","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f9a6","id":"20240526195030-luiwi9j","title":"Redis 使用","type":"doc","updated":"20240526195156"},"Children":[{"ID":"20240526195030-rdyrdbb","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240526195030-rdyrdbb","updated":"20240526195112"},"Children":[{"Type":"NodeText","Data":"Redis 配置说明"}]},{"ID":"20240526195124-hwo9j1k","Type":"NodeParagraph","Properties":{"id":"20240526195124-hwo9j1k","updated":"20240526195124"},"Children":[{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://github.com/zeromicro/go-zero/blob/master/core/stores/redis/conf.go#L16","TextMarkTextContent":"RedisConf"},{"Type":"NodeText","Data":" 相关介绍。"}]},{"ID":"20240526195124-s9grdpf","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240526195124-s9grdpf","updated":"20240526195124"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"RedisConf struct {\n    Host string\n    Type string `json:\",default=node,options=node|cluster\"`\n    Pass string `json:\",optional\"`\n    Tls  bool   `json:\",optional\"`\n}\n\nHost: redis 服务地址 ip:port, 如果是 redis cluster 则为 ip1:port1,ip2:port2,ip3:port3...(暂不支持redis sentinel)\nType: node 单节点 redis，cluster redis 集群\nPass: 密码\nTls: 是否开启tls\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240526195124-2tj2r8t","Type":"NodeParagraph","Properties":{"id":"20240526195124-2tj2r8t","updated":"20240526195124"},"Children":[{"Type":"NodeText","Data":"初始化 redis 配置, 当然我们推荐使用 conf.MustLoad 进行配置的加载，可参考"},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://go-zero.dev/docs/tasks/static/configuration","TextMarkTextContent":"配置文件"}]},{"ID":"20240526195124-tywewdn","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240526195124-tywewdn","updated":"20240526195124"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"conf := redis.RedisConf{\n    Host: \"127.0.0.1:6379\",\n    Type: \"node\",\n    Pass: \"123456\",\n    Tls:  false,\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240526195124-vojdswi","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240526195124-vojdswi","updated":"20240526195124"},"Children":[{"Type":"NodeText","Data":"创建 redis 实例"}]},{"ID":"20240526195124-ajjkb19","Type":"NodeParagraph","Properties":{"id":"20240526195124-ajjkb19","updated":"20240526195125"},"Children":[{"Type":"NodeText","Data":"使用 "},{"Type":"NodeTextMark","TextMarkType":"a","TextMarkAHref":"https://github.com/zeromicro/go-zero/blob/master/core/stores/redis/conf.go#L16","TextMarkTextContent":"MustNewRedis"},{"Type":"NodeText","Data":" 创建一个redis 链接。"}]},{"ID":"20240526195124-8jvolfg","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240526195124-8jvolfg","updated":"20240526195125"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z29sYW5n"},{"Type":"NodeCodeBlockCode","Data":"conf := redis.RedisConf{\n    Host: \"127.0.0.1:6379\",\n    Type: \"node\",\n    Pass: \"123456\",\n    Tls:  false,\n}\n\nrds := redis.MustNewRedis(conf)\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240526195124-64mkhcu","Type":"NodeParagraph","Properties":{"id":"20240526195124-64mkhcu","updated":"20240526195125"},"Children":[{"Type":"NodeText","Data":"这样我们就完成了 rds 的实例创建。"}]},{"ID":"20240526195124-wcdzkg3","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240526195124-wcdzkg3","updated":"20240526195124"},"Children":[{"Type":"NodeText","Data":"redis 使用"}]},{"ID":"20240526195124-zzsag3i","Type":"NodeParagraph","Properties":{"id":"20240526195124-zzsag3i","updated":"20240526195125"},"Children":[{"Type":"NodeText","Data":"字符串值 value 关联到 key， 并从 redis 取出对应的值。"}]},{"ID":"20240526195124-10iwegm","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240526195124-10iwegm","updated":"20240526195125"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"    ctx := context.Background()\n    err := rds.SetCtx(ctx, \"key\", \"hello world\")\n    if err != nil {\n        logc.Error(ctx, err)\n    }\n\n    v, err := rds.GetCtx(ctx, \"key\")\n    if err != nil {\n        logc.Error(ctx, err)\n    }\n    fmt.Println(v)\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240526195124-leugy2n","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240526195124-leugy2n","updated":"20240526195124"},"Children":[{"Type":"NodeText","Data":"完整的实例如下"}]},{"ID":"20240526195124-9pkoubu","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240526195124-9pkoubu","updated":"20240526195138"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"time\"\n\n    \"github.com/zeromicro/go-zero/core/logc\"\n    \"github.com/zeromicro/go-zero/core/stores/redis\"\n)\n\nfunc main() {\n    conf := redis.RedisConf{\n        Host:        \"127.0.0.1:6379\",\n        Type:        \"node\",\n        Pass:        \"\",\n        Tls:         false,\n        NonBlock:    false,\n        PingTimeout: time.Second,\n    }\n    rds := redis.MustNewRedis(conf)\n    ctx := context.Background()\n    err := rds.SetCtx(ctx, \"key\", \"hello world\")\n    if err != nil {\n        logc.Error(ctx, err)\n    }\n\n    v, err := rds.GetCtx(ctx, \"key\")\n    if err != nil {\n        logc.Error(ctx, err)\n    }\n    fmt.Println(v)\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240526195127-o6rwaab","Type":"NodeParagraph","Properties":{"id":"20240526195127-o6rwaab"}}]}