{"ID":"20240526195901-dk8eg0k","Spec":"1","Type":"NodeDocument","Properties":{"icon":"2764-fe0f-200d-1f525","id":"20240526195901-dk8eg0k","title":"日志","type":"doc","updated":"20240526200038"},"Children":[{"ID":"20240526195917-6ctt2nz","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240526195917-6ctt2nz","updated":"20240526195917"},"Children":[{"Type":"NodeText","Data":"概述"}]},{"ID":"20240526195917-fiqz1c5","Type":"NodeParagraph","Properties":{"id":"20240526195917-fiqz1c5","updated":"20240526195918"},"Children":[{"Type":"NodeText","Data":"logc 和 logx 是 go-zero 的日志库，我们可以轻松实现日志的打印的能力。"}]},{"ID":"20240526195934-3dpx1it","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240526195934-3dpx1it","updated":"20240526195934"},"Children":[{"Type":"NodeText","Data":"简单的日志打印"}]},{"ID":"20240526195935-1l68i36","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240526195935-1l68i36","updated":"20240526195938"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"logc.Info(context.Background(), \"hello world\")\n// {\"@timestamp\":\"2023-04-22T20:35:42.681+08:00\",\"caller\":\"inherit/main.go:40\",\"content\":\"hello world\",\"level\":\"info\"}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240526195939-x8zawho","Type":"NodeParagraph","Properties":{"id":"20240526195939-x8zawho","updated":"20240526195945"},"Children":[{"Type":"NodeText","Data":"我们直接使用 logc 进行 info 的日志打印，其中 logc，是需要带上 conext 的，我们会将 ctx 中的 traceID 等信息也打印出来。"}]},{"ID":"20240526195947-hyd8wk0","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240526195947-hyd8wk0","updated":"20240526195947"},"Children":[{"Type":"NodeText","Data":"输出日志到文件"}]},{"ID":"20240526195948-wrp7s0w","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240526195948-wrp7s0w","updated":"20240526195956"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"package main\n\nimport (\n    \"context\"\n\n    \"github.com/zeromicro/go-zero/core/conf\"\n    \"github.com/zeromicro/go-zero/core/logc\"\n    \"github.com/zeromicro/go-zero/core/logx\"\n)\n\nfunc main() {\n    var cfg logx.LogConf\n    _ = conf.FillDefault(\u0026cfg)\n    cfg.Mode = \"file\"\n\n    logc.MustSetup(cfg)\n    defer logc.Close()\n    logc.Info(context.Background(), \"hello world\")\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240526195954-g5bzh7e","Type":"NodeParagraph","Properties":{"id":"20240526195954-g5bzh7e","updated":"20240526200002"},"Children":[{"Type":"NodeText","Data":"这样我们就可以在当前的路径下面看到 "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"logs"},{"Type":"NodeText","Data":" 文件夹，里面就有我们的所有日志文件。 当然你也可以使用 "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"cfg.Path ="},{"Type":"NodeText","Data":" "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"\u0026quot;/tmp/logs\u0026quot;"},{"Type":"NodeText","Data":" 修改日志的路径。"}]},{"ID":"20240526200015-z4y59yn","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240526200015-z4y59yn","updated":"20240526200015"},"Children":[{"Type":"NodeText","Data":"日志中带上额外信息"}]},{"ID":"20240526200016-gxrqxf2","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240526200016-gxrqxf2","updated":"20240526200019"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"logc.Infow(context.Background(), \"hello world\", logc.Field(\"key\", \"value\"))\n// {\"@timestamp\":\"2023-04-22T20:48:12.516+08:00\",\"caller\":\"inherit/main.go:11\",\"content\":\"hello world\",\"key\":\"value\",\"level\":\"info\"}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240526200020-69h7q57","Type":"NodeParagraph","Properties":{"id":"20240526200020-69h7q57","updated":"20240526200023"},"Children":[{"Type":"NodeText","Data":"我们可以通过 logc.Filed 对我们的日志进行扩展。"}]},{"ID":"20240526200027-gl5npv4","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240526200027-gl5npv4","updated":"20240526200027"},"Children":[{"Type":"NodeText","Data":"日志带上自定义的key"}]},{"ID":"20240526200028-qliyq2b","Type":"NodeParagraph","Properties":{"id":"20240526200028-qliyq2b","updated":"20240526200032"},"Children":[{"Type":"NodeText","Data":"我们可以在所有的日志上面带上一些默认的 key和value，例如：我们希望在 api 所有链路上面都带上 路由信息，我们可以将信息注入到ctx中，这样后面的方法在打印的时候就会自动带上 kv 信息。 例如："}]},{"ID":"20240526200035-vr2prvq","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240526200035-vr2prvq","updated":"20240526200036"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"ctx := logx.ContextWithFields(context.Background(), logx.Field(\"path\", \"/user/info\"))\n\nlogc.Infow(ctx, \"hello world\")\nlogc.Error(ctx, \"error log\")\n// {\"@timestamp\":\"2023-04-22T20:53:00.593+08:00\",\"caller\":\"inherit/main.go:13\",\"content\":\"hello world\",\"level\":\"info\",\"path\":\"/user/info\"}\n// {\"@timestamp\":\"2023-04-22T20:53:00.593+08:00\",\"caller\":\"inherit/main.go:14\",\"content\":\"error log\",\"level\":\"error\",\"path\":\"/user/info\"}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240526200038-mib2n7u","Type":"NodeParagraph","Properties":{"id":"20240526200038-mib2n7u"}}]}