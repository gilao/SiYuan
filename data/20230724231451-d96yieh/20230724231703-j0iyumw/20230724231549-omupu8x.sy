{"ID":"20230724231549-omupu8x","Spec":"1","Type":"NodeDocument","Properties":{"id":"20230724231549-omupu8x","title":"net-http-httptest","updated":"20230724231549"},"Children":[{"ID":"20230724231550-zk9zpd8","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20230724231550-zk9zpd8","updated":"20230724231550"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"net-http-httptest"}]},{"ID":"20230724231551-b4azb1s","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231551-b4azb1s","updated":"20230724231551"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"import \"net/http/httptest\"\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231552-tswveqw","Type":"NodeParagraph","Properties":{"id":"20230724231552-tswveqw","updated":"20230724231552"},"Children":[{"Type":"NodeText","Data":"httptest包提供了HTTP测试的常用函数。"}]},{"ID":"20230724231553-03xtwih","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231553-03xtwih","updated":"20230724231553"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"Constants"}]},{"ID":"20230724231554-k7a4z4v","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231554-k7a4z4v","updated":"20230724231554"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"const DefaultRemoteAddr = \"1.2.3.4\"\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231555-k7hpvbf","Type":"NodeParagraph","Properties":{"id":"20230724231555-k7hpvbf","updated":"20230724231555"},"Children":[{"Type":"NodeText","Data":"DefaultRemoteAddr是默认的远端地址。如果ResponseRecorder未显式的设置该属性，RemoteAddr方法就会返回该值。"}]},{"ID":"20230724231556-lzccicm","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231556-lzccicm","updated":"20230724231556"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src//net/http/httptest/httptest.go#L41","TextMarkTextContent":"NewRequest"}]},{"ID":"20230724231557-9iwr6a4","Type":"NodeParagraph","Properties":{"id":"20230724231557-9iwr6a4","updated":"20230724231557"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/net/http/httptest/httptest.go#L41","TextMarkTextContent":"❖"}]},{"ID":"20230724231558-px3gxyy","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231558-px3gxyy","updated":"20230724231558"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func NewRequest(method, target string, body io.Reader) *http.Request\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231559-2smffj7","Type":"NodeParagraph","Properties":{"id":"20230724231559-2smffj7","updated":"20230724231559"},"Children":[{"Type":"NodeText","Data":"NewRequest 返回一个新的服务器访问请求，这个请求可以传递给 http.Handler 以便进行测试。"}]},{"ID":"20230724231560-s2959rb","Type":"NodeParagraph","Properties":{"id":"20230724231560-s2959rb","updated":"20230724231560"},"Children":[{"Type":"NodeText","Data":"target 参数的值为 "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"http://tools.ietf.org/html/rfc7230","TextMarkTextContent":"RFC 7230"},{"Type":"NodeText","Data":" 中提到的“请求目标”（request-target)： 它可以是一个路径或者一个绝对 URL。如果 target 是一个绝对 URL，那么 URL 中的主机名（host name）将被使用；否则主机名将为 example.com。"}]},{"ID":"20230724231561-uqzeyku","Type":"NodeParagraph","Properties":{"id":"20230724231561-uqzeyku","updated":"20230724231561"},"Children":[{"Type":"NodeText","Data":"当 target 的模式为 https 时，TLS 字段的值将被设置为一个非 nil 的随意值（dummy value）。"}]},{"ID":"20230724231562-lv5drn1","Type":"NodeParagraph","Properties":{"id":"20230724231562-lv5drn1","updated":"20230724231562"},"Children":[{"Type":"NodeText","Data":"Request.Proto 总是为 HTTP/1.1。"}]},{"ID":"20230724231563-wjow02z","Type":"NodeParagraph","Properties":{"id":"20230724231563-wjow02z","updated":"20230724231563"},"Children":[{"Type":"NodeText","Data":"如果 method 参数的值为空， 那么使用 GET 方法作为默认值。"}]},{"ID":"20230724231564-qb6sin6","Type":"NodeParagraph","Properties":{"id":"20230724231564-qb6sin6","updated":"20230724231564"},"Children":[{"Type":"NodeText","Data":"body 参数的值可以为 nil；另一方面，如果 body 参数的值为 *bytes.Reader 类型、 *strings.Reader 类型或者 *bytes.Buffer 类型，那么 Request.ContentLength 将被设置。"}]},{"ID":"20230724231565-40um60g","Type":"NodeParagraph","Properties":{"id":"20230724231565-40um60g","updated":"20230724231565"},"Children":[{"Type":"NodeText","Data":"为了使用的方便，NewRequest 将在 panic 可以被接受的情况下，使用 panic 代替错误。"}]},{"ID":"20230724231566-3nvefz5","Type":"NodeParagraph","Properties":{"id":"20230724231566-3nvefz5","updated":"20230724231566"},"Children":[{"Type":"NodeText","Data":"如果你想要生成的不是服务器访问请求，而是一个客户端 HTTP 请求，那么请使用 net/http 包中的 NewRequest 函数。"}]},{"ID":"20230724231567-ktmji09","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231567-ktmji09","updated":"20230724231567"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"type "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/net/http/httptest/recorder.go?name=release#15","TextMarkTextContent":"ResponseRecorder"}]},{"ID":"20230724231568-54mmgiu","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231568-54mmgiu","updated":"20230724231568"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"type ResponseRecorder struct {\n    Code      int           // HTTP回复的状态码\n    HeaderMap http.Header   // HTTP回复的头域\n    Body      *bytes.Buffer // 如非nil，会将Write方法写入的数据写入bytes.Buffer\n    Flushed   bool\n    // 内含隐藏或非导出字段\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231569-mixjxi8","Type":"NodeParagraph","Properties":{"id":"20230724231569-mixjxi8","updated":"20230724231569"},"Children":[{"Type":"NodeText","Data":"ResponseRecorder实现了http.ResponseWriter接口，它记录了其修改，用于之后的检查。"}]},{"ID":"20230724231570-vhit5mr","Type":"NodeParagraph","Properties":{"id":"20230724231570-vhit5mr","updated":"20230724231570"},"Children":[{"Type":"NodeText","Data":"Example"}]},{"ID":"20230724231571-1chrll3","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230724231571-1chrll3","updated":"20230724231571"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/net/http/httptest/recorder.go?name=release#25","TextMarkTextContent":"NewRecorder"}]},{"ID":"20230724231572-2rs5a09","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231572-2rs5a09","updated":"20230724231572"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func NewRecorder() *ResponseRecorder\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231573-zz896cc","Type":"NodeParagraph","Properties":{"id":"20230724231573-zz896cc","updated":"20230724231573"},"Children":[{"Type":"NodeText","Data":"NewRecorder返回一个初始化了的ResponseRecorder."}]},{"ID":"20230724231574-see1dsr","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230724231574-see1dsr","updated":"20230724231574"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func (*ResponseRecorder) "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/net/http/httptest/recorder.go?name=release#67","TextMarkTextContent":"Flush"}]},{"ID":"20230724231575-pujzoju","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231575-pujzoju","updated":"20230724231575"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func (rw *ResponseRecorder) Flush()\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231576-ecrf7v2","Type":"NodeParagraph","Properties":{"id":"20230724231576-ecrf7v2","updated":"20230724231576"},"Children":[{"Type":"NodeText","Data":"Flush将rw.Flushed设置为真。"}]},{"ID":"20230724231577-4upcplc","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230724231577-4upcplc","updated":"20230724231577"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func (*ResponseRecorder) "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/net/http/httptest/recorder.go?name=release#38","TextMarkTextContent":"Header"}]},{"ID":"20230724231578-32oetav","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231578-32oetav","updated":"20230724231578"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func (rw *ResponseRecorder) Header() http.Header\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231579-j8q8s4w","Type":"NodeParagraph","Properties":{"id":"20230724231579-j8q8s4w","updated":"20230724231579"},"Children":[{"Type":"NodeText","Data":"Header返回回复的头域，即Header字段。"}]},{"ID":"20230724231580-6rbpcj2","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230724231580-6rbpcj2","updated":"20230724231580"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func (*ResponseRecorder) "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/net/http/httptest/recorder.go#L162","TextMarkTextContent":"Result"}]},{"ID":"20230724231581-hypdbek","Type":"NodeParagraph","Properties":{"id":"20230724231581-hypdbek","updated":"20230724231581"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://golang.org/src/net/http/httptest/recorder.go#L162","TextMarkTextContent":"❖"}]},{"ID":"20230724231582-zsmubia","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231582-zsmubia","updated":"20230724231582"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func (rw *ResponseRecorder) Result() *http.Response\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231583-ulkw3o6","Type":"NodeParagraph","Properties":{"id":"20230724231583-ulkw3o6","updated":"20230724231583"},"Children":[{"Type":"NodeText","Data":"Result 返回处理器生成的响应。"}]},{"ID":"20230724231584-ofqv8b2","Type":"NodeParagraph","Properties":{"id":"20230724231584-ofqv8b2","updated":"20230724231584"},"Children":[{"Type":"NodeText","Data":"处理器返回的响应至少会对状态码（StatusCode）、首部（Header）、主体（Body）以及可选的 Trailer 进行设置。 因为未来可能会有更多字段被设置，所以用户不应该在测试里面对结果调用 DeepEqual。"}]},{"ID":"20230724231585-dwv34uf","Type":"NodeParagraph","Properties":{"id":"20230724231585-dwv34uf","updated":"20230724231585"},"Children":[{"Type":"NodeText","Data":"Response.Header 是写入操作第一次调用时的首部快照（snapshot of the headers）； 另一方面， 如果处理器没有执行过写入操作， 那么 Response.Header 就是 Result 方法调用时的首部快照。"}]},{"ID":"20230724231586-nvwux0w","Type":"NodeParagraph","Properties":{"id":"20230724231586-nvwux0w","updated":"20230724231586"},"Children":[{"Type":"NodeText","Data":"Response.Body 将被生成为一个非 nil 值，而 Body.Read 则保证不会返回除 io.EOF 之外的其他任何错误。"}]},{"ID":"20230724231587-rtaylp4","Type":"NodeParagraph","Properties":{"id":"20230724231587-rtaylp4","updated":"20230724231587"},"Children":[{"Type":"NodeText","Data":"Result 必须在处理器执行完毕之后调用。"}]},{"ID":"20230724231588-8bgdh19","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230724231588-8bgdh19","updated":"20230724231588"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func (*ResponseRecorder) "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/net/http/httptest/recorder.go?name=release#48","TextMarkTextContent":"Write"}]},{"ID":"20230724231589-tv4ad5n","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231589-tv4ad5n","updated":"20230724231589"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func (rw *ResponseRecorder) Write(buf []byte) (int, error)\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231590-pfk70ys","Type":"NodeParagraph","Properties":{"id":"20230724231590-pfk70ys","updated":"20230724231590"},"Children":[{"Type":"NodeText","Data":"Write总是成功，如果rw.Body非nil会把数据写入该字段。"}]},{"ID":"20230724231591-osuh73k","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230724231591-osuh73k","updated":"20230724231591"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func (*ResponseRecorder) "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/net/http/httptest/recorder.go?name=release#59","TextMarkTextContent":"WriteHeader"}]},{"ID":"20230724231592-m32lxyl","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231592-m32lxyl","updated":"20230724231592"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func (rw *ResponseRecorder) WriteHeader(code int)\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231593-mh2ah65","Type":"NodeParagraph","Properties":{"id":"20230724231593-mh2ah65","updated":"20230724231593"},"Children":[{"Type":"NodeText","Data":"WriteHeader设置rw.Code。"}]},{"ID":"20230724231594-ai4mb4s","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230724231594-ai4mb4s","updated":"20230724231594"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func (*ResponseRecorder) "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://golang.org/src/net/http/httptest/recorder.go#L107","TextMarkTextContent":"WriteString"}]},{"ID":"20230724231595-u8l2cye","Type":"NodeParagraph","Properties":{"id":"20230724231595-u8l2cye","updated":"20230724231595"},"Children":[{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://golang.org/src/net/http/httptest/recorder.go#L107","TextMarkTextContent":"❖"}]},{"ID":"20230724231596-a2hvye3","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231596-a2hvye3","updated":"20230724231596"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func (rw *ResponseRecorder) WriteString(str string) (int, error)\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231597-1ydypph","Type":"NodeParagraph","Properties":{"id":"20230724231597-1ydypph","updated":"20230724231597"},"Children":[{"Type":"NodeText","Data":"在 str 不为 nil 的情况下， WriteString 总会成功地将 buf 中的内容写入到 rw.Body 当中。"}]},{"ID":"20230724231598-pn2ha4n","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231598-pn2ha4n","updated":"20230724231598"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"type "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/net/http/httptest/server.go?name=release#21","TextMarkTextContent":"Server"}]},{"ID":"20230724231599-6wq7lc5","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231599-6wq7lc5","updated":"20230724231599"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"type Server struct {\n    URL      string // 格式为http://ipaddr:port，没有末尾斜杠的基地址\n    Listener net.Listener\n    // TLS是可选的TLS配置，在TLS开始后会填写为新的配置。\n    // 如果在未启动的Server调用StartTLS方法前设置，已经存在的字段会拷贝进新配置里。\n    TLS *tls.Config\n    // Config可能会在调用Start/StartTLS方法之前调用NewUnstartedServer时被修改。\n    Config *http.Server\n    // 内含隐藏或非导出字段\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231600-qgqiw6k","Type":"NodeParagraph","Properties":{"id":"20230724231600-qgqiw6k","updated":"20230724231600"},"Children":[{"Type":"NodeText","Data":"Server是一个HTTP服务端，在本地环回接口的某个系统选择的端口监听，用于点对点HTTP测试。"}]},{"ID":"20230724231601-vtqw3d7","Type":"NodeParagraph","Properties":{"id":"20230724231601-vtqw3d7","updated":"20230724231601"},"Children":[{"Type":"NodeText","Data":"Example"}]},{"ID":"20230724231602-kfulo6q","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230724231602-kfulo6q","updated":"20230724231602"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/net/http/httptest/server.go?name=release#82","TextMarkTextContent":"NewServer"}]},{"ID":"20230724231603-2i79mip","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231603-2i79mip","updated":"20230724231603"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func NewServer(handler http.Handler) *Server\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231604-ik1thmp","Type":"NodeParagraph","Properties":{"id":"20230724231604-ik1thmp","updated":"20230724231604"},"Children":[{"Type":"NodeText","Data":"NewServer返回一个新的、已启动的Server。调用者必须在用完时调用Close方法关闭它。"}]},{"ID":"20230724231605-ah6k88b","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230724231605-ah6k88b","updated":"20230724231605"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/net/http/httptest/server.go?name=release#158","TextMarkTextContent":"NewTLSServer"}]},{"ID":"20230724231606-vonhuw2","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231606-vonhuw2","updated":"20230724231606"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func NewTLSServer(handler http.Handler) *Server\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231607-fl8oux5","Type":"NodeParagraph","Properties":{"id":"20230724231607-fl8oux5","updated":"20230724231607"},"Children":[{"Type":"NodeText","Data":"NewTLSServer返回一个新的、使用TLS的、已启动的Server。调用者必须在用完时调用Close方法关闭它。"}]},{"ID":"20230724231608-a149ynk","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230724231608-a149ynk","updated":"20230724231608"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/net/http/httptest/server.go?name=release#94","TextMarkTextContent":"NewUnstartedServer"}]},{"ID":"20230724231609-ehia1nb","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231609-ehia1nb","updated":"20230724231609"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func NewUnstartedServer(handler http.Handler) *Server\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231610-dkd9t27","Type":"NodeParagraph","Properties":{"id":"20230724231610-dkd9t27","updated":"20230724231610"},"Children":[{"Type":"NodeText","Data":"NewUnstartedServer返回一个新的、未启动的Server。在修改其配置后，调用者应该调用Start或StartTLS启动它；调在用完时用者必须调用Close方法关闭它。"}]},{"ID":"20230724231611-03hv6xe","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230724231611-03hv6xe","updated":"20230724231611"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func (*Server) "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/net/http/httptest/server.go?name=release#102","TextMarkTextContent":"Start"}]},{"ID":"20230724231612-3jj3wxs","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231612-3jj3wxs","updated":"20230724231612"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func (s *Server) Start()\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231613-mcunzpx","Type":"NodeParagraph","Properties":{"id":"20230724231613-mcunzpx","updated":"20230724231613"},"Children":[{"Type":"NodeText","Data":"Start启动NewUnstartedServer返回的服务端。"}]},{"ID":"20230724231614-g4wp0fl","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230724231614-g4wp0fl","updated":"20230724231614"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func (*Server) "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/net/http/httptest/server.go?name=release#117","TextMarkTextContent":"StartTLS"}]},{"ID":"20230724231615-16ign23","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231615-16ign23","updated":"20230724231615"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func (s *Server) StartTLS()\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231616-f7qzt2l","Type":"NodeParagraph","Properties":{"id":"20230724231616-f7qzt2l","updated":"20230724231616"},"Children":[{"Type":"NodeText","Data":"StartTLS启动NewUnstartedServer函数返回的服务端的TLS监听。"}]},{"ID":"20230724231617-xftcwtf","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230724231617-xftcwtf","updated":"20230724231617"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func (*Server) "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/net/http/httptest/server.go?name=release#177","TextMarkTextContent":"CloseClientConnections"}]},{"ID":"20230724231618-jxqw67m","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231618-jxqw67m","updated":"20230724231618"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func (s *Server) CloseClientConnections()\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231619-udxoovb","Type":"NodeParagraph","Properties":{"id":"20230724231619-udxoovb","updated":"20230724231619"},"Children":[{"Type":"NodeText","Data":"CloseClientConnections关闭当前任何与该服务端建立的HTTP连接。"}]},{"ID":"20230724231620-80xnvm7","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230724231620-80xnvm7","updated":"20230724231620"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func (*Server) "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/net/http/httptest/server.go?name=release#166","TextMarkTextContent":"Close"}]},{"ID":"20230724231621-yhzljls","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231621-yhzljls","updated":"20230724231621"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func (s *Server) Close()\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231622-bszc5sz","Type":"NodeParagraph","Properties":{"id":"20230724231622-bszc5sz","updated":"20230724231622"},"Children":[{"Type":"NodeText","Data":"Close关闭服务端，并阻塞直到所有该服务端未完成的请求都结束为止。"}]}]}