{"ID":"20240407111532-38gcj7a","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f414","id":"20240407111532-38gcj7a","tags":"公众号-Golang语言开发栈,Go-1.22,Go-http.ServeMux,需要仔细看","title":"Go 1.22 对 net http.ServeMux 多路复用器新增两个增强功能","updated":"20240407142835"},"Children":[{"ID":"20240407111609-9wjzrei","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240407111609-9wjzrei","updated":"20240407111617"},"Children":[{"Type":"NodeText","Data":"介绍"}]},{"ID":"20240407111617-lc7zm3e","Type":"NodeParagraph","Properties":{"id":"20240407111617-lc7zm3e","updated":"20240407111714"},"Children":[{"Type":"NodeText","Data":"在 Go 1.22 中，标准库 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"net/http"},{"Type":"NodeText","Data":"​的 "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"ServeMux 路由模式增强，"},{"Type":"NodeText","Data":" 可以区分 HTTP 请求方法和支持通配符。"}]},{"ID":"20240407111714-wqcsv5w","Type":"NodeParagraph","Properties":{"id":"20240407111714-wqcsv5w","updated":"20240407111735"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ServeMux"},{"Type":"NodeText","Data":"​ 是一个 HTTP 请求多路复用器，它将每个传入请求的 URL 与已注册路由模式列表进行匹配，并调用与 URL 最匹配的路由模式的处理器。"}]},{"ID":"20240407111741-g02298d","Type":"NodeParagraph","Properties":{"id":"20240407111741-g02298d","updated":"20240407111741"},"Children":[{"Type":"NodeText","Data":"本文我们介绍路由模式增强的"},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"多路复用器"},{"Type":"NodeText","Data":" "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ServeMux"},{"Type":"NodeText","Data":"​ 的使用方式。"}]},{"ID":"20240407111532-9v5lmp8","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240407111532-9v5lmp8","updated":"20240407111752"},"Children":[{"Type":"NodeText","Data":"路由模式"}]},{"ID":"20240407112313-axa7bir","Type":"NodeParagraph","Properties":{"id":"20240407112313-axa7bir","updated":"20240407112313"},"Children":[{"Type":"NodeText","Data":"路由模式可以匹配请求方法、请求 HOST 和请求路径，路由模式的格式如下："}]},{"ID":"20240407112313-656nh3w","Type":"NodeParagraph","Properties":{"id":"20240407112313-656nh3w","updated":"20240407112313"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"[METHOD ][HOST]/[PATH]"},{"Type":"NodeText","Data":"​"}]},{"ID":"20240407112313-qjlxyrt","Type":"NodeParagraph","Properties":{"id":"20240407112313-qjlxyrt","updated":"20240407112313"},"Children":[{"Type":"NodeText","Data":"三个部分都是可选的，如果路由模式中存在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"METHOD"},{"Type":"NodeText","Data":"​，它的后面必须有一个空格。"}]},{"ID":"20240407112313-xa7p69y","Type":"NodeParagraph","Properties":{"id":"20240407112313-xa7p69y","updated":"20240407112313"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"限定 HTTP 请求方法的路由模式"}]},{"ID":"20240407112313-alad7hk","Type":"NodeParagraph","Properties":{"id":"20240407112313-alad7hk","updated":"20240407112313"},"Children":[{"Type":"NodeText","Data":"示例代码："}]},{"ID":"20240407112315-9903ltn","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20240407112315-9903ltn","updated":"20240407112348"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"Z28="},{"Type":"NodeCodeBlockCode","Data":"func main() {\n\t// 使用 GET 方法注册处理器函数\n\tmux := http.NewServeMux()\n\tmux.HandleFunc(\"GET /goods/\", func(w http.ResponseWriter, r *http.Request) {\n\t\tfmt.Fprintf(w, \"iPhone\")\n\t})\n\t// 创建 HTTP 服务器\n\tserver := http.Server{\n\t\tHandler: mux,\n\t}\n\tlog.Fatal(server.ListenAndServe())\n}\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20240407112401-s8dvv8c","Type":"NodeParagraph","Properties":{"id":"20240407112401-s8dvv8c","updated":"20240407112401"},"Children":[{"Type":"NodeText","Data":"阅读上面这段代码，我们可以发现路由模式参数的字符串中包含 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"GET"},{"Type":"NodeText","Data":"​ HTTP 请求方法。"}]},{"ID":"20240407112401-iegldpd","Type":"NodeParagraph","Properties":{"id":"20240407112401-iegldpd","updated":"20240407112401"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"GET /goods/"},{"Type":"NodeText","Data":"​ 匹配请求路径以 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/goods/"},{"Type":"NodeText","Data":"​ 开头的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"GET"},{"Type":"NodeText","Data":"​ 请求。"}]},{"ID":"20240407112401-yzf1q5d","Type":"NodeParagraph","Properties":{"id":"20240407112401-yzf1q5d","updated":"20240407112401"},"Children":[{"Type":"NodeText","Data":"没有请求方法的路由模式与每个请求方法匹配。具有 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"GET"},{"Type":"NodeText","Data":"​ 方法的请求模式同时匹配 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"GET"},{"Type":"NodeText","Data":"​ 和 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"HEAD"},{"Type":"NodeText","Data":"​ 请求。"}]},{"ID":"20240407112401-ysgaxfi","Type":"NodeParagraph","Properties":{"id":"20240407112401-ysgaxfi","updated":"20240407112401"},"Children":[{"Type":"NodeText","Data":"需要注意的是，其它请求方法必须完全匹配。"}]},{"ID":"20240407112401-f7yp4v1","Type":"NodeParagraph","Properties":{"id":"20240407112401-f7yp4v1","updated":"20240407112401"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"限定请求 HOST 的路由模式"}]},{"ID":"20240407112401-fjvxoig","Type":"NodeParagraph","Properties":{"id":"20240407112401-fjvxoig","updated":"20240407112401"},"Children":[{"Type":"NodeText","Data":"没有 HOST 的路由模式，与任意 HOST 上的 URL 匹配。"}]},{"ID":"20240407112401-8kphqab","Type":"NodeParagraph","Properties":{"id":"20240407112401-8kphqab","updated":"20240407112401"},"Children":[{"Type":"NodeText","Data":"具有 HOST 的路由模式，仅与该 HOST 上的 URL 匹配。"}]},{"ID":"20240407112401-56e3f1n","Type":"NodeParagraph","Properties":{"id":"20240407112401-56e3f1n","updated":"20240407112401"},"Children":[{"Type":"NodeText","Data":"比如 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"example.com/"},{"Type":"NodeText","Data":"​ 匹配对 HOST "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"example.com"},{"Type":"NodeText","Data":"​ 的任何请求。"}]},{"ID":"20240407112401-cccfar9","Type":"NodeParagraph","Properties":{"id":"20240407112401-cccfar9","updated":"20240407112401"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"example.com/{$}"},{"Type":"NodeText","Data":"​ 匹配对 HOST "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"example.com"},{"Type":"NodeText","Data":"​ 和路径 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/"},{"Type":"NodeText","Data":"​ 的请求，即 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"example.com/"},{"Type":"NodeText","Data":"​。"}]},{"ID":"20240407112401-25pusq7","Type":"NodeParagraph","Properties":{"id":"20240407112401-25pusq7","updated":"20240407112401"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"通配符的路由模式"}]},{"ID":"20240407112401-i3h2l9v","Type":"NodeParagraph","Properties":{"id":"20240407112401-i3h2l9v","updated":"20240407112401"},"Children":[{"Type":"NodeText","Data":"请求路径可以包含格式为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"{NAME}"},{"Type":"NodeText","Data":"​ 或 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"{NAME...}"},{"Type":"NodeText","Data":"​ 的通配符段。例如，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/b/{bucket}/o/{objectname...}"},{"Type":"NodeText","Data":"​。"}]},{"ID":"20240407112401-y0p2kwk","Type":"NodeParagraph","Properties":{"id":"20240407112401-y0p2kwk","updated":"20240407112401"},"Children":[{"Type":"NodeText","Data":"通配符名称必须是有效的 Go 标识符。通配符必须是完整路径段：它们前面必须有一个斜杠，后面必须有一个斜杠或字符串的末尾。例如，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/{bucket}/"},{"Type":"NodeText","Data":"​ 或 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/{bucket}/name"},{"Type":"NodeText","Data":"​ 是有效的路由模式，而 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/b_{bucket}"},{"Type":"NodeText","Data":"​ 不是有效的路由模式。"}]},{"ID":"20240407112401-de9powv","Type":"NodeParagraph","Properties":{"id":"20240407112401-de9powv","updated":"20240407112401"},"Children":[{"Type":"NodeText","Data":"通常，通配符仅匹配单个路径段，以请求 URL 中的下一个文字斜杠 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/"},{"Type":"NodeText","Data":"​（而不是 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"%2F"},{"Type":"NodeText","Data":"​）结尾。但是，如果存在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"..."},{"Type":"NodeText","Data":"​，例如 {NAME...}，则通配符与 URL 路径的其余部分（包括斜杠）匹配。"}]},{"ID":"20240407112401-y9kgiur","Type":"NodeParagraph","Properties":{"id":"20240407112401-y9kgiur","updated":"20240407112401"},"Children":[{"Type":"NodeText","Data":"因此，对于存在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"..."},{"Type":"NodeText","Data":"​ 的通配符，它出现在除路由模式末尾以外的任何位置，都不是有效的路由模式，例如 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/b/{bucket}/o/{objectname...}/name"},{"Type":"NodeText","Data":"​ 不是有效的路由模式。"}]},{"ID":"20240407112401-4tbtsbu","Type":"NodeParagraph","Properties":{"id":"20240407112401-4tbtsbu","updated":"20240407112401"},"Children":[{"Type":"NodeText","Data":"可以通过使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"Request.PathValue(bucket)"},{"Type":"NodeText","Data":"​ 调用通配符的名称，来获取通配符的匹配项。"}]},{"ID":"20240407112401-t318vvy","Type":"NodeParagraph","Properties":{"id":"20240407112401-t318vvy","updated":"20240407112401"},"Children":[{"Type":"NodeText","Data":"需要注意的是，除了新增 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"PathValue"},{"Type":"NodeText","Data":"​，还新增了 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"SetPathValue"},{"Type":"NodeText","Data":"​。"}]},{"ID":"20240407112401-0pbdm3o","Type":"NodeParagraph","Properties":{"id":"20240407112401-0pbdm3o","updated":"20240407112401"},"Children":[{"Type":"NodeText","Data":"路径中的尾部斜杠，充当匿名的通配符 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"..."},{"Type":"NodeText","Data":"​。"}]},{"ID":"20240407112401-6zxas8c","Type":"NodeParagraph","Properties":{"id":"20240407112401-6zxas8c","updated":"20240407112401"},"Children":[{"Type":"NodeText","Data":"特殊通配符 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"{$}"},{"Type":"NodeText","Data":"​ 仅与 URL 的末尾匹配。例如，路由模式 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/{$}"},{"Type":"NodeText","Data":"​ 仅匹配路径 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/"},{"Type":"NodeText","Data":"​，而路由模式 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/"},{"Type":"NodeText","Data":"​ 匹配任意路径。"}]},{"ID":"20240407112401-4soljg2","Type":"NodeParagraph","Properties":{"id":"20240407112401-4soljg2","updated":"20240407112401"},"Children":[{"Type":"NodeText","Data":"为了进行匹配，路由模式的路径和传入请求路径都是逐段未转义的。比如路径 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/a%2Fb/100%25"},{"Type":"NodeText","Data":"​ 被视为具有两个路径段，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"a/b"},{"Type":"NodeText","Data":"​ 和 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"100%"},{"Type":"NodeText","Data":"​。路由模式 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/a%2fb/"},{"Type":"NodeText","Data":"​ 匹配它，但路由模式 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/a/b/"},{"Type":"NodeText","Data":"​ 不匹配。"}]},{"ID":"20240407113426-piopi8h","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240407113426-piopi8h","updated":"20240407142321"},"Children":[{"Type":"NodeText","Data":"优先级"}]},{"ID":"20240407113438-42sg7zp","Type":"NodeParagraph","Properties":{"id":"20240407113438-42sg7zp","updated":"20240407142321"},"Children":[{"Type":"NodeText","Data":"如果两个或多个路由模式与一个请求匹配，则以最具体的路由模式为准。"}]},{"ID":"20240407113438-k24s23r","Type":"NodeParagraph","Properties":{"id":"20240407113438-k24s23r","updated":"20240407142321"},"Children":[{"Type":"NodeText","Data":"如果 P1 与 P2 请求的严格子集匹配，也就是如果 P2 与 P1 的所有请求匹配，甚至更多，则路由模式 P1 比 P2 更具体。如果两者都不是更具体的，则路由模式会冲突。"}]},{"ID":"20240407113438-7chfyfy","Type":"NodeParagraph","Properties":{"id":"20240407113438-7chfyfy","updated":"20240407142321"},"Children":[{"Type":"NodeText","Data":"对于向后兼容性，此规则有一个例外：如果两个路由模式会发生冲突，并且一个路由模式具有 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"HOST"},{"Type":"NodeText","Data":"​，而另一个路由模式没有，则具有 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"HOST"},{"Type":"NodeText","Data":"​ 的路由模式优先级更高。"}]},{"ID":"20240407113438-fepki4h","Type":"NodeParagraph","Properties":{"id":"20240407113438-fepki4h","updated":"20240407142321"},"Children":[{"Type":"NodeText","Data":"如果传递了 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ServeMux.Handle"},{"Type":"NodeText","Data":"​ 或 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ServeMux.HandleFunc"},{"Type":"NodeText","Data":"​ 的路由模式与已注册的另一个路由模式冲突，则这些函数会崩溃。"}]},{"ID":"20240407113438-06jzity","Type":"NodeParagraph","Properties":{"id":"20240407113438-06jzity","updated":"20240407142321"},"Children":[{"Type":"NodeText","Data":"比如 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/images/thumbnails/"},{"Type":"NodeText","Data":"​ 比 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/images/"},{"Type":"NodeText","Data":"​ 更具体，因此两者都可以注册。前者匹配以 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/images/thumbnails/"},{"Type":"NodeText","Data":"​ 开头的路径，后者将匹配 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/images/"},{"Type":"NodeText","Data":"​ 子树中的任何其他路径。前者的优先级高于后者。"}]},{"ID":"20240407113438-6je113n","Type":"NodeParagraph","Properties":{"id":"20240407113438-6je113n","updated":"20240407142321"},"Children":[{"Type":"NodeText","Data":"再比如路由模式 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"GET /"},{"Type":"NodeText","Data":"​ 和 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/index.html"},{"Type":"NodeText","Data":"​：两者都匹配 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/index.html"},{"Type":"NodeText","Data":"​ 的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"GET"},{"Type":"NodeText","Data":"​ 请求，但前者匹配所有其他 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"GET"},{"Type":"NodeText","Data":"​ 和 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"HEAD"},{"Type":"NodeText","Data":"​ 请求，而后者匹配使用不同请求方法的任何 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/index.html"},{"Type":"NodeText","Data":"​ 请求。因为两者都不是更具体的路由模式，所以两者冲突。"}]},{"ID":"20240407142358-vwo9p0t","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240407142358-vwo9p0t","updated":"20240407142820"},"Children":[{"Type":"NodeText","Data":"兼容性"}]},{"ID":"20240407142824-i3bxgxv","Type":"NodeParagraph","Properties":{"id":"20240407142824-i3bxgxv","updated":"20240407142824"},"Children":[{"Type":"NodeText","Data":"在 Go 1.22 中，"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ServeMux"},{"Type":"NodeText","Data":"​ 的路由模式语法和匹配行为发生了重大变化。若要还原旧行为，请将 GODEBUG 环境变量设置为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"httpmuxgo121=1"},{"Type":"NodeText","Data":"​。此设置在程序启动时读取一次，在程序执行期间更改此设置，不会直接生效。"}]},{"ID":"20240407142824-c8u74nf","Type":"NodeParagraph","Properties":{"id":"20240407142824-c8u74nf","updated":"20240407142824"},"Children":[{"Type":"NodeText","Data":"向后不兼容的更改包括："}]},{"ID":"20240407142824-tmbe9ym","Type":"NodeList","ListData":{},"Properties":{"id":"20240407142824-tmbe9ym","updated":"20240407142824"},"Children":[{"ID":"20240407142824-d3seazz","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240407142824-d3seazz","updated":"20240407142824"},"Children":[{"ID":"20240407142824-mplta9u","Type":"NodeParagraph","Properties":{"id":"20240407142824-mplta9u","updated":"20240407142824"},"Children":[{"Type":"NodeText","Data":"通配符只是 1.21 中的普通文字路径段。例如，模式 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/{x}"},{"Type":"NodeText","Data":"​ 将仅匹配 1.21 中的该路径，但将匹配 1.22 中的任何单段路径。"}]}]},{"ID":"20240407142824-31fq2os","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240407142824-31fq2os","updated":"20240407142824"},"Children":[{"ID":"20240407142824-xglaqhj","Type":"NodeParagraph","Properties":{"id":"20240407142824-xglaqhj","updated":"20240407142824"},"Children":[{"Type":"NodeText","Data":"在 1.21 中，没有路由模式被拒绝，除非它是空的或与现有路由模式冲突。在 1.22 中，语法无效的路由模式将导致 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ServeMux.Handle"},{"Type":"NodeText","Data":"​ 和 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ServeMux.HandleFunc"},{"Type":"NodeText","Data":"​ 程序崩溃。例如，在 1.21 中，路由模式 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/{"},{"Type":"NodeText","Data":"​ 和 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/a{x}"},{"Type":"NodeText","Data":"​ 匹配它们自己，但在 1.22 中，它们是无效的，路由模式注册时会引发 "},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"panic"},{"Type":"NodeText","Data":"。"}]}]},{"ID":"20240407142824-sascm8x","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240407142824-sascm8x","updated":"20240407142824"},"Children":[{"ID":"20240407142824-gkvhxd4","Type":"NodeParagraph","Properties":{"id":"20240407142824-gkvhxd4","updated":"20240407142824"},"Children":[{"Type":"NodeText","Data":"在 1.22 中，路由模式的每个段都是未转义的，这在 1.21 中没有完成。例如，在 1.22 中，路由模式 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"%61"},{"Type":"NodeText","Data":"​ 与路径 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/a"},{"Type":"NodeText","Data":"​ 匹配（"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"%61"},{"Type":"NodeText","Data":"​ 是 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"a"},{"Type":"NodeText","Data":"​ 的 URL 转义序列），但在 1.21 中，它只会匹配路径 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"/%2561"},{"Type":"NodeText","Data":"​（其中 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"%25"},{"Type":"NodeText","Data":"​ 是百分号的转义）。"}]}]},{"ID":"20240407142824-kukt10e","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240407142824-kukt10e","updated":"20240407142824"},"Children":[{"ID":"20240407142824-zw5ttji","Type":"NodeParagraph","Properties":{"id":"20240407142824-zw5ttji","updated":"20240407142824"},"Children":[{"Type":"NodeText","Data":"当将路由模式与路径匹配时，在 1.22 中，路径的每一段都是未转义的；在 1.21 中，整个路径都是未转义的。此更改主要影响如何处理与斜杠相邻的 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"%2F"},{"Type":"NodeText","Data":"​ 转义路径"},{"Type":"NodeTextMark","TextMarkType":"sup","TextMarkTextContent":"[2]"},{"Type":"NodeText","Data":"。"}]}]}]},{"ID":"20240407142825-8lb1wzr","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240407142825-8lb1wzr","updated":"20240407142828"},"Children":[{"Type":"NodeText","Data":"总结"}]},{"ID":"20240407142833-oxj3gdw","Type":"NodeParagraph","Properties":{"id":"20240407142833-oxj3gdw","updated":"20240407142833"},"Children":[{"Type":"NodeText","Data":"本文我们介绍 Go 1.22 对 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ServeMux"},{"Type":"NodeText","Data":"​ 新增的两个增强功能："}]},{"ID":"20240407142833-ot69vtj","Type":"NodeList","ListData":{},"Properties":{"id":"20240407142833-ot69vtj","updated":"20240407142833"},"Children":[{"ID":"20240407142833-4c1lqjh","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240407142833-4c1lqjh","updated":"20240407142833"},"Children":[{"ID":"20240407142833-ip4pszv","Type":"NodeParagraph","Properties":{"id":"20240407142833-ip4pszv","updated":"20240407142833"},"Children":[{"Type":"NodeText","Data":"根据 HTTP 请求方法（GET、POST 等）区分请求。"}]}]},{"ID":"20240407142833-hkga1ck","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20240407142833-hkga1ck","updated":"20240407142833"},"Children":[{"ID":"20240407142833-c1ybs80","Type":"NodeParagraph","Properties":{"id":"20240407142833-c1ybs80","updated":"20240407142833"},"Children":[{"Type":"NodeText","Data":"在匹配路径中支持通配符。"}]}]}]},{"ID":"20240407142833-4qqsc80","Type":"NodeParagraph","Properties":{"id":"20240407142833-4qqsc80","updated":"20240407142833"},"Children":[{"Type":"NodeText","Data":"感兴趣的读者朋友们，可以阅读参考资料中的链接地址，了解更多。"}]},{"ID":"20240407142835-hm416dz","Type":"NodeParagraph","Properties":{"id":"20240407142835-hm416dz"}}]}