{"ID":"20231008200319-t968lt4","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1fa94","id":"20231008200319-t968lt4","scroll":"\u0026#123;\u0026quot;rootId\u0026quot;:\u0026quot;20231008200319-t968lt4\u0026quot;,\u0026quot;startId\u0026quot;:\u0026quot;20231008200319-h6o5om6\u0026quot;,\u0026quot;endId\u0026quot;:\u0026quot;20231008200319-h6o5om6\u0026quot;,\u0026quot;scrollTop\u0026quot;:0\u0026#125;","tags":"Go,工作区模式","title":"快速掌握 Go 工作区模式","updated":"20231008203045"},"Children":[{"ID":"20231008200319-h6o5om6","Type":"NodeParagraph","Properties":{"id":"20231008200319-h6o5om6","updated":"20231008200449"},"Children":[{"Type":"NodeText","Data":"在 Go 项目的模块管理中，先是 GOPATH，然后到废弃。再到强推 Go modules，从被社区抗拒到 rsc 硬上弓。现在最新要了解的，就是工作区模式（workspace mode）。这是一个在 Go1.18 引入的重要特性。"}]},{"ID":"20231008200512-zlb737w","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20231008200512-zlb737w","updated":"20231008200524"},"Children":[{"Type":"NodeText","Data":"背景"}]},{"ID":"20231008200714-56f60en","Type":"NodeParagraph","Properties":{"id":"20231008200714-56f60en","updated":"20231008200714"},"Children":[{"Type":"NodeText","Data":"在 Go1.11 起有了 Go modules 后，看起来 Go 模块管理逐步按序有了约束、规范了起来。但也带来了一些使用上的问题。"}]},{"ID":"20231008200714-rsckr8i","Type":"NodeParagraph","Properties":{"id":"20231008200714-rsckr8i","updated":"20231008200714"},"Children":[{"Type":"NodeText","Data":"现实开发时，当我们需要对多个关联模块进行开发（修改）时，这个事情就麻烦了起来。我见过两种方式。"}]},{"ID":"20231008200714-kqrtz98","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20231008200714-kqrtz98","updated":"20231008200721"},"Children":[{"ID":"20231008200721-mtpmgis","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20231008200721-mtpmgis","updated":"20231008200721"},"Children":[{"ID":"20231008200721-kq5kurk","Type":"NodeParagraph","Properties":{"id":"20231008200721-kq5kurk","updated":"20231008200820"},"Children":[{"Type":"NodeText","Data":"第一种：直接在 go.mod 文件上配置replace，配置到本地的开发目录。这是最常见的方式。"}]}]}]},{"ID":"20231008200821-454mdt3","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231008200821-454mdt3","updated":"20231008200932"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2hlbGw="},{"Type":"NodeCodeBlockCode","Data":"// go.mod\nreplace example.com/golang/text =\u003e \"../eddycjy/golang/text\"\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231008200935-gcjushe","Type":"NodeParagraph","Properties":{"id":"20231008200935-gcjushe","updated":"20231008200944"},"Children":[{"Type":"NodeText","Data":"这种做法经常会有人不小心提交到 Git 仓库上。还挺折腾人的，一个不小心就为此 debug 了半天，或者发布部署一直卡着过不去。"}]},{"ID":"20231008202228-wj2iw72","Type":"NodeParagraph","Properties":{"id":"20231008202228-wj2iw72","updated":"20231008202454"},"Children":[{"Type":"NodeTextMark","Properties":{"style":"background-color: var(--b3-card-info-background); color: var(--b3-card-info-color);"},"TextMarkType":"text","TextMarkTextContent":"这种做法经常会有人不小心提交到Git仓库上，还挺折腾人的，一个不小心就为此 debug 了半天，或者发布部署一直卡着过不去。"},{"Type":"NodeKramdownSpanIAL","Data":"{: style=\"background-color: var(--b3-card-info-background); color: var(--b3-card-info-color);\"}"}]},{"ID":"20231008202455-3lby4c3","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20231008202455-3lby4c3","updated":"20231008202730"},"Children":[{"ID":"20231008202500-5kjya92","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20231008202500-5kjya92","updated":"20231008202730"},"Children":[{"ID":"20231008202500-rdrzlyg","Type":"NodeParagraph","Properties":{"id":"20231008202500-rdrzlyg","updated":"20231008202730"},"Children":[{"Type":"NodeText","Data":"第二种： 直接在依赖模块上编码，编码到一定的程度。才上传 GitHub/GitLab。再去发布版本标签再引用。这种用法比较少。只有模块比较简单且对程序比较自信的会这么干。（不推荐）"}]}]}]},{"ID":"20231008202731-c8zm07s","Type":"NodeParagraph","Properties":{"id":"20231008202731-c8zm07s","updated":"20231008202736"},"Children":[{"Type":"NodeText","Data":"总的来讲，就是有了 Go modules 后，多模块间的依赖开发还是挺麻烦的。要经常 replace，有时候又会忘了删。"}]},{"ID":"20231008202737-9ecq6fg","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20231008202737-9ecq6fg"},"Children":[{"Type":"NodeText","Data":"go work 指令集"}]},{"ID":"20231008202756-o3dgciw","Type":"NodeParagraph","Properties":{"id":"20231008202756-o3dgciw","updated":"20231008202756"},"Children":[{"Type":"NodeText","Data":"在大家痛苦了许久后，Go1.18 时终于发布了工作区模式的方式，来优化这个用法和问题。"}]},{"ID":"20231008202756-2gpenbs","Type":"NodeParagraph","Properties":{"id":"20231008202756-2gpenbs","updated":"20231008202756"},"Children":[{"Type":"NodeText","Data":"以下是 go work 的指令集："}]},{"ID":"20231008202758-svo3n2p","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231008202758-svo3n2p","updated":"20231008202813"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2hlbGw="},{"Type":"NodeCodeBlockCode","Data":"go work \u003ccommand\u003e [argument]\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231008202822-dhcw2ad","Type":"NodeList","ListData":{},"Properties":{"id":"20231008202822-dhcw2ad","updated":"20231008202822"},"Children":[{"ID":"20231008202822-h2sur6i","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231008202822-h2sur6i","updated":"20231008202822"},"Children":[{"ID":"20231008202822-izjg3oz","Type":"NodeParagraph","Properties":{"id":"20231008202822-izjg3oz","updated":"20231008202822"},"Children":[{"Type":"NodeText","Data":"edit：从工具或脚本中编辑 go.work。"}]}]},{"ID":"20231008202822-zj27lqo","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231008202822-zj27lqo","updated":"20231008202822"},"Children":[{"ID":"20231008202822-dbtzdix","Type":"NodeParagraph","Properties":{"id":"20231008202822-dbtzdix","updated":"20231008202822"},"Children":[{"Type":"NodeText","Data":"init：初始化工作区文件（go.work）。"}]}]},{"ID":"20231008202822-vl5v6qj","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231008202822-vl5v6qj","updated":"20231008202822"},"Children":[{"ID":"20231008202822-oxvgwyu","Type":"NodeParagraph","Properties":{"id":"20231008202822-oxvgwyu","updated":"20231008202822"},"Children":[{"Type":"NodeText","Data":"sync：将工作区构建列表同步到模块。"}]}]},{"ID":"20231008202822-4q7juxg","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20231008202822-4q7juxg","updated":"20231008202822"},"Children":[{"ID":"20231008202822-g22xpa2","Type":"NodeParagraph","Properties":{"id":"20231008202822-g22xpa2","updated":"20231008202822"},"Children":[{"Type":"NodeText","Data":"use：将模块添加到工作区文件。"}]}]}]},{"ID":"20231008202824-ndhquj9","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20231008202824-ndhquj9","updated":"20231008202838"},"Children":[{"Type":"NodeText","Data":"快速使用"}]},{"ID":"20231008202847-rwuv7q8","Type":"NodeParagraph","Properties":{"id":"20231008202847-rwuv7q8","updated":"20231008202847"},"Children":[{"Type":"NodeText","Data":"接下来我们快速应用 Go 工作区模式，让大家有个直观的了解。"}]},{"ID":"20231008202847-t4vc1dv","Type":"NodeParagraph","Properties":{"id":"20231008202847-t4vc1dv","updated":"20231008202847"},"Children":[{"Type":"NodeText","Data":"需要注意，该特性需要确保 Go 版本 \u003e= 1.18。"}]},{"ID":"20231008202848-8tsiv31","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20231008202848-8tsiv31","updated":"20231008202900"},"Children":[{"Type":"NodeText","Data":"创建工作区"}]},{"ID":"20231008202900-apjt3n1","Type":"NodeParagraph","Properties":{"id":"20231008202900-apjt3n1","updated":"20231008202916"},"Children":[{"Type":"NodeText","Data":"首先我们创建一个工作区，执行如下命令："}]},{"ID":"20231008202916-xm1u5fe","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231008202916-xm1u5fe","updated":"20231008203009"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2hlbGw="},{"Type":"NodeCodeBlockCode","Data":"mkdir workspace-main \u0026\u0026 cd workspace-main\ngo work init\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231008203026-bb9hx41","Type":"NodeParagraph","Properties":{"id":"20231008203026-bb9hx41","updated":"20231008203027"},"Children":[{"Type":"NodeText","Data":"执行完毕后会在该目录下创建一个 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"go.work"},{"Type":"NodeText","Data":"​ 文件，文件内容包含："}]},{"ID":"20231008203027-c5pniqw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20231008203027-c5pniqw","updated":"20231008203035"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"c2hlbGw="},{"Type":"NodeCodeBlockCode","Data":"go 1.20\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20231008203037-s4tgvn4","Type":"NodeParagraph","Properties":{"id":"20231008203037-s4tgvn4","updated":"20231008203044"},"Children":[{"Type":"NodeText","Data":"仅包含版本信息，因为当前是空白的工作区，只有初始化行为。"}]},{"ID":"20231008203045-hdabgsl","Type":"NodeParagraph","Properties":{"id":"20231008203045-hdabgsl"}}]}