{"ID":"20230724020740-9zlkcxy","Spec":"1","Type":"NodeDocument","Properties":{"icon":"2702","id":"20230724020740-9zlkcxy","tags":"Dockerfile","title":"Dockerfile 示例","updated":"20230724020751"},"Children":[{"ID":"20230724020754-64hs0to","Type":"NodeBlockquote","Properties":{"id":"20230724020754-64hs0to","updated":"20230724020754"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20230724020754-1t6huhg","Type":"NodeParagraph","Properties":{"id":"20230724020754-1t6huhg","updated":"20230724020754"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"smart-switch Dockerfile"}]}]},{"ID":"20230724020754-evb1qot","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20230724020754-evb1qot","updated":"20230724020754"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"FROM golang:1.16 AS builder\n\nWORKDIR /usr/src/smart-switch\n\nCOPY ./go.mod /usr/src/smart-switch/\n\nCOPY ./go.sum /usr/src/smart-switch/\n\nENV GOPROXY=http://10.7.83.190:6666,https://goproxy.cn,direct\n\nRUN   echo \"hosts: files dns\" \u003e /etc/nsswitch.conf \u0026\u0026 \\\n      echo -e \"112.19.0.219  goproxy.cn\\n182.89.221.213 mirrors.aliyun.com\"\u003e\u003e/etc/hosts \u0026\u0026 \\\n      go mod download\n\nCOPY . /usr/src/smart-switch/\n\nRUN  go build  -o smart-switch \n\nFROM alpine as runner\n\nCOPY --from=builder /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n\nCOPY --from=builder /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/\n\nCOPY --from=builder /usr/src/smart-switch/smart-switch /tmp/\n\nRUN echo -e \"10.7.82.56 e-con-01\\n10.7.83.97 m-nlp-03\\n10.7.82.133   s-ipd-01\\n10.7.80.153 c-gtw-01\\n10.7.83.174 s-gtw-01\"\u003e\u003e/etc/hosts \u0026\u0026 \\\n    ls /tmp/smart-switch \u0026\u0026 \\\n    chmod +x /tmp/smart-switch\n\nCMD [\"/tmp/smart-switch\",\"-url=http://e-con-01:8500\",\"-token=f9e5e855-9589-610a-94e7-eafbfcb66908\"]\n\n\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20230724020754-shin7hs","Type":"NodeBlockquote","Properties":{"id":"20230724020754-shin7hs","updated":"20230724020754"},"Children":[{"Type":"NodeBlockquoteMarker","Data":"\u003e"},{"ID":"20230724020754-9knl1og","Type":"NodeParagraph","Properties":{"id":"20230724020754-9knl1og","updated":"20230724020754"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"curtain Dockerfile"}]}]},{"ID":"20230724020754-16x8gyk","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20230724020754-16x8gyk","updated":"20230724020754"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker"},{"Type":"NodeCodeBlockCode","Data":"FROM golang:1.16 AS builder\n\nWORKDIR /usr/src/curtain\n\nCOPY ./go.mod /usr/src/curtain/\n\nCOPY ./go.sum /usr/src/curtain/\n\nENV GOPROXY=http://10.7.83.190:6666\n\nRUN   echo \"hosts: files dns\" \u003e /etc/nsswitch.conf \u0026\u0026 \\\n      echo -e \"112.19.0.219  goproxy.cn\\n182.89.221.213 mirrors.aliyun.com\"\u003e\u003e/etc/hosts \u0026\u0026 \\\n      go mod download\n\nCOPY . /usr/src/curtain/\n\nRUN  go build  -o curtain \n\nFROM alpine as runner\n\nCOPY --from=builder /usr/share/zoneinfo/Asia/Shanghai /etc/localtime\n\nCOPY --from=builder /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/\n\nCOPY --from=builder /usr/src/curtain/curtain /tmp/\n\nRUN echo -e \"10.7.82.56 e-con-01\\n10.7.83.97 m-nlp-03\\n10.7.82.133   s-ipd-01\\n10.7.80.153 c-gtw-01\\n10.7.83.174 s-gtw-01\"\u003e\u003e/etc/hosts \u0026\u0026 \\\n    ls /tmp/curtain \u0026\u0026 \\\n    chmod +x /tmp/curtain\n\nCMD [\"/tmp/curtain\",\"-url=http://e-con-01:8500\",\"-token=8dcdd0b6-2d3f-a383-9ca6-94bf392d2fcf\"]\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]}]}