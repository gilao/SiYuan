{"ID":"20231011094834-iiidzd1","Spec":"1","Type":"NodeDocument","Properties":{"icon":"1f964","id":"20231011094834-iiidzd1","scroll":"\u0026#123;\u0026quot;rootId\u0026quot;:\u0026quot;20231011094834-iiidzd1\u0026quot;,\u0026quot;startId\u0026quot;:\u0026quot;20231011094834-qwl7t0b\u0026quot;,\u0026quot;endId\u0026quot;:\u0026quot;20231011094908-4on7zna\u0026quot;,\u0026quot;scrollTop\u0026quot;:0,\u0026quot;focusId\u0026quot;:\u0026quot;20231011094908-4on7zna\u0026quot;,\u0026quot;focusStart\u0026quot;:0,\u0026quot;focusEnd\u0026quot;:0\u0026#125;","tags":"未完成","title":"数据库和缓存双向数据库一致性问题","updated":"20240219154428"},"Children":[{"ID":"20231011094834-qwl7t0b","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20231011094834-qwl7t0b","updated":"20240219153359"},"Children":[{"Type":"NodeText","Data":"前言"}]},{"ID":"20240219153411-6qd1jbd","Type":"NodeParagraph","Properties":{"id":"20240219153411-6qd1jbd","updated":"20240219153411"},"Children":[{"Type":"NodeText","Data":"数据库和缓存（比如：redis）双写数据一致性问题，是一个跟开发语言无关的公共问题。尤其在高并发的场景下，这个问题变得更加严重。"}]},{"ID":"20240219153411-1fbwmzp","Type":"NodeParagraph","Properties":{"id":"20240219153411-1fbwmzp","updated":"20240219153411"},"Children":[{"Type":"NodeText","Data":"我很负责的告诉大家，该问题无论在面试，还是工作中遇到的概率非常大，所以非常有必要跟大家一起探讨一下。"}]},{"ID":"20240219153411-441tmh2","Type":"NodeParagraph","Properties":{"id":"20240219153411-441tmh2","updated":"20240219153411"},"Children":[{"Type":"NodeText","Data":"今天这篇文章我会从浅入深，跟大家一起聊聊，数据库和缓存双写数据一致性问题常见的解决方案，这些方案中可能存在的坑，以及最优方案是什么。"}]},{"ID":"20240219153412-txjbbha","Type":"NodeParagraph","Properties":{"id":"20240219153412-txjbbha","updated":"20240219153412"}},{"ID":"20240219153412-kn43x55","Type":"NodeHeading","HeadingLevel":1,"Properties":{"id":"20240219153412-kn43x55","updated":"20240219153835"},"Children":[{"Type":"NodeText","Data":"一、常见方案"}]},{"ID":"20240219153427-tycncgg","Type":"NodeParagraph","Properties":{"id":"20240219153427-tycncgg","updated":"20240219153835"},"Children":[{"Type":"NodeText","Data":"通常情况下，我们使用缓存的主要目的是为了提升查询的性能。大多数情况下，我们是这样使用缓存的："}]},{"ID":"20240219153447-aesrid2","Type":"NodeParagraph","Properties":{"id":"20240219153447-aesrid2","updated":"20240219153835"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240219153447-7y6ggbk.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240219153457-whh0yjl","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240219153457-whh0yjl","updated":"20240219153835"},"Children":[{"ID":"20240219153457-sgr6dvz","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240219153457-sgr6dvz","updated":"20240219153457"},"Children":[{"ID":"20240219153457-f7mvlxe","Type":"NodeParagraph","Properties":{"id":"20240219153457-f7mvlxe","updated":"20240219153457"},"Children":[{"Type":"NodeText","Data":"用户请求过来之后，先查缓存有没有数据，如果有则直接返回。"}]}]},{"ID":"20240219153457-0rtnwce","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240219153457-0rtnwce","updated":"20240219153457"},"Children":[{"ID":"20240219153457-d3a3pz1","Type":"NodeParagraph","Properties":{"id":"20240219153457-d3a3pz1","updated":"20240219153457"},"Children":[{"Type":"NodeText","Data":"如果缓存没数据，再继续查数据库。"}]}]},{"ID":"20240219153457-qxv0edf","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20240219153457-qxv0edf","updated":"20240219153457"},"Children":[{"ID":"20240219153457-ku9zyyf","Type":"NodeParagraph","Properties":{"id":"20240219153457-ku9zyyf","updated":"20240219153457"},"Children":[{"Type":"NodeText","Data":"如果数据库有数据，则将查询出来的数据，放入缓存中，然后返回该数据。"}]}]},{"ID":"20240219153457-1llcult","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20240219153457-1llcult","updated":"20240219153457"},"Children":[{"ID":"20240219153457-bkd24rs","Type":"NodeParagraph","Properties":{"id":"20240219153457-bkd24rs","updated":"20240219153457"},"Children":[{"Type":"NodeText","Data":"如果数据库也没数据，则直接返回空。"}]}]}]},{"ID":"20240219153512-vuhkuns","Type":"NodeParagraph","Properties":{"id":"20240219153512-vuhkuns","updated":"20240219153835"},"Children":[{"Type":"NodeText","Data":"这是缓存非常常见的用法。一眼看上去，好像没有啥问题。"}]},{"ID":"20240219153512-b4f6qfl","Type":"NodeParagraph","Properties":{"id":"20240219153512-b4f6qfl","updated":"20240219153835"},"Children":[{"Type":"NodeText","Data":"但你忽略了一个非常重要的细节："},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"如果数据库中的某条数据，放入缓存之后，又立马被更新了，那么该如何更新缓存呢？"}]},{"ID":"20240219153514-fzerfqu","Type":"NodeParagraph","Properties":{"id":"20240219153514-fzerfqu","updated":"20240219153835"}},{"ID":"20240219153600-8ba53yp","Type":"NodeParagraph","Properties":{"id":"20240219153600-8ba53yp","style":"color: var(--b3-font-color10);","updated":"20240219153835"},"Children":[{"Type":"NodeText","Data":"不更新缓存行不行？"}]},{"ID":"20240219153600-00rxhvt","Type":"NodeParagraph","Properties":{"id":"20240219153600-00rxhvt","style":"color: var(--b3-font-color10);","updated":"20240219153835"},"Children":[{"Type":"NodeText","Data":"答：当然不行，如果不更新缓存，在很长的一段时间内（决定于缓存的过期时间），用户请求从缓存中获取到的都可能是旧值，而非数据库的最新值。这不是有数据不一致的问题？"}]},{"ID":"20240219153658-3mz8cdj","Type":"NodeParagraph","Properties":{"id":"20240219153658-3mz8cdj","updated":"20240219153835"}},{"ID":"20240219153708-ra9ev8c","Type":"NodeParagraph","Properties":{"id":"20240219153708-ra9ev8c","updated":"20240219153835"},"Children":[{"Type":"NodeText","Data":"那么，我们该如何更新缓存呢？"}]},{"ID":"20240219153708-903ic75","Type":"NodeParagraph","Properties":{"id":"20240219153708-903ic75","updated":"20240219153835"},"Children":[{"Type":"NodeText","Data":"目前有以下4种方案："}]},{"ID":"20240219153708-lzf1tfs","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240219153708-lzf1tfs","updated":"20240219153835"},"Children":[{"ID":"20240219153708-7qjouva","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240219153708-7qjouva","updated":"20240219153708"},"Children":[{"ID":"20240219153708-kfatt3v","Type":"NodeParagraph","Properties":{"id":"20240219153708-kfatt3v","updated":"20240219153708"},"Children":[{"Type":"NodeText","Data":"先写缓存，再写数据库"}]}]},{"ID":"20240219153708-b3w9vig","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240219153708-b3w9vig","updated":"20240219153708"},"Children":[{"ID":"20240219153708-5o6h4ag","Type":"NodeParagraph","Properties":{"id":"20240219153708-5o6h4ag","updated":"20240219153708"},"Children":[{"Type":"NodeText","Data":"先写数据库，再写缓存"}]}]},{"ID":"20240219153708-nf583bx","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20240219153708-nf583bx","updated":"20240219153708"},"Children":[{"ID":"20240219153708-euennyz","Type":"NodeParagraph","Properties":{"id":"20240219153708-euennyz","updated":"20240219153708"},"Children":[{"Type":"NodeText","Data":"先删缓存，再写数据库"}]}]},{"ID":"20240219153708-t1o36q4","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20240219153708-t1o36q4","updated":"20240219153708"},"Children":[{"ID":"20240219153708-89cnkfv","Type":"NodeParagraph","Properties":{"id":"20240219153708-89cnkfv","updated":"20240219153708"},"Children":[{"Type":"NodeText","Data":"先写数据库，再删缓存"}]}]}]},{"ID":"20240219153708-bgcaibz","Type":"NodeParagraph","Properties":{"id":"20240219153708-bgcaibz","updated":"20240219153835"},"Children":[{"Type":"NodeText","Data":"接下来，我们详细说说这4种方案。"}]},{"ID":"20240219153710-jhixik1","Type":"NodeParagraph","Properties":{"id":"20240219153710-jhixik1","updated":"20240219153710"}},{"ID":"20240219153843-mf5xta5","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240219153843-mf5xta5","updated":"20240219153908"},"Children":[{"Type":"NodeText","Data":"1. 先写缓存，再写数据库"}]},{"ID":"20240219153916-e9fjlw4","Type":"NodeParagraph","Properties":{"id":"20240219153916-e9fjlw4","updated":"20240219153916"},"Children":[{"Type":"NodeText","Data":"对于更新缓存的方案，很多人第一个想到的可能是在写操作中直接更新缓存（写缓存），更直接明了。"}]},{"ID":"20240219153916-ebnb8i0","Type":"NodeParagraph","Properties":{"id":"20240219153916-ebnb8i0","updated":"20240219153916"},"Children":[{"Type":"NodeText","Data":"那么，问题来了：在写操作中，到底是先写缓存，还是先写数据库呢？"}]},{"ID":"20240219153916-7ws4z7z","Type":"NodeParagraph","Properties":{"id":"20240219153916-7ws4z7z","updated":"20240219153916"},"Children":[{"Type":"NodeText","Data":"我们在这里先聊聊先写缓存，再写数据库的情况，因为它的问题最严重。"}]},{"ID":"20240219153930-nyc5fqu","Type":"NodeParagraph","Properties":{"id":"20240219153930-nyc5fqu","updated":"20240219153935"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240219153930-rt6dfoj.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240219153936-0qmgyff","Type":"NodeParagraph","Properties":{"id":"20240219153936-0qmgyff","updated":"20240219153940"},"Children":[{"Type":"NodeText","Data":"某一个用户的每一次写操作，如果刚写完缓存，突然网络出现了异常，导致写数据库失败了。"}]},{"ID":"20240219153956-qzm9hgy","Type":"NodeParagraph","Properties":{"id":"20240219153956-qzm9hgy","updated":"20240219154000"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240219153956-24fqb4q.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240219154002-n7fes3r","Type":"NodeParagraph","Properties":{"id":"20240219154002-n7fes3r","updated":"20240219154025"},"Children":[{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"其结果是缓存更新成了最新数据，但数据库没有，这样缓存中的数据不就变成脏数据了？如果此时该用户的查询请求，正好读取到该数据，就会出现问题，因为该数据在数据库中根本不存在，这个问题非常严重。"}]},{"ID":"20240219154029-ipv6azx","Type":"NodeParagraph","Properties":{"id":"20240219154029-ipv6azx","updated":"20240219154029"}},{"ID":"20240219154039-kdb7dl4","Type":"NodeParagraph","Properties":{"id":"20240219154039-kdb7dl4","updated":"20240219154039"},"Children":[{"Type":"NodeText","Data":"我们都知道，缓存的主要目的是把数据库的数据临时保存在内存，便于后续的查询，提升查询速度。"}]},{"ID":"20240219154039-uyd4dos","Type":"NodeParagraph","Properties":{"id":"20240219154039-uyd4dos","updated":"20240219154039"},"Children":[{"Type":"NodeText","Data":"但如果某条数据，在数据库中都不存在，你缓存这种“"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"假数据"},{"Type":"NodeText","Data":"​”又有啥意义呢？"}]},{"ID":"20240219154039-vavw44q","Type":"NodeParagraph","Properties":{"id":"20240219154039-vavw44q","updated":"20240219154039"},"Children":[{"Type":"NodeText","Data":"因此，先写缓存，再写数据库的方案是不可取的，在实际工作中用得不多。"}]},{"ID":"20240219154048-9urqxwe","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20240219154048-9urqxwe","updated":"20240219154108"},"Children":[{"Type":"NodeText","Data":"2. 先写数据库，再写缓存"}]},{"ID":"20240219154109-znae7x9","Type":"NodeParagraph","Properties":{"id":"20240219154109-znae7x9","updated":"20240219154114"},"Children":[{"Type":"NodeText","Data":"既然上面的方案行不通，接下来，聊聊先写数据库，再写缓存的方案，该方案在低并发编程中有人在用（我猜的）。"}]},{"ID":"20240219154123-tav3hx7","Type":"NodeParagraph","Properties":{"id":"20240219154123-tav3hx7","updated":"20240219154128"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240219154123-ci9rui1.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240219154136-er3gzpp","Type":"NodeParagraph","Properties":{"id":"20240219154136-er3gzpp","updated":"20240219154136"},"Children":[{"Type":"NodeText","Data":"用户的写操作，先写数据库，再写缓存，可以避免之前“假数据”的问题。但它却带来了新的问题。"}]},{"ID":"20240219154136-4tffiup","Type":"NodeParagraph","Properties":{"id":"20240219154136-4tffiup","updated":"20240219154136"},"Children":[{"Type":"NodeText","Data":"什么问题呢？"}]},{"ID":"20240219154136-2frde2a","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240219154136-2frde2a","updated":"20240219154153"},"Children":[{"Type":"NodeText","Data":"2.1 写缓存失败了"}]},{"ID":"20240219154156-cmrj1z4","Type":"NodeParagraph","Properties":{"id":"20240219154156-cmrj1z4","updated":"20240219154202"},"Children":[{"Type":"NodeText","Data":"如果把写数据库和写缓存操作，放在同一个事务当中，当写缓存失败了，我们可以把写入数据库的数据进行回滚。"}]},{"ID":"20240219154214-hi5367g","Type":"NodeParagraph","Properties":{"id":"20240219154214-hi5367g","updated":"20240219154223"},"Children":[{"Type":"NodeImage","Data":"span","Properties":{"parent-style":"display: block;"},"Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240219154214-993nnba.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeKramdownSpanIAL","Data":"{: parent-style=\"display: block;\"}"}]},{"ID":"20240219154238-v7zbd70","Type":"NodeParagraph","Properties":{"id":"20240219154238-v7zbd70","updated":"20240219154238"},"Children":[{"Type":"NodeText","Data":"如果是并发量比较小，对接口性能要求不太高的系统，可以这么玩。"}]},{"ID":"20240219154238-q2eszcf","Type":"NodeParagraph","Properties":{"id":"20240219154238-q2eszcf","updated":"20240219154238"},"Children":[{"Type":"NodeText","Data":"但如果在高并发的业务场景中，写数据库和写缓存，都属于远程操作。为了防止出现大事务，造成的死锁问题，通常建议写数据库和写缓存不要放在同一个事务中。"}]},{"ID":"20240219154238-20zl43h","Type":"NodeParagraph","Properties":{"id":"20240219154238-20zl43h","updated":"20240219154238"},"Children":[{"Type":"NodeText","Data":"也就是说在该方案中，如果写数据库成功了，但写缓存失败了，数据库中已写入的数据不会回滚。"}]},{"ID":"20240219154238-99nbgcb","Type":"NodeParagraph","Properties":{"id":"20240219154238-99nbgcb","updated":"20240219154238"},"Children":[{"Type":"NodeText","Data":"这就会出现：数据库是"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"新数据"},{"Type":"NodeText","Data":"​，而缓存是"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"旧数据"},{"Type":"NodeText","Data":"​，两边"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"数据不一致"},{"Type":"NodeText","Data":"​的情况。"}]},{"ID":"20240219154247-kp5za0r","Type":"NodeParagraph","Properties":{"id":"20240219154247-kp5za0r","updated":"20240219154247"}},{"ID":"20240219154259-wuv5d7e","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240219154259-wuv5d7e","updated":"20240219154326"},"Children":[{"Type":"NodeText","Data":"2.2 高并发下的问题"}]},{"ID":"20240219154334-ue4x6rm","Type":"NodeParagraph","Properties":{"id":"20240219154334-ue4x6rm","updated":"20240219154334"},"Children":[{"Type":"NodeText","Data":"假设在高并发的场景中，针对同一个用户的同一条数据，有两个写数据请求：a和b，它们同时请求到业务系统。"}]},{"ID":"20240219154334-iquz9ch","Type":"NodeParagraph","Properties":{"id":"20240219154334-iquz9ch","updated":"20240219154334"},"Children":[{"Type":"NodeText","Data":"其中请求a获取的是旧数据，而请求b获取的是新数据，如下图所示："}]},{"ID":"20240219154348-wd9wucw","Type":"NodeParagraph","Properties":{"id":"20240219154348-wd9wucw","updated":"20240219154348"},"Children":[{"Type":"NodeText","Data":"​"},{"Type":"NodeImage","Data":"span","Children":[{"Type":"NodeBang"},{"Type":"NodeOpenBracket"},{"Type":"NodeLinkText","Data":"image"},{"Type":"NodeCloseBracket"},{"Type":"NodeOpenParen"},{"Type":"NodeLinkDest","Data":"assets/image-20240219154348-iukr9c1.png"},{"Type":"NodeCloseParen"}]},{"Type":"NodeText","Data":"​"}]},{"ID":"20240219154400-5gqidr3","Type":"NodeList","ListData":{"Typ":1},"Properties":{"id":"20240219154400-5gqidr3","updated":"20240219154400"},"Children":[{"ID":"20240219154400-tuixwho","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"MS4=","Num":1},"Properties":{"id":"20240219154400-tuixwho","updated":"20240219154400"},"Children":[{"ID":"20240219154400-472e0nx","Type":"NodeParagraph","Properties":{"id":"20240219154400-472e0nx","updated":"20240219154400"},"Children":[{"Type":"NodeText","Data":"请求a先过来，刚写完了数据库。但由于网络原因，卡顿了一下，还没来得及写缓存。"}]}]},{"ID":"20240219154400-r1lm01p","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"Mi4=","Num":2},"Properties":{"id":"20240219154400-r1lm01p","updated":"20240219154400"},"Children":[{"ID":"20240219154400-6q2mr32","Type":"NodeParagraph","Properties":{"id":"20240219154400-6q2mr32","updated":"20240219154400"},"Children":[{"Type":"NodeText","Data":"这时候请求b过来了，先写了数据库。"}]}]},{"ID":"20240219154400-onkoqei","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"My4=","Num":3},"Properties":{"id":"20240219154400-onkoqei","updated":"20240219154400"},"Children":[{"ID":"20240219154400-51pawkd","Type":"NodeParagraph","Properties":{"id":"20240219154400-51pawkd","updated":"20240219154400"},"Children":[{"Type":"NodeText","Data":"接下来，请求b顺利写了缓存。"}]}]},{"ID":"20240219154400-9df7rm1","Type":"NodeListItem","ListData":{"Typ":1,"Delimiter":46,"Marker":"NC4=","Num":4},"Properties":{"id":"20240219154400-9df7rm1","updated":"20240219154400"},"Children":[{"ID":"20240219154400-9b4jdsl","Type":"NodeParagraph","Properties":{"id":"20240219154400-9b4jdsl","updated":"20240219154400"},"Children":[{"Type":"NodeText","Data":"此时，请求a卡顿结束，也写了缓存。"}]}]}]},{"ID":"20240219154400-5vmfc0u","Type":"NodeParagraph","Properties":{"id":"20240219154400-5vmfc0u","updated":"20240219154400"},"Children":[{"Type":"NodeText","Data":"很显然，在这个过程当中，请求b在缓存中的"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"新数据"},{"Type":"NodeText","Data":"​，被请求a的"},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"旧数据"},{"Type":"NodeText","Data":"​覆盖了。"}]},{"ID":"20240219154400-mjhhrk6","Type":"NodeParagraph","Properties":{"id":"20240219154400-mjhhrk6","updated":"20240219154404"},"Children":[{"Type":"NodeText","Data":"也就是说："},{"Type":"NodeTextMark","TextMarkType":"strong","TextMarkTextContent":"在高并发场景中，如果多个线程同时执行先写数据库，再写缓存的操作，可能会出现数据库是新值，而缓存中是旧值，两边数据不一致的情况。"}]},{"ID":"20240219154407-ymce5ho","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20240219154407-ymce5ho","updated":"20240219154427"},"Children":[{"Type":"NodeText","Data":"2.3 浪费系统资源"}]},{"ID":"20240219154428-rybi6qi","Type":"NodeParagraph","Properties":{"id":"20240219154428-rybi6qi","updated":"20240219154428"}}]}