{"ID":"20230811142333-scjxi1d","Spec":"1","Type":"NodeDocument","Properties":{"id":"20230811142333-scjxi1d","title":"大模型启动脚本","updated":"20230811142654"},"Children":[{"ID":"20230811142654-4bbrwzr","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20230811142654-4bbrwzr","updated":"20230811142654"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cHl0aG9u"},{"Type":"NodeCodeBlockCode","Data":"\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20230811142333-4of91kv","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"Properties":{"id":"20230811142333-4of91kv","updated":"20230811142623"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```"},{"Type":"NodeCodeBlockFenceInfoMarker","CodeBlockInfo":"cHl0aG9u"},{"Type":"NodeCodeBlockCode","Data":"def load_file(filepath, sentence_size=SENTENCE_SIZE):\n        if filepath.lower().endswith(\".md\"):\n        loader = UnstructuredFileLoader(filepath, mode=\"elements\")\n        docs = loader.load()\n    elif filepath.lower().endswith(\".json\"):\n        loader = JSONLoader(filepath, jq_schema=\".[]\", content_key=\"knowledge\", metadata_func=update_source)\n        textsplitter = ChineseTextSplitter(pdf=False, sentence_size=sentence_size)\n        docs = loader.load_and_split(textsplitter)\n    elif filepath.lower().endswith(\".txt\"):\n        loader = TextLoader(filepath, autodetect_encoding=True)\n        textsplitter = ChineseTextSplitter(pdf=False, sentence_size=sentence_size)\n        docs = loader.load_and_split(textsplitter)\n    elif filepath.lower().endswith(\".pdf\"):\n        loader = UnstructuredPaddlePDFLoader(filepath)\n        textsplitter = ChineseTextSplitter(pdf=True, sentence_size=sentence_size)\n        docs = loader.load_and_split(textsplitter)\n    elif filepath.lower().endswith(\".jpg\") or filepath.lower().endswith(\".png\"):\n        loader = UnstructuredPaddleImageLoader(filepath, mode=\"elements\")\n        textsplitter = ChineseTextSplitter(pdf=False, sentence_size=sentence_size)\n        docs = loader.load_and_split(text_splitter=textsplitter)\n    else:\n        loader = UnstructuredFileLoader(filepath, mode=\"elements\")\n        textsplitter = ChineseTextSplitter(pdf=False, sentence_size=sentence_size)\n        docs = loader.load_and_split(text_splitter=textsplitter)\n    write_check_file(filepath, docs)\n    return docs\n"},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```"}]},{"ID":"20230811142639-kgc2gmw","Type":"NodeParagraph","Properties":{"id":"20230811142639-kgc2gmw","updated":"20230811142639"},"Children":[{"Type":"NodeText","Data":"这段代码定义了一个函数 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"load_file"},{"Type":"NodeText","Data":"​，它接受一个参数 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"filepath"},{"Type":"NodeText","Data":"​ 和一个可选参数 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"sentence_size"},{"Type":"NodeText","Data":"​，并返回一个 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"docs"},{"Type":"NodeText","Data":"​ 列表。"}]},{"ID":"20230811142639-yvf6uf8","Type":"NodeParagraph","Properties":{"id":"20230811142639-yvf6uf8","updated":"20230811142639"},"Children":[{"Type":"NodeText","Data":"该函数根据 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"filepath"},{"Type":"NodeText","Data":"​ 的扩展名来确定如何加载文件并创建适当的加载器。根据不同的扩展名，函数采用不同的加载器来处理文件。以下是对不同扩展名的处理逻辑："}]},{"ID":"20230811142639-cjcq9fj","Type":"NodeList","ListData":{},"Properties":{"id":"20230811142639-cjcq9fj","updated":"20230811142639"},"Children":[{"ID":"20230811142639-gsh3ml4","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20230811142639-gsh3ml4","updated":"20230811142639"},"Children":[{"ID":"20230811142639-ondr44u","Type":"NodeParagraph","Properties":{"id":"20230811142639-ondr44u","updated":"20230811142639"},"Children":[{"Type":"NodeText","Data":"如果文件扩展名为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":".md"},{"Type":"NodeText","Data":"​，则使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"UnstructuredFileLoader"},{"Type":"NodeText","Data":"​ 加载器以 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"\u0026quot;elements\u0026quot;"},{"Type":"NodeText","Data":"​ 模式加载文件，并将结果存储在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"docs"},{"Type":"NodeText","Data":"​ 中。"}]}]},{"ID":"20230811142639-wro6z9e","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20230811142639-wro6z9e","updated":"20230811142639"},"Children":[{"ID":"20230811142639-6rx4zaf","Type":"NodeParagraph","Properties":{"id":"20230811142639-6rx4zaf","updated":"20230811142639"},"Children":[{"Type":"NodeText","Data":"如果文件扩展名为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":".json"},{"Type":"NodeText","Data":"​，则使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"JSONLoader"},{"Type":"NodeText","Data":"​ 加载器来加载文件，并结合 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ChineseTextSplitter"},{"Type":"NodeText","Data":"​ 对文本进行分割，最后将结果存储在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"docs"},{"Type":"NodeText","Data":"​ 中。"}]}]},{"ID":"20230811142639-ia9mg11","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20230811142639-ia9mg11","updated":"20230811142639"},"Children":[{"ID":"20230811142639-qs7cago","Type":"NodeParagraph","Properties":{"id":"20230811142639-qs7cago","updated":"20230811142639"},"Children":[{"Type":"NodeText","Data":"如果文件扩展名为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":".txt"},{"Type":"NodeText","Data":"​，则使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"TextLoader"},{"Type":"NodeText","Data":"​ 加载器来加载文件，并结合 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ChineseTextSplitter"},{"Type":"NodeText","Data":"​ 对文本进行分割，最后将结果存储在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"docs"},{"Type":"NodeText","Data":"​ 中。"}]}]},{"ID":"20230811142639-b5q0ckb","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20230811142639-b5q0ckb","updated":"20230811142639"},"Children":[{"ID":"20230811142639-xbxve5c","Type":"NodeParagraph","Properties":{"id":"20230811142639-xbxve5c","updated":"20230811142639"},"Children":[{"Type":"NodeText","Data":"如果文件扩展名为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":".pdf"},{"Type":"NodeText","Data":"​，则使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"UnstructuredPaddlePDFLoader"},{"Type":"NodeText","Data":"​ 加载器来加载文件，并结合 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ChineseTextSplitter"},{"Type":"NodeText","Data":"​ 对文本进行分割，最后将结果存储在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"docs"},{"Type":"NodeText","Data":"​ 中。"}]}]},{"ID":"20230811142639-uave9lb","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20230811142639-uave9lb","updated":"20230811142639"},"Children":[{"ID":"20230811142639-fo0hgsa","Type":"NodeParagraph","Properties":{"id":"20230811142639-fo0hgsa","updated":"20230811142639"},"Children":[{"Type":"NodeText","Data":"如果文件扩展名为 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":".jpg"},{"Type":"NodeText","Data":"​ 或 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":".png"},{"Type":"NodeText","Data":"​，则使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"UnstructuredPaddleImageLoader"},{"Type":"NodeText","Data":"​ 加载器以 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"\u0026quot;elements\u0026quot;"},{"Type":"NodeText","Data":"​ 模式加载文件，并结合 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ChineseTextSplitter"},{"Type":"NodeText","Data":"​ 对文本进行分割，最后将结果存储在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"docs"},{"Type":"NodeText","Data":"​ 中。"}]}]},{"ID":"20230811142639-g4mx2nw","Type":"NodeListItem","ListData":{"BulletChar":42,"Marker":"Kg=="},"Properties":{"id":"20230811142639-g4mx2nw","updated":"20230811142639"},"Children":[{"ID":"20230811142639-6sdeiyj","Type":"NodeParagraph","Properties":{"id":"20230811142639-6sdeiyj","updated":"20230811142639"},"Children":[{"Type":"NodeText","Data":"如果以上条件都不满足，则使用 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"UnstructuredFileLoader"},{"Type":"NodeText","Data":"​ 加载器以 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"\u0026quot;elements\u0026quot;"},{"Type":"NodeText","Data":"​ 模式加载文件，并结合 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"ChineseTextSplitter"},{"Type":"NodeText","Data":"​ 对文本进行分割，最后将结果存储在 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"docs"},{"Type":"NodeText","Data":"​ 中。"}]}]}]},{"ID":"20230811142639-jbqz1d9","Type":"NodeParagraph","Properties":{"id":"20230811142639-jbqz1d9","updated":"20230811142639"},"Children":[{"Type":"NodeText","Data":"最后，函数调用了 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"write_check_file(filepath, docs)"},{"Type":"NodeText","Data":"​ 来写入检查文件，然后返回 "},{"Type":"NodeTextMark","TextMarkType":"code","TextMarkTextContent":"docs"},{"Type":"NodeText","Data":"​ 列表作为结果。"}]},{"ID":"20230811142639-011zkhi","Type":"NodeParagraph","Properties":{"id":"20230811142639-011zkhi","updated":"20230811142650"},"Children":[{"Type":"NodeText","Data":"这段代码的作用是根据给定的文件路径加载文件内容，并根据文件的类型和规则进行解析和处理。"}]},{"ID":"20230811142642-badxd8z","Type":"NodeParagraph","Properties":{"id":"20230811142642-badxd8z"}}]}