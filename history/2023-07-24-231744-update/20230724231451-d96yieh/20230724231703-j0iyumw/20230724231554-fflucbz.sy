{"ID":"20230724231554-fflucbz","Spec":"1","Type":"NodeDocument","Properties":{"id":"20230724231554-fflucbz","title":"crypto-rsa","updated":"20230724231554"},"Children":[{"ID":"20230724231555-5pczrz3","Type":"NodeHeading","HeadingLevel":2,"Properties":{"id":"20230724231555-5pczrz3","updated":"20230724231555"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"## ","Properties":{"id":""}},{"Type":"NodeText","Data":"crypto-rsa"}]},{"ID":"20230724231556-v2f8deh","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231556-v2f8deh","updated":"20230724231556"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"import \"\"\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231557-c3ckfkg","Type":"NodeParagraph","Properties":{"id":"20230724231557-c3ckfkg","updated":"20230724231557"},"Children":[{"Type":"NodeText","Data":"rsa包实现了PKCS#1规定的RSA加密算法。"}]},{"ID":"20230724231558-v7vm6jd","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231558-v7vm6jd","updated":"20230724231558"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"Constants"}]},{"ID":"20230724231559-1bzk5jr","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231559-1bzk5jr","updated":"20230724231559"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"const (\n    // PSSSaltLengthAuto让PSS签名在签名时让盐尽可能长，并在验证时自动检测出盐。\n    PSSSaltLengthAuto = 0\n    // PSSSaltLengthEqualsHash让盐的长度和用于签名的哈希值的长度相同。\n    PSSSaltLengthEqualsHash = -1\n)\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231560-7zabm43","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231560-7zabm43","updated":"20230724231560"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"Variables"}]},{"ID":"20230724231561-j9ftknv","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231561-j9ftknv","updated":"20230724231561"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"var ErrDecryption = errors.New(\"crypto/rsa: decryption error\")\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231562-wszuk2y","Type":"NodeParagraph","Properties":{"id":"20230724231562-wszuk2y","updated":"20230724231562"},"Children":[{"Type":"NodeText","Data":"ErrDecryption代表解密数据失败。它故意写的语焉不详，以避免适应性攻击。"}]},{"ID":"20230724231563-s35qvw2","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231563-s35qvw2","updated":"20230724231563"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"var ErrMessageTooLong = errors.New(\"crypto/rsa: message too long for RSA public key size\")\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231564-7tfm2mo","Type":"NodeParagraph","Properties":{"id":"20230724231564-7tfm2mo","updated":"20230724231564"},"Children":[{"Type":"NodeText","Data":"当试图用公钥加密尺寸过大的数据时，就会返回ErrMessageTooLong。"}]},{"ID":"20230724231565-sr9s98s","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231565-sr9s98s","updated":"20230724231565"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"var ErrVerification = errors.New(\"crypto/rsa: verification error\")\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231566-fp9r71q","Type":"NodeParagraph","Properties":{"id":"20230724231566-fp9r71q","updated":"20230724231566"},"Children":[{"Type":"NodeText","Data":"ErrVerification代表认证签名失败。它故意写的语焉不详，以避免适应性攻击。"}]},{"ID":"20230724231567-bbp8vaf","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231567-bbp8vaf","updated":"20230724231567"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"type "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/crypto/rsa/rsa.go?name=release#73","TextMarkTextContent":"CRTValue"}]},{"ID":"20230724231568-ljxjkpt","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231568-ljxjkpt","updated":"20230724231568"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"type CRTValue struct {\n    Exp   *big.Int // D mod (prime-1).\n    Coeff *big.Int // R·Coeff ≡ 1 mod Prime.\n    R     *big.Int // product of primes prior to this (inc p and q).\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231569-mmcra91","Type":"NodeParagraph","Properties":{"id":"20230724231569-mmcra91","updated":"20230724231569"},"Children":[{"Type":"NodeText","Data":"CRTValue包含预先计算的中国剩余定理的值。"}]},{"ID":"20230724231570-x2aa1o5","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231570-x2aa1o5","updated":"20230724231570"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"type "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/crypto/rsa/rsa.go?name=release#61","TextMarkTextContent":"PrecomputedValues"}]},{"ID":"20230724231571-je674io","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231571-je674io","updated":"20230724231571"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"type PrecomputedValues struct {\n    Dp, Dq *big.Int // D mod (P-1) (or mod Q-1)\n    Qinv   *big.Int // Q^-1 mod P\n    // CRTValues用于保存第3个及其余的素数的预计算值。\n    // 因为历史原因，头两个素数的CRT在PKCS#1中的处理是不同的。\n    // 因为互操作性十分重要，我们镜像了这些素数的预计算值。\n    CRTValues []CRTValue\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231572-t5xe8pa","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231572-t5xe8pa","updated":"20230724231572"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"type "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/crypto/rsa/rsa.go?name=release#21","TextMarkTextContent":"PublicKey"}]},{"ID":"20230724231573-f2mv2lw","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231573-f2mv2lw","updated":"20230724231573"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"type PublicKey struct {\n    N   *big.Int // 模\n    E   int      // 公开的指数\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231574-66wx6ni","Type":"NodeParagraph","Properties":{"id":"20230724231574-66wx6ni","updated":"20230724231574"},"Children":[{"Type":"NodeText","Data":"代表一个RSA公钥。"}]},{"ID":"20230724231575-libbndg","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231575-libbndg","updated":"20230724231575"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"type "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/crypto/rsa/rsa.go?name=release#51","TextMarkTextContent":"PrivateKey"}]},{"ID":"20230724231576-yvxcx3i","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231576-yvxcx3i","updated":"20230724231576"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"type PrivateKey struct {\n    PublicKey            // 公钥\n    D         *big.Int   // 私有的指数\n    Primes    []*big.Int // N的素因子，至少有两个\n    // 包含预先计算好的值，可在某些情况下加速私钥的操作\n    Precomputed PrecomputedValues\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231577-wmgqk41","Type":"NodeParagraph","Properties":{"id":"20230724231577-wmgqk41","updated":"20230724231577"},"Children":[{"Type":"NodeText","Data":"代表一个RSA私钥。"}]},{"ID":"20230724231578-szhe8w0","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230724231578-szhe8w0","updated":"20230724231578"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/crypto/rsa/rsa.go?name=release#125","TextMarkTextContent":"GenerateKey"}]},{"ID":"20230724231579-f5evumq","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231579-f5evumq","updated":"20230724231579"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func GenerateKey(random io.Reader, bits int) (priv *PrivateKey, err error)\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231580-qml8mg7","Type":"NodeParagraph","Properties":{"id":"20230724231580-qml8mg7","updated":"20230724231580"},"Children":[{"Type":"NodeText","Data":"GenerateKey函数使用随机数据生成器random生成一对具有指定字位数的RSA密钥。"}]},{"ID":"20230724231581-btru3q1","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230724231581-btru3q1","updated":"20230724231581"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/crypto/rsa/rsa.go?name=release#140","TextMarkTextContent":"GenerateMultiPrimeKey"}]},{"ID":"20230724231582-6umb1vr","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231582-6umb1vr","updated":"20230724231582"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func GenerateMultiPrimeKey(random io.Reader, nprimes int, bits int) (priv *PrivateKey, err error)\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231583-b36kab2","Type":"NodeParagraph","Properties":{"id":"20230724231583-b36kab2","updated":"20230724231583"},"Children":[{"Type":"NodeText","Data":"GenerateMultiPrimeKey使用指定的字位数生成一对多质数的RSA密钥，参见US patent 4405829。虽然公钥可以和二质数情况下的公钥兼容（事实上，不能区分两种公钥），私钥却不行。因此有可能无法生成特定格式的多质数的密钥对，或不能将生成的密钥用在其他（语言的）代码里。"}]},{"ID":"20230724231584-ny23h0r","Type":"NodeParagraph","Properties":{"id":"20230724231584-ny23h0r","updated":"20230724231584"},"Children":[{"Type":"NodeText","Data":"http://www.cacr.math.uwaterloo.ca/techreports/2006/cacr2006-16.pdf中的Table 1说明了给定字位数的密钥可以接受的质数最大数量。"}]},{"ID":"20230724231585-83g5ogv","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230724231585-83g5ogv","updated":"20230724231585"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func (*PrivateKey) "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/crypto/rsa/rsa.go?name=release#348","TextMarkTextContent":"Precompute"}]},{"ID":"20230724231586-1zrf976","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231586-1zrf976","updated":"20230724231586"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func (priv *PrivateKey) Precompute()\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231587-6t0jswu","Type":"NodeParagraph","Properties":{"id":"20230724231587-6t0jswu","updated":"20230724231587"},"Children":[{"Type":"NodeText","Data":"Precompute方法会预先进行一些计算，以加速未来的私钥的操作。"}]},{"ID":"20230724231588-iellur4","Type":"NodeHeading","HeadingLevel":4,"Properties":{"id":"20230724231588-iellur4","updated":"20230724231588"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"#### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func (*PrivateKey) "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/crypto/rsa/rsa.go?name=release#81","TextMarkTextContent":"Validate"}]},{"ID":"20230724231589-uf0pqks","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231589-uf0pqks","updated":"20230724231589"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func (priv *PrivateKey) Validate() error\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231590-9wj8k5a","Type":"NodeParagraph","Properties":{"id":"20230724231590-9wj8k5a","updated":"20230724231590"},"Children":[{"Type":"NodeText","Data":"Validate方法进行密钥的完整性检查。如果密钥合法会返回nil，否则会返回说明问题的error值。"}]},{"ID":"20230724231591-2gz4rlo","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231591-2gz4rlo","updated":"20230724231591"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"type "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/crypto/rsa/pss.go?name=release#220","TextMarkTextContent":"PSSOptions"}]},{"ID":"20230724231592-ztopcct","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231592-ztopcct","updated":"20230724231592"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"type PSSOptions struct {\n    // SaltLength控制PSS签名中加盐的长度，可以是字节数，或者某个PSS盐长度的常数\n    SaltLength int\n}\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231593-mtmfjic","Type":"NodeParagraph","Properties":{"id":"20230724231593-mtmfjic","updated":"20230724231593"},"Children":[{"Type":"NodeText","Data":"PSSOptions包含用于创建和认证PSS签名的参数。"}]},{"ID":"20230724231594-jpmxbug","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231594-jpmxbug","updated":"20230724231594"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/crypto/rsa/rsa.go?name=release#268","TextMarkTextContent":"EncryptOAEP"}]},{"ID":"20230724231595-sp7ns9q","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231595-sp7ns9q","updated":"20230724231595"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func EncryptOAEP(hash hash.Hash, random io.Reader, pub *PublicKey, msg []byte, label []byte) (out []byte, err error)\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231596-pesvwqa","Type":"NodeParagraph","Properties":{"id":"20230724231596-pesvwqa","updated":"20230724231596"},"Children":[{"Type":"NodeText","Data":"采用RSA-OAEP算法加密给出的数据。数据不能超过((公共模数的长度)-2*( hash长度)+2)字节。"}]},{"ID":"20230724231597-zeh9iyd","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231597-zeh9iyd","updated":"20230724231597"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/crypto/rsa/rsa.go?name=release#457","TextMarkTextContent":"DecryptOAEP"}]},{"ID":"20230724231598-malmm3e","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231598-malmm3e","updated":"20230724231598"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func DecryptOAEP(hash hash.Hash, random io.Reader, priv *PrivateKey, ciphertext []byte, label []byte) (msg []byte, err error)\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231599-099tvpp","Type":"NodeParagraph","Properties":{"id":"20230724231599-099tvpp","updated":"20230724231599"},"Children":[{"Type":"NodeText","Data":"DecryptOAEP解密RSA-OAEP算法加密的数据。如果random不是nil，函数会注意规避时间侧信道攻击。"}]},{"ID":"20230724231600-zdhv99g","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231600-zdhv99g","updated":"20230724231600"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/crypto/rsa/pkcs1v15.go?name=release#21","TextMarkTextContent":"EncryptPKCS1v15"}]},{"ID":"20230724231601-x3etc9f","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231601-x3etc9f","updated":"20230724231601"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func EncryptPKCS1v15(rand io.Reader, pub *PublicKey, msg []byte) (out []byte, err error)\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231602-qh2s979","Type":"NodeParagraph","Properties":{"id":"20230724231602-qh2s979","updated":"20230724231602"},"Children":[{"Type":"NodeText","Data":"EncryptPKCS1v15使用PKCS#1 v1.5规定的填充方案和RSA算法加密msg。信息不能超过((公共模数的长度)-11)字节。注意：使用本函数加密明文（而不是会话密钥）是危险的，请尽量在新协议中使用RSA OAEP。"}]},{"ID":"20230724231603-dawndq2","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231603-dawndq2","updated":"20230724231603"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/crypto/rsa/pkcs1v15.go?name=release#52","TextMarkTextContent":"DecryptPKCS1v15"}]},{"ID":"20230724231604-g9c2fan","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231604-g9c2fan","updated":"20230724231604"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func DecryptPKCS1v15(rand io.Reader, priv *PrivateKey, ciphertext []byte) (out []byte, err error)\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231605-dmt1fsl","Type":"NodeParagraph","Properties":{"id":"20230724231605-dmt1fsl","updated":"20230724231605"},"Children":[{"Type":"NodeText","Data":"DecryptPKCS1v15使用PKCS#1 v1.5规定的填充方案和RSA算法解密密文。如果random不是nil，函数会注意规避时间侧信道攻击。"}]},{"ID":"20230724231606-d6tuggh","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231606-d6tuggh","updated":"20230724231606"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/crypto/rsa/pkcs1v15.go?name=release#80","TextMarkTextContent":"DecryptPKCS1v15SessionKey"}]},{"ID":"20230724231607-sblnd6a","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231607-sblnd6a","updated":"20230724231607"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func DecryptPKCS1v15SessionKey(rand io.Reader, priv *PrivateKey, ciphertext []byte, key []byte) (err error)\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231608-59ido1l","Type":"NodeParagraph","Properties":{"id":"20230724231608-59ido1l","updated":"20230724231608"},"Children":[{"Type":"NodeText","Data":"DecryptPKCS1v15SessionKey使用PKCS#1 v1.5规定的填充方案和RSA算法解密会话密钥。如果random不是nil，函数会注意规避时间侧信道攻击。"}]},{"ID":"20230724231609-4lw3fch","Type":"NodeParagraph","Properties":{"id":"20230724231609-4lw3fch","updated":"20230724231609"},"Children":[{"Type":"NodeText","Data":"如果密文长度不对，或者如果密文比公共模数的长度还长，会返回错误；否则，不会返回任何错误。如果填充是合法的，生成的明文信息会拷贝进key；否则，key不会被修改。这些情况都会在固定时间内出现（规避时间侧信道攻击）。本函数的目的是让程序的使用者事先生成一个随机的会话密钥，并用运行时的值继续协议。这样可以避免任何攻击者从明文窃取信息的可能性。"}]},{"ID":"20230724231610-7ms2q5r","Type":"NodeParagraph","Properties":{"id":"20230724231610-7ms2q5r","updated":"20230724231610"},"Children":[{"Type":"NodeText","Data":"参见”Chosen Ciphertext Attacks Against Protocols Based on the RSA Encryption Standard PKCS "},{"Type":"NodeTag","Children":[{"Type":"NodeTagOpenMarker","Data":"#"},{"Type":"NodeText","Data":"1”。"},{"Type":"NodeTagCloseMarker","Data":"#"}]}]},{"ID":"20230724231611-qyslj2c","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231611-qyslj2c","updated":"20230724231611"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/crypto/rsa/pkcs1v15.go?name=release#194","TextMarkTextContent":"SignPKCS1v15"}]},{"ID":"20230724231612-7fd8okq","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231612-7fd8okq","updated":"20230724231612"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func SignPKCS1v15(rand io.Reader, priv *PrivateKey, hash crypto.Hash, hashed []byte) (s []byte, err error)\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231613-0tnaffs","Type":"NodeParagraph","Properties":{"id":"20230724231613-0tnaffs","updated":"20230724231613"},"Children":[{"Type":"NodeText","Data":"SignPKCS1v15使用RSA PKCS#1 v1.5规定的RSASSA-PKCS1-V1_5-SIGN签名方案计算签名。注意hashed必须是使用提供给本函数的hash参数对（要签名的）原始数据进行hash的结果。"}]},{"ID":"20230724231614-9i5bbrj","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231614-9i5bbrj","updated":"20230724231614"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/crypto/rsa/pkcs1v15.go?name=release#231","TextMarkTextContent":"VerifyPKCS1v15"}]},{"ID":"20230724231615-cnwk3km","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231615-cnwk3km","updated":"20230724231615"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func VerifyPKCS1v15(pub *PublicKey, hash crypto.Hash, hashed []byte, sig []byte) (err error)\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231616-3mx7175","Type":"NodeParagraph","Properties":{"id":"20230724231616-3mx7175","updated":"20230724231616"},"Children":[{"Type":"NodeText","Data":"VerifyPKCS1v15认证RSA PKCS#1 v1.5签名。hashed是使用提供的hash参数对（要签名的）原始数据进行hash的结果。合法的签名会返回nil，否则表示签名不合法。"}]},{"ID":"20230724231617-zkv4e29","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231617-zkv4e29","updated":"20230724231617"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/crypto/rsa/pss.go?name=release#238","TextMarkTextContent":"SignPSS"}]},{"ID":"20230724231618-dlglslp","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231618-dlglslp","updated":"20230724231618"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func SignPSS(rand io.Reader, priv *PrivateKey, hash crypto.Hash, hashed []byte, opts *PSSOptions) (s []byte, err error)\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231619-pajeqpt","Type":"NodeParagraph","Properties":{"id":"20230724231619-pajeqpt","updated":"20230724231619"},"Children":[{"Type":"NodeText","Data":"SignPSS采用RSASSA-PSS方案计算签名。注意hashed必须是使用提供给本函数的hash参数对（要签名的）原始数据进行hash的结果。opts参数可以为nil，此时会使用默认参数。"}]},{"ID":"20230724231620-5e79y4c","Type":"NodeHeading","HeadingLevel":3,"Properties":{"id":"20230724231620-5e79y4c","updated":"20230724231620"},"Children":[{"Type":"NodeHeadingC8hMarker","Data":"### ","Properties":{"id":""}},{"Type":"NodeText","Data":"func "},{"Type":"NodeTextMark","Properties":{"id":""},"TextMarkType":"a","TextMarkAHref":"https://github.com/golang/go/blob/master/src/crypto/rsa/pss.go?name=release#259","TextMarkTextContent":"VerifyPSS"}]},{"ID":"20230724231621-q8mw5v2","Type":"NodeCodeBlock","IsFencedCodeBlock":true,"CodeBlockFenceChar":96,"CodeBlockFenceLen":3,"CodeBlockOpenFence":"YGBg","CodeBlockCloseFence":"YGBg","Properties":{"id":"20230724231621-q8mw5v2","updated":"20230724231621"},"Children":[{"Type":"NodeCodeBlockFenceOpenMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}},{"Type":"NodeCodeBlockFenceInfoMarker","Properties":{"id":""}},{"Type":"NodeCodeBlockCode","Data":"func VerifyPSS(pub *PublicKey, hash crypto.Hash, hashed []byte, sig []byte, opts *PSSOptions) error\n","Properties":{"id":""}},{"Type":"NodeCodeBlockFenceCloseMarker","Data":"```","CodeBlockFenceLen":3,"Properties":{"id":""}}]},{"ID":"20230724231622-9dwj5ik","Type":"NodeParagraph","Properties":{"id":"20230724231622-9dwj5ik","updated":"20230724231622"},"Children":[{"Type":"NodeText","Data":"VerifyPSS认证一个PSS签名。hashed是使用提供给本函数的hash参数对（要签名的）原始数据进行hash的结果。合法的签名会返回nil，否则表示签名不合法。opts参数可以为nil，此时会使用默认参数。"}]}]}